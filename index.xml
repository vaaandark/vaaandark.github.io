<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>vaaandark&#39;s blog</title>
    <link>https://vaaandark.top/</link>
    <description>Recent content on vaaandark&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <lastBuildDate>Fri, 27 Dec 2024 20:07:44 +0800</lastBuildDate><atom:link href="https://vaaandark.top/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>åŒåŸè®°â€”â€”2024 å›é¡¾</title>
      <link>https://vaaandark.top/posts/2024-look-back/</link>
      <pubDate>Fri, 27 Dec 2024 20:07:44 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/2024-look-back/</guid>
      <description>&lt;p&gt;2024 å¹´è¿‡å¾—çœŸå¿«ï¼Œæˆ‘çš„æœ¬ç§‘ä¹Ÿè¿‡å¾—é£å¿«ï¼Œå·²ç»æ˜¯åäºŒæœˆæœ«äº†ï¼Œå†æœ‰äº”å…­ä¸ªæœˆæˆ‘å°±æ¯•ä¸šäº†ï¼Œè€Œä¸”æˆ‘å·²ç»æ‰“äº†åŠå¹´å¤šçš„å·¥äº†ã€‚ç›¸æ¯”å¿ƒæ€ä¸Šçš„è½¬å˜ï¼Œç”Ÿæ´»å·¥ä½œæ–¹å¼å’ŒèŠ‚å¥çš„å˜åŒ–åˆ™æ˜¯çœŸçœŸåˆ‡åˆ‡è€Œä¸”æ— æ³•å›é¿çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¹´æœ‰å¤ªå¤šçš„ç¬¬ä¸€æ¬¡å°è¯•ï¼šç¬¬ä¸€æ¬¡åœ¨å¦ä¸€åº§åŸå¸‚ç”Ÿæ´»ï¼Œç¬¬ä¸€æ¬¡å®ä¹ ï¼Œç¬¬ä¸€æ¬¡è½¬æ­£ç­”è¾©ï¼Œç¬¬ä¸€æ¬¡è·å¾—å›½å®¶çº§ç«èµ›ä¸€ç­‰å¥–ï¼Œç¬¬ä¸€æ¬¡å¬éŸ³ä¹ä¼šâ€¦â€¦ä¹Ÿåšå‡ºäº†å¤ªå¤šé€‰æ‹©ï¼šé€‰æ‹©å®ä¹ å»å‘ï¼Œé€‰æ‹©æ”¾å¼ƒä¿ç ”â€¦â€¦&lt;/p&gt;
&lt;p&gt;ä»Šå¹´å»è¿‡å…­ä¸ªåŸå¸‚ï¼ŒæŒ‰ç…§æ—¶é—´å…ˆåæ˜¯æ­¦æ±‰ã€ä¸Šæµ·ã€å®œæ˜Œã€æ·±åœ³ã€é¦™æ¸¯å’Œæˆéƒ½ï¼Œåœ¨æ­¦æ±‰ç”Ÿæ´»å’Œè¯»ä¹¦ï¼Œåœ¨ä¸Šæµ·å‚åŠ äº†ä¸€åœºè¶…ç®—æ¯”èµ›ï¼Œåœ¨æ·±åœ³å®ä¹ ï¼Œå»äº†é¦™æ¸¯å’Œé‡åº†æ—…æ¸¸ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šæµ·çš„ ASC è¶…ç®—æ¯”èµ›æ˜¯è½»æ¾åŠ æ„‰å¿«çš„ï¼Œæˆ‘ä½œä¸ºç¼–å¤–è¿ç»´æ‰“äº†é…±æ²¹ï¼Œè¢«å­¦é•¿å­¦å§è¯·åƒé¥­ï¼Œè¿˜å’Œé«˜ä¸­åŒå­¦è¿ç©ä¸¤å¤©ï¼Œç”šè‡³åœ¨ä¸Šæµ·æ”¶è·äº†æˆ‘çš„å®ä¹  offerã€‚ç­‰åˆ°å›½é™…åŠ³åŠ¨èŠ‚å‰å¤•ï¼Œæˆ‘åˆå’Œå®¤å‹é”™å³°æ¸¸äº†å®œæ˜Œï¼Œåœ¨æ¸…æ±Ÿå³¡è°·æ”¶è·äº†æˆ‘çš„å¾®ä¿¡å¤´åƒï¼Œè¿˜è§è¯†äº†ä¸‰å³¡å¤§åçš„äººé€ ä¼ŸåŠ›ã€‚ä¹‹åæˆ‘ä¾¿é©¬ä¸åœè¹„é£å¾€æ·±åœ³å®ä¹ ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¯¹å®ä¹ ç§‹æ‹›å…¶å®æ˜¯ç¼ºä¹å‡†å¤‡çš„ï¼Œå…«è‚¡ä¹Ÿæ²¡å¥½å¥½èƒŒï¼Œé¢˜ç›®ä¹Ÿæ²¡å¥½å¥½åˆ·ï¼Œæ‰€ä»¥é¢è¯•ä¸­è‡ªå·±çš„é•¿æ¿å’ŒçŸ­æ¿éƒ½å±•ç°å¾—æ·‹æ¼“å°½è‡´ã€‚æ¯”å¦‚æˆ‘å¯ä»¥è·Ÿé¢è¯•å®˜ç•…è°ˆæ“ä½œç³»ç»Ÿå’Œåç¨‹æ¶‰åŠï¼Œä½†é‡åˆ°æ•°æ®åº“ç›´æ¥è¯´æˆ‘ä¸ä¼šã€‚éå¸¸æ„Ÿè°¢è…¾è®¯â˜ï¸çš„é¢è¯•å®˜ï¼Œå¯ä»¥è¯´æ˜¯ä¸æ‹˜ä¸€æ ¼é™äººæ‰äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯éå¸¸å¯¹èƒƒå£ï¼ˆæ ¹æ®ä¹‹åä»–åšæˆ‘å¯¼å¸ˆçš„æƒ…å†µæ¥çœ‹ï¼‰ã€‚åœ¨ç»è¿‡äº†ä¸€æ¬¡æŠ€æœ¯é¢ï¼Œä¸€æ¬¡æ€»ç›‘é¢ï¼Œä¸€æ¬¡ hr é¢åæˆ‘è¿›å…¥äº†è…¾è®¯äº‘å®ä¹ ï¼Œåœ¨äº‘åŸç”Ÿçš„å®¹å™¨å›¢é˜Ÿåšåˆ†å¸ƒå¼ç›¸å…³çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¹‹å‰æˆ‘ä»æœªåœ¨å®¶ä¹¡ä¹‹å¤–çš„åŸå¸‚ç”Ÿæ´»ï¼Œç”Ÿæ´»çŠ¶æ€çš„è½¬æ¢å…¶å®æ²¡æœ‰é‚£ä¹ˆå›°éš¾ã€‚å’Œä»åˆä¸­å¼€å§‹åŒå­¦çš„æœ‹å‹ä¸€èµ·æ¥åˆ°æ·±åœ³å®ä¹ ï¼Œåˆç§Ÿä¸€é—´ä¸¤å±…å®¤ï¼Œä¸€èµ·äº¤ç»™ä¸­ä»‹åŠä¸ªæœˆçš„æˆ¿ç§Ÿã€‚ä»ä¸€å¼€å§‹ä¸€èµ·ä¸Šç­ä¸‹ç­ï¼Œåˆ°åæ¥æˆ‘ä¸‹ç­æ™šæ—©ä¸Šèµ·ä¸æ¥ï¼Œæˆ‘ä»¬åˆ†åˆ«ä¸Šä¸‹ç­ã€‚æˆ‘å‘¨æœ«åˆ°å¤„é—²é€›ï¼Œæ¢ç´¢æ·±åœ³ï¼›ä»–ä¸­é€”æš‘ç ”ï¼Œå¹³æ—¶å¤ä¹ è€ƒè¯•å¹¶å‡†å¤‡è‹±è¯­ã€‚æˆ‘å‡†å¤‡è½¬æ­£å’Œç›´æ¥å·¥ä½œï¼›ä»–å……å®ç®€å†å¹¶å‡†å¤‡å‡ºå›½ï¼šæˆ‘ä»¬éƒ½åšç€å„è‡ªè®¤ä¸ºæ­£ç¡®çš„äº‹æƒ…ã€‚ç›´åˆ°æˆ‘å¼€å§‹å‡†å¤‡è½¬æ­£ç­”è¾©ï¼Œä»–å‘ç°äº†æ›´é€‚åˆä»–çš„å®ä¹ å²—ä½ã€‚æœ€åæˆ‘ä»¬éƒ½ç¦»å¼€é‚£é—´ä¸¤å±…å®¤ï¼Œä»–å»å‘ä¸Šæµ·ï¼Œæˆ‘å»å‘éš”å£çš„ä¸€å±…å®¤â€¦â€¦&lt;/p&gt;
&lt;p&gt;å·¥ä½œå’Œè½¬æ­£éƒ½æ¯”æˆ‘æƒ³è±¡ä¸­é¡ºåˆ©å¾ˆå¤šï¼Œç»„å†…æ°›å›´å¾ˆå¥½ï¼ŒåŒäº‹å’Œè€æ¿éƒ½å¾ˆå¥½ã€‚å°¤å…¶æ˜¯å¯¼å¸ˆå¸®åŠ©äº†æˆ‘å¾ˆå¤šï¼Œåœ¨æˆ‘å…¥èŒå‰ä¸€å¤©å°±åšå¥½äº†æˆ‘çš„åŸ¹å…»è®¡åˆ’å‘ç»™äº†æˆ‘ï¼Œå¯†å¯†éº»éº»çš„å¥½å‡ é¡µã€‚æˆ‘ä¸çŸ¥é“æˆ‘åœ¨åˆ«çš„åœ°æ–¹æ˜¯å¦ä¼šæ”¶åˆ°è¿™æ ·çš„é‡è§†å’ŒåŸ¹å…»â€”â€”æˆ‘è§‰å¾—ä¸ä¼šï¼Œæ‰€ä»¥æˆ‘ç›´æ¥å‡†å¤‡äº†å®ä¹ è½¬æ­£ï¼Œæ²¡æœ‰è€ƒè™‘å®ä¹ ã€‚æˆ‘ä¹Ÿå–œæ¬¢è¿™ä¸ªå·¥ä½œï¼Œæˆ‘å¹¶æ²¡æœ‰æ¥è§¦è¿‡åç«¯ä¸šåŠ¡ï¼Œä¹Ÿå¹¶ä¸å–œæ¬¢ curdï¼Œæˆ‘æ›´å–œæ¬¢ infra å’Œè§£å†³ Linux çš„ç–‘éš¾æ‚ç—‡ã€‚&lt;/p&gt;
&lt;p&gt;æš‘å‡å’Œæˆ‘å¦ˆå»äº†é¦™æ¸¯è½¬äº†ä¸€ä¸‹ï¼Œåœ¨ä¹‹åå’Œæœ‹å‹å»é‡åº†ç©·æ¸¸ã€‚é¡ºå¸¦ä¸€æï¼Œé‡åº†å’Œé¦™æ¸¯çœŸåƒï¼Œè·¯ä¸Šéƒ½æ˜¯é»„è‰²çš„å‡ºç§Ÿè½¦ï¼Œè·¯ä¸Šéƒ½æ²¡æœ‰ç”µåŠ¨è½¦ã€‚æˆ‘å¥½åƒé™¤äº†åˆä¸­æ¯•ä¸šå’Œé«˜ä¸­æ¯•ä¸šæ—¶ï¼Œæ„Ÿè§‰ä»æ¥æ²¡æœ‰è¿™ä¹ˆè‡ªç”±è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;å®ä¹ ç­”è¾©åæˆ‘å›åˆ°äº†æ­¦æ±‰ä¸Šå­¦ï¼ˆå…¶å®æ˜¯ç¿˜è¯¾åœ¨æ­¦æ±‰çš„ base ä¸Šç­ï¼‰ï¼Œåœ¨ä¸Šè½¦å‰æ¥åˆ°è€æ¿çš„ç”µè¯å‘Šè¯‰æˆ‘å¯ä»¥ç•™ç”¨ï¼Œåœ¨æ¬£å–œè¿‡åçš„ææƒšé—´æˆ‘æ‰å‘ç°æˆ‘å…¶å®å¯ä»¥ä¸ç”¨å‡†å¤‡ç§‹æ‹›äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¥½åƒæ²¡æœ‰åšä»€ä¹ˆé€‰æ‹©ï¼Œè¢«æœºç¼˜æ¨ç€å‰è¡Œï¼Œä½†åˆåœ¨æ¯ä¸ªå‘½è¿çš„åå­—è·¯å£åšå‡ºäº†åšå®šçš„é€‰æ‹©ã€‚åœ¨å…«æœˆä»½æˆ‘è¢«å¸¦ç€æ‰“äº†æ“ä½œç³»ç»Ÿèµ›è·å¾—äº†ä¸€ç­‰å¥–ï¼Œæˆ‘åˆçªç„¶æ„è¯†ï¼Œæˆ‘å¯èƒ½æœ‰ä¿ç ”çš„æœºä¼šã€‚ç»“æœä¹æœˆä»½æ—¶æˆ‘å‘ç°æˆ‘ä¸Šä¸ªå­¦æœŸçš„ä½“è‚²è¯¾æˆç»©å› ä¸ºæå‰è€ƒè¯•å¹¶è·‘è·¯å»å®ä¹ è€Œæ²¡æœ‰ä½œæ•°ï¼Œæˆ‘å¿…é¡»å¿«é€Ÿåšå‡ºé€‰æ‹©ï¼Œæ˜¯å…¨åŠ›äº‰å–ä½“è‚²æˆç»©ç”Ÿæ•ˆäº‰å–ä¿ç ”ï¼Œè¿˜æ˜¯å°½åŠ›äº‰å–å°±è¡Œï¼Œæœ¬ç§‘æ¯•ä¸šç›´æ¥å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;ç†Ÿæ‚‰æˆ‘çš„æœ‹å‹éƒ½çŸ¥é“åæ¥å‘ç”Ÿçš„æ•…äº‹äº†ï¼Œæˆ‘æ”¾å¼ƒäº†ä¿ç ”ï¼Œæˆ‘åœ¨å›½åº†é•¿å‡åå›åˆ°äº†æ·±åœ³ç»§ç»­å®ä¹ ã€‚åªä¸è¿‡é‚£ä¸ªæ—¶å€™æš‘æœŸå·²è¿‡ï¼Œæ·±åœ³å†æ²¡æœ‰åŒçº§çš„åŒå­¦ä¸€èµ·å®ä¹ ï¼Œæˆ‘åŸä»¥ä¸ºåç»­å®ä¹ çš„åŸºè°ƒæ˜¯å­¤ç‹¬è€Œæ— èŠçš„ï¼Œä½†æˆ‘å‘ç°æˆ‘å·²ç»èå…¥äº†å›¢é˜Ÿï¼šæˆ‘å…ˆæ˜¯è¢«åŒäº‹é‚€è¯·å»ä»–ä¹”è¿ä¹‹å–œï¼Œæ—¶éš”å¤šå¹´å†æ¬¡æ‰“äº†ä¸‰å›½æ€ï¼Œè¿™æ˜¯åœ¨å¤§å­¦è¿™ä¸ªå……æ»¡å¹´è½»äººçš„åœ°æ–¹éƒ½ä¸æ›¾æœ‰è¿‡çš„ä½“éªŒï¼›åˆå»äº†æƒ å·å›¢å»ºï¼Œäººç”Ÿç¬¬ä¸€æ¬¡çœ‹åˆ°å¦‚æ­¤æ¸…æ™°çš„æ˜Ÿç©ºã€‚æˆ‘ä¹Ÿå‘ç°äº†å…¶ä»–æœ‰è¶£çš„æ´»åŠ¨ï¼Œæˆ‘åœ¨åä¸€æœˆå·¦å³å¼€å§‹æ¯å‘¨æœ«ç‹¬è‡ªçˆ¬ä¸¤åº§å±±ï¼Œè¿™æ˜¯ç”Ÿåœ¨æ±Ÿæ±‰å¹³åŸçš„æˆ‘ä»æœªæœ‰è¿‡çš„ä½“éªŒï¼šä¸­åˆèµ·åºŠï¼Œéª‘è¡Œå‰å¾€å±±è„šä¸‹ï¼Œå‚æ™šå‰ç™»é¡¶æ¬£èµæ—¥è½ï¼Œèµ°å¤œè·¯ä¸‹å±±ï¼Œå†éª‘è¡Œå›å®¶ã€‚ä¹˜å…´è€Œæ¥ï¼Œå…´å°½è€Œå½’ã€‚&lt;/p&gt;
&lt;p&gt;åˆ°å‰å‡ å¤©ï¼Œä¹Ÿå°±æ˜¯åœ£è¯å‰å¤•ï¼Œæˆ‘åˆå’Œæœ‹å‹å»é¦™æ¸¯å¬äº†å¼¥æ’’äºšéŸ³ä¹ä¼šï¼Œåˆæ˜¯æ–°å¥‡çš„äººç”Ÿä½“éªŒã€‚åœ¨å“ˆåˆ©è·¯äºšçš„å¤§åˆå”±ä¸­ï¼Œæˆ‘çœ‹åˆ°æ‰€æœ‰ä¿¡å¾’èµ·ç«‹ï¼Œå‘å—éš¾ç¾”ç¾Šè‡´æ•¬ï¼›åœ¨ç»´æ¸¯æµ·è¾¹çš„è½»é£å’ŒéŸ³ä¹ä¸­ï¼Œæˆ‘åˆæ„Ÿåˆ°æ–‡è‰ºç”µå½±é‡åº†æ£®æ—èˆ¬çš„æ°›å›´ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åœ¨é¦™æ¸¯çš„ä¹¦åº—åˆçœ‹åˆ°äº†æˆ‘æƒ³çœ‹è€Œä¸€ç›´æ²¡æ—¶é—´çœ‹çš„å¡å¤«å¡çš„ã€ŠåŸå ¡ã€‹ï¼Œæˆ‘å´è”æƒ³åˆ°ä¸­é—´ä»¶æ¶ˆæ¯é˜Ÿåˆ—å·¥å…· kafkaï¼Œä¹Ÿè®¸æˆ‘å¯ä»¥æŠŠæˆ‘ä¸‹ä¸€ä¸ªå†™çš„äº‘åŸç”Ÿç»„ä»¶å‘½åä¸ºå¡å°”ç»´è¯ºï¼ˆæŒ‰ç…§â˜ï¸ä¸Šå·¥å…·çš„å‘½åä¹ æƒ¯æŠŠcæ”¹æˆkï¼‰ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘æœ€å–œæ¬¢çš„ä½œå®¶ã€‚æˆ–è€…å¯ä»¥å«æŸ¯è¥¿è«ï¼Œè®©ğŸŒ³ä¸Šçš„ç”·çˆµå˜æˆâ˜ï¸ä¸Šçš„ç”·çˆµã€‚&lt;/p&gt;
&lt;p&gt;å†è§æˆ‘çš„ 2024ï¼Œæˆ‘å·²ä¸Šâ˜ï¸ï¼ŒçŠ¶æ€è‰¯å¥½ã€‚å¸Œæœ›ç”Ÿæ´»åœ¨â˜ï¸ä¸Šä¸æ˜¯ç”Ÿæ´»åœ¨ğŸŒ³ä¸Šï¼Œä¸æ˜¯ç¦»ç¾¤ç´¢å±…ï¼Œè€Œæ˜¯å‘½è¿ä¸å…±â€¦â€¦&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æ±‚ n ä¸ªæ•°ä¸­å‰ k å°çš„æ•°</title>
      <link>https://vaaandark.top/posts/the-smallest-k-numbers/</link>
      <pubDate>Wed, 27 Mar 2024 20:02:33 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/the-smallest-k-numbers/</guid>
      <description>&lt;p&gt;é¢è¯•æ—¶é‡åˆ°çš„ä¸€é“é¢˜ï¼šç»™å‡ºç»™å‡º n ä¸ªæ•°ï¼Œæ±‚å‡ºå‰ k å°çš„æ•°å­—ã€‚&lt;/p&gt;
&lt;p&gt;è¾“å…¥æ˜¯ n + 1 è¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€è¡Œæ˜¯ n å’Œ k&lt;/li&gt;
&lt;li&gt;ä¹‹å n è¡Œæ˜¯è¿™ä¸ªæ•°åˆ—&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¾“å‡ºæ˜¯ k ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ—¶æ²¡æƒ³å‡ºæ¥æ€ä¹ˆåšï¼Œç›´æ¥å—¯æ’åºï¼Œç„¶åè¾“å‡ºï¼ŒOJ çš„æ—¶é™æ¯”è¾ƒå®½å®¹ï¼Œç«Ÿç„¶è¿‡äº†ğŸ˜„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ä¸è¿‡åœ¨é¢è¯•å®˜é‚£é‡Œè‚¯å®šæ˜¯æ²¡è¿‡çš„ã€‚&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ç›´æ¥æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(nlg{n})$ ï¼Œå¦‚æœç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸º k çš„å †åˆ™æ˜¯èƒ½å¤Ÿä¼˜åŒ–æˆ $O(nlg{k})$ ï¼Œè‚¯å®šæœ‰æ›´å¥½çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;åæ¥æƒ³åˆ°äº†ç±»ä¼¼å¿«æ’çš„åˆ’åˆ†çš„æ€æƒ³ï¼Œä»£ç å’Œæ€è·¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;using&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;namespace&lt;/span&gt; std;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// æ‰“å°èŒƒå›´åœ¨ [begin, end) çš„æ•°ç»„åˆ‡ç‰‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; print_slice(vector&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;a, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; begin, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; end) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//  cout &amp;lt;&amp;lt; &amp;#34;-------&amp;#34; &amp;lt;&amp;lt; endl;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = begin; i &amp;lt; end; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cout &amp;lt;&amp;lt; a[i] &amp;lt;&amp;lt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//  cout &amp;lt;&amp;lt; endl;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//  cout &amp;lt;&amp;lt; &amp;#34;-------&amp;#34; &amp;lt;&amp;lt; endl;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// ç±»ä¼¼äºŒåˆ†çš„æ€æƒ³ï¼Œå¯¹äºèŒƒå›´åœ¨ [begin, end) çš„æ•°ç»„åˆ‡ç‰‡è¿›è¡Œåˆ’åˆ†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; sol(vector&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;&amp;gt; &amp;amp;a, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; begin, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; end, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; k) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (begin &amp;gt;= end || k &amp;lt;= &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; lower = begin;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; upper = end - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// ä»¥æœ€å·¦è¾¹çš„ä¸ºè½´
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// å°äºå®ƒçš„æ”¾å·¦è¾¹ï¼Œå¤§äºå®ƒçš„æ”¾å³è¾¹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; pivot = a[lower];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (lower &amp;lt; upper) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (lower &amp;lt; upper &amp;amp;&amp;amp; a[upper] &amp;gt; pivot) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      upper -= &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (lower &amp;lt; upper) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      a[lower] = a[upper];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      lower += &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (lower &amp;lt; upper &amp;amp;&amp;amp; a[lower] &amp;lt; pivot) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      lower += &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (lower &amp;lt; upper) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      a[upper] = a[lower];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      upper -= &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  a[lower] = pivot;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; left_count = lower - begin;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// å·¦è¾¹çš„æ•°å°±æ˜¯å‰ left_count å°çš„æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// å¦‚æœè½´å·¦è¾¹æ•°çš„æ•°é‡åˆšå¥½ä¸º k - 1 ï¼Œåˆ™è¯´æ˜å·²ç»æ‰¾åˆ°äº†å‰ k å°çš„æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// å¦‚æœå°äº k - 1 ï¼Œåˆ™è¯´æ˜è¿˜éœ€è¦åœ¨å³è¾¹æ‰¾å‰ k - 1 - left_count å°çš„æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// å¦‚æœå¤§äº k - 1 ï¼Œåˆ™è¯´æ˜éœ€è¦åœ¨å·¦è¾¹æ‰¾å‰ k å°çš„æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (left_count &amp;lt;= k - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print_slice(a, begin, lower + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sol(a, lower + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, end, k - left_count - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sol(a, begin, lower, k);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n, k;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  vector&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;&amp;gt; a(n);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; n; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cin &amp;gt;&amp;gt; a[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  sol(a, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, n, k);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  cout &amp;lt;&amp;lt; endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é“é¢˜åœ¨ &lt;a href=&#34;https://leetcode.cn/problems/smallest-k-lcci/description/&#34;&gt;åŠ›æ‰£&lt;/a&gt; ä¸Šä¹Ÿæœ‰ï¼Œçœ‹äº†é¢˜è§£ä¹‹åå‘ç°è¿™æ˜¯ç®—æ³•å¯¼è®ºä¸Šè®²è¿‡çš„ï¼Œæ„Ÿè§‰è‡ªå·±ä¸ä»…ç®—æ³•æ°´å¹³ä½ä¸‹ï¼Œè€Œä¸”è¿˜è¯»ä¹¦ä¸è®¤çœŸğŸ˜­ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2021 å¹´å…«æœˆæ‚æ„Ÿã€è¡¥æ¡£ã€‘</title>
      <link>https://vaaandark.top/posts/scribble-in-august/</link>
      <pubDate>Sat, 16 Mar 2024 01:58:33 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/scribble-in-august/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;é¦–å‘äºçŸ¥ä¹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»æœªå¯¹å¾ˆå°‘é˜…è¯»è¿‘ä¸‰åå¹´çš„æ–‡å­¦ä½œå“æ„Ÿåˆ°é—æ†¾ï¼Œå› ä¸ºæˆ‘å¹¶æ²¡æœ‰ä»é‚£äº›å·²ç»åŠ å…¥ä½œåçš„â€œä¸»æµâ€ä½œå®¶é‚£é‡Œæ±²å–è¿‡è¥å…»ï¼Œæˆ‘è§‰å¾—ä½œå®¶ä¸é ç¨¿è´¹è€Œæ˜¯é ä½“åˆ¶çš„å·¥èµ„ç”Ÿæ´»æ˜¯ä¸€ä»¶å¥‡æ€ªè€Œåˆç¾è€»çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡æˆ‘çš„ç¡®ä¹Ÿæ›¾è¯»è¿‡ä»–ä»¬ä½œå“çš„ç‰‡æ®µï¼Œé‚£æ˜¯åœ¨åˆä¸­å’Œé«˜ä¸­çš„é˜…è¯»ä¹‹ä¸­ï¼Œä½†è¿™ä½¿æˆ‘å¸¸å¸¸æ„Ÿåˆ°åŒçƒ¦ã€‚å€’ä¸æ˜¯å› ä¸ºå¯¹åº”è¯•çš„åæ„Ÿï¼Œå¯èƒ½å°±æ˜¯æ€§æ ¼è®©æˆ‘è¯»ä¸è¿›å»è¿™äº›æ–‡ç« ã€‚æˆ‘ä¼šåæ„Ÿä½™ç§‹é›¨çš„â€œæ–‡åŒ–å¤§æ•£æ–‡â€ï¼Œä¹Ÿä¼šè§‰å¾—éŸ©å°‘åŠŸçš„ä½œå“å……æ»¡äº†å°å†œæ€æƒ³ï¼Œè¿˜ä¼šè§‰å¾—ã€Šå—æ¸¡åŒ—å½’ã€‹å¯¹æ°‘å›½å’Œæ°‘å›½çŸ¥è¯†ç²¾è‹±è¿‡åº¦ç¾åŒ–â€¦â€¦æ— ä¸€ä¾‹å¤–ï¼Œè¿™éƒ½æ˜¯è€å¸ˆä»¬æ¨èçš„ä½œå®¶ï¼Œä¸è¿‡æˆ‘éšéšçº¦çº¦æ„Ÿè§‰æˆ‘å°±æ˜¯å¯¹è¿™æ ·çš„æ–‡å­¦éš¾ä»¥æ¥å—ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å‰å¤©çœ‹åˆ°äº†ä¸€äº›è§†é¢‘ï¼Œè®²çš„æ˜¯çŸ¿å·¥è¯—äººé™ˆå¹´å–œçš„æ•…äº‹ã€‚çŸ¿å·¥ï¼Œå¤§å®¶éƒ½çŸ¥é“è¿™æ˜¯ä¸€ç§é«˜å±èŒä¸šï¼Œä½†å¾ˆå°‘æœ‰äººèƒ½å¤Ÿç†è§£ä»–ä»¬çš„æ—¥å¸¸å·¥ä½œåˆ°åº•æœ‰å¤šä¹ˆå±é™©ã€‚ä»–ä»¬æ—¢æ˜¯è¿œç¦»ä¹¡åœŸçš„å†œæ°‘ï¼Œä¹Ÿæ˜¯æ·±å±±æ·±äº•ä¸­çš„å·¥äººï¼Œä»–ä»¬æ³¨å®šäº†ä¸ä¼šè·å¾—ç¤¾ä¼šçš„è¿‡å¤šå…³æ³¨ï¼Œå°±åƒæˆ‘çš„è¾“å…¥æ³•çŸ¿å·¥åœ¨â€œæ—·å·¥â€å’Œâ€œç‹‚æ”»â€çš„åé¢ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å›æƒ³èµ·æŸæ¬¡ç»¼è‰ºäº‹æ•…ï¼Œæ¼”å‘˜é«˜æŸèº«äº¡ï¼Œä¸€å †æ‰€è°“æ˜æ˜Ÿåœ¨å¾®åšå‘å£°â€œæ¼”å‘˜æ˜¯é«˜å±èŒä¸šâ€ï¼Œè¦æ±‚ä¿éšœæ¼”å‘˜æƒåˆ©ã€‚æœ‰äº›ç½‘å‹ç”¨è®¸å¤šèŒä¸šçš„ä¾‹å­æ¥åé©³æ¼”å‘˜ç®—é«˜å±èŒä¸šçš„è§‚ç‚¹ï¼Œæ›´å¤šç½‘å‹åªæ˜¯æŠŠä»–ä»¬å½“åšäº†å…¬çŒ´å’Œæ¯çŒ´ã€‚æ˜¯å•Šï¼Œè¿™äº›æ˜æ˜Ÿå…‰é²œäº®ä¸½ã€æ”¶å…¥ä¸è²ï¼Œå·²ç»æ˜¯ååˆ©åŒæ”¶ï¼Œä½†ä»–ä»¬è¿˜æƒ³è¦æ›´å¤šï¼Œä¹Ÿè®¸æ˜¯â€œå­¦éœ¸äººè®¾â€ï¼Œä¹Ÿè®¸æ˜¯â€œèŒä¸šç²¾ç¥â€ï¼Œä¹Ÿè®¸æ˜¯å…¬ä¼—å¯¹ä»–ä»¬â€œç¤¾ä¼šè´£ä»»æ„Ÿâ€è®¤åŒã€‚æˆ‘åˆå‘ç°äº†æˆ‘å¥½åƒå¾ˆå°‘çœ‹è¿™äº›æ˜æ˜Ÿçš„ä½œå“ï¼Œæ›´ä¼šè§‰å¾—æ˜æ˜Ÿçš„ç»¼è‰ºå°±æ˜¯åƒåœ¾ã€‚æƒ³åˆ°è¿™é‡Œï¼Œæˆ‘åˆæ¨¡ç³Šåœ°æ„Ÿè§‰æˆ‘å¥½åƒçŸ¥é“äº†æˆ‘å¯¹æ–‡è‰ºä½œå“çš„è¯„åˆ¤æ ‡å‡†ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘çœ‹å®Œè®²è¿™ä½çŸ¿å·¥è¯—äººçš„è§†é¢‘åï¼Œæˆ‘ç»ˆäºæ˜ç™½äº†æˆ‘ä¸ºä½•ä¼šæœ‰å¦‚æ­¤çš„å¥½æ¶è§‚ï¼Œé‚£å°±æ˜¯æˆ‘ä¸ä¼šå»å–œæ¬¢è„±ç¦»äº†äººæ°‘ç”Ÿæ´»çš„ä½œå“ã€‚é™ˆå¹´å–œçš„ä½œå“æ˜¯ä»åœŸé‡Œé¢ç”Ÿé•¿å‡ºæ¥çš„ã€‚è¿™é‡Œçš„åœŸï¼Œå¹¶ä¸æ˜¯æ–‡è”ä¸»å¸­ã€å‰¯ä¸»å¸­è¡£é”¦è¿˜ä¹¡ï¼Œå¸‚å§”å¿å§”ä½œé™ªæ—¶è¸ä¸Šçš„â€œä¹¡åœŸâ€ï¼Œè€Œæ˜¯æˆ‘å›½æœ€ä¸ºå¹¿å¤§çš„åŠ³åŠ¨äººæ°‘é­å—ä¸”æ¶ˆåŒ–è¿‡çš„æ— å°½è‹¦éš¾å’Œé€šè¿‡åŠ³åŠ¨åˆ›é€ å‡ºçš„å°‘è®¸å¹¸ç¦ã€‚é™ˆå¹´å–œçˆ±ç§¦è…”ï¼Œçˆ±å­æ­Œï¼Œä»–çš„ä½œå“é›†çš„åå­—å«åšã€Šæ´»ç€å°±æ˜¯å†²å¤©ä¸€å–Šã€‹ï¼Œä»–çš„è¯—é›†å«åšã€Šç‚¸è£‚å¿—ã€‹ã€‚&lt;/p&gt;
&lt;p&gt;ä»–å†™çš„æœ‰äº›è¯—å¥å¹¶ä¸é€Šè‰²é¡¾åŸã€æµ·å­å¤ªå¤šï¼Œå½“ä»–çŸ¥é“æ¯äº²èº«æ‚£é£Ÿé“ç™Œæ—¶ï¼Œä»–å†™ä¸‹â€œæˆ‘åœ¨äº”åƒç±³æ·±å¤„æ‰“å‘ä¸­å¹´/æˆ‘æŠŠå²©å±‚ä¸€æ¬¡æ¬¡ç‚¸è£‚/å€Ÿæ­¤/æŠŠä¸€ç”Ÿé‡æ–°ç»„åˆ/æˆ‘å¾®å°çš„äº²äºº/è¿œåœ¨å•†å±±è„šä¸‹/ä»–ä»¬æœ‰ç—…/èº«ä½“è½æ»¡ç°å°˜/æˆ‘çš„ä¸­å¹´è£ä¸‹å¤šå°‘/ä»–ä»¬çš„æ™šå¹´å°±èƒ½å»¶é•¿å¤šå°‘/æˆ‘èº«ä½“é‡Œæœ‰ç‚¸è¯ä¸‰å¨/ä»–ä»¬æ˜¯å¼•ä¿¡éƒ¨åˆ†/å°±åœ¨æ˜¨å¤œ/åœ¨ä»–ä»¬åºŠå‰/æˆ‘å²©çŸ³ä¸€æ ·/è½°åœ°ç‚¸è£‚ä¸€åœ°â€ã€‚ä»–çš„æ–‡å­—æ·±æ²‰è´¨æœ´ï¼Œä¸ç”¨è¿‡å¤šä¿®é¥°ä¹Ÿä¸å–œæ¸²æŸ“è‹¦éš¾ï¼ŒçŠ¹å¦‚ä»åœŸé‡Œå¸¦ç€æ³¥å·´é’»å‡ºï¼Œä½†åˆæœ‰ç€ç‚¸è£‚åœ°åº•æœ€åšç¡¬å²©çŸ³çš„åŠ›é‡ã€‚è¿™åŠ›é‡ä¹Ÿæ˜¯æŸ”è½¯çš„ï¼Œèƒ½ä»¤çŒ›å£«å •æ³ªã€‚&lt;/p&gt;
&lt;p&gt;è¯´å®è¯ï¼Œå¤§éƒ¨åˆ†ç°ä»£è¯—æ­Œçš„æ–‡å­¦æ„ä¹‰æˆ‘éš¾ä»¥ç†è§£ï¼Œå‡­å€Ÿç€æ—¶ä»£èƒŒæ™¯å’Œä»–äººçš„è¯„ä»·æˆ‘æ‰èƒ½å¤Ÿç†è§£æ–‡å­¦å²çš„æ„ä¹‰ã€‚ä¸­å›½ä¸Šä¸ªä¸–çºªçš„è¯—äººï¼Œæœ‰å¤šå°‘éƒ½æ˜¯æ–‡å­¦å²æ„ä¹‰å¤§äºæ–‡å­¦æ„ä¹‰ã€‚ä½†æˆ‘æ—¶å¸¸åœ¨æƒ³ï¼Œè‹¥ä¸æ˜¯â€œä¸»æµâ€çš„æ‰¹è¯„å®¶å¯ä»¥çœ‹åˆ°ä»–ä»¬çš„è¯—å¥ï¼Œè‹¥ä¸æ˜¯ä»–ä»¬çš„è¯—å¥å¸¦åŠ¨äº†é‚£ä¸ªå†™è¯—çš„æ—¶ä»£ï¼Œä»–ä»¬çš„æ–‡å­¦å²æ„ä¹‰åˆä»ä½•è€Œæ¥ï¼Ÿå†å¦‚æœé™ˆå¹´å–œæˆ–æ˜¯å…¶ä»–çš„å·¥å†œè¯—äººï¼Œä»–ä»¬çš„ä½œå“èƒ½å¤Ÿå¸¦åŠ¨å…¬ä¼—ç›®å…‰å¯¹åŠ³åŠ¨çš„å…³æ³¨ï¼Œå¯¹åŠ³åŠ¨è€…çš„å…³åˆ‡ï¼Œä»¥åŠäººæ°‘å¨±ä¹æ–¹å¼å’Œç²¾ç¥ç”Ÿæ´»çš„è½¬å˜å‡åï¼Œä»–ä»¬çš„æ–‡å­¦å²æ„ä¹‰å²‚ä¸æ˜¯æ¯”â€œä¸»æµâ€ä½œå®¶æ›´é«˜æ›´é«˜ã€‚&lt;/p&gt;
&lt;p&gt;å†è°ˆå›åˆ°æˆ‘æ‰€è®¨åŒçš„å‡ ç§æ–‡å­¦å§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šä¸ªä¸–çºªçš„â€œä¼¤ç—•æ–‡å­¦â€ï¼Œè¿˜æœ‰æ‰€è°“çš„â€œæ–°ä¼¤ç—•æ–‡å­¦â€ï¼Œä»–ä»¬å¤§å¤šæ•°çš„åæ€è¿˜æ˜¯åœç•™åœ¨è‡ªå·±çš„è‹¦éš¾ä¸Šï¼Œå¹¶æŠŠå®ƒå½’ç»“åˆ°äººç¥¸ä¹‹ä¸Šï¼Œäºæ˜¯ä»–ä»¬å¯ä»¥æ‰¹è¯„ä¼Ÿäººï¼Œè®½åˆºå…»æ´»ä»–ä»¬çš„æ‰€è°“â€œè½åä½“åˆ¶â€ï¼Œè§£æ„ä¸­å›½çš„ä¼ ç»Ÿï¼Œæ»¥ç”¨ä¸­å›½äººçš„åŠ£æ ¹æ€§ã€‚ä½†ä»–ä»¬ä»æœªæ„è¯†åˆ°è‡ªå·±èº«ä¸ºçŸ¥è¯†é’å¹´ä½“ä¼šåˆ°çš„åªæ˜¯å†œæ°‘çš„æ—¥å¸¸ï¼Œä»–ä»¬åº”è¯¥åæ€çš„éš¾é“ä¸åº”è¯¥æ˜¯ï¼Œä¸ºä»€ä¹ˆè‡ªå·±èƒ½å¤Ÿå¨‡æŸ”åšä½œåˆ°å°†å‡ äº¿äººçš„ç”Ÿæ´»æ—¥å¸¸è§†ä½œè‡ªå·±ä¸è¯¥æ‰¿å—çš„ç¾éš¾ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä¸€äº›æœ‰å…³è‡ªç„¶å’Œç”Ÿæ€ç¯å¢ƒçš„ä½œå“ï¼Œå¹¶ä¸æ˜¯é€šè¿‡è¡¨ç°ç”Ÿæ€ç¾éš¾æ¥è¡¨è¾¾ç¯å¢ƒä¿æŠ¤çš„é‡è¦æ€§ï¼Œè€Œæ˜¯ä»¥æ–‡äººå¯¹ç¾æ„Ÿçš„è¿½æ±‚å‡ºå‘ï¼Œç©ºæ´åœ°è°ˆè¿‡å»çš„è‡ªç„¶æ˜¯ç¾çš„ï¼Œç°åœ¨æ˜¯ä¸ç¾çš„ã€‚ä¹Ÿè®¸è¿™åªæ˜¯æˆ‘èº«ä¸ºç†ç§‘ç”Ÿçš„åè§ï¼Œä½†ä»–ä»¬çš„ç¡®ä¹Ÿå¯¹å·¥ä¸šåŒ–å’Œç§‘æŠ€å‘å±•æœ‰åè§ã€‚è¿˜è®°å¾—ä¸€ç‰‡æ–‡ç« é‡Œï¼ŒéŸ©å°‘åŠŸä»¥ä»–çš„æå…¶æ— çŸ¥ï¼Œç»„ç»‡ç€ä¸å±äºä»–è®¤çŸ¥èŒƒå›´çš„ä¸“ä¸šåè¯ï¼Œå†·å˜²çƒ­è®½ç€äººå·¥æ™ºèƒ½ã€‚ä¼°è®¡è¯´æ¥ä¹Ÿå°±æ˜¯ç­”åº”ç»™æŸä¸ªè½é­„çº¸åª’çš„ä¸»ç¼–çš„äººæƒ…ï¼Œå¸®ä»–å†™ä¸€ç¯‡èƒ½å¤Ÿè¹­åˆ°ç¤¾ä¼šçƒ­ç‚¹çš„è¯„è®ºæ–‡ç« ã€‚å‘å±•å¸¦æ¥çš„é—®é¢˜ä¸æ˜¯å‘å±•æœ¬èº«çš„è¿‡é”™ï¼Œå¯¹å‘å±•çš„è´¬ä½è«ä¸æ˜¯å¯¹é‚£äº›ä¸ºå»ºè®¾ä»˜å‡ºè¡€æ±—çš„äººçš„èƒŒå›ã€‚ååœ¨åŠå…¬å®¤é‡Œå–èŒ¶çš„ä½œå®¶è€çˆ·ä»¬ï¼Œæ€ä¹ˆå¯èƒ½çœ‹åˆ°å·¥å‚å¼€å·¥æ—¶å¯¹å½“åœ°å°±ä¸šçš„è´¡çŒ®ã€èŒä¸šç—…å¯¹å·¥äººèº«ä½“çš„æ‘§æ®‹ï¼Œä»–ä»¬æˆ–è®¸ä¹Ÿæ—©å·²å¤±å»äº†æˆ–è€…ä»æœªæœ‰è¿‡èƒ½å¤Ÿä¹¦å†™è¿‡é‡åŠ³åŠ¨å’Œæ±¡æŸ“å¯¹äººæ°‘çš„ä¼¤å®³çš„è‰ºæœ¯æŠ€å·§ã€‚è¯´çš„ä½æƒ…å•†ä¸€ç‚¹ï¼Œä»–ä»¬éœ€è¦å»æ‰¾åˆ°è‡ªå·±çš„åˆå¿ƒå’Œè‰¯å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ç½‘è´­äº†ã€Šæ´»ç€å°±æ˜¯å†²å¤©ä¸€å–Šã€‹å’Œã€Šç‚¸è£‚å¿—ã€‹ï¼Œå°±å½“æ˜¯æ”¯æŒèº«æ‚£çŸ½è‚ºç—…çš„è€é™ˆï¼Œå¯æƒœå‡ºç‰ˆç¤¾åªæœ‰ç®€è£…ç‰ˆã€‚ä½†æˆ‘è½¬å¿µä¸€æƒ³ï¼Œé‚£äº›è¢«æˆ‘å†…æ¶µçš„â€œä¸»æµâ€ä½œå®¶ä»¬ï¼Œåˆæœ‰å¤šå°‘ä½œå“æœ‰ç²¾è£…ç‰ˆå‘¢ï¼Ÿåœ¨è¿™ä¸ªå¨±ä¹è‡³æ­»çš„æ—¶ä»£ï¼Œä»–ä»¬è™½ç„¶è¢«å…³æ³¨ï¼Œä½†ä¹Ÿä¸è¿‡æ˜¯é‚£ä½™å…‰çš„ä¸€ç¥ã€‚ä¸è¿‡ä½œå®¶ä»¬å¯ä»¥å¼€ä¸ªå…¬ä¼—å·ï¼Œå†æŠ¢ä¸€æŠ¢æµé‡çš„æ®‹ç¾¹å†·é¥­å˜›ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä»Šçš„æ–‡è‰ºå¤ªè½»å¤ªè½»ï¼Œé£˜å¾—å¤ªé«˜å¤ªé«˜ï¼Œç¦»åœŸåœ°å¤ªè¿œå¤ªè¿œã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¼–è¾‘äº 2021-08-13 15:34&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>åç§‘ OS å®éªŒçš„ RISC-V ä»£ç†å†…æ ¸æ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Ÿ</title>
      <link>https://vaaandark.top/posts/how-riscv-pke-startup/</link>
      <pubDate>Sat, 02 Mar 2024 01:32:50 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/how-riscv-pke-startup/</guid>
      <description>&lt;p&gt;ä»£ç ä»“åº“ä¸º &lt;a href=&#34;https://gitee.com/hustos/riscv-pke&#34;&gt;hustos riscv-pke&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹å†…å®¹åŸºäº lab2 ä»£ç &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;å…¥å£åœ¨å“ª&#34;&gt;å…¥å£åœ¨å“ªï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å…¥å£ä¸º &lt;code&gt;kernel/machine/mentry.S&lt;/code&gt; çš„ &lt;code&gt;_mentry&lt;/code&gt; ï¼Œå®ƒè°ƒç”¨äº† &lt;code&gt;kernel/machine/minit.c&lt;/code&gt; çš„ &lt;code&gt;m_start(uintptr_t hartid, uintptr_t dtb)&lt;/code&gt; ï¼Œä¸¤ä¸ªå‚æ•°å¹¶æ²¡æœ‰åœ¨ &lt;code&gt;_mentry&lt;/code&gt; ä¸­è®¾ç½®ï¼Œè¿™æ˜¯å› ä¸º spike ä¼šè‡ªåŠ¨è®¾ç½® &lt;code&gt;a0&lt;/code&gt; å¯„å­˜å™¨ä¸º CPU id ï¼Œè®¾ç½® &lt;code&gt;a1&lt;/code&gt; å¯„å­˜å™¨ä¸ºè®¾å¤‡æ ‘å­—ç¬¦ä¸²ï¼Œè¿™åˆšå¥½ä¹Ÿç¬¦åˆ RV çš„ä¼ å‚è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ spike æ¨¡æ‹Ÿæ‰§è¡Œ pke ä»£ç æ—¶æ˜¯ä» M æ¨¡å¼å¼€å§‹çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;_mentry-é‡Œé¢åšäº†ä»€ä¹ˆ&#34;&gt;&lt;code&gt;_mentry&lt;/code&gt; é‡Œé¢åšäº†ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆæ˜¯ç»™ &lt;code&gt;mscratch&lt;/code&gt; å¯„å­˜å™¨èµ‹å€¼ä¸º 0 ï¼Œå†è®¾ç½®æ“ä½œç³»ç»Ÿçš„å †æ ˆã€‚&lt;/p&gt;
&lt;p&gt;è®¾ç½®æ“ä½œç³»ç»Ÿå †æ ˆçš„å…·ä½“æ­¥éª¤æ˜¯ï¼šå°† &lt;code&gt;mhartid&lt;/code&gt; å¯„å­˜å™¨çš„å€¼è¯»åˆ° &lt;code&gt;a4&lt;/code&gt; å¯„å­˜å™¨ï¼Œä¹‹åä¸€ç³»åˆ—å››åˆ™è¿ç®—é‡æ–°è®¡ç®—æ ˆåº•å¯„å­˜å™¨ï¼Œè®©ä¸åŒ CPU æ ¸å¿ƒçš„å †æ ˆä¸ä¼šå†²çªã€‚æ¯”å¦‚ thread0 çš„æ ˆåº•æ˜¯ a ï¼Œ thread1 çš„æ ˆåº•å°±åº”è¯¥æ˜¯ a + 4096 ã€‚&lt;/p&gt;
&lt;h3 id=&#34;m_start-å‡½æ•°é‡Œé¢åšäº†ä»€ä¹ˆ&#34;&gt;&lt;code&gt;m_start&lt;/code&gt; å‡½æ•°é‡Œé¢åšäº†ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;
&lt;p&gt;åˆå§‹åŒ–äº†ä¸€äº› spike çš„ä¸œè¥¿ï¼Œè¿™äº›ä¸æ˜¯å¾ˆé‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åå°±æ˜¯å°†ä¿å­˜ä¸­æ–­æ—¶ä¸Šä¸‹æ–‡çš„ &lt;code&gt;g_itrframe&lt;/code&gt; çš„åœ°å€èµ‹å€¼ç»™äº† &lt;code&gt;mscratch&lt;/code&gt; å¯„å­˜å™¨ï¼ˆä¹Ÿå°±æ˜¯ &lt;code&gt;_mentry&lt;/code&gt; ä¸­çš„æ³¨é‡Šï¼Œ &lt;code&gt;mscratch&lt;/code&gt; æŒ‡å‘ M æ¨¡å¼ä¸‹çš„æ ˆåº•ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å°† MPP è®¾ç½®æˆäº† S æ¨¡å¼ï¼Œè¿™ä¸ª MPP(machine previous privilege) æ˜¯æŒ‡è¿›å…¥ M æ¨¡å¼ä¹‹å‰çš„æ¨¡å¼ï¼Œè¿™æ ·è®¾ç½®çš„ç›®çš„æ˜¯åœ¨ä¹‹åçš„ &lt;code&gt;mret&lt;/code&gt; åèƒ½è¿›å…¥ S æ¨¡å¼ã€‚ä¹‹åå°† &lt;code&gt;mepc&lt;/code&gt; å¯„å­˜å™¨è®¾ç½®ä¸º &lt;code&gt;s_start&lt;/code&gt; ï¼Œè¿™å°±èƒ½åœ¨ä¹‹åçš„ &lt;code&gt;mret&lt;/code&gt; åä¸ä»…èƒ½è¿›å…¥ S æ¨¡å¼ï¼Œè¿˜èƒ½ä» &lt;code&gt;s_start&lt;/code&gt; å¼€å§‹æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿè¦åœ¨ M æ¨¡å¼æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œæ‰€ä»¥è¦è®¾ç½®ç³»ç»Ÿè°ƒç”¨æ—¶çš„å…¥å£ï¼Œä¹Ÿå°±æ˜¯æŠŠ &lt;code&gt;mtvec&lt;/code&gt; å¯„å­˜å™¨èµ‹å€¼ä¸º &lt;code&gt;mtrapvec&lt;/code&gt; ã€‚ä¹‹ååˆ†æå¦‚ä½•è¿›å…¥ç³»ç»Ÿè°ƒç”¨æ—¶å†è¯¦ç»†ä»‹ç»ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ &lt;code&gt;mtrapvec&lt;/code&gt; è¦ 4-byte å¯¹é½ï¼Œ &lt;code&gt;mtvec&lt;/code&gt; å¯„å­˜å™¨è™½ç„¶æ˜¯ MXLEN é•¿åº¦çš„ï¼Œä½†æ˜¯å®ƒåä¸¤ä½ä½¿ç”¨æ¥æ ‡è¯†æ˜¯ç›´æ¥ç³»ç»Ÿè°ƒç”¨è¿˜æ˜¯å‘é‡ç³»ç»Ÿè°ƒç”¨çš„ï¼Œæ‰€ä»¥å®ƒåªèƒ½å­˜ 4-byte å¯¹é½çš„å‡½æ•°å…¥å£åœ°å€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¹‹åä¾æ¬¡ï¼Œæ‰“å¼€ M æ¨¡å¼ä¸­æ–­ï¼Œå°†æ‰€æœ‰ä¸­æ–­å’Œå¼‚å¸¸å§”æ‰˜åˆ° S æ¨¡å¼æ‰§è¡Œï¼Œå†æ‰“å¼€ S æ¨¡å¼ä¸­æ–­ï¼Œåˆå§‹åŒ–æ—¶é’Ÿä¸­æ–­ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åè°ƒç”¨ &lt;code&gt;mret&lt;/code&gt; é€€å‡º M æ¨¡å¼ï¼Œè¿›å…¥åˆ°é¢„è®¾å¥½çš„ S æ¨¡å¼ä»£ç ï¼Œä¹Ÿå°±æ˜¯ &lt;code&gt;s_start&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;h3 id=&#34;s_start-å‡½æ•°é‡Œé¢åšäº†ä»€ä¹ˆ&#34;&gt;&lt;code&gt;s_start&lt;/code&gt; å‡½æ•°é‡Œé¢åšäº†ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;
&lt;p&gt;(æœªå®Œå¾…ç»­)&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>MIT6.S081 Lab:Fixup Xargs</title>
      <link>https://vaaandark.top/posts/mit6.s081-labfixup-xargs/</link>
      <pubDate>Mon, 26 Feb 2024 23:41:18 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/mit6.s081-labfixup-xargs/</guid>
      <description>&lt;p&gt;æ˜¨å¤©æœ‹å‹è·Ÿæˆ‘è¯´æˆ‘çš„ MIT6.S081 lab1 çš„ &lt;code&gt;xargs&lt;/code&gt; å‘½ä»¤çš„ä»£ç æ— æ³•é€šè¿‡ï¼Œçœ‹åˆ°ä»–çš„æµ‹è¯•æ–¹æ³•æ‰çŸ¥é“åŸæ¥æ˜¯è¿™æ ·æµ‹è¯•çš„ï¼Œæ„Ÿè§‰ä¹‹å‰å†™çš„æµ‹çš„éƒ½å¤ªç®€ç•¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚æµ‹è¯• &lt;code&gt;xargs&lt;/code&gt; å‘½ä»¤è¿™ä¸€å…³å¯ä»¥è¿™æ ·æµ‹è¯•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ make GRADEFLAGS=xargs grade
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹‹å‰çš„åšå®¢åœ¨è¿™é‡Œï¼š&lt;a href=&#34;&#34;&gt;MIT6.S081 Lab: Xv6 and Unix Utilities&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ£€æŸ¥äº†ä¸€ä¸‹æˆ‘ä¹‹å‰çš„ä»£ç ï¼Œå‘ç°å®Œå…¨æ²¡æœ‰å¤„ç†å¤šè¡Œçš„æƒ…å†µï¼Œåœ¨æµ‹è¯•çš„æ—¶å€™å°±ä¼šå‡ºç°é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å·çœ‹ä¸€ä¸‹æµ‹è¯•ç”¨çš„è„šæœ¬ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mkdir a
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;echo&lt;/span&gt; hello &amp;gt; a/b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mkdir c
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;echo&lt;/span&gt; hello &amp;gt; c/b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;echo&lt;/span&gt; hello &amp;gt; b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;find . b | xargs grep hello
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰€ä»¥å¯¹äº &lt;code&gt;find . b&lt;/code&gt; ï¼Œå®ƒçš„ç»“æœä¼šæ˜¯ä¸‰è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./a/b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./c/b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./b
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç®¡é“ä¹‹åçš„ xargs åº”è¯¥æ‰§è¡Œä¸‰æ¬¡ &lt;code&gt;grep&lt;/code&gt; ï¼Œè¿™æ‰æ˜¯æ­£ç¡®çš„è¡Œä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;grep hello ./a/b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;grep hello ./c/b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;grep hello ./b
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯æˆ‘ä½¿ç”¨ &lt;code&gt;read()&lt;/code&gt; å¤„ç†çš„æ—¶å€™åˆå‘ç°äº†æ–°çš„é—®é¢˜ï¼Œç®¡é“ä¸æ˜¯è¡Œç¼“å†²çš„ï¼Œä¸æ–¹ä¾¿ç›´æ¥è¯»å…¥ä¸€è¡Œï¼Œæƒ³è¦æ¢ç”¨ &lt;code&gt;scanf()&lt;/code&gt; ä½†æ˜¯ xv6 æ²¡æœ‰æä¾›ï¼Œæ‰€ä»¥åªèƒ½ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦æ‰‹åŠ¨å¤„ç†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/types.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/param.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;user/user.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; buf[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1024&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *cmd[MAXARG];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  memset(buf, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1024&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  memset(cmd, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *) * MAXARG);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; argc; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cmd[i-&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;] = argv[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; ch;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *p = buf;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; blanked = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; ncmd = argc - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (read(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &amp;amp;ch, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;) &amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (ch == &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; || ch == &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\t&amp;#39;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      *p = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      blanked = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      p += &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (ch == &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (fork() == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        exec(cmd[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;], cmd);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        wait(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      memset(buf, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt; buf);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      p = buf;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      ncmd = argc - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (blanked) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        blanked = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        cmd[ncmd] = p;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ncmd += &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      *p = ch;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      p += &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>æ¶è¡¥ CPU çŸ¥è¯†ä¹‹ Cache å’Œ TLB</title>
      <link>https://vaaandark.top/posts/relearning-cpu-2-cache-and-tlb/</link>
      <pubDate>Sun, 18 Feb 2024 21:30:43 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/relearning-cpu-2-cache-and-tlb/</guid>
      <description>&lt;p&gt;å³æ˜¯çŸ¥è¯†å›é¡¾ï¼Œä¹Ÿæ˜¯æœ€è¿‘å­¦åˆ°çŸ¥è¯†çš„æ‹“å±•å»¶ä¼¸ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ARMv6 Manual: &amp;ldquo;The only architecturally-guaranteed way to invalidate all aliases of a physical address from a VIPT instruction cache is to invalidate the entire instruction cache.&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;cache-çš„åŸºæœ¬æƒ…å†µ&#34;&gt;Cache çš„åŸºæœ¬æƒ…å†µ&lt;/h2&gt;
&lt;p&gt;Cache ä¹Ÿå°±æ˜¯ç¼“å­˜ï¼Œä½œä¸ºé«˜é€Ÿçš„ CPU å’Œä½é€Ÿçš„å†…å­˜ä¹‹é—´çš„ç¼“å†²ï¼Œç”¨äºåŠ é€Ÿè®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå†…å­˜åœ°å€ä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œç”±é«˜åˆ°ä½åˆ†åˆ«ä¸º tag, index å’Œ offset ã€‚index ç”¨äºç´¢å¼•ç¼“å­˜è¡Œï¼Œoffset ç”¨äºç¡®å®šåœ¨ç¼“å­˜è¡Œçš„ä½ç½®ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆéœ€è¦ tag å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºç¼“å­˜çš„å¤§å°æ˜¯è¿œè¿œå°äºå†…å­˜å¤§å°çš„ï¼Œæ‰€ä»¥ä¸åŒçš„ index å¯èƒ½å¯¹åº”åŒä¸€ä¸ªç¼“å­˜è¡Œï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ tag æ¥åŒºåˆ†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;é‚£ä¸ºä»€ä¹ˆ tag æ˜¯é«˜ä½ï¼Œè€Œ index æ˜¯ä½ä½å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹è®¿é—®çš„å†…å­˜éƒ½æ˜¯è‹¥å¹²å—è¿ç»­çš„ï¼Œå¤„äºä¸åŒå—çš„å†…å­˜åœ°å€ä½ä½å¯èƒ½é‡å¤è€Œé«˜ä½ä¸é‡å¤ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ‰ä¸‰ç§ Cache ç»„ç»‡æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯å…¨ç›¸è¿ã€ç»„ç›¸è¿å’Œç›´æ¥ç›¸è¿ï¼Œå…¶ä¸­å…¨ç›¸è¿ä¸åˆ’åˆ† index ï¼Œç›´æ¥æ¯”å¯¹ tag ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤šçº§-cache&#34;&gt;å¤šçº§ Cache&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†è¿›ä¸€æ­¥æå‡è®¿å­˜é€Ÿåº¦ï¼Œäººä»¬å¼•å…¥äº†å¤šçº§ Cache ã€‚ç°ä»£ CPU ä¸€èˆ¬æœ‰ 3 çº§ï¼Œä»¥ Cortex-A53 ä¸ºä¾‹ï¼Œå®ƒçš„ L1 cache æ˜¯ CPU ç§æœ‰çš„ï¼ŒL2 cache æ˜¯åŒä¸€ä¸ª cluster å…±äº«çš„ï¼ŒL3 cache æ˜¯æ‰€æœ‰ CPU å…±äº«çš„ï¼Œå¹¶ä»¥æ€»çº¿ä¸å†…å­˜ç›¸è¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;icachedcache-åŠå…¶ä¸€è‡´æ€§&#34;&gt;icache/dcache åŠå…¶ä¸€è‡´æ€§&lt;/h2&gt;
&lt;p&gt;åœ¨ L1 æˆ–è€… L2 cache ä¸­ï¼Œä¸€äº› CPU ä¼šå°† cache åˆ†ä¸º instruction cache å’Œ data cache ã€‚è¿™æœ‰ä¸¤ä¸ªè€ƒè™‘ï¼Œä¸€æ˜¯æ€§èƒ½ï¼ŒäºŒæ˜¯æˆæœ¬ã€‚æœ¬è´¨åŸå› æ˜¯ CPU å¯¹æŒ‡ä»¤å’Œæ•°æ®çš„è®¿é—®æ–¹å¼ä¸åŒï¼ŒæŒ‡ä»¤ä¸€èˆ¬æ˜¯åªè¯»çš„ï¼Œä¸éœ€è¦æŠŠç”µè·¯è®¾è®¡å¾—éå¸¸å¤æ‚ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ç°å®è¿˜æ˜¯æ¯”è¾ƒæ®‹é…·çš„ï¼Œå¾ˆå¤šæ—¶å€™ icache æ˜¯ä¸èƒ½ä¿è¯åªè¯»ï¼Œæ¯”å¦‚ GCC è°ƒè¯•æ‰“æ–­ç‚¹çš„æ—¶å€™å°±ä¼šä¿®æ”¹æŒ‡ä»¤ï¼Œå®ƒå…ˆå°†æ•°æ®åŠ è½½åˆ° dcache ä¸­å†ä¿®æ”¹ï¼Œè¿™æ—¶å°±éœ€è¦è§£å†³ icache å’Œ dcache çš„ä¸€è‡´æ€§é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;mmu-å’Œ-tlb&#34;&gt;MMU å’Œ TLB&lt;/h2&gt;
&lt;p&gt;MMU æ˜¯ Memory Management Unit ï¼Œç”¨äºå°†æŠŠè™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚Linux ä¸­çš„é¡µè¡¨ä¸€èˆ¬æ˜¯å››çº§çš„ï¼Œä¹Ÿå¯ä»¥é…ç½®ä¸ºäº”çº§ã€‚ä»é«˜åˆ°åº•åˆ†åˆ«ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PGDï¼špage Global directory(47-39), é¡µå…¨å±€ç›®å½•&lt;/li&gt;
&lt;li&gt;PUDï¼šPage Upper Directory(38-30)ï¼Œé¡µä¸Šçº§ç›®å½•&lt;/li&gt;
&lt;li&gt;PMDï¼špage middle directory(29-21)ï¼Œé¡µä¸­é—´ç›®å½•&lt;/li&gt;
&lt;li&gt;PTEï¼špage table entry(20-12)ï¼Œé¡µè¡¨é¡¹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™è§£å†³äº†åˆ©ç”¨å°‘é‡é¡µé¢æ•°æ®ç®¡ç†å¤§é‡å†…å­˜çš„é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿä¼šè®©ä¸€æ¬¡æŸ¥è¯¢éœ€è¦åœ¨å†…å­˜ä¸­æŸ¥å››æ¬¡é¡µè¡¨ï¼Œå¤§å¤§é™ä½äº†è®¿å­˜é€Ÿåº¦ï¼Œ&lt;strong&gt;æ‰€ä»¥ MMU ä¸­ä¹Ÿéœ€è¦ä¸€ä¸ªç±»ä¼¼ Cache çš„å­˜åœ¨&lt;/strong&gt;ï¼Œé‚£å°±æ˜¯ TLB ã€‚TLB çš„è®¿é—®é€Ÿåº¦æ¯” L1 è¿˜è¦å¿«ï¼Œå’Œå¯„å­˜å™¨ç›¸å½“ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºé¡µé¢å¤§å°ä¸€èˆ¬ä¸º 4KB ï¼Œå› æ­¤ TLB ä¸éœ€è¦ç®¡æœ€ä½çš„ 12 ä½ã€‚è€Œä¸” TLB çš„ä¸€ä¸ª entry åªå­˜ä¸€ä¸ªç‰©ç†åœ°å€ï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦ç±»ä¼¼ cache çš„ offset å­—æ®µï¼Œè™šæ‹Ÿåœ°å€åªéœ€è¦åˆ†æˆ tag å’Œ index ä¸¤ä¸ªéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;vivt-vs-vipt-vs-pipt&#34;&gt;VIVT vs VIPT vs PIPT&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œçš„ V ä»£è¡¨ virtual ï¼Œ P ä»£è¡¨ physical ï¼Œ I å’Œ T åˆ†åˆ«ä»£è¡¨ index(ed) å’Œ tag(ged) ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‰é¢è¯´äº†é€šè¿‡ tag å’Œ index åœ¨ cache ä¸­æŸ¥æ‰¾ï¼Œä½†æ˜¯è¿™é‡Œçš„ tag å’Œ index ä½äºè™šæ‹Ÿåœ°å€è¿˜æ˜¯ç‰©ç†åœ°å€å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h3 id=&#34;æ­§ä¹‰å’Œåˆ«å&#34;&gt;æ­§ä¹‰å’Œåˆ«å&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥å…ˆæ³¨æ„ä¸¤ä¸ªé—®é¢˜ï¼šæ­§ä¹‰(ambiguity)å’Œåˆ«å(aliasing)ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ­§ä¹‰æŒ‡ä¸åŒçš„æ•°æ®æœ‰ç›¸åŒçš„ tag å’Œ index ï¼Œä»è€Œå¯¼è‡´æ— æ³•åŒºåˆ«ã€‚&lt;/li&gt;
&lt;li&gt;åˆ«åæŒ‡ä¸åŒçš„è™šæ‹Ÿåœ°å€æ˜ å°„ç›¸åŒçš„ç‰©ç†åœ°å€ï¼ˆè¿™åœ¨ Linux ä¸­å¾ˆå¸¸è§ï¼‰ï¼Œè¿™å®¹æ˜“å¯¼è‡´ cache çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;vivt&#34;&gt;VIVT&lt;/h3&gt;
&lt;p&gt;è¿™ç§ index å’Œ tag éƒ½å–è‡ªè™šæ‹Ÿåœ°å€çš„æ–¹æ³•åˆå«è™šæ‹Ÿé«˜é€Ÿç¼“å­˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªè¦ cache å‘½ä¸­ï¼Œå°±ä¸éœ€è¦è¿›è¡Œåœ°å€ç¿»è¯‘ï¼Œè¿™æå‡äº†é€Ÿåº¦ï¼Œä¹Ÿè®¾è®¡ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿™æ ·çš„è®¾è®¡æš‚æ—¶è¿˜ä¸èƒ½è§£å†³ ambiguity å’Œ aliasing é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æƒ³è¦è§£å†³ ambiguity ï¼Œå¯ä»¥åœ¨æ¯æ¬¡åˆ‡æ¢è¿›ç¨‹çš„æ—¶å€™ flush æ‰€æœ‰çš„ cache ï¼Œä½†æ˜¯è¿™æ ·åˆä¼šå¯¼è‡´å¤§é‡çš„ cache miss ã€‚&lt;/p&gt;
&lt;p&gt;æƒ³è¦è§£å†³ä¸åŒè¿›ç¨‹çš„ aliasing ï¼Œä¹Ÿå¯ä»¥åœ¨æ¯æ¬¡åˆ‡æ¢è¿›ç¨‹çš„æ—¶å€™ flush æ‰€æœ‰çš„ cache ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯åŒä¸€ä¸ªè¿›ç¨‹çš„ aliasing ï¼Œå°±æ²¡æœ‰å¾ˆå¥½çš„åŠæ³•äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pipt&#34;&gt;PIPT&lt;/h3&gt;
&lt;p&gt;è¿™ç§ index å’Œ tag éƒ½å–è‡ªç‰©ç†åœ°å€çš„æ–¹æ³•åˆå«ç‰©ç†é«˜é€Ÿç¼“å­˜ã€‚è¿™æ ·çš„è®¾è®¡å¯ä»¥è®©æ“ä½œç³»ç»Ÿå°‘æ“å¿ƒï¼Œå®Œå…¨é¿å…äº† ambiguity å’Œ  aliasing é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ PIPT åœ¨è½¯ä»¶å±‚é¢åŸºæœ¬ä¸éœ€è¦ç»´æŠ¤ï¼Œä½†æ˜¯ç¡¬ä»¶è®¾è®¡ä¸Šæ¯” VIVT å¤æ‚å¾ˆå¤šï¼Œæˆæœ¬ä¹Ÿæ›´é«˜ã€‚è€Œä¸”ç”±äºè™šæ‹Ÿåœ°å€æ¯æ¬¡éƒ½è¦å…ˆç¿»è¯‘æˆç‰©ç†åœ°å€ï¼Œå› æ­¤åœ¨æŸ¥æ‰¾æ€§èƒ½ä¸Šä½äº VIVT ã€‚&lt;/p&gt;
&lt;h3 id=&#34;vipt&#34;&gt;VIPT&lt;/h3&gt;
&lt;p&gt;åœ¨ç´¢å¼• cache æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è™šæ‹Ÿåœ°å€çš„ä¸€éƒ¨åˆ†ä½œä¸º cache çš„inde ã€‚è€Œ cache çš„ tag åˆ™ä½¿ç”¨ç‰©ç†åœ°å€ä¸­çš„ PFN ï¼ˆç‹¬ä¸€æ— äºŒï¼Œåæ–‡ä¹Ÿä¼šè¯´åˆ°ï¼‰ã€‚è¿™ç§æ–¹æ³•çš„å¥½å¤„æ˜¯ï¼ŒTLB ç¿»è¯‘å¾—åˆ° PFN å’Œ index ç´¢å¼• cache æ˜¯åŒæ—¶è¿›è¡Œçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;VIPT&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/vipt.png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;ä¸ºä»€ä¹ˆæ²¡æœ‰æ­§ä¹‰é—®é¢˜&#34;&gt;ä¸ºä»€ä¹ˆæ²¡æœ‰æ­§ä¹‰é—®é¢˜ï¼Ÿ&lt;/h4&gt;
&lt;p&gt;æˆ‘ä»¬å¯èƒ½æœ‰ç§æ€ç»´æƒ¯æ€§ï¼Œ tag å°±æ˜¯åœ°å€çš„ä¸€éƒ¨åˆ†ï¼Œå’Œ index åˆåœ¨ä¸€èµ·æ‰èƒ½æˆä¸ºä¸€ä¸ªä½ offset ä½ä¸º 0 çš„åœ°å€ã€‚è¿™ç§è¯´æ³•åœ¨ VIVT ä¸­æ˜¯å¯¹çš„ï¼Œä½†æ˜¯åœ¨ VIPT ä¸­æ˜¯é”™çš„ã€‚&lt;strong&gt;tag æœ¬æ¥å°±æ˜¯æ ‡ç­¾çš„æ„æ€ï¼Œåªæ˜¯ç”¨äºåŒºåˆ†ç›¸åŒ index ï¼Œå®ƒå¹¶ä¸æ„å‘³ç€å®ƒæ˜¯å‡å» index çš„é‚£äº›ä½ã€‚&lt;/strong&gt; åªæ˜¯åœ¨ cache çš„æŸ¥è¯¢ä¸­ï¼Œ tag å’Œ index æ²¡æœ‰é‡åˆè€Œä¸”åˆèµ·æ¥åˆšå¥½è¦†ç›–äº†åœ°å€ä¸­é™¤äº† offset çš„ä½ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å†çœ‹ MMU ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ 64 ä½åœ°å€åªç”¨äº†ä½ 48 ä½è¡¨ç¤ºåœ°å€ï¼Œè€Œä¸€ä¸ªé¡µé¢ä¸€èˆ¬æ˜¯ 4KB ã€‚è¿™æ ·ä¸€æ¥ï¼Œ MMU åªéœ€è¦å°† 47 ä½åˆ° 12 ä½è¿›è¡Œåœ°å€æ˜ å°„ï¼Œè¿™å’Œ VIVT çš„ index å’Œ tag çš„é‚£äº›ä½æ˜¯ä¸åŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶éƒ½ä½¿ç”¨äº† MMU æŠŠè™šæ‹Ÿåœ°å€çš„å…¨éƒ¨ä½ç¿»è¯‘æˆäº†ç‰©ç†åœ°å€ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦å–ç‰©ç†åœ°å€ä¸­å’Œ VIVT ä¸­çš„ tag ä¸€æ ·çš„ä½å‘¢ï¼Ÿæ‰€ä»¥ VIPT ä½¿ç”¨è¿™ 47 ä½åˆ° 12 ä½ä½œä¸º tag ï¼Œ&lt;strong&gt;è¿™äº› tag æ˜¯ç‹¬ä¸€æ— äºŒçš„&lt;/strong&gt;ï¼Œå¯ä»¥å®Œå…¨é¿å… ambiguity çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä»€ä¹ˆæ—¶å€™æ²¡æœ‰åˆ«åé—®é¢˜&#34;&gt;ä»€ä¹ˆæ—¶å€™æ²¡æœ‰åˆ«åé—®é¢˜ï¼Ÿ&lt;/h4&gt;
&lt;p&gt;å¯ä»¥å‘ç°ï¼Œ VIPT è™½ç„¶æ²¡æœ‰ç›´æ¥è§£å†³åˆ«åé—®é¢˜ï¼Œä½†æœ‰äº›æƒ…å†µä¸‹å¯ä»¥é¿å…åˆ«åï¼Œé‚£å°±æ˜¯ cache size é™¤ä»¥è·¯æ•°å°äº page å¤§å°æ—¶ã€‚å³ index + offset &amp;lt;= 12bit ä¸ä¼šå‘ç”Ÿé‡åï¼Œå³åªè¦ cache æ¯ä¸€è·¯å°äºç­‰äº 4KB ï¼Œå°±ä¸ä¼šå‘ç”Ÿé‡åã€‚å³ 4KB ç›´æ¥æ˜ å°„ã€ 8KB ä¸¤è·¯ç»„ç›¸è”ã€ 32KB å…«è·¯ç»„ç›¸è”ç­‰ï¼Œéƒ½ä¸ä¼šæœ‰é—®é¢˜ã€‚æ­¤æ—¶ VIPT çš„åŠŸèƒ½å’Œ PIPT ä¸€è‡´ï¼Œä½†é€Ÿåº¦å’Œ VIVT ä¸€è‡´ï¼Œå¯ä»¥è¯´ç»¼åˆäº†ä¸¤è€…çš„ä¼˜ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;VIPT æ²¡æœ‰åˆ«åé—®é¢˜çš„æƒ…å†µ&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/vipt-no-aliasing.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå½“ index + offset &amp;gt; 12bit ï¼ˆé¡µé¢å¤§å°ä¸º 4KB ï¼‰æ—¶ï¼Œå¯¹åº”åŒä¸€ä¸ªç‰©ç†åœ°å€çš„ä¸¤ä¸ªè™šæ‹Ÿåœ°å€å¯èƒ½è¢«åˆ†é…åˆ°ä¸¤ä¸ª cache set ä¸­ï¼Œå°±å‡ºç°äº†é‡åç°è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;VIPT æœ‰åˆ«åé—®é¢˜çš„æƒ…å†µ&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/vipt-aliasing.png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å¦‚æœæ— æ³•é¿å…åˆ«åå¦‚ä½•è§£å†³&#34;&gt;å¦‚æœæ— æ³•é¿å…åˆ«åï¼Œå¦‚ä½•è§£å†³ï¼Ÿ&lt;/h4&gt;
&lt;p&gt;å¾ˆå¤š CPU çš„ L1 dcache éƒ½éµå¾ªäº†ä¸Šè¿°çš„ cache æ¯ä¸€è·¯å°äº 4KB çš„è§„å¾‹ã€‚ä½†æ˜¯ç»§ç»­å¢åŠ  cache size çš„åŒæ—¶ç»§ç»­å¢åŠ ç›¸è”åº¦ä¼šå¯¼è‡´è¿‡äºå¤æ‚çš„æ—¶åºã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å¢å¤§ cacheline å’Œå¢åŠ ç»„æ•°ï¼Œæœ€åå¯¼è‡´ index + offset &amp;gt; 4KB ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³åŠæ³•å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå¯ä»¥åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šåˆ›å»ºå…±äº«å†…å­˜çš„æ—¶å€™åœ°å€è¦æŒ‰ç…§ä¸€è·¯ cache size å¯¹é½ï¼Œè¿™æ ·å°±å®Œå…¨é¿å…äº†åˆ«åé—®é¢˜ã€‚è¿™ä¹Ÿå°±æ˜¯ page coloring æŠ€æœ¯ã€‚å®ƒç›¸å½“äºå°†ä¸€è·¯ cache æŒ‰ç…§ page çš„å¤§å°åˆ‡åˆ†äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ page size æ˜¯ 4KB ï¼Œè€Œä¸€è·¯ cache size æ˜¯ 16 KB ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å°†é¡µé¢æŒ‰é¡ºåºå¡«ä¸Š 16 / 4 = 4 ç§é¢œè‰²ï¼Œåªæœ‰é¢œè‰²ç›¸åŒçš„è™šæ‹Ÿé¡µé¢æ‰èƒ½åˆ†é…åˆ°å¯¹åº”çš„ç‰©ç†åœ°å€ä¸Šï¼Œè¿™ä¹Ÿå°±åšåˆ°äº†æŒ‰ç…§ä¸€è·¯ cache size å¯¹é½äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸Šä¾‹ï¼Œä¸€äº› CPU çš„åšæ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç¡®ä¿ç»™å®šè™šæ‹Ÿåœ°å€çš„ç¬¬ 12 ä½å’Œç¬¬ 13 ä½ï¼ˆä¹Ÿå°±æ˜¯ VPN çš„ä½ä¸¤ä½ï¼‰ä¸ç›¸åº”ç‰©ç†åœ°å€ä¸­çš„ç›¸åŒä½åŒ¹é…ã€‚å³ç›¸å½“äºå°†é¡µé¢å¤§å°æ”¹å¤§ä¸º 16KB ï¼Œè¿™éœ€è¦ CPU æ”¯æŒä¿®æ”¹ MMU ç²’åº¦ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä»…ä½¿ç”¨ 4KB é¡µé¢ï¼Œåˆ™å¯ä»¥æ„å»ºä¿ç•™é¢œè‰²é™åˆ¶çš„æ˜ å°„ï¼Œå¹¶å…è®¸è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€ä¹‹é—´çš„ç¬¬ 12 ä½å’Œç¬¬ 13 ä½ä¸åŒã€‚è¿™ç§åšæ³•ä¼šå¢åŠ é¢å¤–çš„å¤æ‚æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ç¡¬ä»¶æ–¹æ³•è§£å†³ï¼Œä¾‹å¦‚ &lt;a href=&#34;https://xiangshan-doc.readthedocs.io/zh-cn/latest/huancun/cache_alias/&#34;&gt;é¦™å±±æ¶æ„&lt;/a&gt; ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;page coloring&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/page-coloring.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;ç°ä»£-cpu-çš„é€‰æ‹©&#34;&gt;ç°ä»£ CPU çš„é€‰æ‹©&lt;/h2&gt;
&lt;h3 id=&#34;å¤šæ•°çš„é€‰æ‹©&#34;&gt;å¤šæ•°çš„é€‰æ‹©&lt;/h3&gt;
&lt;p&gt;ç»å¤§å¤šæ•° CPU çš„ L2 L3 éƒ½æ˜¯ PIPT çš„ï¼Œä¸åŒç‚¹åœ¨äº L1 cache çš„è®¾è®¡ã€‚&lt;/p&gt;
&lt;p&gt;L1 cache çš„ dcache å’Œ icache å¯ä»¥é‡‡ç”¨ä¸åŒçš„è®¾è®¡ï¼Œåˆ†åˆ«é€‰ç”¨ VIPT æˆ–è€… PIPT ã€‚å¾ˆå¤š CPU çš„ L1 dcache ä½¿ç”¨çš„æ˜¯ PIPT è€Œ icache æ˜¯ VIPT ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å°‘æ•°-vivt-çš„-l1-è®¾è®¡&#34;&gt;å°‘æ•° VIVT çš„ L1 è®¾è®¡&lt;/h3&gt;
&lt;p&gt;ä¼ ç»Ÿä¸Šï¼Œè™šæ‹Ÿåœ°å€çš„ç¼“å­˜æœ‰å¾ˆå¤šç¼ºç‚¹ï¼šå®ƒä»¬ä¼šåœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æˆ– TLB ç»´æŠ¤æ“ä½œæ—¶è¢«åˆ·æ–°ï¼Œå› ä¸ºæ›´æ”¹è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„æ„å‘³ç€ä¸€ä¸ªè™šæ‹Ÿåœ°å€çš„ç¼“å­˜çš„å†…å®¹ä¸å†æ˜¯æœ€æ–°çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¯ä»¥é€šè¿‡å¼•å…¥ ASID ï¼ˆæ ‡è®°ä¸åŒè¿›ç¨‹ï¼‰æ¥é¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶åˆ·æ–°ï¼Œè¿˜å¯ä»¥é€šè¿‡è®°å½• VA åˆ° PA çš„åˆ«åæ¥è§£å†³åˆ«åé—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¶£äº‹arm-ä¸-mmap&#34;&gt;è¶£äº‹ï¼šARM ä¸ &lt;code&gt;mmap&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;ARMv6 å’Œ ARMv7 æ‰§è¡Œç›¸åŒçš„ &lt;code&gt;mmap&lt;/code&gt; ä»£ç ä¼šæœ‰ä¸åŒçš„ç»“æœï¼Œ v6 ä¼šå¤±è´¥ï¼Œè€Œ v7 ä¼šæˆåŠŸï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// Preconditions:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//  - fd is a file descriptor as returned from open() (or a related function).
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//  - The file is at least 4096 bytes long (and so can fill the mapping).
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//  - The file&amp;#39;s permissions are compatible with those in the mmap calls.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//  - MAP_FIXED is supported.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//  - The addresses provided can be mapped by the process, and are not
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//    allocated or otherwise reserved or invalid.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; * buffer0 = mmap((&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;*)(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x12340000&lt;/span&gt;), &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4096&lt;/span&gt;, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_FIXED, fd, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; * buffer1 = mmap((&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;*)(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0xdebc1000&lt;/span&gt;), &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4096&lt;/span&gt;, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_FIXED, fd, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ®µä»£ç å°†æ–‡ä»¶æ˜ å°„åˆ°äº†ä¸¤ç§é¢œè‰²çš„è™šæ‹Ÿåœ°å€ä¸Šï¼Œå¯ä»¥çœ‹åˆ° 0x12340000 çš„ç¬¬åäºŒåä¸‰ä½æ˜¯ 00 ï¼Œè€Œ 0xdebc1000 çš„ç¬¬åäºŒåä¸‰ä½æ˜¯ 01 ï¼Œè¿™è¿èƒŒäº† page coloring çš„åŸåˆ™ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤ä»£æ¶æ„æ‰§è¡Œä»£ç çš„ç»“æœä¸åŒæ˜¯å› ä¸ºï¼šv6 çš„ dcache æ˜¯ vipt çš„ï¼Œè€Œ v7 çš„ dcache æ˜¯ pipt çš„ï¼Œæ‰€ä»¥ v7 ä¸å­˜åœ¨åˆ«åé—®é¢˜ï¼Œè€Œ v6 å­˜åœ¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.eastonman.com/blog/2024/02/hot-chips-2023-ventanas-unconventional-veyron-v1/&#34;&gt;HotChips 2023: Ventana ä¸å¯»å¸¸çš„ Veyron V1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://xiangshan-doc.readthedocs.io/zh-cn/latest/huancun/cache_alias/&#34;&gt;é¦™å±±å®˜æ–¹æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://community.arm.com/arm-community-blogs/b/architectures-and-processors-blog/posts/page-colouring-on-armv6-and-a-bit-on-armv7&#34;&gt;arm community: Page Colouring on ARMv6 (and a bit on ARMv7)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>æ¶è¡¥ CPU çŸ¥è¯†ä¹‹åˆ†æ”¯é¢„æµ‹</title>
      <link>https://vaaandark.top/posts/relearning-cpu-1-branch-prediction/</link>
      <pubDate>Sun, 18 Feb 2024 12:44:41 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/relearning-cpu-1-branch-prediction/</guid>
      <description>&lt;h2 id=&#34;å‰å› &#34;&gt;å‰å› &lt;/h2&gt;
&lt;p&gt;æœ€è¿‘çœ‹äº†ä¸€ç¯‡ä»‹ç» Ventana çš„ Veyron V1 æ ¸å¿ƒçš„åšå®¢ &lt;a href=&#34;https://blog.eastonman.com/blog/2024/02/hot-chips-2023-ventanas-unconventional-veyron-v1/&#34;&gt;HotChips 2023: Ventana ä¸å¯»å¸¸çš„ Veyron V1&lt;/a&gt; ï¼Œé‡Œé¢å‡ºç°äº†å¾ˆå¤šæˆ‘æ²¡å¬è¯´è¿‡æˆ–è€…ä¸ç”šäº†è§£çš„åè¯ï¼Œåœ¨é˜…è¯»è¿™ç¯‡åšå®¢å’ŒæŸ¥æ‰¾èµ„æ–™çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å­¦åˆ°äº†å¾ˆå¤šæ–°çš„ CPU çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;Veyron V1 çš„æ¡†å›¾&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/veyron.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;btb-æ˜¯ä»€ä¹ˆ&#34;&gt;BTB æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;BTB å³åˆ†æ”¯ç›®æ ‡ç¼“å†²(Branch Target Buffer)ï¼Œæœ¬è´¨ä¸Šæ˜¯ Cache ï¼Œé€šè¿‡å½“å‰ PC çš„ä¸€éƒ¨åˆ†è¿›è¡Œç´¢å¼•ï¼Œä¸ entry ä¸­çš„ tag è¿›è¡Œæ¯”å¯¹ï¼Œè¾“å‡ºçš„æ˜¯ target address ã€‚&lt;/p&gt;
&lt;p&gt;BTB è§£å†³çš„æ˜¯ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿè§£å†³çš„æ˜¯å¦‚ä½•å¿«é€Ÿå®šä½è·³è½¬åœ°å€çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œè·³è½¬çš„åœ°å€ä¸€èˆ¬å°±åœ¨æŒ‡ä»¤ä¸­ï¼Œå–å‡ºæ¥å‡ ä¹æ˜¯æ— å»¶è¿Ÿçš„ï¼Œé‚£ä¸ºä»€ä¹ˆéœ€è¦å¿«é€Ÿå®šä½å‘¢ï¼ŸåŸå› åœ¨äº&lt;strong&gt;åˆ†æ”¯é¢„æµ‹åœ¨å–æŒ‡é˜¶æ®µä¹‹å‰&lt;/strong&gt;ï¼åªæœ‰å…ˆåšé¢„æµ‹æ‰èƒ½å¿«é€Ÿå–å‡ºå¤šæ¡æŒ‡ä»¤è¿›è¡Œè¯‘ç ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-bit-é¥±å’Œè®¡æ•°å™¨æ˜¯ä»€ä¹ˆ&#34;&gt;2-bit é¥±å’Œè®¡æ•°å™¨æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è§£å†³äº†è·³è½¬åœ°å€çš„é—®é¢˜è¿˜éœ€è¦è§£å†³æ˜¯å¦è·³è½¬çš„é—®é¢˜ï¼Œè¿™ä¸ªä¸€èˆ¬å«åš Taken / Not taken ï¼Œè¿™ä¹Ÿæ˜¯åˆ†æ”¯é¢„æµ‹çš„æ ¸å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;åˆ†æ”¯é¢„æµ‹çš„å‰ææ˜¯ç¨‹åºæ‰§è¡Œé¡ºåºæœ‰ä¸€å®šçš„è§„å¾‹ï¼Œæˆ–è€…è¯´æœ‰ä¸€å®šçš„æƒ¯æ€§ï¼Œæ‰€ä»¥æœ‰äººå°±è®¾è®¡å‡ºæ¥äº† 2-bit é¥±å’Œè®¡æ•°å™¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¹‹æ‰€ä»¥å« 2-bit æ˜¯å› ä¸ºå®ƒæœ‰å››ç§çŠ¶æ€ï¼šstrongly taken, weakly taken, weakly not taken, strongly not taken ã€‚æ¯æ¬¡ actually taken äº†ï¼ŒçŠ¶æ€å°±å°†å‘å·¦è¿ç§»ï¼›æ¯æ¬¡ actually not taken ,çŠ¶æ€å°±å°†å‘å³è¿ç§»ã€‚&lt;/li&gt;
&lt;li&gt;ä¹‹æ‰€ä»¥å«ã€Œé¥±å’Œã€æ˜¯å› ä¸ºå½“å¤„äº strongly (not) taken çŠ¶æ€æ—¶å† (not) taken ä¸ä¼šå†è¿ç§»çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;çŠ¶æ€è¿ç§»å›¾&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/2-bit-counter.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;2-bit é¥±å’Œè®¡æ•°å™¨æ˜¯å¦‚ä»Šåˆ†æ”¯é¢„æµ‹æ–¹æ¡ˆçš„åŸºç¡€ï¼Œä½†æ˜¯å•çº¯åªä½¿ç”¨å®ƒä¼šå¯¼è‡´åœ¨ä¸€äº›æç«¯æ¡ä»¶ä¸‹æ€§èƒ½å¾ˆä½ã€‚ä¸¾ä¸€ä¸ªå¾ˆç®€å•çš„ä¾‹å­ NTNTNTNT&amp;hellip; ï¼Œå®ƒçš„å‡†ç¡®ç‡åªæœ‰ 50% ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯æ¥å—çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;bhr-æ˜¯ä»€ä¹ˆå±€éƒ¨å†å²åˆ†æ”¯é¢„æµ‹å™¨æ˜¯ä»€ä¹ˆ&#34;&gt;BHR æ˜¯ä»€ä¹ˆï¼Ÿå±€éƒ¨å†å²åˆ†æ”¯é¢„æµ‹å™¨æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;BHR å³åˆ†æ”¯å†å²å¯„å­˜å™¨(Branch History Register)ï¼Œå®ƒçš„å‡ºç°æ˜¯ä¸ºäº†é…åˆ 2-bit é¥±å’Œè®¡æ•°å™¨æ¥æé«˜é¢„æµ‹å‡†ç¡®ç‡ã€‚&lt;/p&gt;
&lt;p&gt;BHR æ˜¯ä¸€ä¸ª n ä½çš„å¯ä»¥ä¸æ–­å·¦ç§»çš„å¯„å­˜å™¨ï¼Œç”¨äºå­˜å‚¨ n æ¬¡åˆ†æ”¯è·³è½¬ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª BHR å¯¹åº” 2^n ä¸ª 2-bit é¥±å’Œè®¡æ•°å™¨ï¼Œè¿™æ ·çš„ä¸€ç»„é¥±å’Œè®¡æ•°å™¨è¢«ç§°ä¸º Pattern History Table(PHT) ã€‚å¯ä»¥æƒ³åˆ°ï¼Œæ­¤æ—¶çš„åˆ†æ”¯é¢„æµ‹å°±æ˜¯é€šè¿‡ BHR çš„å€¼æ¥ç´¢å¼• PHT çš„è®¡æ•°å™¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;BHR&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/branch-history-register.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¹‹å‰æåˆ°çš„ NTNTNTNT&amp;hellip; è¿™ä¸ªæç«¯æƒ…å†µä¸ºä¾‹ï¼Œå‡è®¾ BHR çš„å®½åº¦ä¸º 2 ï¼Œå®ƒä¼šåœ¨ 10 å’Œ 01 ä¹‹é—´äº¤æ›¿ï¼Œåˆ†åˆ«å¯¹åº”äº†ä¸¤ä¸ªè®¡æ•°å™¨ï¼Œä¸€ä¸ªä¼šé¥±å’Œäº taken ï¼Œå¦ä¸€ä¸ªåˆ™ä¼šé¥±å’Œäº not taken ã€‚è¿™æ ·ä¸€æ¥å°±å®Œç¾è§£å†³äº†ä¹‹å‰çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ•´ä½“çš„å·¥ä½œæµç¨‹å°±æ˜¯ï¼šé¦–å…ˆé€šè¿‡ BTB æ‰¾åˆ°åˆ†æ”¯ PC ï¼Œå†é€šè¿‡åˆ†æ”¯ PC æ‰¾åˆ°å¯¹åº”çš„ BHR ï¼Œæœ€åé€šè¿‡ BHR åœ¨ PHT ä¸­æŸ¥æ‰¾ï¼Œå†³å®šæ˜¯å¦ taken ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;pht2-bit-counter-ä½•æ—¶æ›´æ–°&#34;&gt;PHT/2-bit counter ä½•æ—¶æ›´æ–°ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ç°ä»£ CPU ä¸€èˆ¬éƒ½æ˜¯è¶…æ ‡é‡çš„ï¼Œæ¯æ¬¡å¯ä»¥å–å‡ºä¸æ­¢ä¸€æ¡æŒ‡ä»¤é€å…¥æµæ°´çº¿ä¸­è¿›è¡Œä¹±åºæ‰§è¡Œã€‚ä¸ºäº†ä¿è¯ç»“æœçš„æ­£ç¡®æ€§ï¼Œå¿…é¡»åœ¨ commit/retire é˜¶æ®µæ›´æ–°ï¼Œæ­¤æ—¶ä¸ä¼šå†å› ä¸ºåˆ†æ”¯é¢„æµ‹çš„é”™è¯¯å¯¼è‡´æµæ°´çº¿ flush ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åˆ†æ”¯é¢„æµ‹ä¸€èˆ¬æ˜¯æµæ°´çº¿çš„ç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œ commit/retire æ˜¯æœ€åä¸€ä¸ªé˜¶æ®µã€‚è¿™æ ·ä¸€æ¥ï¼Œé¢„æµ‹å’Œæ›´æ–°ä¹‹é—´é—´éš”æ—¶é—´è¿‡é•¿ï¼Œåœ¨è¿™ä¸ªé—´éš”æ—¶é—´å†…è¿™æ¡æŒ‡ä»¤å¯èƒ½å·²ç»æŒ‰ç…§ä¹‹å‰çš„ counter çŠ¶æ€æ‰§è¡Œå¤šæ¬¡äº†ï¼Œè¿™å¥½åƒå¤±å»äº†æ—¶æ•ˆæ€§ã€‚&lt;strong&gt;ä½†å…¶å®ä¸éœ€è¦æ‹…å¿ƒï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬å‘ç”Ÿåœ¨å¾ªç¯ä½“å¾ˆçŸ­çš„æƒ…å†µä¸‹ï¼Œç”±äºé¥±å’Œè®¡æ•°å™¨çš„æ€§è´¨ï¼Œå®ƒåœ¨å‡ æ¬¡åå°±ä¼šæˆä¸º strongly taken çŠ¶æ€ï¼Œç”±äºå·²ç»é¥±å’Œï¼Œä¸åŠæ—¶æ›´æ–°ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;bhr-ä½•æ—¶æ›´æ–°&#34;&gt;BHR ä½•æ—¶æ›´æ–°ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸€èˆ¬æƒ…å†µä¸‹ BHR çš„æ›´æ–°ä¹Ÿæ˜¯åœ¨ commit/retire é˜¶æ®µçš„ã€‚è¿™ä¹Ÿæ˜¯å› ä¸ºå¦‚æœåœ¨å…¶ä»–é˜¶æ®µä¼šé‡åˆ°æ­£ç¡®æ€§é—®é¢˜ï¼Œéœ€è¦é¢å¤–å¼€é”€æ¥æ¢å¤ï¼ˆæˆ–è€…è¯´ä¿®æ­£ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;BHR åŒæ ·ä¸ç”¨æ‹…å¿ƒé—´éš”æ—¶é—´è¿‡é•¿ï¼ŒåŸå› å’Œä¸Šé¢çš„ PHT ä¸€æ ·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ghr-æ˜¯ä»€ä¹ˆå…¨å±€å†å²åˆ†æ”¯é¢„æµ‹å™¨æ˜¯ä»€ä¹ˆ&#34;&gt;GHR æ˜¯ä»€ä¹ˆï¼Ÿå…¨å±€å†å²åˆ†æ”¯é¢„æµ‹å™¨æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¿™ä¸€è®¾è®¡çš„å‡è®¾æ˜¯åˆ†æ”¯çš„ç»“æœä¹‹é—´äº’ç›¸å…³è”ï¼Œè¿™åœ¨æˆ‘ä»¬æ—¥å¸¸å†™çš„ä»£ç ä¸­æœ‰å¾ˆå¤šä½“ç°ï¼Œæ˜¾ç„¶æ˜¯å¾ˆæœ‰é“ç†çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·å°±åªéœ€è¦ä¸€ä¸ª Global Branch History Register ï¼Œè®°å½•æ‰€æœ‰åˆ†æ”¯åœ¨è¿‡å»çš„æ‰§è¡Œç»“æœã€‚&lt;/p&gt;
&lt;h3 id=&#34;ghr-ä½•æ—¶æ›´æ–°&#34;&gt;GHR ä½•æ—¶æ›´æ–°ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;GHR åº”å½“åœ¨åˆ†æ”¯é¢„æµ‹åæ›´æ–°ï¼Œå› ä¸ºä¸¤ä¸ªé‚»è¿‘çš„åˆ†æ”¯æŒ‡ä»¤ä¼šé—´éš”å¾ˆçŸ­çš„æ—¶é—´è¿›å…¥æµæ°´çº¿ï¼ŒGHR å¦‚æœä¸åœ¨åˆ†æ”¯é¢„æµ‹åæ›´æ–°ä¾¿å¤±å»äº†æ„ä¹‰ï¼Œè¿åäº†ã€Œåˆ†æ”¯çš„ç»“æœä¹‹é—´ç›¸äº’å…³è”ã€çš„å‡è®¾ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†æ”¯é¢„æµ‹é”™è¯¯äº†ï¼Œä½†æ˜¯åç»­çš„åˆ†æ”¯æŒ‡ä»¤ä½¿ç”¨äº†é”™è¯¯çš„ GHR æ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;strong&gt;ä¸ç”¨ç®¡ï¼Œå› ä¸ºåç»­çš„æŒ‡ä»¤éƒ½åº”è¯¥è¢«æµæ°´çº¿ flush æ‰ã€‚&lt;/strong&gt; ä¸è¿‡ï¼Œè¿˜æ˜¯éœ€è¦é¢å¤–çš„å¼€é”€æ¥æ¢å¤ GHR ã€‚&lt;/p&gt;
&lt;h3 id=&#34;aliasing-pht-æ˜¯ä»€ä¹ˆé—®é¢˜&#34;&gt;Aliasing PHT æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ç”±äºæ‰€æœ‰çš„åˆ†æ”¯ä½¿ç”¨åŒä¸€ä¸ª PHT ï¼Œå› æ­¤å®¹æ˜“å‡ºç°ä¸åŒåˆ†æ”¯æŒ‡å‘åŒä¸€ä¸ª PHT entry çš„é—®é¢˜ã€‚è§£å†³æ–¹æ¡ˆæœ‰å¾ˆå¤šï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ€ç®€å•çš„æ–¹æ³•æ˜¯å¢å¤§ PHT ï¼Œä½¿ç”¨ PC ä¸­æ›´å¤šä½æ¥å¯»æ‰¾ entry ï¼Œè¿™ä¼šå¢åŠ é¢ç§¯å’ŒåŠŸè€—ã€‚&lt;/li&gt;
&lt;li&gt;è¿˜æœ‰å°±æ˜¯ä½¿ç”¨ hashing/index-randomization ï¼Œæ¯”å¦‚ Tage(TAgged GEometric history length)ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯å°† GHR å’Œ PC è¿›è¡Œå¼‚æˆ–æ“ä½œåå†å¯»å€ï¼Œ&lt;a href=&#34;https://xiangshan-doc.readthedocs.io/zh-cn/latest/frontend/bp/#ubtb&#34;&gt;é¦™å±±æ¶æ„&lt;/a&gt;å°±ä½¿ç”¨çš„æ˜¯è¿™ä¸ªæ–¹æ³•ã€‚ä»¥æ­¤æ€æƒ³è¿˜æœ‰å¾ˆå¤š hash è®¾è®¡æ¥é˜²æ­¢ç¢°æ’ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;warmuptraining-time-æ˜¯ä»€ä¹ˆ&#34;&gt;Warmup/Training time æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;
&lt;p&gt;PHT entryçš„è®¡æ•°å™¨è¾¾åˆ°é¥±å’ŒçŠ¶æ€çš„æ—¶é—´ç§°ä¸º training time ï¼Œå®ƒå’Œ BHR/GHR çš„é•¿åº¦æœ‰å…³ï¼Œè¾ƒé•¿çš„ BHR/GHR éœ€è¦æ›´å¤šçš„æ—¶é—´ warmup ï¼Œä½†ä¹Ÿä¼šè®°å½•æ›´å¤šçš„å†å²ä¿¡æ¯ï¼Œæé«˜é¢„æµ‹å‡†ç¡®åº¦ã€‚è¾ƒçŸ­çš„ BHR/GHR ä¸èƒ½è®°å½•åˆ†æ”¯çš„æ‰€æœ‰ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ç°ä»£ CPU å¾ˆå¤šéƒ½æ˜¯è¶…æ ‡é‡çš„ï¼Œä¸‹ä¸€æ¡åˆ†æ”¯æŒ‡ä»¤å¼€å§‹é¢„æµ‹æ—¶ä¸Šä¸€æ¡åˆ†æ”¯æŒ‡ä»¤å¯èƒ½è¿˜è¿œè¿œæ²¡æœ‰æ‰§è¡Œç»“æŸã€‚ä¸ºäº†å°½å¿«æ‹¿åˆ°åˆ†æ”¯å†å²ï¼Œå¤§éƒ¨åˆ†åˆ†æ”¯é¢„æµ‹æœºåˆ¶éƒ½ä¼šé€‰æ‹©ã€Œæ¨æµ‹æ›´æ–°å†å²ã€ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­è¯´åˆ°çš„åœ¨åˆ†æ”¯é¢„æµ‹åç«‹å³æ›´æ–° GHR ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…¨å±€å†å²åˆ†æ”¯é¢„æµ‹--å±€éƒ¨å†å²åˆ†æ”¯é¢„æµ‹&#34;&gt;å…¨å±€å†å²åˆ†æ”¯é¢„æµ‹ &amp;gt; å±€éƒ¨å†å²åˆ†æ”¯é¢„æµ‹ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è®°å¾—ä¹‹å‰è¯´è¿‡å…¨å±€åˆ†æ”¯é¢„æµ‹åªéœ€è¦ä¸€ä¸ª GHR è€Œå±€éƒ¨åˆ†æ”¯é¢„æµ‹éœ€è¦ä¸€ç»„ BHR å—ï¼Ÿ&lt;strong&gt;è¿™ä¼šå¼•èµ·å­˜å‚¨ä»‹è´¨é€‰æ‹©çš„é—®é¢˜ï¼Œä¸€ä¸ª GHR å†æ€ä¹ˆé•¿éƒ½å¯ä»¥ç›´æ¥ç”¨å¯„å­˜å™¨å­˜ï¼Œè€Œä¸€ç»„é€šè¿‡ PC ç´¢å¼•çš„ BHR è¡¨ç›¸å¯¹è¾ƒå¤§ï¼Œåªèƒ½ç”¨å’Œç¼“å­˜ä¸€æ ·çš„ SRAM æ¥å­˜ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ SRAM æ¥å­˜çš„é—®é¢˜åœ¨äºï¼Œæ¢å¤å†å²æ—¶æ— æ³•åœ¨ä¸€æ‹å†…æ¢å¤æˆ–è€…ç”šè‡³æ— æ³•åœ¨çŸ­æ—¶é—´å†…æ¢å¤ã€‚è¿™ç§ç»´æŠ¤çš„å›°éš¾ä½¿å¾—å±€éƒ¨å†å²åœ¨ç°ä»£å¤„ç†å™¨çš„åˆ†æ”¯é¢„æµ‹å™¨ä¸­å¾ˆå°‘è§åˆ°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ›´é«˜çº§çš„åˆ†æ”¯é¢„æµ‹æœºåˆ¶&#34;&gt;æ›´é«˜çº§çš„åˆ†æ”¯é¢„æµ‹æœºåˆ¶&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å°†å±€éƒ¨å’Œå…¨å±€å†å²åˆ†æ”¯é¢„æµ‹ç»“åˆ &lt;a href=&#34;https://link.zhihu.com/?target=https%3A//www.csee.umbc.edu/portal/help/architecture/alpha21264a.pdf&#34;&gt;The Alpha 21264 Microprocessor Architecture&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é¢„æµ‹å¾ªç¯ï¼Œå³ä½¿ç”¨é€šè¿‡è®¡æ•°é¿å…æœ€åä¸€æ¬¡å¾ªç¯é¢„æµ‹é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;å¼•å…¥æœºå™¨å­¦ä¹ çš„æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.zhihu.com/question/486239354&#34;&gt;çŸ¥ä¹é—®é¢˜ï¼šç°ä»£ä¸­å¤®å¤„ç†å™¨ï¼ˆCPUï¼‰æ˜¯æ€æ ·è¿›è¡Œåˆ†æ”¯é¢„æµ‹çš„ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.eastonman.com/blog/2024/02/hot-chips-2023-ventanas-unconventional-veyron-v1/&#34;&gt;HotChips 2023: Ventana ä¸å¯»å¸¸çš„ Veyron V1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.eastonman.com/blog/2023/12/modern-branch-prediction-from-academy-to-industry/&#34;&gt;ç°ä»£åˆ†æ”¯é¢„æµ‹ï¼šä»å­¦æœ¯ç•Œåˆ°å·¥ä¸šç•Œ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://xiangshan-doc.readthedocs.io/zh-cn/latest/frontend/bp/&#34;&gt;é¦™å±±å®˜æ–¹æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.inf.pucrs.br/~calazans/graduate/SDAC/saltos.pdf&#34;&gt;Two-Level Adaptive Training Branch Prediction&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Pthread</title>
      <link>https://vaaandark.top/posts/pthread/</link>
      <pubDate>Sat, 23 Dec 2023 22:03:25 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/pthread/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;èµ›åšè€ƒå¤ï¼šLinux æ”¯æŒ POSIX çº¿ç¨‹æ ‡å‡†çš„å‰ä¸–ä»Šç”Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;çº¿ç¨‹æ˜¯ä»€ä¹ˆ&#34;&gt;çº¿ç¨‹æ˜¯ä»€ä¹ˆ&lt;/h2&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ã€‚åœ¨ä¸€èˆ¬çš„æ“ä½œç³»ç»Ÿä¸Šï¼Œå®ƒè¢«åŒ…å«åœ¨è¿›ç¨‹ä¹‹ä¸­ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;çº¿ç¨‹å…±äº«äº†ä»€ä¹ˆ&#34;&gt;çº¿ç¨‹å…±äº«äº†ä»€ä¹ˆ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç æ®µã€æ•°æ®æ®µã€å †&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶æè¿°ç¬¦&lt;/li&gt;
&lt;li&gt;è¿›ç¨‹ä¿¡æ¯ï¼ˆå¦‚ pid ï¼‰ã€ç”¨æˆ· id å’Œç»„ id&lt;/li&gt;
&lt;li&gt;Signal Handle&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;çº¿ç¨‹æ²¡æœ‰å…±äº«ä»€ä¹ˆ&#34;&gt;çº¿ç¨‹æ²¡æœ‰å…±äº«ä»€ä¹ˆ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ ˆ&lt;/li&gt;
&lt;li&gt;å¯„å­˜å™¨&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹ä¼˜å…ˆçº§å’Œè°ƒåº¦ç­–ç•¥&lt;/li&gt;
&lt;li&gt;TLS(Thread Local Storage)ï¼ˆçº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼‰&lt;/li&gt;
&lt;li&gt;tid(å¯ä»¥ä½¿ç”¨ &lt;code&gt;syscall(SYS_gettid)&lt;/code&gt; æŸ¥çœ‹)&lt;/li&gt;
&lt;li&gt;Signal Mask&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å€¼å¾—æ³¨æ„çš„é—®é¢˜pid-vs-tgid-getpid-vs-gettid&#34;&gt;å€¼å¾—æ³¨æ„çš„é—®é¢˜(pid vs tgid, getpid vs gettid)&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;tg for thread group&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;getpid&lt;/code&gt; æ˜¯ man 3 é‡Œé¢çš„ï¼Œå› æ­¤å®ƒæ˜¯ Library call ï¼›&lt;code&gt;gettid&lt;/code&gt; æ˜¯ man 2 é‡Œé¢çš„ï¼Œå› æ­¤å®ƒæ˜¯ System Call ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;unistd.h&lt;/code&gt; ä¸­çš„ &lt;code&gt;getpid()&lt;/code&gt; å®é™…ä¸Šè·å–çš„æ˜¯ tgid ï¼Œè€Œ &lt;code&gt;syscall(SYS_gettid)&lt;/code&gt; å®é™…ä¸Šè·å–çš„æ˜¯ pid ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ç‹¬ä¸€æ— äºŒçš„ pid ï¼Œæœ‰å¯èƒ½é‡å¤çš„ tgid ã€‚å½“ä¸€ä¸ªè¿›ç¨‹å±äºä¸€ä¸ªå•çº¿ç¨‹ç¨‹åºæ—¶ï¼Œå®ƒçš„ pid å°±ç­‰äº tgid ï¼›å½“å®ƒåˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œæ–°çš„çº¿ç¨‹æ‹¥æœ‰ä¸€ä¸ªæ–°çš„ pid ï¼ŒåŒæ—¶ç»§æ‰¿äº†åŒä¸€çº¿ç¨‹ç»„çš„ tgid ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                         USER VIEW
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;-- PID 43 --&amp;gt;|&amp;lt;----------------- PID 42 -----------------&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              |      +---------+          |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              |      | process |          |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              |     _| pid=42  |_         |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         __(fork) _/ | tgid=42 | \_ (new thread) _
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        /     |      +---------+          |       \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;+---------+   |                           |    +---------+
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| process |   |                           |    | process |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| pid=43  |   |                           |    | pid=44  |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| tgid=43 |   |                           |    | tgid=42 |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;+---------+   |                           |    +---------+
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;-- PID 43 --&amp;gt;|&amp;lt;--------- PID 42 --------&amp;gt;|&amp;lt;--- PID 44 ---&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        KERNEL VIEW
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;posix-thread&#34;&gt;POSIX Thread&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸å…¶è¯´æ˜¯ pthread çš„å†å²ï¼Œä¸å¦‚è¯´æ˜¯ kernel å˜å¾—æ›´å¤§æ›´å¼ºï¼Œå¯¹çº¿ç¨‹æ¨¡å‹æ”¯æŒå¾—æ›´å¥½çš„å†å²ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;LinuxThreadsï¼ˆæ—©æœŸï¼‰&lt;/li&gt;
&lt;li&gt;NPTL(Native POSIX Thread Library)ï¼ˆç°åœ¨ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æŸ¥çœ‹ä½ çš„ pthread å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ getconf GNU_LIBPTHREAD_VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;NPTL 2.38
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;linuxthreads&#34;&gt;LinuxThreads&lt;/h3&gt;
&lt;p&gt;åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œ LinuxThreads æ˜¯ 1996 å¹´æ¨å‡ºçš„ POSIX Threads çš„éƒ¨åˆ†å®ç°ï¼Œå…¶ä¸»è¦å¼€å‘è€…æ˜¯ Xavier Leroy ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ç®¡ç†çº¿ç¨‹manager-thread&#34;&gt;ç®¡ç†çº¿ç¨‹(Manager Thread)&lt;/h4&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆéœ€è¦ç®¡ç†çº¿ç¨‹ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹è‡´å‘½çš„ä¿¡å·åšå‡ºååº”(fatal signals)ï¼Œå¹¶æ€æ­»æˆ–ç»ˆæ­¢æ•´ä¸ªçº¿ç¨‹ã€‚ï¼ˆåæ–‡è¯¦ç»†è¯´æ˜è¿™ä¸€ç‚¹çš„åŸå› ï¼Œè¿™æ˜¯ç”± LinuxThreads çš„ç¼ºé™·å¯¼è‡´çš„ï¼‰&lt;/li&gt;
&lt;li&gt;é‡Šæ”¾ç”¨ä½œçº¿ç¨‹æ ˆçš„å†…å­˜ä¸èƒ½ç”±è¯¥çº¿ç¨‹æœ¬èº«æ‰§è¡Œï¼Œå¿…é¡»è¦ç­‰è¿™ä¸ªçº¿ç¨‹ç»“æŸå†è¿›è¡Œï¼Œå› æ­¤éœ€è¦ç‰¹æ®Šçš„ç®¡ç†çº¿ç¨‹æ¥æ”¶å°¾ã€‚&lt;/li&gt;
&lt;li&gt;é‡Šæ”¾ tls éœ€è¦éå†æ‰€æœ‰çº¿ç¨‹ï¼Œå› æ­¤éœ€è¦ç®¡ç†çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;ç»ˆæ­¢çº¿ç¨‹å¿…é¡»æ˜¯ç­‰å¾…çš„ï¼ˆç”±ç®¡ç†çº¿ç¨‹ç­‰å¾…ï¼‰ï¼Œä¸ç„¶ä¼šå‡ºç°åƒµå°¸çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;å½“ä¸»çº¿ç¨‹è°ƒç”¨ &lt;code&gt;pthread_exit()&lt;/code&gt; æ—¶ï¼Œè¿™ä¸ªè¿›ç¨‹ä¸èƒ½å°±æ­¤ç»“æŸã€‚æ­£ç¡®çš„è¡Œä¸ºæ˜¯ï¼Œä¸»çº¿ç¨‹ sleep ï¼Œå½“å…¶ä»–çº¿ç¨‹è¢«æ€æ­»åç®¡ç†çº¿ç¨‹å†å”¤é†’ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹æ­¤æ—¶æ‰èƒ½é€€å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ç¼ºé™·&#34;&gt;ç¼ºé™·&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ç®¡ç†çº¿ç¨‹å¸¦æ¥çš„é¢å¤–å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä¿¡å·å®ç°åŒæ­¥åŸè¯­ã€‚&lt;/li&gt;
&lt;li&gt;åŸºæœ¬ç¬¦åˆ POSIX æ ‡å‡†ï¼Œä¿¡å·å¤„ç†é™¤å¤–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;LinuxThreads å®ç°çš„çº¿ç¨‹ï¼Œæœ¬è´¨ä¸Šæ˜¯å…±äº«äº†å†…å­˜ã€æ–‡ä»¶æè¿°ç¬¦çš„è¿›ç¨‹ï¼Œå®ƒä»¬æœ‰ç€ä¸åŒçš„ pid ï¼Œå®ƒä»¬å¹¶ä¸ä½œä¸ºè¿›ç¨‹çš„ä¸€ä¸ªæ•´ä½“ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œçš„ pid æ˜¯æŠ½è±¡æ¦‚å¿µï¼Œå½“æ—¶çš„ Kernel å¹¶æ²¡æœ‰ pid å’Œ tgid çš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å‘é€åˆ°çº¿ç¨‹ pid çš„ä¿¡å·åªèƒ½ç”±è¯¥çº¿ç¨‹å¤„ç†ã€‚åªè¦æ²¡æœ‰çº¿ç¨‹é˜»å¡è¯¥ä¿¡å·ï¼Œè¯¥è¡Œä¸ºå°±ç¬¦åˆæ ‡å‡†ï¼šç¨‹åºçš„ä¸€ä¸ªï¼ˆæœªæŒ‡å®šï¼‰çº¿ç¨‹å¤„ç†è¯¥ä¿¡å·ã€‚&lt;/li&gt;
&lt;li&gt;ä½†æ˜¯ï¼Œå¦‚æœå‘ pid å‘é€ä¿¡å·çš„çº¿ç¨‹é˜»å¡äº†ä¿¡å·ï¼Œé‚£ä¹ˆ LinuxThreads å°†ç®€å•åœ°åœ¨è¯¥çº¿ç¨‹ä¸­æ’é˜Ÿï¼Œä»…å½“è¯¥çº¿ç¨‹è§£é™¤é˜»å¡ä¿¡å·æ—¶æ‰æ‰§è¡Œå¤„ç†ç¨‹åºï¼Œè€Œä¸æ˜¯ç«‹å³åœ¨ä¸é˜»å¡ä¿¡å·çš„å¦ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å®ç°è€…çš„åæ§½ï¼šThis is to be viewed as a LinuxThreads bug, but I currently don&amp;rsquo;t see any way to implement the POSIX behavior without kernel support.&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;çº¿ç¨‹æ¨¡å‹&#34;&gt;çº¿ç¨‹æ¨¡å‹&lt;/h4&gt;
&lt;p&gt;æ­¤æ—¶å°±å·²ç»å‡ºç°äº† Linux ä»£è¡¨æ€§çš„ä¸€å¯¹ä¸€(one-to-one)æ¨¡å‹ã€‚å†…æ ¸å¯¹çº¿ç¨‹å’Œè¿›ç¨‹ä¸åšåŒºåˆ†ï¼Œæ‰€è°“çš„å†…æ ¸çº¿ç¨‹æ˜¯ &lt;code&gt;task_struct&lt;/code&gt; ï¼Œè€Œå†…æ ¸è°ƒåº¦æ—¶ä¹Ÿåªè€ƒè™‘å®ƒä»¬ã€‚&lt;/p&gt;
&lt;h5 id=&#34;one-to-one-vs-many-to-one&#34;&gt;one-to-one vs many-to-one&lt;/h5&gt;
&lt;p&gt;å½“ç”¨æˆ·åˆ›å»ºå‡ºå¾ˆå¤šç”¨æˆ·çº¿ç¨‹æ—¶ï¼Œ Linux çš„åšæ³•æ˜¯ï¼šæ¯å½“ç”¨æˆ·è°ƒç”¨åº“å‡½æ•°åˆ›å»ºçº¿ç¨‹ï¼Œåº“å‡½æ•°è®©å†…æ ¸åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„å†…æ ¸çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤šå¤„ç†å™¨ä¸Šï¼ŒCPU å¯†é›†å‹ç¨‹åºçš„å¼€é”€æœ€å°ï¼Œå³æ¯ä¸ªå¤„ç†å™¨ä¸Šéƒ½å¯ä»¥è·‘ä¸€ä¸ªçº¿ç¨‹ï¼ˆæ€è€ƒä¸€ä¸‹å¦‚æœæ˜¯ many-to-one ï¼Œä¸€ä¸ªå†…æ ¸çº¿ç¨‹å¯¹åº”å¤šä¸ªç”¨æˆ·çº¿ç¨‹ï¼Œåˆ™å¾ˆéš¾åœ¨å¤šæ ¸ä¸Šå¹¶è¡Œï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;I/O æ“ä½œå¼€é”€æœ€å°ï¼ˆæ€è€ƒä¸€ä¸‹å¦‚æœæ˜¯ many-to-one ï¼Œé˜»å¡ IO æ“ä½œå®ç°èµ·æ¥æœ‰å¤šä¹ˆå¤æ‚ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°ç®€å•ï¼Œä¸ä¸å†…æ ¸è¿‡åº¦è€¦åˆï¼ˆå†…æ ¸è°ƒåº¦å¯ä»¥å®Œæˆå¤§éƒ¨åˆ†å¤æ‚å·¥ä½œï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;one-to-one-vs-many-to-many&#34;&gt;one-to-one vs many-to-many&lt;/h5&gt;
&lt;p&gt;é‚£ä¹ˆä¸ºä»€ä¹ˆä¸ç”¨å¤šå¯¹å¤šæ¨¡å‹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å½“æ—¶å¤§å¤šæ•°å•†ä¸š Unix ç³»ç»Ÿï¼ˆSolarisã€Digital Unixã€IRIXï¼‰éƒ½ä»¥è¿™ç§æ–¹å¼å®ç° POSIX çº¿ç¨‹ã€‚è¯¥æ¨¡å‹ç»“åˆäº†â€œå¤šå¯¹ä¸€â€å’Œâ€œä¸€å¯¹ä¸€â€æ¨¡å‹çš„ä¼˜ç‚¹ï¼Œå¾ˆæœ‰å¸å¼•åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;å¤šå¯¹å¤šæ¨¡å‹èƒ½æˆåŠŸé¿å…ä¸¤ç§æ¨¡å‹çš„æœ€åæƒ…å†µã€‚åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬é«˜æ˜‚çš„å†…æ ¸ Digital Unix ä¸Šå¤šå¯¹å¤šæ¨¡å‹å‡ ä¹å¯ä»¥è¯´æ˜¯å”¯ä¸€é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå¤šå¯¹å¤šæ¨¡å‹çš„å®ç°ç›¸å½“å¤æ‚ï¼Œå¹¶ä¸”éœ€è¦ Linux å¢åŠ æ”¯æŒå¾ˆå¤šæ–°çš„åŠŸèƒ½ã€‚å¦ä¸€æ–¹é¢ï¼ŒLinus Torvalds å’Œå…¶ä»– Linux å†…æ ¸å¼€å‘äººå‘˜ä¸€ç›´ä»¥æ•´ä½“ç®€å•æ€§çš„åä¹‰æ¨åŠ¨ä¸€å¯¹ä¸€æ¨¡å‹ï¼Œæ›´ä½•å†µ Linux çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ•ˆç‡ç›¸å½“å‡ºè‰²ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è™½ç„¶å¤šå¯¹å¤šæ¨¡å‹åœ¨ pthread ä¸­è¢«æ”¾å¼ƒï¼Œä½†æ˜¯å®ƒåœ¨ä¸€äº›ç¼–ç¨‹è¯­è¨€çš„è¿è¡Œæ—¶ä¸­å¤§æ”¾å¼‚å½©ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id=&#34;ç®¡ç†çº¿ç¨‹ä¸ä¸€å¯¹ä¸€æ¨¡å‹ç»“åˆå¯¼è‡´çš„é—®é¢˜&#34;&gt;ç®¡ç†çº¿ç¨‹ä¸ä¸€å¯¹ä¸€æ¨¡å‹ç»“åˆå¯¼è‡´çš„é—®é¢˜&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;ç®¡ç†çº¿ç¨‹åªèƒ½åœ¨ä¸€ä¸ªæ ¸ä¸Šè¿è¡Œï¼Œè¿™å¯¼è‡´åŠ é€Ÿæ¯”å˜ä½ï¼Œæ€§èƒ½å˜å·®ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºæ•´ä¸ªç³»ç»Ÿå›´ç»•ç€ç®¡ç†çº¿ç¨‹è®¾è®¡ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å˜å¤§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;nptl&#34;&gt;NPTL&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†è§£å†³ LinuxThreads çš„ä¸€äº›é—®é¢˜ï¼Œå†…æ ¸å¼€å‘äººå‘˜è®¾è®¡å®ç°äº† NPTL(Native POSIX Thread Library) ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NPTL å®Œå…¨å…¼å®¹ POSIX æ ‡å‡†ã€‚&lt;/li&gt;
&lt;li&gt;NPTL åœ¨å¤šå¤„ç†å™¨æœºå™¨ä¸Šæ•ˆæœä¹Ÿå¾ˆå¥½ã€‚&lt;/li&gt;
&lt;li&gt;NPTL çš„å¯åŠ¨å¼€é”€ä¸å¤§ã€‚&lt;/li&gt;
&lt;li&gt;NPTL ä¹Ÿèƒ½åˆ©ç”¨åˆ° NUMA æ¶æ„çš„ä¼˜åŠ¿ã€‚&lt;/li&gt;
&lt;li&gt;NPTL å’Œ LinuxThreads äºŒè¿›åˆ¶å…¼å®¹ï¼ˆLD å®ç°çš„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;åˆ©ç”¨äº†æ–°çš„å†…æ ¸ç‰¹æ€§&#34;&gt;åˆ©ç”¨äº†æ–°çš„å†…æ ¸ç‰¹æ€§&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;NPTL æ— éœ€ç®¡ç†çº¿ç¨‹ï¼š
&lt;ul&gt;
&lt;li&gt;ä¸éœ€è¦è½¬å‘ fatal signal çš„å·¥ä½œï¼Œå†…æ ¸å¯ä»¥å¤„ç†å¥½å‘æŸä¸€è¿›ç¨‹å‘é€ä¿¡å·çš„å·¥ä½œã€‚&lt;/li&gt;
&lt;li&gt;ä¸éœ€è¦ç”±ç®¡ç†çº¿ç¨‹ææ„ï¼Œå†…æ ¸å¯ä»¥å¤„ç†çº¿ç¨‹å†…å­˜çš„é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;ä¸éœ€è¦ç®¡ç†çº¿ç¨‹æ¥é¿å…åƒµå°¸çº¿ç¨‹ï¼Œå†…æ ¸å¯ä»¥åœ¨æ¸…ç†çˆ¶çº¿ç¨‹å‰ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;å»æ‰ç®¡ç†çº¿ç¨‹ï¼Œå¯¹ SMP å’Œ NUMA æ›´å‹å¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;em&gt;futex&lt;/em&gt; æ¥å®ç°åŒæ­¥ï¼Œè€Œä¸” futex å¯ä»¥åœ¨è¿›ç¨‹é—´å…±äº«ï¼Œèƒ½åœ¨æ›´å¤šåœºæ™¯ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;NPTL çš„æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„çˆ¶çº¿ç¨‹ï¼Œåœ¨è¿›è¡Œèµ„æºç»Ÿè®¡æ—¶ä¾¿äºç»Ÿè®¡æ•´ä¸ªè¿›ç¨‹ï¼Œæ­¤å‰çš„ LinuxThreads ä¸èƒ½åšåˆ°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;å¦‚ä½•å®ç°-tls&#34;&gt;å¦‚ä½•å®ç° TLS&lt;/h4&gt;
&lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“åœ¨å†™å£°æ˜æ—¶åŠ å…¥ &lt;code&gt;__thread&lt;/code&gt; å¯ä»¥å£°æ˜ä¸€ä¸ªçº¿ç¨‹å±€éƒ¨å˜é‡ã€‚é‚£å®ƒæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æ—©æœŸ LinuxThreads çš„å®ç°ä¸­ï¼Œ TLS ç›´æ¥æ”¾åœ¨çº¿ç¨‹æ ˆæ—è¾¹ã€‚è€Œåœ¨å¼•å…¥ NPTL åï¼Œå„ä¸ª libc ï¼ˆå¦‚ glibc, uClibc, muslï¼‰éƒ½æ˜¯ä½¿ç”¨æ–°å¢çš„ ELF æ ‡å‡†å¯¹ TLS çš„æ”¯æŒå’ŒåŠ¨æ€é“¾æ¥å™¨æ¥å®ç°çš„ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ä¸€ä¸ª &lt;code&gt;__thread&lt;/code&gt; å£°æ˜çš„æ±‡ç¼–ä»£ç æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½çœ‹åˆ° &lt;code&gt;mov %fs:0xfffffffffffffffc,%eax&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¹Ÿå°±æ˜¯ &lt;code&gt;mov %fs:-4,%eax&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä»€ä¹ˆï¼Ÿè¿™å¤ªå¥‡æ€ªäº†ï¼&lt;/p&gt;
&lt;p&gt;è™½ç„¶æŸäº› CPU æ¶æ„æœ‰ä¸“ç”¨çš„å¯„å­˜å™¨æ¥ä¿å­˜çº¿ç¨‹ç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œä½† x86 æ²¡æœ‰ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œx86 åªæœ‰å°‘é‡çš„é€šç”¨å¯„å­˜å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è‹±ç‰¹å°” 80386 å¼•å…¥äº† FS å’Œ GS ä½œä¸ºç”¨æˆ·å®šä¹‰çš„æ®µå¯„å­˜å™¨ï¼Œä½†æ²¡æœ‰è§„å®šå®ƒä»¬çš„ç”¨é€”ã€‚ç„¶è€Œï¼Œéšç€å¤šçº¿ç¨‹ç¼–ç¨‹çš„å…´èµ·ï¼Œäººä»¬çœ‹åˆ°äº†é‡æ–°åˆ©ç”¨ FS å’Œ GS çš„æœºä¼šï¼Œå¹¶å¼€å§‹å°†å®ƒä»¬ç”¨ä½œçº¿ç¨‹å¯„å­˜å™¨ã€‚&lt;/p&gt;
&lt;p&gt;TLS çš„ç»“æ„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;tls&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/tls.png&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;dlopen&lt;/code&gt; åŠ è½½çš„ DSO(åŠ¨æ€å…±äº«å¯¹è±¡) æ”¾åœ¨åŠ¨æ€ TLS ä¸­ï¼Œå…¶ä½™çš„æ”¾åœ¨é™æ€ TLS ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;$dtv_t$ å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡æ¨¡å— id å’Œåç§»é‡å¯¹ä»»ä½• TLS å˜é‡è¿›è¡Œå¯»å€ã€‚TLS å˜é‡åç§»é‡æ˜¯æ¨¡å—ä¸­çš„æœ¬åœ°åç§»é‡ï¼Œæ¨¡å— id æ˜¯è¿›ç¨‹ä¸­åŠ è½½çš„ ELF å¯¹è±¡çš„ç´¢å¼•å·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®¿é—®ä¸€ä¸ª TLS å˜é‡çš„é€šç”¨æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dtv[-&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;].counter; &lt;span style=&#34;color:#007f7f&#34;&gt;/* Pro tip: The length of this dtv array */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dtv[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;].counter;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* Generation counter for the DTV in this thread */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dtv[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;].pointer;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* Pointer to the main executable TLS block in this thread */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;/* Pointer to a TLS variable defined in a module id `ti_module` */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;main_tls_var = *(dtv[tls_index.ti_module].pointer + tls_index.ti_offset);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¼–è¯‘å™¨å’ŒåŠ¨æ€é“¾æ¥å™¨å…±åŒè®¡ç®—å‡ºåœ°å€ï¼Œå› ä¸ºå¯æ‰§è¡Œæ–‡ä»¶çš„ TLS å—å’Œ TLS åç§»é‡éƒ½æ˜¯æå‰çŸ¥é“çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§åˆä½œä¾èµ–äºç¼–è¯‘å™¨åœ¨æ„å»ºæ—¶çš„ä»¥ä¸‹ã€Œäº‹å®ã€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;FS å¯„å­˜å™¨æŒ‡å‘ TCB ã€‚&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘å™¨è®¾ç½®çš„ TLS å˜é‡åç§»é‡åœ¨è¿è¡Œæ—¶ä¸ä¼šæ›´æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;å¯æ‰§è¡Œæ–‡ä»¶çš„ TLS å—ä½äº TCB ä¹‹å‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åŒæ—¶ï¼Œå°† TLS æ”¾åœ¨ TCB ä¹‹å‰å¯ä»¥è®©ç»å¸¸è¢«è®¿é—®çš„å†…å­˜æ›´æŒä¹…åœ°ç•™åœ¨ç¼“å­˜ä¸­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.lix.polytechnique.fr/~liberti/public/computing/parallel/threads/linuxthreads/linuxthreads-FAQ.html&#34;&gt;LinuxThreads Frequently Asked Questions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://comet.lehman.cuny.edu/jung/cmp426697/NPTL.pdf&#34;&gt;Linux threading models compared: LinuxThreads and NPTL&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.cs.utexas.edu/~witchel/372/lectures/POSIX_Linux_Threading.pdf&#34;&gt;NPTL design&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.kernel.org/doc/ols/2006/ols2006v1-pages-409-420.pdf&#34;&gt;uClibc NPTL design&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.akkadia.org/drepper/tls.pdf&#34;&gt;ELF Handling for Thread-Local Storage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://maskray.me/blog/2021-02-14-all-about-thread-local-storage&#34;&gt;All about thread-local storage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://chao-tic.github.io/blog/2018/12/25/tls&#34;&gt;A Deep dive into (implicit) Thread Local Storage&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ä¸ºä»€ä¹ˆ Rust std fs æ…¢äº Python</title>
      <link>https://vaaandark.top/posts/rust-slower-than-python/</link>
      <pubDate>Thu, 30 Nov 2023 16:45:58 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/rust-slower-than-python/</guid>
      <description>&lt;p&gt;çœ‹åˆ°äº† &lt;a href=&#34;https://github.com/Xuanwo/&#34;&gt;xuanwo&lt;/a&gt; çš„ä¸€ç¯‡ &lt;a href=&#34;https://xuanwo.io/2023/04-rust-std-fs-slower-than-python/&#34;&gt;åšå®¢&lt;/a&gt;ï¼Œæ„Ÿè§‰å¾ˆæœ‰æ„æ€ã€‚&lt;/p&gt;
&lt;p&gt;å®Œæ•´è¯»ä¸€éä¹Ÿå¯ä»¥ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥çœ‹æˆ‘çš„çœæµã€‚&lt;/p&gt;
&lt;h2 id=&#34;python-io-æ¯”-c--rust-io-æ›´å¿«&#34;&gt;Python IO æ¯” C / Rust IO æ›´å¿«&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰äººå‘ç°åœ¨ AMD Ryzen 9 5900X å’Œ AMD Ryzen 7 5700X ä¸Šè®¿é—®é¡µå¯¹é½çš„å‰10ä¸ª byte ä¼šæ¯”å…¶ä»–åç§»æœ‰æ›´å¤šçš„ L1 prefetch å’Œ load çš„ miss ã€‚&lt;/li&gt;
&lt;li&gt;å­¦è¿‡ x86 æ±‡ç¼–çš„åº”è¯¥çŸ¥é“ä¸åŒäº RISC ï¼Œx86 æ˜¯æœ‰ä¸“é—¨ç”¨äºå¤åˆ¶å­—ç¬¦ä¸²çš„æŒ‡ä»¤çš„ã€‚æœ‰äººå‘ç°ä¸Šè¿°é—®é¢˜çš„åº•å±‚åŸå› æ¥è‡ªäº AMD å¯¹ FSRM(Fast Short REP MOV) çš„å®ç°ï¼Œ&lt;strong&gt;é€†å¤©çš„æ˜¯åœ¨ Zen 3 ä¸Šï¼Œè®¿é—®é¡µå¯¹é½çš„æ•°æ®æ¯”ä¸å¯¹é½æ…¢&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ›´æœ‰è¶£çš„äº‹æƒ…&#34;&gt;æ›´æœ‰è¶£çš„äº‹æƒ…&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½œè€…å‘ç°å°† C çš„åˆ†é…å™¨æ¢æˆ jemalloc åé€Ÿåº¦å°±å¯ä»¥å‡»è´¥ Python äº†ï¼Œæˆ‘ä¸ªäººçŒœæµ‹å¯èƒ½æ˜¯ mmap ååˆ†é…çš„é¡µå¯¹é½çš„å†…å­˜ä½¿ç”¨äº†æ›´å¤šï¼ˆä¹Ÿå°±æ˜¯å¤§äº glibc çš„ 10 byteï¼‰æ¥å­˜ meta data ï¼Œæ°å·§é¿å…äº†è¿™ä¸ªç¡¬ä»¶ bug ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰äººä½¿ç”¨ eBPF profile å‘ç° Rust å’Œ Python çš„ fs read åœ¨ç³»ç»Ÿè°ƒç”¨çš„å»¶è¿Ÿä¸Šå­˜åœ¨å·®è·ï¼ŒRust æ›´æ…¢ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºäº†è§£å†³è¿™ä¸ªå¥‡æ€ªçš„æ€§èƒ½é—®é¢˜ï¼Œä½œè€…ï¼ˆå¼€æºå¤§æ‰‹å­æ¼©æ¶¡ï¼‰å’Œä»–çš„å¼€æºä¼™ä¼´ï¼ˆåŒ…æ‹¬äº†çƒ­å¿ƒç½‘å‹ã€å›½å†…å¼€æºå¤§ä½¬ä¾äº‘å’Œä¸€äº›å†…æ ¸å¼€å‘è€…ï¼‰ä½¿ç”¨äº† strace, perf, eBPF ç­‰å„ç§æ€§èƒ½åˆ†æå·¥å…·ï¼Œä»¥åŠåˆ†æäº†å„ç§å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜çš„åŸå› ï¼ˆå†…å­˜å¤§é¡µã€CPU æ ¸äº²å’Œæ€§ã€mmap åˆ†é…åŒ¿åå†…å­˜ã€Linux å¯åŠ¨é€‰é¡¹ä¾‹å¦‚ Enable Mitigationsã€ç³»ç»Ÿè°ƒç”¨å»¶è¿Ÿç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰ &lt;a href=&#34;https://github.com/Enter-tainer&#34;&gt;æœ‹å‹&lt;/a&gt; å‘Šè¯‰æˆ‘ã€ŒIntel å‰å‡ å¤©åˆšå‡ºäº† &lt;code&gt;rep mov&lt;/code&gt; å¯¼è‡´çš„ Dos æ¼æ´ã€ã€‚&lt;/li&gt;
&lt;li&gt;å¥½æ¶ˆæ¯æ˜¯ FSRM æ˜¯å¾®ç å®ç°ï¼Œä¹Ÿè®¸åœ¨æœªæ¥çš„æŸä¸€æ¬¡æ›´æ–°å°±ä¿®å¥½äº†ğŸ¥°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç›¸å…³é“¾æ¥&#34;&gt;ç›¸å…³é“¾æ¥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://bugs.launchpad.net/ubuntu/+source/glibc/+bug/2030515&#34;&gt;Terrible memcpy performance on Zen 3 when using rep movsb&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Cargo Runner</title>
      <link>https://vaaandark.top/posts/cargo-runner/</link>
      <pubDate>Sun, 22 Oct 2023 11:36:13 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/cargo-runner/</guid>
      <description>&lt;p&gt;æœ€è¿‘åœ¨å®Œæˆä¸€ä¸ªä½¿ç”¨ Rust è¯­è¨€ç¼–å†™ Linux å†…æ ¸å¼•å¯¼ç¨‹åºçš„é¡¹ç›® &lt;a href=&#34;github.com/vaaandark/lboot&#34;&gt;lboot&lt;/a&gt; ï¼Œå…¶æ ¸å¿ƒä»£ç å’ŒåŸç†åœ¨ä¹‹å‰çš„åšå®¢ä¸­ä»‹ç»è¿‡ &lt;a href=&#34;https://vaaandark.top/posts/how-uefi-startup-linux/&#34;&gt;UEFI å¦‚ä½•å¯åŠ¨ Linux&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºä¸å¯èƒ½ç›´æ¥åœ¨ UEFI ç¯å¢ƒä¸‹è¿›è¡Œä»£ç å¼€å‘ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨çš„æ˜¯äº¤å‰ç¼–è¯‘çš„æ–¹æ³•ï¼Œç›®æ ‡å¹³å°æ˜¯ &lt;code&gt;x86_64-unknown-uefi&lt;/code&gt; å’Œ &lt;code&gt;aarch64-unknown-uefi&lt;/code&gt; ã€‚è¿™å°±å¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼Œä½¿ç”¨å‘½ä»¤ &lt;code&gt;cargo run&lt;/code&gt; ä¸èƒ½ç›´æ¥è¿è¡Œä»£ç ï¼Œå¿…é¡»ä½¿ç”¨ qemu æ¥æ¨¡æ‹Ÿç›®æ ‡æ¶æ„çš„æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çœŸçš„ä¸è¡Œå—ï¼Ÿå…¶å®æ˜¯å¯ä»¥çš„ğŸ¥³ğŸ¥³ğŸ¥³&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ç¿»é˜… Cargo Book ä¹‹åå‘ç°ï¼Œåœ¨&lt;a href=&#34;https://doc.rust-lang.org/cargo/reference/config.html?#command-line-overrides&#34;&gt;å‘½ä»¤è¡Œé‡è½½&lt;/a&gt;è¿™ä¸€ç« ä¸­å†™åˆ°å¯ä»¥ä½¿ç”¨ &lt;code&gt;runner&lt;/code&gt; å­—æ®µæ¥å®šä¹‰è‡ªå·±çš„ &lt;code&gt;cargo run&lt;/code&gt; è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;å½“æ‰§è¡Œ &lt;code&gt;cargo run&lt;/code&gt; æ—¶ï¼Œcargo ä¼šé¦–å…ˆå°†è¿™ä¸ª &lt;code&gt;runner&lt;/code&gt; å­—æ®µä¸­çš„å‘½ä»¤æœ«å°¾é™„ä¸Šæ„å»ºå‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼ˆç›¸å½“äºæŠŠè·¯å¾„ä¼ å…¥ runner è„šæœ¬æˆ–å‘½ä»¤ï¼‰ï¼Œç„¶åæ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ç¼–å†™äº†ä¸€ä¸ª&lt;a href=&#34;https://github.com/vaaandark/lboot/blob/dev/test/qemu_run.sh&#34;&gt;åŒ…è£…è„šæœ¬&lt;/a&gt; ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç›®æ ‡å¹³å°ï¼Œç¬¬äºŒä¸ªæ˜¯ UEFI å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚ç„¶åç¼–å†™ &lt;code&gt;.cargo/config.toml&lt;/code&gt; æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[target.x86_64-unknown-uefi]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;runner = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;test/qemu_run.sh x86_64&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[target.aarch64-unknown-uefi]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;runner = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;test/qemu_run.sh aarch64&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;runner&lt;/code&gt; å­—æ®µåªå†™ä¸€ä¸ªå‚æ•°æ˜¯å› ä¸ºï¼Œ&lt;code&gt;cargo run&lt;/code&gt; æ—¶å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ä¼šé™„åŠ åˆ°æœ€åã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç°åœ¨å°±å¯ä»¥ç›´æ¥ &lt;code&gt;cargo run&lt;/code&gt; å¯åŠ¨ qemu ä»¿çœŸäº†ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>UEFI å¦‚ä½•å¯åŠ¨ Linux</title>
      <link>https://vaaandark.top/posts/how-uefi-startup-linux/</link>
      <pubDate>Sat, 30 Sep 2023 19:59:34 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/how-uefi-startup-linux/</guid>
      <description>&lt;p&gt;ä¹‹å‰è®²åˆ°äº† Linux æ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Œç°åœ¨å°±å†™ä¸€ä¸ª UEFI ç¨‹åºå¯ä»¥å¯åŠ¨ Linux ï¼Œè¯­è¨€é€‰æ‹©çš„æ˜¯éå¸¸ç«çƒ­çš„ Rust ã€‚&lt;/p&gt;
&lt;p&gt;Linux Kernel ç»è¿‡äº†è¿™ä¹ˆå¤šå¹´çš„å‘å±•ï¼Œå…¶å®å®Œå…¨æœ‰ç€ boot çš„èƒ½åŠ›ï¼Œä½¿ç”¨ UEFI å¯åŠ¨ Kernel å…¶å®æ˜¯éå¸¸ç®€å•çš„ä¸€ä»¶äº‹æƒ…ï¼Œä¸å†éœ€è¦åƒä»¥å‰ BIOS å¯åŠ¨è€ç‰ˆæœ¬å†…æ ¸ä¸€æ ·è¦æŠŠå†…æ ¸åŠ è½½åˆ°æŸä¸ªå†…å­˜åœ°å€ï¼ŒæŠŠå‚æ•°æ”¾åˆ°æŸä¸ªå†…å­˜åœ°å€ï¼Œå†å°†è¿™ä¸ªåœ°å€æ”¾åˆ°å¯„å­˜å™¨ä¸­ç­‰ç­‰å¤æ‚æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id=&#34;åˆ¶ä½œ-kernel-é•œåƒ&#34;&gt;åˆ¶ä½œ Kernel é•œåƒ&lt;/h2&gt;
&lt;p&gt;å¯åŠ¨ Linux ä¹‹å‰æˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ª Linux Kernel çš„é•œåƒã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä» kernel.org ä¸Šæ‹‰å–æœ€æ–°çš„ release Linux 6.5.5 ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ wget &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.5.5.tar.xz&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ tar -xf linux-6.5.5.tar.xz
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;cd&lt;/span&gt; linux-6.5.5
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å†é…ç½®ä¸€ä¸‹ç¼–è¯‘é€‰é¡¹ï¼Œè¦æŠŠå†…æ ¸ç¼–è¯‘æˆä¸€ä¸ª EFI æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ make menuconfig
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰¾åˆ°å¹¶è¿›å…¥ &amp;ldquo;Processor type and features&amp;rdquo; ï¼Œå¹¶å‹¾é€‰ &amp;ldquo;EFI stub support&amp;rdquo; ï¼Œã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç›®å‰çš„ Kernel ä¸­ &amp;ldquo;EFI stub support&amp;rdquo; æ˜¯é»˜è®¤å‹¾é€‰ï¼Œåªæ˜¯ä¸ºäº†ç¡®è®¤ä¸€ä¸‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥ç¼–è¯‘äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ make -j &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;$(&lt;/span&gt;nproc&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®Œæˆä¹‹åå¯ä»¥çœ‹åˆ°åœ¨ &lt;code&gt;arch/x86/boot/&lt;/code&gt; ä¸‹æœ‰ä¸ª &lt;code&gt;bzImage&lt;/code&gt; ï¼Œè¿™å°±æ˜¯ç¼–è¯‘å‡ºæ¥çš„å†…æ ¸ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ file arch/x86/boot/bzImage
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;arch/x86/boot/bzImage: Linux kernel x86 boot executable bzImage, version 6.5.5 (vandark@hustcpu01) #2 SMP PREEMPT Fri Sep 29 02:03:58 CST 2023, RO-rootFS, swap_dev 0xB, Normal VGA
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ„å»º-initramfs-å’Œ-rootfs&#34;&gt;æ„å»º initramfs å’Œ rootfs&lt;/h2&gt;
&lt;p&gt;åªæ˜¯æƒ³è¦å¯åŠ¨çœ‹çœ‹æ•ˆæœçš„è¯å…¶å®åªéœ€è¦å¤åˆ¶ &lt;code&gt;/boot/initramfs-linux.img&lt;/code&gt; åˆ° &lt;code&gt;esp/efi/boot&lt;/code&gt; ä¸­å°±å¯ä»¥äº†ï¼Œè¿™æ ·çš„è¯èƒ½å¤Ÿè¿›å…¥ä¸€ä¸ªä½¿ç”¨å†…å­˜å½“ä½œç£ç›˜çš„ Linux ç¯å¢ƒä¸­ï¼Œä½†è¿™ä¹Ÿè¶³ä»¥éªŒè¯ Linux çš„æˆåŠŸå¯åŠ¨äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¼–å†™-rust-uefi-ä»£ç &#34;&gt;ç¼–å†™ Rust UEFI ä»£ç &lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#![no_main]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#![no_std]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;crate&lt;/span&gt; alloc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; alloc::vec::&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; log::info;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; uefi::prelude::*;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; uefi::proto::device_path::build::media::FilePath;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; uefi::proto::device_path::build::DevicePathBuilder;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; uefi::proto::device_path::{DevicePath, DeviceSubType, DeviceType, LoadedImageDevicePath};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; uefi::proto::loaded_image::LoadedImage;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; uefi::table::boot::LoadImageSource;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; uefi::{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    entry,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    table::{Boot, SystemTable},
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Handle,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#[entry]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; main(image_handle: Handle, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; st: SystemTable&amp;lt;Boot&amp;gt;) -&amp;gt; Status {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    uefi_services::init(&amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; st).unwrap();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; bt = st.boot_services();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    info!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Start booting...&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; storage = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;::new();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; kernel_image_path = get_kernel_device_path(bt, &amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; storage);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; kernel_image_handle = bt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .load_image(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            image_handle,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            LoadImageSource::FromDevicePath {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                device_path: kernel_image_path,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                from_boot_manager: false,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .expect(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;failed to load kernel&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// åŠ è½½ kernel image
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; kernel_loaded_image = bt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .open_protocol_exclusive::&amp;lt;LoadedImage&amp;gt;(kernel_image_handle)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .expect(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;failed to open LoadedImage protocol&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// è®¾ç½®å‚æ•°ï¼Œåªè®¾ç½®äº† initrd æ²¡æœ‰è®¾ç½® root
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; load_options = cstr16!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;initrd=efi\boot\initramfs-linux.img&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsafe&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        kernel_loaded_image.set_load_options(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            load_options.as_ptr().cast(),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            load_options.num_bytes() &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u32&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        );
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// å¯åŠ¨ kernel image
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    bt.start_image(kernel_image_handle).expect(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;failed to launch kernel&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Status::SUCCESS
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; get_kernel_device_path&amp;lt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt;&amp;gt;(bt: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;BootServices, storage: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt; mut &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u8&lt;/span&gt;&amp;gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt; DevicePath {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; loaded_image_device_path = bt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .open_protocol_exclusive::&amp;lt;LoadedImageDevicePath&amp;gt;(bt.image_handle())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .expect(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;failed to open LoadedImageDevicePath protocol&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; builder = DevicePathBuilder::with_vec(storage);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; node &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; loaded_image_device_path.node_iter() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; node.full_type() == (DeviceType::MEDIA, DeviceSubType::MEDIA_FILE_PATH) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        builder = builder.push(&amp;amp;node).unwrap();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    builder = builder
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .push(&amp;amp;FilePath {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            path_name: cstr16!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;efi\boot\bzImage.efi&amp;#34;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        })
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        .unwrap();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    builder.finalize().unwrap()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ qemu ç¯å¢ƒä¸­è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ mkdir -p esp/efi/boot
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cp target/x86_64-unknown-uefi/debug/boot.efi esp/efi/boot/bootx64.efi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cp bzImage esp/efi/boot/bzImage.efi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cargo build --target x86_64-unknown-uefi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ qemu-system-x86_64 -enable-kvm &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;    -m 1G \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    -hda disk.qcow2 \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    -serial stdio \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    -drive if=pflash,format=raw,readonly=on,file=OVMF_CODE.fd \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    -drive if=pflash,format=raw,readonly=on,file=OVMF_VARS.fd \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    -drive format=raw,file=fat:rw:esp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;OVMF æ˜¯ä¸ºè™šæ‹Ÿæœºå¼€å¯ UEFI æ”¯æŒçš„å·¥å…·&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt=&#34;è¿è¡Œç»“æœ&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/boot.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¥½è€¶ï¼æˆåŠŸå¼•å¯¼å¯åŠ¨äº† Linux ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Linux ï¼Œå¯åŠ¨ï¼</title>
      <link>https://vaaandark.top/posts/linux-startup/</link>
      <pubDate>Sat, 09 Sep 2023 08:15:06 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/linux-startup/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;pull oneself up by one&amp;rsquo;s bootstraps.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;æ‹½ç€é‹å¸¦æŠŠè‡ªå·±æ‹‰èµ·æ¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¤§å®¶åœ¨å®‰è£… Arch Linux æˆ–è€…å…¶ä»– Linux å‘è¡Œç‰ˆæ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°å¾ˆå¤šæœ‰å…³å¯åŠ¨æˆ–è€…å¼•å¯¼çš„åè¯ï¼Œä¾‹å¦‚ BIOS ã€UEFI ã€GRUB ã€ESP ã€GPT ã€LBA ã€MBR ç­‰ç­‰ã€‚æœ‰äº›åè¯æ¯”è¾ƒç†Ÿæ‚‰ï¼Œæœ‰äº›å°±ä¼šä¸€å¤´é›¾æ°´ï¼Œä»Šå¤©å°±æ¥è®²è®²è¿™äº›åè¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;bios-vs-uefi&#34;&gt;BIOS vs UEFI&lt;/h2&gt;
&lt;p&gt;BIOSï¼ˆBasic Input Output Systemï¼ŒåŸºæœ¬è¾“å…¥è¾“å‡ºç³»ç»Ÿï¼‰æ˜¯å›ºåŒ–åœ¨è®¡ç®—æœºä¸»æ¿ä¸­çš„ç¨‹åºä»£ç ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯åœ¨è®¡ç®—æœºä¸Šç”µæ—¶å¯¹ç¡¬ä»¶è¿›è¡Œåˆå§‹åŒ–é…ç½®ï¼Œå¹¶å°†ç¡¬ä»¶æ“ä½œå°è£…ä¸ºBIOSä¸­æ–­æœåŠ¡ã€‚è¿™æ ·ï¼Œå„ç§ç¡¬ä»¶é—´çš„å·®å¼‚ä¾¿ç”± BIOS è´Ÿè´£ç»´æŠ¤ï¼Œç¨‹åºç›´æ¥è°ƒç”¨ BIOS ä¸­æ–­æœåŠ¡å³å¯å®ç°å¯¹ç¡¬ä»¶çš„æ§åˆ¶ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŠ ç”µè‡ªæ£€ç¨‹åºï¼Œåœ¨å¼€æœºæ—¶è´Ÿè´£æ£€æµ‹ç¡¬ä»¶è®¾å¤‡æ˜¯å¦æ­£å¸¸å·¥ä½œ&lt;/li&gt;
&lt;li&gt;ç³»ç»Ÿåˆå§‹åŒ–ç¨‹åºï¼Œå…¶ä¸­åŒ…æ‹¬ç¡¬ä»¶è®¾å¤‡çš„åˆå§‹åŒ–ä»¥åŠåˆ›å»º BIOS ä¸­æ–­å‘é‡ç­‰&lt;/li&gt;
&lt;li&gt;é€‚é…å¤–å›´å³æ’å³ç”¨è®¾å¤‡&lt;/li&gt;
&lt;li&gt;CMOS è®¾ç½®ç¨‹åºï¼Œè´Ÿè´£è¯»å†™ä¿å­˜åœ¨ CMOS ä¸­çš„ç³»ç»Ÿè®¾ç½®ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;UEFIï¼ˆUnified Extensible Firmware Interfaceï¼Œç»Ÿä¸€å¯æ‰©å±•å›ºä»¶æ¥å£ï¼‰åˆ™æ˜¯ä¸€ç§è§„èŒƒï¼Œå®ƒæè¿°äº†æ“ä½œç³»ç»Ÿå’Œå¹³å°å›ºä»¶ä¹‹é—´çš„æ¥å£ï¼Œå…¶ç›®çš„æ˜¯ä¸ºæ“ä½œç³»ç»Ÿå’Œå¹³å°å›ºä»¶å®šä¹‰ä¸€ç§é€šä¿¡æ–¹æ³•ã€‚åœ¨ UEFI ä¸­ï¼Œè®¾å¤‡çš„è®¿é—®æ˜¯é€šè¿‡å¥æŸ„ï¼ˆHandleï¼‰å’Œåè®®ï¼ˆProtocolï¼‰æŠ½è±¡å‡ºæ¥çš„ã€‚UEFI é€šè¿‡å°†åŸºç¡€å®ç°éš”ç¦»åœ¨è§„èŒƒä¹‹å¤–ï¼Œä»¥é¿å…ç»™è®¾å¤‡çš„è®¿é—®è€…å¸¦æ¥è´Ÿæ‹…ï¼Œè¿›è€Œä¿ƒè¿›ç°æœ‰ BIOS ä»£ç çš„é‡ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;uefi ç»„æˆç»“æ„&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/uefi.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;bios-å¯åŠ¨&#34;&gt;BIOS ï¼Œå¯åŠ¨ï¼&lt;/h3&gt;
&lt;p&gt;åœ¨ç³»ç»Ÿä¸Šç”µåï¼ŒCPU è¿è¡Œäºå®æ¨¡å¼å·¥ä½œç¯å¢ƒä¸­ï¼Œæ•°æ®ä½å®½ä¸º 16 ä½ï¼Œæœ€å¤§ç‰©ç†åœ°å€å¯»å€èŒƒå›´æ˜¯ 0&lt;del&gt;1 MBï¼Œå…¶ä¸­çš„ç‰©ç†åœ°å€ 0x0C0000&lt;/del&gt;0x0FFFFF ä¿ç•™ç»™ BIOS ä½¿ç”¨ã€‚å¼€æœºåï¼Œ CPU é¦–å…ˆè·³è½¬åˆ°ç‰©ç†åœ°å€ 0x0FFFF0 å¤„æ‰§è¡Œç¨‹åºã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™é‡Œæ˜¯ä¸€æ¡è·³è½¬æŒ‡ä»¤ï¼Œ CPU é€šè¿‡æ‰§è¡Œæ­¤å¤„çš„è·³è½¬æŒ‡ä»¤è·³è½¬åˆ°çœŸæ­£çš„ BIOS å…¥å£åœ°å€å¤„æ‰§è¡Œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;BIOSä»£ç é¦–å…ˆåšçš„æ˜¯ POSTï¼ˆPower On Self Testï¼ŒåŠ ç”µè‡ªæ£€ï¼‰æ“ä½œï¼Œä¸»è¦æ˜¯æ£€æµ‹å…³é”®è®¾å¤‡æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œè®¾å¤‡è®¾ç½®æ˜¯å¦ä¸CMOSä¸­çš„è®¾ç½®ä¸€è‡´ã€‚å¦‚æœå‘ç°ç¡¬ä»¶é”™è¯¯ï¼Œåˆ™é€šè¿‡å–‡å­æŠ¥è­¦&lt;/li&gt;
&lt;li&gt;åˆå§‹åŒ–æ˜¾ç¤ºè®¾å¤‡å¹¶æ˜¾ç¤ºæ˜¾å¡ä¿¡æ¯ï¼Œæ¥ç€åˆå§‹åŒ–å…¶ä»–è®¾å¤‡&lt;/li&gt;
&lt;li&gt;æ£€æµ‹CPUå’Œå†…å­˜å¹¶æ˜¾ç¤ºæ£€æµ‹ç»“æœ&lt;/li&gt;
&lt;li&gt;æ£€æµ‹æ ‡å‡†è®¾å¤‡ï¼Œä¾‹å¦‚ç¡¬ç›˜ã€å…‰é©±ã€ä¸²å£è®¾å¤‡ã€å¹¶å£è®¾å¤‡ç­‰&lt;/li&gt;
&lt;li&gt;æ£€æµ‹å³æ’å³ç”¨è®¾å¤‡ï¼Œå¹¶ä¸ºè¿™äº›è®¾å¤‡åˆ†é…ä¸­æ–­å·ã€ I/O ç«¯å£å’Œ DMA é€šé“ç­‰èµ„æº&lt;/li&gt;
&lt;li&gt;å¦‚æœç¡¬ä»¶é…ç½®å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè¿™äº›å˜åŒ–çš„é…ç½®å°†æ›´æ–°åˆ° CMOS ä¸­&lt;/li&gt;
&lt;li&gt;æ ¹æ®é…ç½®çš„å¯åŠ¨é¡ºåºå¼•å¯¼è®¾å¤‡å¯åŠ¨ï¼Œé€šè¿‡BIOSä¸­æ–­å°†è®¾å¤‡çš„å¼•å¯¼ç¨‹åºå…¥å†…å­˜&lt;/li&gt;
&lt;li&gt;å°†å¤„ç†å™¨çš„æ§åˆ¶æƒäº¤ç»™å¼•å¯¼ç¨‹åºï¼Œæœ€ç»ˆå¼•å¯¼è¿›å…¥æ“ä½œç³»ç»Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;uefi-å¯åŠ¨&#34;&gt;UEFI ï¼Œå¯åŠ¨ï¼&lt;/h3&gt;
&lt;p&gt;&lt;img alt=&#34;uefi å¯åŠ¨æµç¨‹&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/uefi-stages.png&#34;&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éªŒè¯é˜¶æ®µï¼ˆSecurityï¼ŒSECï¼‰ã€‚ç³»ç»Ÿä¸Šç”µåï¼ŒCPU å¼€å§‹æ‰§è¡Œç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œæ­¤æ—¶ç³»ç»Ÿå°±è¿›å…¥ SEC é˜¶æ®µã€‚è¿™ä¸ªé˜¶æ®µçš„å†…å­˜å°šæœªè¢«åˆå§‹åŒ–ï¼Œä¸å¯ä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œ SEC é˜¶æ®µæœ€ä¸»è¦çš„å·¥ä½œæ˜¯å»ºç«‹ä¸€äº›ä¸´æ—¶å†…å­˜å¹¶å°† CPU åˆ‡æ¢åˆ°ä¿æŠ¤æ¨¡å¼ï¼Œè¿™é‡Œæåˆ°çš„ä¸´æ—¶å†…å­˜å¯ä»¥æ˜¯å¤„ç†å™¨çš„ç¼“å­˜ï¼Œäº¦æˆ–è€…ç³»ç»Ÿçš„ç‰©ç†å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;EFI ç¯å¢ƒé¢„åˆå§‹åŒ–é˜¶æ®µï¼ˆPre-EFI Initialization Environmentï¼ŒPEIï¼‰ã€‚PEI é˜¶æ®µæœ€ä¸»è¦çš„å·¥ä½œå°±æ˜¯å¯¹å†…å­˜ã€CPU ä»¥åŠèŠ¯ç‰‡ç»„ç­‰å…³é”®è®¾å¤‡è¿›è¡Œåˆå§‹åŒ–ã€‚ç”±äºè¿™éƒ¨åˆ†ä»£ç æ²¡æœ‰è¿›è¡Œå‹ç¼©ï¼Œå› æ­¤ä»£ç å¿…é¡»è¶Šç²¾ç®€è¶Šå¥½ã€‚è€Œä¸”ï¼Œåœ¨PEIé˜¶æ®µè¿˜è¦ç¡®å®šæ“ä½œç³»ç»Ÿçš„å¼•å¯¼è·¯å¾„ï¼Œåˆå§‹åŒ– UEFI é©±åŠ¨å’Œå›ºä»¶éœ€è¦çš„å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;é©±åŠ¨è¿è¡Œç¯å¢ƒé˜¶æ®µï¼ˆDriver Execution Environmentï¼ŒDXEï¼‰ã€‚DXE æ˜¯ EFI æœ€é‡è¦çš„é˜¶æ®µï¼Œå¤§éƒ¨åˆ†çš„é©±åŠ¨ã€å›ºä»¶åŠ è½½å·¥ä½œéƒ½æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µå®Œæˆçš„ã€‚&lt;/li&gt;
&lt;li&gt;å¼•å¯¼è®¾å¤‡é€‰æ‹©é˜¶æ®µï¼ˆBoot Device Selectï¼ŒBDSï¼‰ã€‚BDS é˜¶æ®µçš„ä¸»è¦å·¥ä½œæ˜¯åˆå§‹åŒ–æ§åˆ¶å°è®¾å¤‡çš„ç¯å¢ƒå˜é‡ï¼Œå°è¯•åŠ è½½ç¯å¢ƒå˜é‡åˆ—è¡¨ä¸­è®°å½•çš„é©±åŠ¨ï¼Œå¹¶å°è¯•ä»ç¯å¢ƒå˜é‡åˆ—è¡¨ä¸­è®°å½•çš„å¯åŠ¨è®¾å¤‡ä¸­å¯åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;ä¸´æ—¶ç³»ç»Ÿè¿è¡Œé˜¶æ®µï¼ˆTransient System Loadï¼ŒTSLï¼‰ã€‚è¿™ä¸ªé˜¶æ®µå°†è¿›å…¥ UEFI çš„ä¸´æ—¶ Shell ç³»ç»Ÿç¯å¢ƒã€‚&lt;/li&gt;
&lt;li&gt;è¿è¡Œæ—¶é˜¶æ®µï¼ˆRunTimeï¼ŒRTï¼‰ã€‚å½“æ“ä½œç³»ç»Ÿè°ƒç”¨ &lt;code&gt;EFI_BOOT_SERVICES.ExitBootServices&lt;/code&gt; æœåŠ¡åï¼Œç³»ç»Ÿè¿›å…¥ RT é˜¶æ®µã€‚æ­¤æ—¶ï¼ŒDXE ä¸å¼•å¯¼æœåŠ¡éƒ½å°†é”€æ¯ï¼Œåªæœ‰ EFI è¿è¡Œæ—¶æœåŠ¡å’Œ EFI ç³»ç»Ÿè¡¨å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;åä¸–é˜¶æ®µï¼ˆAfter Lifeï¼ŒALï¼‰ã€‚å½“æ“ä½œç³»ç»Ÿè°ƒç”¨ &lt;code&gt;EFI_RUNTIME_SERVICES.ResetSystem&lt;/code&gt; æœåŠ¡æˆ–è€…è°ƒç”¨ ACPI SleepStateï¼Œç³»ç»Ÿè¿›å…¥ AL é˜¶æ®µã€‚è§¦å‘å¼‚æ­¥äº‹ä»¶ï¼ˆæ¯”å¦‚ï¼šSMIã€NMIï¼‰äº¦å¯ä½¿ç³»ç»Ÿè¿›å…¥ AL é˜¶æ®µï¼Œè¿™åœ¨æœåŠ¡å™¨å’Œå·¥ä½œç«™ä¸­æ¯”è¾ƒå¸¸è§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;bios-çš„ç¼ºç‚¹--uefi-çš„ä¼˜ç‚¹&#34;&gt;BIOS çš„ç¼ºç‚¹ &amp;amp; UEFI çš„ä¼˜ç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ­£å¦‚ systemd å–ä»£ init.d çš„åŸå› ä¹‹ä¸€ï¼ŒBIOS ä¸æ”¯æŒå¼‚æ­¥å·¥ä½œæ¨¡å¼ï¼Œåªèƒ½ä½¿ç”¨ä¸­æ–­æ¥å®ç°å„ç§æœåŠ¡ï¼›è€Œ UEFI å¯ä»¥èˆå¼ƒä¸­æ–­è¿™ç§æ¯”è¾ƒè€—æ—¶çš„æ“ä½œå¤–éƒ¨è®¾å¤‡çš„æ–¹å¼ï¼Œä»…ä»…ä¿ç•™äº†æ—¶é’Ÿä¸­æ–­ã€‚å¤–éƒ¨è®¾å¤‡çš„æ“ä½œé‡‡ç”¨â€œäº‹ä»¶+å¼‚æ­¥æ“ä½œâ€å®Œæˆã€‚&lt;/li&gt;
&lt;li&gt;åŠŸèƒ½æ‹“å±•æ€§ä¸æ‹“å±•æ€§ï¼šBIOS ä»£ç é‡‡ç”¨é™æ€é“¾æ¥ï¼Œå¢åŠ ç¡¬ä»¶åŠŸèƒ½æ—¶ï¼Œå¿…é¡»å°† 16 ä½ä»£ç æ”¾ç½®åœ¨ 0x0C0000~0x0DFFFF åŒºé—´ï¼Œåˆå§‹åŒ–æ—¶å°†å…¶è®¾ç½®ä¸ºçº¦å®šçš„ä¸­æ–­å¤„ç†ç¨‹åºã€‚è€Œä¸” BIOS æ²¡æœ‰æä¾›åŠ¨æ€åŠ è½½è®¾å¤‡é©±åŠ¨çš„æ–¹æ¡ˆã€‚è€Œ UEFI ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼šä¸€æ˜¯é©±åŠ¨çš„æ¨¡å—åŒ–è®¾è®¡ï¼›äºŒæ˜¯è½¯ç¡¬ä»¶å‡çº§çš„å…¼å®¹æ€§ã€‚å¤§éƒ¨åˆ†ç¡¬ä»¶çš„åˆå§‹åŒ–é€šè¿‡ UEFI é©±åŠ¨å®ç°ã€‚æ¯ä¸ªé©±åŠ¨æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œå¯ä»¥åŒ…å«åœ¨å›ºä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨è®¾å¤‡ä¸Šï¼Œè¿è¡Œæ—¶æ ¹æ®éœ€è¦åŠ¨æ€åŠ è½½ã€‚UEFI ä¸­çš„æ¯ä¸ªè¡¨å’Œåè®®ï¼ˆåŒ…æ‹¬é©±åŠ¨ï¼‰éƒ½æœ‰ç‰ˆæœ¬å·ï¼Œè¿™ä½¿å¾—ç³»ç»Ÿå‡çº§è¿‡ç¨‹æ›´åŠ ç®€å•ã€å¹³æ»‘ã€‚&lt;/li&gt;
&lt;li&gt;BIOS ä¸æ”¯æŒä»ç¡¬ç›˜ 2TB ä»¥ä¸Šçš„åœ°å€ç©ºé—´å¼•å¯¼ï¼šå—é™äº BIOS ç¡¬ç›˜çš„å¯»å€æ–¹å¼ï¼ŒBIOS ç¡¬ç›˜é‡‡ç”¨ 32 ä½åœ°å€ï¼Œå› è€Œå¼•å¯¼æ‰‡åŒºçš„æœ€å¤§é€»è¾‘å—åœ°å€æ˜¯ 2^32ï¼ˆæ¢ç®—æˆå­—èŠ‚åœ°å€ï¼Œå³ 2^32Ã—512B=2TBï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;mbr-vs-gpt&#34;&gt;MBR vs GPT&lt;/h2&gt;
&lt;p&gt;Legacy MBRï¼ˆMaster Boot Recordï¼‰æ˜¯ä¸º BIOS å¼•å¯¼æ–¹å¼è®¾è®¡çš„ç£ç›˜å¼•å¯¼æ‰‡åŒºç»“æ„ï¼Œå…¶ç»å¤§éƒ¨åˆ†åŠŸèƒ½ç»“æ„éƒ½ä¿å­˜åœ¨ç£ç›˜çš„å¼•å¯¼æ‰‡åŒºã€‚è€Œ GPTï¼ˆGUID Partition tableï¼‰å´æ˜¯åŒºåˆ«äº legacy MBR ç£ç›˜å¸ƒå±€çš„ä¸€ç§å…¨æ–°å¸ƒå±€ï¼Œå®ƒä¸“ä¸º UEFI å›ºä»¶ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;64 ä½çš„LBAï¼ˆLogical Block Addressï¼‰ç£ç›˜æ‰‡åŒºå¯»å€ï¼Œè€Œä¸æ˜¯ 32 ä½&lt;/li&gt;
&lt;li&gt;æ”¯æŒæ›´å¤šåˆ†åŒºï¼Œè€Œä¸ä»…ä»…æ˜¯å››ä¸ªä¸»åˆ†åŒº&lt;/li&gt;
&lt;li&gt;ä¸ºä¸»åˆ†åŒºè¡¨æä¾›å†—ä½™çš„å¤‡ä»½åˆ†åŒºè¡¨&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç‰ˆæœ¬å·å’Œå¤§å°å­—æ®µä¸ºå°†æ¥åšæ‰©å±•&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ CRC32 å­—æ®µæ”¹è¿›æ•°æ®å®Œæ•´æ€§&lt;/li&gt;
&lt;li&gt;å®šä¹‰ç”¨äºå”¯ä¸€æ ‡è¯†æ¯ä¸ªåˆ†åŒºçš„ GUID&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ GUID å’Œå±æ€§å®šä¹‰åˆ†åŒºç±»å‹&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªåˆ†åŒºåŒ…å«ä¸€ä¸ª 36 å­—ç¬¦çš„äººç±»å¯è¯»åç§°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†å…¼å®¹ legacy MBR ç£ç›˜å¸ƒå±€ï¼ŒGPT ä»ä½¿ç”¨ legacy MBR çš„å¼•å¯¼æ‰‡åŒºç»“æ„ï¼Œä½† UEFI å›ºä»¶ä¸ä¼šæ‰§è¡Œ MBR ä¸Šçš„å¯åŠ¨ä»£ç ã€‚GPT ä¸ºäº†ä¸ legacy MBR çš„å¼•å¯¼æ‰‡åŒºç»“æ„ç›¸åŒºåˆ†ç‰¹å°†å¼•å¯¼æ‰‡åŒºç»“æ„å‘½åä¸º Protective MBRï¼ˆPMBRï¼‰ï¼Œå¹¶ä½¿ç”¨ GPT ä¼ªåˆ†åŒºæ¨¡æ‹Ÿ MBR åˆ†åŒºè¡¨ã€‚&lt;/p&gt;
&lt;p&gt;GPT çš„ Protective MBR å¼•å¯¼æ‰‡åŒºç»“æ„åªä½¿ç”¨ä¸€ä¸ªåˆ†åŒºè®°å½•è¡¨é¡¹ï¼Œè¿™ä¸ªåˆ†åŒºå°†å ç”¨ Protective MBR ä¹‹åçš„æ•´ä¸ªç£ç›˜ç©ºé—´ï¼Œå‰©ä½™ä¸‰ä¸ªè¡¨é¡¹ä¿ç•™ä½¿ç”¨å¹¶å¡«å…… 0 ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;pmbr&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/pmbr.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å¤‡ä»½åˆ†åŒºè¡¨çš„é¡ºåºæ˜¯ç›¸åçš„ï¼Œè¿™ä¹Ÿéå¸¸ç¬¦åˆæˆ‘ä»¬å¯¹è¿™ç§è®°å½•ç»“æ„çš„ç›´è§‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;guid&#34;&gt;GUID&lt;/h3&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æè¿°&lt;/th&gt;
          &lt;th&gt;GUIDå€¼&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;æœªä½¿ç”¨&lt;/td&gt;
          &lt;td&gt;00000000-0000-0000-0000-000000000000&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;EFI System Partition&lt;/td&gt;
          &lt;td&gt;C12A7328-F81F-11D2-BA4B-00A0C93EC93B&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Partition Containing a legacy MBR&lt;/td&gt;
          &lt;td&gt;024DEE41-33E7-11D3-9D69-0008C781F39F&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;FAT12/16/32/NTFS&lt;/td&gt;
          &lt;td&gt;EBD0A0A2-B9E5-4433-87C0-68B6B72699C7&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;EXT4&lt;/td&gt;
          &lt;td&gt;0FC63DAF-8483-4772-8E79-3D69D8477DE4&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;åŒºåˆ«äºåˆ†åŒºçš„ UUID ã€‚è¿™ä¸ª GUID ç”¨äºæ ‡è¯†åˆ†åŒºçš„å†…å®¹ï¼Œç±»ä¼¼äºMBRä¸­çš„ OSType å­—æ®µã€‚æ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿéƒ½å¿…é¡»å‘å¸ƒå…¶å”¯ä¸€çš„ GUID ã€‚&lt;/p&gt;
&lt;h3 id=&#34;esp--fat--pe&#34;&gt;ESP &amp;amp; FAT &amp;amp; PE&lt;/h3&gt;
&lt;p&gt;UEFI çš„ ESP æ–‡ä»¶ç³»ç»Ÿæ˜¯æŒ‡ UEFI ç³»ç»Ÿåˆ†åŒºï¼ˆEFI System Partitionï¼‰ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªä½¿ç”¨ FAT32 æ ¼å¼åŒ–çš„å°åˆ†åŒºï¼Œé€šå¸¸ä¸º 100MBï¼Œå…¶ä¸­å­˜å‚¨äº†å·²å®‰è£…ç³»ç»Ÿçš„ UEFI å¼•å¯¼åŠ è½½ç¨‹åºä»¥åŠå¯åŠ¨æ—¶å›ºä»¶ä½¿ç”¨çš„åº”ç”¨ç¨‹åºã€‚UEFI å›ºä»¶åœ¨å¯åŠ¨æ—¶ä¼šåŠ è½½ ESP åˆ†åŒºä¸Šçš„ .efi æ–‡ä»¶ï¼Œå¼€å§‹åŠ è½½æ“ä½œç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;UEFI ä¸èƒ½è¿è¡Œ ELF æ ¼å¼çš„å¯æ‰§è¡Œç¨‹åºï¼Œåªèƒ½è¿è¡Œ PE æ ¼å¼çš„ã€‚ä½¿ç”¨ objcopy å¤„ç†ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°†å…¶æ ¼å¼æ”¹å˜ä¸º PE+ ï¼Œæˆ–è€…ä½¿ç”¨äº¤å‰ç¼–è¯‘çš„æ–¹å¼ï¼Œå°† target è®¾ç½®ä¸º &lt;code&gt;x86_64-unknown-uefi&lt;/code&gt; æˆ– &lt;code&gt;aarch64-unknown-uefi&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# file /boot/EFI/GRUB/grubx64.efi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/boot/EFI/GRUB/grubx64.efi: PE32+ executable (EFI application) x86-64 (stripped to external PDB), for MS Windows, 4 sections
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;linux-å¯åŠ¨&#34;&gt;Linux ï¼Œå¯åŠ¨ï¼&lt;/h2&gt;
&lt;p&gt;ä¸ç®¡æ¥å£æˆ–è€…è§„èŒƒå¦‚ä½•å˜åŒ–ï¼Œè®¡ç®—æœºçš„å¯åŠ¨ä¸€èˆ¬éƒ½ä¼šæ˜¯ä¸‰ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CAR(Cache As RAM) ï¼Œè¿™ä¸ªé˜¶æ®µè¿å†…å­˜éƒ½ç”¨ä¸äº†&lt;/li&gt;
&lt;li&gt;èƒ½æ‰§è¡Œæ±‡ç¼–è¯­è¨€&lt;/li&gt;
&lt;li&gt;è®¾ç½®å †æ ˆç¯å¢ƒï¼Œè¿™æ—¶èƒ½æ‰§è¡Œ C ç­‰é«˜çº§è¯­è¨€&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™é‡Œä¸»è¦ä»‹ç»åœ¨ BootLoader é˜¶æ®µå®Œæˆçš„å·¥ä½œã€‚&lt;/p&gt;
&lt;h3 id=&#34;grub-å¯åŠ¨&#34;&gt;GRUB ï¼Œå¯åŠ¨ï¼&lt;/h3&gt;
&lt;p&gt;grub æ˜¯ä¸€æ¬¾ä¸æ–­æ‰©å……åŠŸèƒ½ç›´åˆ°æœ€åå†å²åŒ…è¢±ç§¯é‡éš¾è¿”çš„è½¯ä»¶ï¼Œå› æ­¤å®ƒçš„å¯åŠ¨è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Stage 1ï¼šæ‰§è¡ŒGRUBä¸»ç¨‹åºã€‚ç¬¬ä¸€é˜¶æ®µæ˜¯ç”¨æ¥æ‰§è¡Œ GRUB ä¸»ç¨‹åºçš„ï¼Œè¿™ä¸ªä¸»ç¨‹åºå¿…é¡»æ”¾åœ¨å¯åŠ¨åŒºä¸­ï¼ˆä¹Ÿå°±æ˜¯ MBR æˆ–è€…å¼•å¯¼æ‰‡åŒºä¸­ï¼‰ã€‚ä½†æ˜¯ MBR å¤ªå°äº†ï¼Œæ‰€ä»¥åªèƒ½å®‰è£… GRUB çš„æœ€å°çš„ä¸»ç¨‹åºï¼Œè€Œä¸èƒ½å®‰è£… GRUB çš„ç›¸å…³é…ç½®æ–‡ä»¶ã€‚è¿™ä¸ªä¸»ç¨‹åºä¸»è¦æ˜¯ç”¨æ¥å¯åŠ¨ Stage 1.5 å’Œ Stage 2 çš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Stage 1.5ï¼šè¯†åˆ«ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚Stage 2 æ¯”è¾ƒå¤§ï¼Œåªèƒ½æ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ˆåˆ†åŒºï¼‰ï¼Œä½†æ˜¯ Stage 1 ä¸èƒ½è¯†åˆ«ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥åŠ è½½ Stage 2ã€‚è¿™æ—¶éœ€è¦å…ˆåŠ è½½ Stage 1.5ï¼Œç”± Stage 1.5 æ¥åŠ è½½ä¸åŒæ–‡ä»¶ç³»ç»Ÿä¸­çš„ Stage 2ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œéš¾é“ Stage 1.5 ä¸æ˜¯æ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„å—ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆ Stage 1 åŒæ ·ä¸èƒ½æ‰¾åˆ° Stage 1.5ã€‚å…¶å®ï¼ŒStage 1.5 è¿˜çœŸæ²¡æœ‰æ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œè€Œæ˜¯åœ¨å®‰è£… GRUB æ—¶ï¼Œç›´æ¥å®‰è£…åˆ°ç´§è·Ÿ MBR ä¹‹åçš„ 32KB çš„ç©ºé—´ä¸­ï¼Œè¿™æ®µç¡¬ç›˜ç©ºé—´æ˜¯ç©ºç™½æ— ç”¨çš„ï¼Œè€Œä¸”æ˜¯æ²¡æœ‰æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæ‰€ä»¥ Stage 1 å¯ä»¥ç›´æ¥è¯»å– Stage 1.5ã€‚è¯»å–äº† Stage 1.5 å°±èƒ½è¯†åˆ«ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰èƒ½åŠ è½½ Stage 2ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Stage 2ï¼šåŠ è½½GRUBçš„é…ç½®æ–‡ä»¶ã€‚Stage 2 é˜¶æ®µä¸»è¦å°±æ˜¯åŠ è½½ GRUB çš„é…ç½®æ–‡ä»¶ /boot/grub/grub.confï¼Œç„¶åæ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰ï¼ŒåŠ è½½å†…æ ¸å’Œè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€‚æ¥ä¸‹æ¥å†…æ ¸å°±å¯ä»¥æ¥ç®¡å¯åŠ¨è¿‡ç¨‹ï¼Œç»§ç»­è‡ªæ£€ä¸åŠ è½½ç¡¬ä»¶æ¨¡å—äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;grub2-å¯åŠ¨&#34;&gt;GRUB2 ï¼Œå¯åŠ¨ï¼&lt;/h3&gt;
&lt;p&gt;grub2 æ˜¯ grub çš„é‡å†™ç‰ˆæœ¬ï¼Œå¯åŠ¨è¿‡ç¨‹æ›´ç®€å•æ˜äº†ã€‚grub2 å°† boot.img è½¬æ¢åçš„å†…å®¹å®‰è£…åˆ° MBR(VBRæˆ–EBR) ä¸­çš„ boot loader éƒ¨åˆ†ï¼Œå°† diskboot.img å’Œ kernel.img ç»“åˆæˆä¸º core.imgï¼ŒåŒæ—¶è¿˜ä¼šåµŒå…¥ä¸€äº›æ¨¡å—æˆ–åŠ è½½æ¨¡å—çš„ä»£ç åˆ° core.img ä¸­ï¼Œç„¶åå°† core.img è½¬æ¢åçš„å†…å®¹å®‰è£…åˆ°ç£ç›˜çš„æŒ‡å®šä½ç½®å¤„ã€‚&lt;/p&gt;
&lt;p&gt;grub2 çš„ core é˜¶æ®µç›¸å½“äº grub çš„ stage1.5 å’Œ stage2 çš„ç»“åˆï¼Œå®ƒå¯ä»¥ç›´æ¥åŠ è½½ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿå’Œæ¨¡å—ï¼Œè€Œä¸éœ€è¦é¢å¤–çš„é©±åŠ¨ç¨‹åºã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;core é˜¶æ®µé€šå¸¸å­˜å‚¨åœ¨ä¸€ä¸ªä¸“é—¨çš„ UEFI åˆ†åŒºæˆ–è€… /boot/grub ç›®å½•ä¸­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Stage 1ï¼šç¬¬ä¸€é˜¶æ®µä¸ºæ‰§è¡Œ boot loader çš„ä¸»ç¨‹åºï¼Œè¿™ä¸ªä¸»ç¨‹åºå¿…é¡»è¦è¢«å®‰è£…åœ¨å¼•å¯¼åŒºï¼Œä¹Ÿå°±æ˜¯æ˜¯ MBR æˆ–è€…å¯åŠ¨æ‰‡åŒºã€‚ä½†å› ä¸º MBR ç©ºé—´æœ‰é™ï¼Œæ‰€ä»¥ï¼ŒMBR æˆ–å¯åŠ¨æ‰‡åŒºé€šå¸¸ä»…å®‰è£… boot loader çš„æœ€å°ä¸»ç¨‹åºï¼Œå¹¶æ²¡æœ‰å®‰è£… loader çš„ç›¸å…³é…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Stage 2ï¼šç¬¬äºŒé˜¶æ®µé€šè¿‡ boot loader åŠ è½½æ‰€æœ‰é…ç½®æ–‡ä»¶ä¸ç›¸å…³çš„ç¯å¢ƒå‚æ•°æ–‡ä»¶ï¼ˆåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿå®šä¹‰ä¸ä¸»è¦é…ç½®æ–‡ä»¶ grub.cfgï¼‰ï¼Œé€šå¸¸é…ç½®æ–‡ä»¶éƒ½åœ¨ /boot ç›®å½•ä¸‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# ls /boot
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;EFI  grub  initramfs-linux-fallback.img  initramfs-linux.img  vmlinuz-linux
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# file vmlinuz-linux
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vmlinuz-linux: Linux kernel x86 boot executable bzImage, version 6.4.12-arch1-1 (linux@archlinux) #1 SMP PREEMPT_DYNAMIC Thu, 24 Aug 2023 00:38:14 +0000, RO-rootFS, swap_dev 0XC, Normal VGA
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# tree EFI
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;EFI
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€ GRUB
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    â””â”€â”€ grubx64.efi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f00&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f00&#34;&gt;&lt;/span&gt;2 directories, 1 file
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# tree grub
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;grub
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€ fonts
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚Â Â  â””â”€â”€ unicode.pf2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€ grub.cfg
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€ grubenv
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€ locale
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚Â Â  â”œâ”€â”€ ast.mo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚Â Â  â”œâ”€â”€ ca.mo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚Â Â  â”œâ”€â”€ da.mo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚Â Â  â”œâ”€â”€ de_CH.mo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚Â Â  â”œâ”€â”€ de@hebrew.mo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;......
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;.mo æ–‡ä»¶éƒ½æ˜¯ä¾› grub åŠ è½½çš„æ¨¡å—ï¼ŒåŒ…å«äº†å¯¹å­—ä½“ã€å›¾åƒã€USB è®¾å¤‡ç­‰ã€‚è€Œ initramfs-linux.img æ˜¯ä¸€ä¸ªåˆå§‹å†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªå‹ç¼©çš„å½’æ¡£æ–‡ä»¶ï¼ŒåŒ…å«äº†ä¸€äº›å¿…è¦çš„ç¨‹åºå’Œé©±åŠ¨ï¼Œç”¨äºåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­åŠ è½½æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚vmlinuz-linux æ˜¯ä¸€ä¸ª Linux å†…æ ¸é•œåƒï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”¨äºåœ¨ UEFI å¯åŠ¨æ¨¡å¼ä¸‹è¢«å›ºä»¶ç›´æ¥åŠ è½½ã€‚è¿™ä¸¤ä¸ªæ–‡ä»¶é€šå¸¸ä½äº /boot ç›®å½•ä¸‹ï¼Œæ˜¯ Linux ç³»ç»Ÿå¯åŠ¨çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;initramfs çš„ç›®çš„åœ¨äºæä¾›å¯åŠ¨è¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„æœ€é‡è¦å†…æ ¸æ¨¡å—ï¼Œä»¥è®©ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹å¯ä»¥é¡ºåˆ©å®Œæˆã€‚éœ€è¦ initramfs çš„åŸå› ï¼Œæ˜¯å› ä¸ºå†…æ ¸æ¨¡å—æ”¾ç½®äº /lib/modules/$(uname -r)/kernel/ å½“ä¸­ï¼Œ è¿™äº›æ¨¡å—å¿…é¡»è¦æ ¹ç›®å½•è¢«æŒ‚è½½æ—¶æ‰èƒ½å¤Ÿè¢«è¯»å–ã€‚ä½†æ˜¯å¦‚æœå†…æ ¸æœ¬èº«ä¸å…·å¤‡ç£ç›˜çš„é©±åŠ¨ç¨‹åºæ—¶ï¼Œ å°±æ— æ³•æŒ‚è½½æ ¹ç›®å½•ï¼Œä¹Ÿå°±æ²¡æœ‰åŠæ³•è·å–åˆ°é©±åŠ¨ç¨‹åºï¼Œé€ æˆæ— æ³•å¯åŠ¨&lt;/p&gt;
&lt;p&gt;initramfs å¯ä»¥å°† /lib/modules/ å†…çš„å¯åŠ¨è¿‡ç¨‹ä¸­å¿…éœ€çš„æ¨¡å—æ‰“åŒ…åˆ° initramfs ä¸­ï¼Œç„¶ååœ¨å¯åŠ¨æ—¶ï¼Œé€šè¿‡ä¸»æœºçš„ INT 13 ç¡¬ä»¶åŠŸèƒ½å°†è¯¥æ–‡ä»¶è¯»å‡ºæ¥è§£å‹ç¼©ï¼Œå¹¶ä¸” initramfs åœ¨å†…å­˜å†…ä¼šæ¨¡æ‹Ÿæˆä¸ºæ ¹ç›®å½•ï¼Œ ç”±äºæ­¤è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸»è¦åŒ…å«ç£ç›˜ä¸æ–‡ä»¶ç³»ç»Ÿçš„æ¨¡å—ï¼Œå› æ­¤å†…æ ¸æœ€åå°±èƒ½å¤Ÿè¯†åˆ«å®é™…çš„ç£ç›˜ï¼Œç„¶åå°±èƒ½å¤Ÿè¿›è¡Œå®é™…æ ¹ç›®å½•çš„æŒ‚è½½ï¼Œå› æ­¤ï¼Œinitramfs å†…æ‰€åŒ…å«çš„æ¨¡å—å¤§å¤šæ˜¯ä¸å¯åŠ¨è¿‡ç¨‹æœ‰å…³ï¼Œä¸”ä¸»è¦ä»¥æ–‡ä»¶ç³»ç»ŸåŠç¡¬ç›˜æ¨¡å— (å¦‚ usb, SCSI ç­‰) ä¸ºä¸»çš„&lt;/p&gt;
&lt;p&gt;é€šå¸¸åœ¨ä»¥ä¸‹æƒ…å†µä¸‹éœ€è¦ initramfsï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ ¹ç›®å½•æ‰€åœ¨ç£ç›˜ä¸º SATAã€USB æˆ– SCSI ç­‰æ¥å£&lt;/li&gt;
&lt;li&gt;æ ¹ç›®å½•æ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿä¸º LVM, RAID ç­‰ç‰¹æ®Šæ ¼å¼&lt;/li&gt;
&lt;li&gt;æ ¹ç›®å½•æ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿä¸ºéä¼ ç»Ÿ Linux è¯†åˆ«çš„æ–‡ä»¶ç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;å…¶ä»–å¿…é¡»è¦åœ¨å†…æ ¸åŠ è½½æ—¶æä¾›çš„æ¨¡å—&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨å‘è¡Œç‰ˆæ›´æ–°å†…æ ¸æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šæ‰§è¡Œä¸€ä¸ªé’©å­å‡½æ•°ï¼Œé‡æ–°ç”Ÿæˆè¿™äº›é‡è¦éƒ¨ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;:: Running post-transaction hooks...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt;) Reloading system manager configuration...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt;) Reloading device manager configuration...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt;) Arming ConditionNeedsUpdate...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt;) Updating module dependencies...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt;) Install DKMS modules
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; dkms install --no-depmod v4l2loopback/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.12&lt;/span&gt;.&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt; -k &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;6.5&lt;/span&gt;.&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;-arch1-&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; depmod &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;6.5&lt;/span&gt;.&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;-arch1-&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;6&lt;/span&gt;/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt;) Updating linux initcpios...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Building image from preset: /etc/mkinitcpio.d/linux.preset: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Using default configuration file: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;/etc/mkinitcpio.conf&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; -k /boot/vmlinuz-linux -g /boot/initramfs-linux.img --microcode /boot/*-ucode.img
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Starting build: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;6.5.2-arch1-1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [base]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [udev]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [autodetect]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [modconf]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [kms]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [keyboard]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;xhci_pci&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [keymap]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [consolefont]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: consolefont: no font found in configuration
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [block]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [filesystems]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [fsck]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Generating module dependencies
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Creating zstd-compressed initcpio image: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;/boot/initramfs-linux.img&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Image generation successful
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Building image from preset: /etc/mkinitcpio.d/linux.preset: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;fallback&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Using default configuration file: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;/etc/mkinitcpio.conf&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; -k /boot/vmlinuz-linux -g /boot/initramfs-linux-fallback.img -S autodetect --microcode /boot/*-ucode.img
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Starting build: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;6.5.2-arch1-1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [base]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [udev]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [modconf]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [kms]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;ast&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [keyboard]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;xhci_pci&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [keymap]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [consolefont]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: consolefont: no font found in configuration
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [block]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;aic94xx&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;bfa&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;qed&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;qla1280&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;qla2xxx&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; WARNING: Possibly missing firmware &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; module: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;wd719x&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [filesystems]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  -&amp;gt; Running build hook: [fsck]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Generating module dependencies
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Creating zstd-compressed initcpio image: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;/boot/initramfs-linux-fallback.img&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;==&amp;gt; Image generation successful
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt;/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;7&lt;/span&gt;) Reloading system bus configuration...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;total &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;h &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;m &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;21&lt;/span&gt;s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ª UEFi å¼•å¯¼ç¨‹åºçš„å®ç°&lt;/li&gt;
&lt;li&gt;GRUB legacy document&lt;/li&gt;
&lt;li&gt;GRUB2 document&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.yanjun.pro/?p=78&#34;&gt;Linuxå¯åŠ¨æµç¨‹ï¼ˆäºŒï¼‰ï¼šgrub2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.dingmos.com/index.php/archives/31/&#34;&gt;è®¡ç®—æœºæ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Ÿä»æœªä¸Šç”µåˆ°æ“ä½œç³»ç»Ÿå¯åŠ¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>è¶³çƒé˜Ÿè´¦å•</title>
      <link>https://vaaandark.top/posts/football-team-bill/</link>
      <pubDate>Tue, 29 Aug 2023 21:57:09 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/football-team-bill/</guid>
      <description>&lt;p&gt;8 æœˆ 13 æ—¥å¼€å§‹è®°è´¦ï¼Œå¼€å§‹æ—¶å‰©ä½™ 2392.87 å…ƒã€‚æˆªè‡³ 12.29 æ—¥ï¼Œå‰©ä½™ 864.77 å…ƒã€‚&lt;/p&gt;
&lt;p&gt;å»é™¤å°šæœªåˆ°è´¦çš„å­¦é™¢æŠ¥é”€ï¼Œ2023 å¹´ç§‹å­£å­¦æœŸå®é™…æ”¯å‡º 801.10 å…ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤‡æ³¨&#34;&gt;å¤‡æ³¨&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ä¸­æ“è¥¿æ“çº¯å‡€æ°´ 1 å…ƒä¸€ç“¶ï¼Œæ•´ç®±è´­ä¹°ä¸­æ“æœ‰ä¼˜æƒ  22 å…ƒï¼Œè¥¿æ“æ²¡æœ‰ä¼˜æƒ  24 å…ƒï¼Œç›´æ¥è´­ä¹°è¶…å¸‚çŸ¿æ³‰æ°´ä¸€ä»¶ 48 å…ƒã€‚&lt;/li&gt;
&lt;li&gt;è´­ä¹°è®­ç»ƒé“å…· 728 å…ƒï¼Œå­¦é™¢å°šæœªæŠ¥é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;è´¦å•&#34;&gt;è´¦å•&lt;/h2&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æ—¥æœŸ&lt;/th&gt;
          &lt;th&gt;æ”¶å…¥ / æ”¯å‡º&lt;/th&gt;
          &lt;th&gt;ç”¨é€”&lt;/th&gt;
          &lt;th&gt;å‰©ä½™&lt;/th&gt;
          &lt;th&gt;å¤‡æ³¨&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.08.29&lt;/td&gt;
          &lt;td&gt;-24.00&lt;/td&gt;
          &lt;td&gt;ä¸æ–°ç”Ÿè®­ç»ƒèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;2368.87&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.08.31&lt;/td&gt;
          &lt;td&gt;-36.00&lt;/td&gt;
          &lt;td&gt;ä¸æ–°ç”Ÿè®­ç»ƒèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;2332.87&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.01&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿé‡çƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;2310.87&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.02&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;2288.87&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.09&lt;/td&gt;
          &lt;td&gt;-43.20&lt;/td&gt;
          &lt;td&gt;ä¸ç½‘å®‰é™¢é˜Ÿå‹è°Šèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;2245.67&lt;/td&gt;
          &lt;td&gt;å†œå¤«å±±æ³‰ 1.8/ç“¶&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.16&lt;/td&gt;
          &lt;td&gt;-43.20&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿé˜Ÿä¸é›†æˆæ–°ç”Ÿé˜Ÿå‹è°Šèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;2202.47&lt;/td&gt;
          &lt;td&gt;å†œå¤«å±±æ³‰ 1.8/ç“¶&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.16&lt;/td&gt;
          &lt;td&gt;-200.00&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿæ¯ä¿è¯é‡‘&lt;/td&gt;
          &lt;td&gt;2002.47&lt;/td&gt;
          &lt;td&gt;ä¹‹åä¼šæ ¹æ®çº¢é»„ç‰Œæƒ…å†µé€€è¿˜&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.17&lt;/td&gt;
          &lt;td&gt;-78.00&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿæ¯ç¬¬ä¸€åœºä¿é™©&lt;/td&gt;
          &lt;td&gt;1924.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.18&lt;/td&gt;
          &lt;td&gt;-33.00&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿæ¯ç¬¬ä¸€åœºä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1891.47&lt;/td&gt;
          &lt;td&gt;åŠç®±å†°éœ²å’Œå››ç“¶ä½³å¾—ä¹&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.24&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;ä¸é›†æˆé™¢é˜Ÿå‹è°Šèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1869.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.09.25&lt;/td&gt;
          &lt;td&gt;-48.00&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿæ¯ç¬¬äºŒåœºä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1821.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.10.07&lt;/td&gt;
          &lt;td&gt;-48.00&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿæ¯ç¬¬ä¸‰åœºä¿é™©&lt;/td&gt;
          &lt;td&gt;1773.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.10.07&lt;/td&gt;
          &lt;td&gt;-45.00&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿæ¯ç¬¬ä¸‰åœºä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1728.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.10.15&lt;/td&gt;
          &lt;td&gt;-48.00&lt;/td&gt;
          &lt;td&gt;ä¸è½¯ä»¶é™¢é˜Ÿå‹è°Šèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1680.47&lt;/td&gt;
          &lt;td&gt;ä¸¤ç®±çŸ¿æ³‰æ°´&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.10.17&lt;/td&gt;
          &lt;td&gt;-24.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1656.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.10.21&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;ä¸æ•°å­¦é™¢é˜Ÿå‹è°Šèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1634.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.10.24&lt;/td&gt;
          &lt;td&gt;+170.00&lt;/td&gt;
          &lt;td&gt;æ–°ç”Ÿæ¯ä¿è¯é‡‘é€€è¿˜&lt;/td&gt;
          &lt;td&gt;1804.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.10.24&lt;/td&gt;
          &lt;td&gt;-728.00&lt;/td&gt;
          &lt;td&gt;è´­ä¹°è®­ç»ƒé“å…·&lt;/td&gt;
          &lt;td&gt;1076.47&lt;/td&gt;
          &lt;td&gt;ç­‰å¾…å­¦é™¢æŠ¥é”€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.10.31&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1054.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.11.06&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1032.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.11.14&lt;/td&gt;
          &lt;td&gt;-2.00&lt;/td&gt;
          &lt;td&gt;å†°è¢‹&lt;/td&gt;
          &lt;td&gt;1030.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.11.22&lt;/td&gt;
          &lt;td&gt;-12.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;1018.47&lt;/td&gt;
          &lt;td&gt;åŠç®±&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.11.26&lt;/td&gt;
          &lt;td&gt;-48.00&lt;/td&gt;
          &lt;td&gt;ä¸ç®¡ç†é™¢é˜Ÿå‹è°Šèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;970.47&lt;/td&gt;
          &lt;td&gt;ä¸¤ç®±&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.11.28&lt;/td&gt;
          &lt;td&gt;-24.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;946.47&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.12.10&lt;/td&gt;
          &lt;td&gt;-37.70&lt;/td&gt;
          &lt;td&gt;ä¸å…‰ç”µé™¢é˜Ÿå‹è°Šèµ›ä¹°æ°´å’Œå†°æ•·&lt;/td&gt;
          &lt;td&gt;898.77&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.12.17&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;ä¸ç½‘å®‰é™¢é˜Ÿå‹è°Šèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;876.77&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.12.26&lt;/td&gt;
          &lt;td&gt;-12.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;864.77&lt;/td&gt;
          &lt;td&gt;åŠç®±&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.03&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;842.77&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.05&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;820.77&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.09&lt;/td&gt;
          &lt;td&gt;-24.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;796.77&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.10&lt;/td&gt;
          &lt;td&gt;-40.08&lt;/td&gt;
          &lt;td&gt;ä¸è½¯ä»¶é™¢é˜Ÿå‹è°Šèµ›ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;756.69&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.12&lt;/td&gt;
          &lt;td&gt;-24.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;732.69&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.20&lt;/td&gt;
          &lt;td&gt;-24.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;708.69&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.21&lt;/td&gt;
          &lt;td&gt;-48.00&lt;/td&gt;
          &lt;td&gt;åå·¥æ¯(vsç½‘å®‰)ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;660.69&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.24&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;è®­ç»ƒä¹°æ°´&lt;/td&gt;
          &lt;td&gt;638.69&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.03.31&lt;/td&gt;
          &lt;td&gt;-47.00&lt;/td&gt;
          &lt;td&gt;åå·¥æ¯(vsèˆ¹æµ·)ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;591.69&lt;/td&gt;
          &lt;td&gt;åŒ…å«äº”ç“¶ä½³å¾—ä¹&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.04.06&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;åå·¥æ¯(vsç”Ÿç§‘)ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;569.69&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.04.13&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;åå·¥æ¯(vsé›†æˆ)ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;547.69&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.04.17&lt;/td&gt;
          &lt;td&gt;-47.00&lt;/td&gt;
          &lt;td&gt;åå·¥æ¯(vså»ºè§„)ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;500.69&lt;/td&gt;
          &lt;td&gt;åŒ…å«äº”ç“¶ä½³å¾—ä¹&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2023.04.20&lt;/td&gt;
          &lt;td&gt;-22.00&lt;/td&gt;
          &lt;td&gt;åå·¥æ¯(vså»ºè§„)ä¹°æ°´&lt;/td&gt;
          &lt;td&gt;478.69&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</description>
    </item>
    
    <item>
      <title>PAC2023å¨±ä¹èµ›</title>
      <link>https://vaaandark.top/posts/pac2023-game/</link>
      <pubDate>Thu, 06 Jul 2023 23:55:08 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/pac2023-game/</guid>
      <description>&lt;p&gt;7.6 ä¸¾åŠäº† PAC2023 çš„å¼€å¹•èµ›ï¼Œä»¥è½»æ¾å¨±ä¹ä¸ºä¸»ï¼Œæˆ‘è¿˜æ²¡æœ‰ä½“éªŒè¿‡åœ¨çŸ­æ—¶é—´å†…å®Œæˆä¼˜åŒ–å·¥ä½œï¼ˆä¸è¿‡ä»Šå¤©çš„å·¥ä½œé‡å€’ä¹Ÿä¸å¤§ï¼‰ã€‚è¿™åœºå¨±ä¹èµ›ç»™äº†æˆ‘åˆ«æ ·çš„ä½“éªŒï¼Œä¹Ÿè®©æˆ‘å‘ç°äº†æˆ‘æœ‰å¥½çš„å¥½å¤šä¸è¶³ï¼Œä»¥åŠä¸€äº›ä»¥å‰æ²¡æœ‰æ³¨æ„åˆ°çš„åä¹ æƒ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;èµ›é¢˜ä»‹ç»&#34;&gt;èµ›é¢˜ä»‹ç»&lt;/h2&gt;
&lt;p&gt;èµ›é¢˜æ˜¯é’ˆå¯¹ä¸€ä¸ªæœ´ç´ å®ç°çš„&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E5%BA%B7%E5%A8%81%E7%94%9F%E5%91%BD%E6%B8%B8%E6%88%8F&#34;&gt;åº·å¨ç”Ÿå‘½æ¸¸æˆ&lt;/a&gt;çš„ä¼˜åŒ–ã€‚ç”±äºä»£ç å†™å¾—å¾ˆæœ´ç´ ï¼Œæ‰€ä»¥æ¯”è¾ƒè½»æ¾åœ°å°±å¯ä»¥è¾¾åˆ°æ¯”è¾ƒå¥½çœ‹çš„åŠ é€Ÿæ¯”ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; iter = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; iter &amp;lt; max_iter; ++iter) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Iter %d...&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, iter);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; j &amp;lt; Nx - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; cnt = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; k = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; k &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;8&lt;/span&gt;; ++k) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; ii = i + dy[k];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; jj = j + dx[k];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (a[ii][jj] == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            cnt++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (a[i][j] == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (cnt == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; || cnt == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            tmp[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            tmp[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {  &lt;span style=&#34;color:#007f7f&#34;&gt;// a[i][j] == 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;          &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (cnt == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            tmp[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            tmp[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; Ny; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; j &amp;lt; Nx; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        a[i][j] = tmp[i][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä»£ç åˆ†æ&#34;&gt;ä»£ç åˆ†æ&lt;/h2&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ç”Ÿå‘½æ¸¸æˆä¸€å…±è¦è¿›è¡Œ 1000 æ¬¡è¿­ä»£ï¼Œæ¯æ¬¡éƒ½éå†ä¸€éæ•´ä¸ªåœ°å›¾ï¼Œå¯¹æ¯ä¸ªç‚¹éƒ½è®¡ç®—ä¸€ä¸‹é‚»å±…çš„ä¸ªæ•°ï¼Œå†æ ¹æ®ç”Ÿå‘½æ¸¸æˆçš„ B3/S23 è§„åˆ™å†³å®šä¸‹ä¸€æ¬¡è¿­ä»£æ—¶çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;B3/S23 è§„åˆ™æ˜¯å¯¹ç”Ÿå‘½æ¸¸æˆè§„åˆ™çš„æ¦‚æ‹¬ç¼©å†™&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªæœ´ç´ å†™æ³•éå¸¸çš„æš´åŠ›ï¼Œä¸ä»…æ˜¯ç›´æ¥è®¿é—®æ¯ä¸ªç‚¹å‘¨å›´çš„å…«ä¸ªç‚¹ï¼Œè€Œä¸”è¿˜ä½¿ç”¨äº† &lt;code&gt;tmp&lt;/code&gt; æ•°ç»„æš‚å­˜å…ƒç´ ï¼Œæœ€åå°† &lt;code&gt;tmp&lt;/code&gt; å¤åˆ¶åˆ°åœ°å›¾æ•°ç»„ &lt;code&gt;a&lt;/code&gt; ä¸­ï¼Œå¼€é”€ä¸å¯è°“ä¸å¤§ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬åœ°çš„ 64 æ ¸å¿ƒé›†ç¾¤ä¸Šè¿è¡Œ baseline ï¼Œè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;741335.164000 ms&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒä¸Šè¿è¡Œ baseline ï¼Œè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;634306.056000 ms&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;ä¼˜åŒ–ç­–ç•¥&#34;&gt;ä¼˜åŒ–ç­–ç•¥&lt;/h2&gt;
&lt;h3 id=&#34;ç®—æ³•å¾®è°ƒ--è®¿å­˜ä¼˜åŒ–&#34;&gt;ç®—æ³•å¾®è°ƒ &amp;amp;&amp;amp; è®¿å­˜ä¼˜åŒ–&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆæˆ‘æƒ³åˆ°çš„æ˜¯å¯¹ç®—æ³•è¿›è¡Œå¾®è°ƒï¼Œå°†ä¹‹å‰çš„å¯¹æ¯ä¸ªç‚¹æ±‚é‚»å±…ä¸ªæ•°æ”¹ä¸ºï¼Œå°†æ¯è¡Œä¸ä¸Šä¸‹ä¸¤è¡Œè¿›è¡Œå åŠ ï¼Œè¿™æ ·æ¯ä¸ªå…ƒç´ å°±æ˜¯ä¸‰ä¸ªç‚¹å’Œã€‚è¿™å°±æŠŠå¯¹ä¸€ä¸ªã€Œä¹å®«æ ¼ã€çš„è®¡ç®—æ”¹æˆäº†ä¸¤æ¬¡å¯¹ä¸‰ä¸ªå…ƒç´ çš„åŠ å’Œã€‚è¿™æ ·å¹¶ä¸èƒ½å‡å°‘è®¡ç®—é‡ï¼Œä½†æ˜¯èƒ½å‡å°‘è®¿å­˜ä¸Šçš„å¼€é”€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™æ ·åšçš„ç›®çš„è¿˜æœ‰ç®€åŒ–ä»£ç é€»è¾‘ï¼Œæ–¹ä¾¿ç¼–è¯‘å™¨ç”Ÿæˆ SIMD æŒ‡ä»¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨ä¸€ç•ªå–èˆä¹‹åæ²¡æœ‰ä½¿ç”¨å‰ç¼€å’Œç®—æ³•æ¥ï¼Œè¿™æ˜¯å› ä¸ºæ‹…å¿ƒåœ¨æ”¹å˜æ•°æ®ç±»å‹åï¼Œæ•°æ®ç±»å‹ä¸å¤Ÿå®½ï¼Œæ— æ³•å­˜æ”¾å‰ç¼€å’Œã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å…¶å®è¿™æ˜¯åè¯ï¼Œåé¢æŠŠ &lt;code&gt;int&lt;/code&gt; æ”¹æˆäº† &lt;code&gt;uint8_t&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ ¸å¿ƒä»£ç æ”¹æˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; iter = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; iter &amp;lt; max_iter; ++iter) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Iter %d...&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, iter);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    memcpy(sum, a, Nx * Ny * &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; j &amp;lt; Nx - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum[i][j] += a[i + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; j &amp;lt; Nx; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum[i][j] += a[i - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; j &amp;lt; Nx - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; neighbors = sum[i][j] + sum[i][j - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;] + sum[i][j + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;] - a[i][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (neighbors == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          tmp[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (neighbors &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; || neighbors &amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          tmp[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          tmp[i][j] = a[i][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    memcpy(a, tmp, Nx * Ny * &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æœ¬åœ°çš„ 64 æ ¸å¿ƒé›†ç¾¤ä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;293731.276000 ms&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;260813.238000 ms&lt;/strong&gt; ï¼ŒåŠ é€Ÿæ¯”çº¦ä¸º &lt;strong&gt;2.4x&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;h3 id=&#34;openmp--åˆå¹¶å¾ªç¯&#34;&gt;openmp &amp;amp;&amp;amp; åˆå¹¶å¾ªç¯&lt;/h3&gt;
&lt;p&gt;ä¹‹åå°±æ˜¯æœ€å–œæ¬¢çš„ã€Œ&lt;strong&gt;openmpï¼Œå¯åŠ¨ï¼&lt;/strong&gt;ã€ç¯èŠ‚äº†ã€‚openmp ç›¸å¯¹å…¶ä»–çš„å¹¶è¡Œæ¡†æ¶æ¥è¯´éå¸¸å¥½ç”¨ï¼Œæ— è„‘æ¨èã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ•²ä»£ç æ—¶åˆçªç„¶å‘ç°å åŠ çš„ä¸¤ä¸ªå¾ªç¯å…¶å®å¯ä»¥åˆå¹¶ï¼Œ&lt;del&gt;è¿™ä¸‹å‚»é€¼äº†&lt;/del&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æ ¸å¿ƒä»£ç å˜æˆäº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Iter %d...&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, iter);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    memcpy(sum, a, Nx * Ny * &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel for
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; j &amp;lt; Nx - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum[i][j] += a[i + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum[i][j] += a[i - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel for
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æœ¬åœ°çš„ 64 æ ¸å¿ƒé›†ç¾¤ä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;18918.941000 ms&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;18864.766000 ms&lt;/strong&gt; ï¼ŒåŠ é€Ÿæ¯”çº¦ä¸º &lt;strong&gt;33x&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;h3 id=&#34;o3--simd&#34;&gt;O3 &amp;amp;&amp;amp; SIMD&lt;/h3&gt;
&lt;p&gt;ä¹‹å‰ä½¿ç”¨çš„ç¼–è¯‘å‚æ•°éƒ½æ˜¯ &lt;code&gt;-O0&lt;/code&gt; ç°åœ¨æ”¹æˆ &lt;code&gt;-O3&lt;/code&gt; ï¼Œå¤§é‡çš„æ•´æ•°è¿ç®—æ“ä½œå¯ä»¥å‘é‡åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬åœ°çš„ 64 æ ¸å¿ƒé›†ç¾¤ä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;10292.194000 ms&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;15419.145000 ms&lt;/strong&gt; ï¼ŒåŠ é€Ÿæ¯”çº¦ä¸º &lt;strong&gt;41x&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°æœ¬åœ°é›†ç¾¤å’Œäº‘è®¡ç®—ä¸­å¿ƒé›†ç¾¤æœºå™¨æ€§èƒ½çš„å·®åˆ«ï¼Œæœ¬åœ°é›†ç¾¤å•æ ¸æ€§èƒ½å¼±äºè®¡ç®—ä¸­å¿ƒï¼ˆä½“ç°åœ¨ baseline æœ¬åœ°è·‘äº†æ›´ä¹…ï¼‰ï¼Œä½†æ˜¯è®¡ç®—ä¸­å¿ƒçš„æ ¸å¿ƒå°‘äºæœ¬åœ°ï¼Œå› æ­¤ä½¿ç”¨ openmp çš„æƒ…å†µä¸‹æœ¬åœ°åŠ é€Ÿæ›´æ˜æ˜¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;æ”¹å˜æ•°æ®ç±»å‹&#34;&gt;æ”¹å˜æ•°æ®ç±»å‹&lt;/h3&gt;
&lt;p&gt;ç”±äºåœ¨ä¹å®«æ ¼ä¸­çš„è®¡ç®—ç»“æœåœ¨ 0-9 ä¹‹é—´ï¼Œå› æ­¤ä¸éœ€è¦å¾ˆå®½çš„æ•°æ®ç±»å‹æ¥å­˜å‚¨ï¼Œè€Œä¸”ä¹Ÿä¸éœ€è¦è€ƒè™‘è´Ÿæ•°ï¼Œå› æ­¤æˆ‘ä½¿ç”¨äº† &lt;code&gt;uint8_t&lt;/code&gt; ç±»å‹æ¥æ›¿æ¢ &lt;code&gt;int&lt;/code&gt; ï¼Œè¿™æ ·æ“ä½œä¹‹ååŠ é€Ÿæ¯”åˆæé«˜äº†ä¸å°‘ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬åœ°çš„ 64 æ ¸å¿ƒé›†ç¾¤ä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;3004.615000 ms&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;3858.775000 ms&lt;/strong&gt; ï¼ŒåŠ é€Ÿæ¯”çº¦ä¸º &lt;strong&gt;164x&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å»æ‰ä¸å¿…è¦çš„æ‹·è´&#34;&gt;å»æ‰ä¸å¿…è¦çš„æ‹·è´&lt;/h3&gt;
&lt;p&gt;æœ€åå†çœ‹çœ‹è‡ªå·±çš„ä»£ç ï¼Œå‘ç°å¾ˆå¤šç»†èŠ‚è¿˜å¯ä»¥å¤„ç†ã€‚ä¾‹å¦‚æ•°æ®çš„æ‹·è´ï¼Œä¸ºäº†è®¡ç®—ä¸ç›¸é‚»ä¸¤è¡Œçš„å’Œï¼Œæˆ‘æ–°å¢äº†ä¸€ä¸ªæ•°ç»„ï¼Œç”±äºè¿™ä¸ªæ•°ç»„å¯ä»¥å­˜å‚¨ä¸­é—´è¿‡ç¨‹ï¼Œæˆ‘å¯ä»¥å»æ‰ &lt;code&gt;tmp&lt;/code&gt; æ•°ç»„ï¼Œç›´æ¥å¯¹ &lt;code&gt;a&lt;/code&gt; æ•°ç»„è¿›è¡Œæ“ä½œï¼Œè¿™æ ·å‡å°‘äº† &lt;code&gt;memcpy&lt;/code&gt; çš„å¼€é”€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å°æ’æ›²ï¼šbaseline å¯¹è¾¹ç¼˜çš„å¤„ç†éå¸¸å·®ï¼Œå¯¼è‡´ç¬¬ä¸€æ¬¡è¿­ä»£(iter=0)æ—¶éœ€è¦å°† &lt;code&gt;a&lt;/code&gt; æ•°ç»„çš„è¾¹ç¼˜å…¨éƒ¨ç½®ä¸º 0&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿˜æœ‰å°±æ˜¯åœ¨ä¸€å¼€å§‹å°† &lt;code&gt;a&lt;/code&gt; æ•°ç»„æ‹·è´åˆ° &lt;code&gt;sum&lt;/code&gt; æ•°ç»„ï¼Œè¿™ä¸ªå…¶å®ä¹Ÿå¯ä»¥å¸¦åˆ°ç¬¬ä¸€æ¬¡çš„å¾ªç¯ä¸­è¿›è¡Œï¼Œè¿™å¯¹è®¿å­˜æ²¡æœ‰ä»€ä¹ˆå‰¯ä½œç”¨ï¼Œè€Œä¸”å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æœ€åçš„ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; iter = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; iter &amp;lt; max_iter; ++iter) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel for proc_bind(spread)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; j &amp;lt; Nx - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum[i][j] += a[i + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum[i][j] += a[i][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum[i][j] += a[i - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel for proc_bind(spread)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; j &amp;lt; Nx - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; neighbors = sum[i][j] + sum[i][j - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;] + sum[i][j + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;] - a[i][j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (neighbors == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          a[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (neighbors &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; || neighbors &amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          a[i][j] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (iter == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      memset(a[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;], &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(a[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      memset(a[Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(a[Ny - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; Ny; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        a[i][Nx - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        a[i][&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æœ¬åœ°çš„ 64 æ ¸å¿ƒé›†ç¾¤ä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;247.119000 ms&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬åœ°ç”±äºå•æ ¸å¼±è€Œæ ¸æ•°å¤šï¼Œè·‘åˆ° 3000x æ²¡ä»€ä¹ˆé¸Ÿç”¨ï¼Œä¸å…·å¤‡å‚è€ƒä»·å€¼ğŸ˜­&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨åŒ—äº¬è¶…çº§äº‘è®¡ç®—ä¸­å¿ƒä¸Šè¿è¡Œæ—¶é—´ä¸º &lt;strong&gt;318.769000 ms&lt;/strong&gt; ï¼ŒåŠ é€Ÿæ¯”çº¦ä¸º &lt;strong&gt;1990x&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰æ‰“é«˜æ€§èƒ½æ¯”èµ›éƒ½æ˜¯ç»„é˜Ÿå‚åŠ ï¼Œæ€»æ˜¯éœ€è¦å¤§ä½¬çš„æŒ‡å¯¼å’Œå®‰æ’ä»»åŠ¡ï¼Œè¿™æ¬¡ä¸ªäººèµ›æš´éœ²äº†å¾ˆå¤šä¸è¶³ï¼Œå®Œå…¨æ²¡æœ‰å‘æŒ¥å‡ºæœºå™¨çš„å…¨éƒ¨æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ä¸è¿‡å¾€å¥½å¤„æƒ³ï¼Œæ•´ä½“çš„ä¼˜åŒ–æ€è·¯æ˜¯çŸ­æ—¶é—´å†…å°±æƒ³å‡ºæ¥äº†çš„ï¼Œéƒ½æ€ªæ„šè ¢çš„ baseline ï¼Œæˆ‘èŠ±äº†å¾ˆå¤šæ—¶é—´åœ¨è§£å†³æ­£ç¡®æ€§çš„é—®é¢˜ã€‚&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡æ¯”èµ›æ²¡æœ‰æœºä¼šå°è¯•ä½¿ç”¨ MPI ï¼Œæœ‰æ—¶é—´çš„è¯ç”¨ MPI ç»§ç»­åšåšè¿™é“é¢˜ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æ•°æ®åº“å¤ä¹ ä¹‹å…³ç³»ä»£æ•°</title>
      <link>https://vaaandark.top/posts/review-for-database-on-relation-algebra/</link>
      <pubDate>Mon, 19 Jun 2023 16:19:07 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/review-for-database-on-relation-algebra/</guid>
      <description>&lt;h1 id=&#34;å…³ç³»ä»£æ•°&#34;&gt;å…³ç³»ä»£æ•°&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0_(%E6%95%B0%E6%8D%AE%E5%BA%93)&#34;&gt;å…³ç³»ä»£æ•°ï¼ˆæ•°æ®åº“ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®¡ç®—æœºç§‘å­¦å®¶ Codd å¯¹å…³ç³»ä»£æ•°çš„å½¢æˆä½œå‡ºäº†å¾ˆå¤§çš„è´¡çŒ®ï¼Œä»–çš„ä»£æ•°çš„å…­ä¸ªåŸå§‹è¿ç®—æ˜¯ã€Œé€‰æ‹©ã€ã€ã€ŒæŠ•å½±ã€ã€ã€Œç¬›å¡å°”ç§¯ã€ã€ã€Œå¹¶é›†ã€ã€ã€Œå·®é›†ã€ã€ã€Œé‡å‘½åã€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;select&#34;&gt;Select&lt;/h2&gt;
&lt;p&gt;ç›¸å½“äº sql ä¸­ &lt;code&gt;where&lt;/code&gt; çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;$$
\sigma_{verb}(relationship)
$$&lt;/p&gt;
&lt;p&gt;é€‰æ‹©è°“è¯ä¸€èˆ¬æ˜¯é€»è¾‘è¡¨è¾¾å¼ï¼Œå¯ä»¥æ˜¯è¿è¯è¿æ¥ï¼ˆä¹Ÿå¯ä»¥æ²¡æœ‰è¿è¯ï¼‰çš„å¤šä¸ªæ¯”è¾ƒè¯­å¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;projection&#34;&gt;Projection&lt;/h2&gt;
&lt;p&gt;ç›¸å½“äº sql ä¸­ &lt;code&gt;select&lt;/code&gt; çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;$$
\Pi_{fields}(relationship)
$$&lt;/p&gt;
&lt;p&gt;ä»å…³ç³»ä¸­é€‰å‡ºè‹¥å¹²å±æ€§åˆ—ç»„æˆæ–°çš„å…³ç³»ï¼Œåœ¨è¿™ç§é€‰æ‹©è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡å°‘ä¸€äº›åˆ—ï¼ˆæ²¡æœ‰è¢«é€‰ä¸­æˆ–è€…å‡ºç°äº†é‡å¤ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;join&#34;&gt;Join&lt;/h2&gt;
&lt;p&gt;è¿æ¥å¯ä»¥åˆ†ä¸ºè‡ªç„¶è¿æ¥ã€ç­‰å€¼è¿æ¥ã€å¤–è¿æ¥ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ç­‰å€¼è¿æ¥ï¼Œä»å…³ç³» R å’Œ S çš„å¹¿ä¹‰ç¬›å¡å°”ç§¯ä¸­é€‰å– A ã€B å±æ€§å€¼ç›¸ç­‰çš„é‚£äº›å…ƒç»„ï¼Œä¸€èˆ¬å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;$$
R\bowtie_{A=B}S
$$&lt;/p&gt;
&lt;p&gt;è‡ªç„¶è¿æ¥ï¼Œ è¿æ¥æ—¶ä¸¤ä¸ªå…³ç³»ä¸­æ¯”è¾ƒçš„åˆ†é‡å¿…é¡»æ˜¯åŒåçš„å±æ€§ç»„ï¼Œå¹¶åœ¨ç»“æœä¸­æŠŠé‡å¤çš„å±æ€§åˆ—å»æ‰ã€‚ä¸€èˆ¬å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;$$
R\bowtie{S}
$$&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;join&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/join.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;è‡ªç„¶è¿æ¥æ—¶ä¼šå‡ºç° R ä¸­çš„æŸäº›å…ƒç»„åœ¨ S ä¸­ä¸å­˜åœ¨å…¬å…±å±æ€§ä¸Šå€¼ç›¸ç­‰çš„å…ƒç»„ï¼Œæ‰€ä»¥å‡ºç°äº†ã€Œæ‚¬æµ®å…ƒç»„ã€ï¼Œå¦‚æœä¿ç•™å®ƒä»¬ï¼ŒæœªçŸ¥çš„å±æ€§å¡«ä¸Š NULL ï¼Œè¿™å°±æ˜¯ã€Œå¤–è¿æ¥ã€ã€‚å¦‚æœåªä¿ç•™å·¦è¾¹å…³ç³»ä¸­çš„æ‚¬æµ®å…ƒç»„å°±æ˜¯ã€Œå·¦å¤–è¿æ¥ã€ï¼Œåä¹‹å°±æ˜¯ã€Œå³å¤–è¿æ¥ã€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;divsion&#34;&gt;Divsion&lt;/h2&gt;
&lt;p&gt;å…¶ç»“æœç”± R ä¸­å…ƒç»„åˆ°å”¯ä¸€äº R çš„å±æ€§åå­—ï¼ˆå°±æ˜¯è¯´åªåœ¨ R è¡¨å¤´ä¸­è€Œä¸åœ¨ S è¡¨å¤´ä¸­çš„å±æ€§ï¼‰çš„é™åˆ¶æ„æˆï¼Œå¹¶ä¸”å®ƒä»¬ä¸ S ä¸­çš„å…ƒç»„çš„æ‰€æœ‰ç»„åˆéƒ½å­˜åœ¨äº R ä¸­ã€‚ä¸€èˆ¬å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;$$
R\div{S}
$$&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;divsion&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/divsion.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;rename&#34;&gt;Rename&lt;/h2&gt;
&lt;p&gt;ä¸€èˆ¬å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;$$
\rho_{a/b}(R)
$$&lt;/p&gt;
&lt;p&gt;æŠŠæ‰€æœ‰å…ƒç»„ä¸­çš„ b å­—æ®µæ”¹æˆ a å­—æ®µã€‚ç›¸å½“äº sql ä¸­çš„ &lt;code&gt;as&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;PS:&lt;/p&gt;
&lt;p&gt;å…³ç³»çš„å®Œæ•´æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®ä½“å®Œæ•´æ€§ï¼ˆä¸»ç ä¸èƒ½ä¸ºç©ºï¼‰&lt;/li&gt;
&lt;li&gt;å‚ç…§å®Œæ•´æ€§ï¼ˆå¤–ç è¦ä¹ˆä¸ºç©ºè¦ä¹ˆå­˜åœ¨äºå‚ç…§å…³ç³»ä¸­ï¼‰&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·å®šä¹‰å®Œæ•´æ€§ï¼ˆè¦éµç…§ç”¨æˆ·çš„å®šä¹‰ï¼Œä¾‹å¦‚äººæ•°ä¸èƒ½ä¸ºå°æ•°ç­‰ï¼‰&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>CPU æµæ°´çº¿</title>
      <link>https://vaaandark.top/posts/cpu-pipeline/</link>
      <pubDate>Sat, 22 Apr 2023 17:29:49 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/cpu-pipeline/</guid>
      <description>&lt;h1 id=&#34;æµæ°´çº¿çº§&#34;&gt;æµæ°´çº¿çº§&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€æ¡æµæ°´çº¿çš„æ¯ä¸ªåˆ†æ­¥éª¤è¢«ç§°ä¸ºæµæ°´çº¿çº§ã€‚å®ƒä»¬è¢«æµæ°´çº¿å¯„å­˜å™¨åˆ†å¼€ã€‚ä¸‹æ–‡ä¸­æ²¡æœ‰è¯´æ˜æ˜¯æµæ°´çº¿å¯„å­˜å™¨çš„éƒ½æ˜¯æ™®é€š CPU å¯„å­˜å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ç°ä»£è®¡ç®—æœºæµæ°´çº¿çº§æ•°å·²ç»è¾¾åˆ°äº† 10-20 çº§ï¼Œåœ¨ 2000-2010 å¹´é—´ï¼Œæµæ°´çº¿çº§æ•°çš„ç«èµ›è¾¾åˆ°äº†æœ€é«˜å³°ï¼Œé‚£æ—¶å€™çš„å¤„ç†å™¨ç”šè‡³å¯ä»¥æœ‰é«˜è¾¾ 31 çº§çš„æµæ°´çº¿ã€‚ä½†æ˜¯è¶…æ·±çš„æµæ°´çº¿å¸¦æ¥çš„æ˜¯ç»“æ„ä¸Šçš„å¤æ‚å’Œæ˜¾è‘—å¢å¤§çš„åŠ¨æ€è°ƒåº¦æ¨¡å—è®¾è®¡éš¾åº¦ï¼Œå› æ­¤ï¼Œä»é‚£ä»¥åå°±æ²¡æœ‰å†å‡ºç°è¿‡ä½¿ç”¨è¿™ä¹ˆå¤šçº§æµæ°´çº¿çš„ CPU äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªæ˜¯ç¨å¾®ä»‹ç»ï¼ˆæˆ–è€…è¯´æ˜¯ä¸ºå·²ç»çŸ¥é“çš„åŒå­¦å‰æƒ…å›é¡¾ï¼‰ä¸€ä¸‹æœ€åŸºç¡€çš„ CPU æµæ°´çº¿ï¼Œå®ƒæœ‰åŠ©äºæˆ‘ä»¬ç†è§£æ›´ä¸ºå¤æ‚çš„æµæ°´çº¿å®ç°ã€‚åŒæ—¶ï¼Œè¿™ä¸ªæœ€åŸºç¡€çš„ CPU æµæ°´çº¿å¹¶ä¸åŸºäºæŸä¸€æ¶æ„ï¼Œå› æ­¤å¹¶ä¸ä¼šæ¶‰åŠæ“ä½œæ•°çš„æ•°é‡ã€å¯¹ç«‹å³æ•°çš„æ“ä½œç­‰ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å–æŒ‡instruction-fetch&#34;&gt;å–æŒ‡(Instruction Fetch)&lt;/h2&gt;
&lt;p&gt;ä»å†…å­˜ä¸­è·å–æŒ‡ä»¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªå‘¨æœŸä»æŒ‡ä»¤ç¼“å­˜ä¸­å–ä¸€æ¡æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;å°†çŠ¶æ€å†™å…¥æµæ°´çº¿å¯„å­˜å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è¯‘ç instruction-decode&#34;&gt;è¯‘ç (Instruction Decode)&lt;/h2&gt;
&lt;p&gt;è¯»å–å¯„å­˜å™¨å¹¶è§£ç æŒ‡ä»¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è§£ç æ“ä½œæ•°ï¼Œä¸ºåç»­é˜¶æ®µè®¾ç½®ä¸åŒæ ‡å¿—&lt;/li&gt;
&lt;li&gt;ä»å¯„å­˜å™¨æ–‡ä»¶ä¸­è¯»å–è¾“å…¥æ“ä½œæ•°ï¼Œç”±æ‰€éœ€æ“ä½œæ•°æˆ–æŒ‡ä»¤æŒ‡å®šï¼ˆä¾‹å¦‚ push éšå«äº†å¯¹æ ˆé¡¶å¯„å­˜å™¨çš„æ“ä½œï¼‰&lt;/li&gt;
&lt;li&gt;å°†çŠ¶æ€å†™å…¥æµæ°´çº¿å¯„å­˜å™¨ï¼ˆä¾‹å¦‚æ“ä½œæ•°ã€å¯„å­˜å™¨å†…å®¹ã€ç«‹å³æ•°ç­‰ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ‰§è¡Œexecute&#34;&gt;æ‰§è¡Œ(Execute)&lt;/h2&gt;
&lt;p&gt;æ‰§è¡ŒæŒ‡ä»¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œ ALU è¿ç®—ï¼Œè®¡ç®—æŒ‡ä»¤ç»“æœ&lt;/li&gt;
&lt;li&gt;å°†çŠ¶æ€å†™å…¥æµæ°´çº¿å¯„å­˜å™¨ï¼ˆä¾‹å¦‚ ALU è®¡ç®—ç»“æœç­‰ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è®¿å­˜memory-access&#34;&gt;è®¿å­˜(Memory Access)&lt;/h2&gt;
&lt;p&gt;è®¿é—®å†…å­˜&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œæ•°æ®ç¼“å­˜è®¿é—®&lt;/li&gt;
&lt;li&gt;å°†çŠ¶æ€å†™å…¥æµæ°´çº¿å¯„å­˜å™¨ï¼ˆä¾‹å¦‚ä¸Šä¸€æ­¥å¾—åˆ°çš„ ALU è®¡ç®—ç»“æœå’Œè¿™ä¸€æ­¥è·å¾—çš„æ•°æ®ç­‰ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å†™å›write-back&#34;&gt;å†™å›(Write-Back)&lt;/h2&gt;
&lt;p&gt;å°†ç»“æœå†™å…¥å¯„å­˜å™¨ï¼ˆå¦‚æœè¯¥æŒ‡ä»¤éœ€è¦è¿™ä¹ˆåšçš„è¯ï¼‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°†åŠ è½½çš„æ•°æ®å†™å…¥ç›®æ ‡å¯„å­˜å™¨&lt;/li&gt;
&lt;li&gt;å°† ALU è®¡ç®—ç»“æœå†™å…¥ç›®æ ‡å¯„å­˜å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;è®¾è®¡å’Œå®ç°çš„é—®é¢˜&#34;&gt;è®¾è®¡å’Œå®ç°çš„é—®é¢˜&lt;/h1&gt;
&lt;h2 id=&#34;å†’é™©hazard&#34;&gt;å†’é™©(Hazard)&lt;/h2&gt;
&lt;p&gt;åœ¨æµæ°´çº¿ä¸­æˆ‘ä»¬å¸Œæœ›å½“å‰æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸéƒ½æœ‰ä¸€æ¡æŒ‡ä»¤è¿›å…¥æµæ°´çº¿å¯ä»¥æ‰§è¡Œã€‚ä½†&lt;strong&gt;åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤æ— æ³•æŒ‰ç…§é¢„æœŸå¼€å§‹æ‰§è¡Œï¼Œè¿™ç§æƒ…å†µå°±è¢«ç§°ä¸ºå†’é™©&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ•°æ®å†’é™©&#34;&gt;æ•°æ®å†’é™©&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ä¸€æ¡æŒ‡ä»¤éœ€è¦æŸæ•°æ®è€Œè¯¥æ•°æ®æ­£åœ¨è¢«ä¹‹å‰çš„æŒ‡ä»¤æ“ä½œ&lt;/strong&gt;ï¼Œè¿™æ¡æŒ‡ä»¤å°±æ— æ³•æ‰§è¡Œã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-asm&#34; data-lang=&#34;asm&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mov eax, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;add ebx, eax
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡è®¾ CPU  ä¸ç®¡ä»»ä½•æ•°æ®å†’é™©ã€‚é‚£ä¹ˆå½“æŒ‡ä»¤ &lt;code&gt;add ebx, eax&lt;/code&gt; æ¥åˆ°è¯‘ç é˜¶æ®µæ—¶ï¼Œå®ƒçš„ä¸Šä¸€æ¡æŒ‡ä»¤ï¼Œ&lt;code&gt;mov eax, 1&lt;/code&gt; ï¼Œè¿˜å¤„åœ¨æ‰§è¡Œé˜¶æ®µä¸­ã€‚æ­¤æ—¶ &lt;code&gt;mov  eax, 1&lt;/code&gt; è¿˜æ²¡æœ‰å°†ç«‹å³æ•°å†™å…¥ CPU å¯„å­˜å™¨ï¼Œå› æ­¤ &lt;code&gt;add ebx, eax&lt;/code&gt; æ— æ³•è¯»å–åˆ°æ­£ç¡®çš„ &lt;code&gt;eax&lt;/code&gt; å†…å®¹ã€‚è¿™æ—¶å°±å‡ºç°äº†æ•°æ®å†’é™©ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ§åˆ¶å†’é™©&#34;&gt;æ§åˆ¶å†’é™©&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å½“å‰åº”è¯¥æ‰§è¡Œçš„æŒ‡ä»¤éœ€è¦ä¹‹å‰çš„æŒ‡ä»¤è¿è¡Œç»“æœæ¥å†³å®š&lt;/strong&gt;ï¼Œè¿™æ¡æŒ‡ä»¤å°±æ— æ³•æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå½“éœ€è¦å½“å‰æŒ‡ä»¤è¿›å…¥æµæ°´çº¿æ—¶ï¼Œä¸Šä¸€æ¡æŒ‡ä»¤ &lt;code&gt;je l1&lt;/code&gt; å°šæœªé€šè¿‡è¯‘ç é˜¶æ®µï¼Œå°šæœªè¯»å–æ¡ä»¶ç å¯„å­˜å™¨ï¼Œä¸èƒ½ç¡®å®šä¸‹ä¸€æ¡æ‰§è¡Œçš„æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç»“æ„å†’é™©&#34;&gt;ç»“æ„å†’é™©&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ä¸€æ¡æŒ‡ä»¤éœ€è¦çš„ç¡¬ä»¶éƒ¨ä»¶è¿˜åœ¨ä¸ºä¹‹å‰çš„æŒ‡ä»¤å·¥ä½œ&lt;/strong&gt;ï¼Œè¿™æ¡æŒ‡ä»¤å°±æ— æ³•æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚æœæŒ‡ä»¤å’Œæ•°æ®æ”¾åœ¨åŒä¸€ä¸ªå­˜å‚¨å™¨ä¸­ï¼Œåˆ™ä¸èƒ½åŒæ—¶è¯»å­˜å‚¨å™¨ï¼ˆä¸€æ¡æŒ‡ä»¤æ­£åœ¨ä»å†…å­˜ä¸­å–æŒ‡ä»¤ï¼Œå¦ä¸€æ¡æ­£åœ¨è®¿å­˜ï¼‰ã€‚å®é™…ä¸Šï¼Œè™½ç„¶å†¯è¯ºä¾æ›¼ç»“æ„ä¸åŒºåˆ†æŒ‡ä»¤å’Œæ•°æ®ï¼Œä½†æ˜¯åœ¨ç°ä»£ CPU çš„ä¸€çº§é«˜é€Ÿç¼“å­˜(L1 cache)ä¸Šï¼Œå…¶å®åŒºåˆ†äº†æŒ‡ä»¤(icache)å’Œæ•°æ®(dcache)ã€‚&lt;/p&gt;
&lt;p&gt;åˆä¾‹å¦‚ï¼Œè¯»å¯„å­˜å™¨å’Œå†™å¯„å­˜å™¨åŒæ—¶å‘ç”Ÿï¼ˆä¸€æ¡æŒ‡ä»¤æ­£åœ¨å†™å›ï¼Œå¦ä¸€æ¡æ­£åœ¨è¯‘ç ï¼‰ã€‚å¯ä»¥é€šè¿‡å‰åŠä¸ªå‘¨æœŸå†™ï¼ŒååŠä¸ªå‘¨æœŸè¯»ï¼Œå¹¶ä¸”è®¾ç½®ç‹¬ç«‹çš„è¯»å†™ç«¯å£çš„æ–¹å¼æ¥è§£å†³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è§£å†³&#34;&gt;è§£å†³&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;è§£å†³å†’é™©é—®é¢˜ï¼Œå¾ˆå¤šæ—¶å€™é‡‡å–çš„æ˜¯ç»™ CPU å¢åŠ æ›´å¤šçš„æ”¯è·¯å°†ä¸åŒæµæ°´çº¿é˜¶æ®µè¿æ¥èµ·æ¥çš„æ–¹æ³•ï¼Œä½†æ˜¯ç”±äºä¸èƒ½å°†æœªæ¥çš„æ•°æ®ä¼ é€’åˆ°è¿‡å»ï¼Œæ‰€ä»¥é™¤äº†ã€Œè½¬å‘ã€æ“ä½œè¿˜ä¸å¾—ä¸ä½¿ç”¨ã€Œæš‚åœã€æ“ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;è½¬å‘forwarding&#34;&gt;è½¬å‘(Forwarding)&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;è½¬å‘æœ‰æ—¶åˆå«æ—è·¯(Bypassing)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å°†ç»“æœå€¼ç›´æ¥ä»ä¸€ä¸ªæµæ°´çº¿é˜¶æ®µä¼ åˆ°è¾ƒæ—©é˜¶æ®µ&lt;/strong&gt;çš„æŠ€æœ¯å°±æ˜¯æ•°æ®è½¬å‘ã€‚æ•°æ®è½¬å‘éœ€è¦åœ¨åŸºæœ¬çš„ç¡¬ä»¶ç»“æ„ä¸­å¢åŠ ä¸€äº›é¢å¤–çš„æ•°æ®è¿æ¥å’Œæ§åˆ¶é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;æ•°æ®ä¾èµ–&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/reg-dep.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ•°æ®ä¾èµ–å¯¼è‡´äº†æ•°æ®å†’é™©ï¼Œç®­å¤´è¡¨ç¤ºä¾èµ–å…³ç³»ï¼Œçº¢è‰²ç®­å¤´è¡¨ç¤ºæ‰€ä¾èµ–çš„æ•°æ®æ­¤æ—¶å°šæœªå†™å›ï¼Œé»‘è‰²æ•°æ®è¡¨ç¤ºæ‰€ä¾èµ–æ•°æ®æ­¤æ—¶å·²ç»å†™å›ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºçº¢è‰²ç®­å¤´ï¼Œå½“ &lt;code&gt;and&lt;/code&gt; å’Œ &lt;code&gt;or&lt;/code&gt; å¤„äºè¯‘ç é˜¶æ®µï¼Œéœ€è¦è¯»å–å¯„å­˜å™¨æ–‡ä»¶æ—¶ï¼ŒCPU èƒ½å‘ç°åœ¨ä¹‹å‰çš„ &lt;code&gt;sub&lt;/code&gt; æŒ‡ä»¤ä¸­è¿˜æœ‰æ²¡æœ‰å®Œæˆçš„å¯„å­˜å™¨å†™æ“ä½œï¼Œç„¶åé€šè¿‡æ•°æ®è½¬å‘ç›´æ¥è·å¾— &lt;code&gt;$2&lt;/code&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æš‚åœstall--bubble&#34;&gt;æš‚åœ(Stall &amp;amp; Bubble)&lt;/h3&gt;
&lt;p&gt;æš‚åœæ—¶ï¼Œå¤„ç†å™¨ä¼š&lt;strong&gt;åœæ­¢æµæ°´çº¿çš„ä¸€æ¡æˆ–å¤šæ¡æŒ‡ä»¤ï¼Œç›´åˆ°å†’é™©æ¡ä»¶ä¸å†æ»¡è¶³&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;æ— æ³•è½¬å‘&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/cannot-forward.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œ&lt;code&gt;lw $2 20($3)&lt;/code&gt; å°†å†…å­˜ä¸­çš„æ•°æ®åŠ è½½åˆ°å¯„å­˜å™¨ &lt;code&gt;$2&lt;/code&gt; ä¸­ï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤ä½¿ç”¨äº† &lt;code&gt;$2&lt;/code&gt; çš„å€¼ï¼Œå› æ­¤äº§ç”Ÿäº†æ•°æ®å†’é™©ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå¯„å­˜å™¨çš„å€¼æœ€æ—©ä¹Ÿè¦åœ¨è®¿å­˜é˜¶æ®µè·å¾—ï¼Œå› æ­¤ &lt;code&gt;and&lt;/code&gt; æŒ‡ä»¤æ— æ³•é€šè¿‡æ•°æ®è½¬å‘çš„æ–¹å¼è·å¾— &lt;code&gt;$2&lt;/code&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶å°±ä¸å¾—ä¸ä½¿ç”¨æš‚åœçš„æ–¹æ³•æ¥å¤„ç†å†’é™©äº†ã€‚åœ¨è¿™é‡Œå¤„ç†å™¨è¦æš‚åœå·²ç»è¿›å…¥æµæ°´çº¿çš„ &lt;code&gt;lw&lt;/code&gt; ä»¥åçš„æ‰€æœ‰æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;bubble&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/bubble.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç‰¹åˆ«éœ€è¦æé†’çš„æ˜¯ï¼Œæš‚åœè™½ç„¶å’ŒæŒ‡ä»¤ &lt;code&gt;nop&lt;/code&gt; æœ‰ç›¸åŒä¹‹å¤„ï¼Œä½†å…¶æœ¬è´¨æ˜¯å¤„ç†å™¨å†…éƒ¨å¤„ç†æ•°æ®å†’é™©æ—¶è‡ªåŠ¨æ·»åŠ çš„ï¼Œè€Œä¸æ˜¯ç”±ç¼–è¯‘å™¨äº§ç”Ÿçš„ã€‚å¦‚æœéœ€è¦ç¼–è¯‘å™¨äº§ç”Ÿ &lt;code&gt;nop&lt;/code&gt; æŒ‡ä»¤æ¥æš‚åœï¼Œé‚£ä»£ç å°†ä¸èƒ½åœ¨ç›¸åŒå¹³å°çš„ä¸åŒæµæ°´çº¿çº§æ•°çš„å¤„ç†å™¨ä¸Šé€šç”¨ï¼ˆæ¯”å¦‚æœ‰çš„éœ€è¦ 7 ä¸ª &lt;code&gt;nop&lt;/code&gt; æŒ‡ä»¤èƒ½ç­‰å¾…åˆ°å†’é™©æ¡ä»¶ä¸æ»¡è¶³ï¼Œæœ‰çš„éœ€è¦ 9 ä¸ª &lt;code&gt;nop&lt;/code&gt; æŒ‡ä»¤ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆ†æ”¯é¢„æµ‹&#34;&gt;åˆ†æ”¯é¢„æµ‹&lt;/h3&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¦é¢„æµ‹åˆ†æ”¯ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬ä¸é¢„æµ‹åˆ†æ”¯ï¼Œæ¯å½“æˆ‘ä»¬é‡åˆ°æ§åˆ¶å†’é™©æ—¶éƒ½é‡‡ç”¨æš‚åœçš„æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ç­‰å¾…ä¸€æ¡æŒ‡ä»¤å®Œæˆæ‰§è¡Œé˜¶æ®µå†å¯¹ä¸‹ä¸€æ¡å–æŒ‡ã€‚åœ¨å‰æ–‡çš„äº”æ®µæµæ°´çº¿ CPU ä¸­ï¼Œè¿™ä¼šæµªè´¹ä¸¤ä¸ªå‘¨æœŸã€‚&lt;/p&gt;
&lt;p&gt;è€Œå½“æˆ‘ä»¬é¢„æµ‹åˆ†æ”¯æ—¶ï¼Œå½“æˆ‘ä»¬è¿›å…¥äº†é”™è¯¯çš„åˆ†æ”¯æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æŠ›å¼ƒå·²ç»è¿è¡Œçš„ç»“æœé‡æ–°å–æŒ‡ï¼ˆä¸€èˆ¬å« flushï¼‰ï¼Œè¿™æ ·ä¹Ÿæ˜¯æµªè´¹ä¸¤ä¸ªå‘¨æœŸã€‚ä½†æ˜¯åªè¦æˆ‘ä»¬é¢„æµ‹æ­£ç¡®ä¸€æ¬¡ï¼Œé‚£å°±å¿…ç„¶æ¯”æš‚åœçš„æ–¹æ³•å¿«ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰æ‰€æœ‰çš„ CPU éƒ½é‡‡ç”¨äº†åˆ†æ”¯é¢„æµ‹çš„æ–¹æ³•æ¥å¤„ç†æ§åˆ¶å†’é™©ï¼Œç°ä»£ CPU çš„åˆ†æ”¯é¢„æµ‹å‡†ç¡®ç‡å¯ä»¥è¾¾åˆ° 90% ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CS246 Finding Similar Items: Locality Sensitive Hashing</title>
      <link>https://vaaandark.top/posts/cs246-finding-similar-itemslocality-sensitive-hashing/</link>
      <pubDate>Wed, 15 Mar 2023 16:44:34 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/cs246-finding-similar-itemslocality-sensitive-hashing/</guid>
      <description>&lt;p&gt;æœ€è¿‘åœ¨ä¸Šå¤§æ•°æ®åˆ†æçš„è¯¾ç¨‹ï¼Œè€å¸ˆä½¿ç”¨çš„æ˜¯æ–¯å¦ç¦å¤§å­¦çš„æ•™æå’Œ PPT ï¼Œæ„Ÿè§‰æŒºæœ‰è¶£çš„ï¼Œè®°å½•ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›ç®—æ³•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;èƒŒæ™¯&#34;&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;å¾ˆå¤šé—®é¢˜å¯ä»¥è¢«å½’åŒ–ä¸ºå¯»æ‰¾ç›¸ä¼¼é›†åˆçš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®ºæ–‡å·®é‡&lt;/li&gt;
&lt;li&gt;å¯»æ‰¾è´­ä¹°ç›¸ä¼¼å•†å“çš„äººç¾¤&lt;/li&gt;
&lt;li&gt;å¯»æ‰¾æœ‰ç›¸ä¼¼ç‰¹å¾çš„å›¾ç‰‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸å¦¨å°†è¿™æ¬¡çš„ç›®çš„è®¾ç½®ä¸ºï¼š&lt;strong&gt;ç»™å®šå¤§é‡çš„æ–‡æ¡£ï¼Œå‘ç°å…¶ä¸­æœ‰æŠ„è¢­å«Œç–‘çš„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½†é—®é¢˜æ˜¯ï¼Œä¸€ä¸ªé›†åˆä¸­çš„å…ƒç´ éå¸¸å¤šï¼Œå¦‚æœè¦ç›´æ¥æ¯”å¯¹ï¼Œå…¶å¤æ‚åº¦å¯ä»¥è¾¾åˆ° $O(N^2)$ ï¼Œè¿™åœ¨å¤§æ•°æ®å°ºåº¦æ˜æ˜¾æ˜¯ä¸èƒ½æ¥å—çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‰ç½®çŸ¥è¯†&#34;&gt;å‰ç½®çŸ¥è¯†&lt;/h2&gt;
&lt;p&gt;æ•°æ®ä¹‹é—´çš„è·ç¦»ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥è¯´æ˜¯ç”¨æ•°æ®ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œä¸€èˆ¬è·ç¦»è¶Šè¿œï¼Œç›¸ä¼¼åº¦è¶Šä½&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å‘é‡çš„æ€æƒ³ï¼šä½¿ç”¨è§’åº¦åº¦é‡&lt;/li&gt;
&lt;li&gt;é›†åˆçš„æ€æƒ³ï¼šä½¿ç”¨é›…å¡å°”è·ç¦»åº¦é‡&lt;/li&gt;
&lt;li&gt;ç‚¹çš„æ€æƒ³ï¼šä½¿ç”¨æ¬§æ°è·ç¦»åº¦é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;é›…å¡å°”æŒ‡æ•°&lt;/strong&gt;å¯ä»¥åº¦é‡æœ‰é™æ ·æœ¬é›†åˆçš„ç›¸ä¼¼åº¦ï¼Œå®šä¹‰ä¸ºä¸¤ä¸ªé›†åˆäº¤é›†å¤§å°å’Œå¹¶é›†å¤§å°ä¹‹æ¯”ï¼š&lt;/p&gt;
&lt;p&gt;$$
J(A, B) = \frac{\lvert A \cap B\rvert}{\lvert B \cup A\rvert} = \frac{\lvert A \cap B\rvert}{\lvert A \rvert + \lvert B \rvert - \lvert A \cap B \rvert}
$$&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é›…å¡å°”è·ç¦»&lt;/strong&gt;ç”¨äºåº¦é‡æ ·æœ¬é›†ä¹‹é—´çš„ä¸ç›¸ä¼¼åº¦ï¼Œå®šä¹‰ä¸º 1 å‡å»é›…å¡å°”ç³»æ•°ï¼š&lt;/p&gt;
&lt;p&gt;$$
d_J(A, B) = 1 - J(A, B) = \frac{\lvert A \cup B \rvert - \lvert A \cap B \rvert}{\lvert A \cup B \rvert}
$$&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥å«é›…å¡å°”è·ç¦»ä¸ºä¸¤é›†åˆçš„å¯¹ç§°å·®ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å“ˆå¸Œå‡½æ•°æ˜¯ä¸€ç§ä»ä»»ä½•æ•°æ®ä¸­åˆ›å»ºå°çš„æ•°å­—ã€ŒæŒ‡çº¹ã€çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¦‚æœèƒ½å¤Ÿæ‰¾åˆ°ä¸€ç§å“ˆå¸Œå‡½æ•°ï¼Œå¯ä»¥åœ¨å‹ç¼©é›†åˆæˆä¸ºã€ŒæŒ‡çº¹ã€çš„åŒæ—¶ä¿ç•™å…¶ç‰¹å¾ï¼Œèƒ½å¤Ÿç”¨äºæ¯”è¾ƒé›†åˆä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå°±å¯ä»¥å‡å°è®¡ç®—é‡äº†ã€‚è¿™ä¹Ÿå°±å¼•å‡ºäº† Min-Hash è¿™ä¸ªç®—æ³•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;shingling&#34;&gt;Shingling&lt;/h2&gt;
&lt;h3 id=&#34;ä½•ä¸º-shingling&#34;&gt;ä½•ä¸º Shingling&lt;/h3&gt;
&lt;p&gt;å°†æ–‡æ¡£è½¬åŒ–ä¸ºå•è¯çš„é›†åˆã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•è½¬åŒ–æ˜¯ä¸ªé—®é¢˜ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›´æ¥å°†æ–‡æ¡£æ‹†åˆ†æˆå¾ˆå¤šä¸ªå•ä¸ªå•è¯çš„é›†åˆ&lt;/li&gt;
&lt;li&gt;ä»æ–‡ç« ä¸­æå–å‡ºå…³é”®å•è¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½†ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½ä¼šæŸå¤±æ‰å•è¯çš„é¡ºåºä¿¡æ¯ã€‚è€Œè¿™é‡Œè¦ä»‹ç»çš„æ–¹æ³• Shingling å°±å¯ä»¥é¿å…ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨çš„å•è¯ Shingling æ„æ€ä¸ºã€Œå ç“¦ã€ï¼Œéå¸¸æœ‰æ„æ€ã€‚è¯´èµ·ã€Œå ç“¦ã€ï¼Œå¯èƒ½ä¼šè®©äººæƒ³åˆ°ã€Œå ç“¦ç›˜ã€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;SMR å ç“¦å¼ç£ç›˜æ˜¯ä¸€ç§é‡‡ç”¨æ–°å‹ç£å­˜å‚¨æŠ€æœ¯çš„é«˜å®¹é‡ç£ç›˜ã€‚SMR ç›˜å°†ç›˜ç‰‡ä¸Šçš„æ•°æ®ç£é“éƒ¨åˆ†é‡å ï¼Œå°±åƒå±‹é¡¶ä¸Šçš„ç“¦ç‰‡ä¸€æ ·ï¼Œè¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºå ç“¦å¼ç£è®°å½•æŠ€æœ¯ã€‚è¯¥æŠ€æœ¯åœ¨åˆ¶é€ å·¥è‰ºæ–¹é¢çš„å˜åŠ¨éå¸¸å¾®å°ï¼Œä½†å´å¯ä»¥å¤§å¹…æé«˜ç£ç›˜å­˜å‚¨å¯†åº¦ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt=&#34;SMR&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/SMR.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œçš„ Shingling ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä¸¾ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;p&gt;æ–‡æ¡£ $D_1 = abcab$ ï¼Œä½¿ç”¨ 2-shingles å°±å¯ä»¥è·å¾— $S(D_1) = {ab, bc, ca}$&lt;/p&gt;
&lt;p&gt;å¦‚æ­¤ä¸€æ¥å°±å¯ä»¥ä¿ç•™åŸæ¥æ–‡æ¡£ä¸­å•è¯çš„é¡ºåºä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯¹-shingle-å‹ç¼©&#34;&gt;å¯¹ Shingle å‹ç¼©&lt;/h3&gt;
&lt;p&gt;ç”±äºä¸¤ç¯‡æ–‡æ¡£å¤§éƒ¨åˆ†çš„ Shingle éƒ½ä¼šæ˜¯ä¸åŒçš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ Hash å‹ç¼© Shingle åˆ°ç›¸åŒçš„å®½åº¦çš„æ•°å­—ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åå½“æˆ‘ä»¬éœ€è¦æ¯”è¾ƒä¸¤ä¸ª Shingle é›†åˆçš„ç›¸ä¼¼ç¨‹åº¦æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¹‹å‰çš„é›…å¡å°”è·ç¦»æ¥ä¼°ç®—ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸è¿‡è¿™æ ·è¿˜æ˜¯æœ‰å¾ˆå¤§çš„è®¡ç®—é‡ï¼Œæˆ‘ä»¬éœ€è¦ä¸‹æ–‡è¯´çš„ Min-Hash ç®—æ³•&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºçŸ­ç¯‡ï¼Œk å¯ä»¥å– 5&lt;/li&gt;
&lt;li&gt;å¯¹äºé•¿ç¯‡ï¼Œk å¯ä»¥å– 10&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»…ä½œå‚è€ƒï¼Œè¦ä¾æ®å…·ä½“æƒ…å†µå–èˆ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;min-hash-ç®—æ³•&#34;&gt;Min-Hash ç®—æ³•&lt;/h2&gt;
&lt;h3 id=&#34;éœ€æ±‚&#34;&gt;éœ€æ±‚&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨é›…å¡å°”ç®—æ³•æ¯”è¾ƒ Shingle çš„å“ˆå¸Œä¾ç„¶æ˜¯ç¼“æ…¢çš„ã€‚å‡è®¾æœ‰ N ç¯‡æ–‡æ¡£ï¼Œåˆ™éœ€è¦æ¯”è¾ƒ $N(N-1)/2$ æ¬¡ï¼Œå½“ $N = 1 million$ æ—¶ï¼Œéœ€è¦æ¯”è¾ƒ $5 * 10 ^11$ æ¬¡ï¼Œä»¥ä¸€å¤©æœ‰ $10^5$ ç§’ï¼Œæ¯ç§’å¯ä»¥æ¯”è¾ƒ $10^6$ ä¼°ç®—ï¼Œè¿™å°†èŠ±è´¹äº”å¤©ã€‚å¦‚æœ N å†å¤§ä¸€ä¸ªæ•°é‡çº§ï¼Œå°†ä¼šèŠ±è´¹è¶…è¿‡ä¸€å¹´çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;Min-Hash çš„æ€æƒ³ï¼Œå°†å¤§çš„é›†åˆè½¬æ¢æˆå°çš„ã€Œç­¾åã€ï¼Œæ¯ä¸ªç­¾åä¸­éƒ½åŒ…å«äº†å¯ä»¥è®¡ç®—ç›¸ä¼¼ç¨‹åº¦çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦å°†é›†åˆè½¬æ¢ä¸ºä½æ•°ç»„ï¼ˆ0 å’Œ 1 ç»„æˆï¼‰ï¼Œ0 ä»£è¡¨é›†åˆä¸­æ²¡æœ‰è¿™ä¸ªå…ƒç´ ï¼Œ1 ä»£è¡¨é›†åˆä¸­æœ‰è¿™ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æ­¤ä¸€æ¥ï¼Œäº¤é›†å°±æ˜¯ã€ŒæŒ‰ä½ä¸è¿ç®—ã€ï¼Œå¹¶é›†å°±æ˜¯ã€ŒæŒ‰ä½æˆ–è¿ç®—ã€ã€‚&lt;/p&gt;
&lt;p&gt;å†å°†é›†åˆè½¬æ¢ä¸ºçŸ©é˜µï¼Œæ¯ä¸€è¡Œè¡¨ç¤ºæŸä¸€å…ƒç´ ï¼ˆshinglesï¼‰åœ¨ä¸åŒé›†åˆï¼ˆdocumentsï¼‰ä¸­æ˜¯å¦å­˜åœ¨ã€‚æ¢è¨€ä¹‹ï¼Œæ¯ä¸€åˆ—è¡¨ç¤ºæŸä¸€é›†åˆåŒ…å«äº†å“ªäº›å…ƒç´ ã€‚&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;/th&gt;
          &lt;th&gt;D1&lt;/th&gt;
          &lt;th&gt;D2&lt;/th&gt;
          &lt;th&gt;&amp;hellip;&lt;/th&gt;
          &lt;th&gt;Dn&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;E1&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;&amp;hellip;&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;E2&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;&amp;hellip;&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&amp;hellip;&lt;/td&gt;
          &lt;td&gt;&amp;hellip;&lt;/td&gt;
          &lt;td&gt;&amp;hellip;&lt;/td&gt;
          &lt;td&gt;&amp;hellip;&lt;/td&gt;
          &lt;td&gt;&amp;hellip;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;En&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;&amp;hellip;&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å‡è®¾æœ‰ä¸€ä¸ªå“ˆå¸Œå‡½æ•° h ï¼Œå¯ä»¥æ»¡è¶³ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$h(C)$ è¶³å¤Ÿå°ï¼Œå¯ä»¥å°†å¤§é‡çš„ shingles æ”¾å…¥å†…å­˜ä¸­&lt;/li&gt;
&lt;li&gt;ç­¾å $h(C_1)$ ä¸ $h(C_2)$ çš„ç›¸ä¼¼ç¨‹åº¦ç­‰åŒäº $sim(C_1, C_2)$&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;$sim(C_1, C_2)$ è¡¨ç¤º $C_1$ å’Œ $C_2$ çš„é›…å¡å°”ç³»æ•° $\frac{\lvert A \cap B\rvert}{\lvert B \cup A\rvert}$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç†æƒ³çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬æ‰¾åˆ°çš„å‡½æ•° $h(\cdot)$ æ»¡è¶³ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ $sim(C_1, C_2)$ å¾ˆé«˜æ—¶ï¼Œæœ‰å¾ˆå¤§æ¦‚ç‡ $h(C_1) = h(C_2)$&lt;/li&gt;
&lt;li&gt;å½“ $sim(C_1, C_2)$ å¾ˆä½æ—¶ï¼Œæœ‰å¾ˆå¤§æ¦‚ç‡ $h(C_1) \neq h(C_2)$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;åŸºæœ¬æ€è·¯&#34;&gt;åŸºæœ¬æ€è·¯&lt;/h3&gt;
&lt;p&gt;é€‰æ‹©ä¸€ä¸ªå¯ä»¥å°†é›†åˆæ‰“ä¹±çš„éšæœºå‡½æ•° $\pi$ ï¼Œå®ƒåšåˆ° $Pr(h_{\pi}(C_1) = h_{\pi}(C_2)) = sim(C_1, C_2)$ ï¼Œæ»¡è¶³äº†æˆ‘ä»¬çš„éœ€æ±‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¯æ˜&#34;&gt;è¯æ˜&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;è¯æ˜ä¸€&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;é›†åˆ $X$ æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œ$y \in X$&lt;/p&gt;
&lt;p&gt;$Pr[\pi(y) = min(\pi(X))] = 1/\lvert X \rvert$&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„ $\pi(y) = min(\pi(X))$ è¡¨ç¤ºåœ¨ä½¿ç”¨ $\pi$ æ‰“ä¹± X åï¼ŒX ä¸­çš„å…ƒç´  y æ’åœ¨ç¬¬ä¸€ä½ã€‚ç”±äºæ¯ä¸ªå…ƒç´ åœ¨éšæœºæ‰“ä¹±åæ’åœ¨ç¬¬ä¸€ä½çš„æ¦‚ç‡éƒ½æ˜¯å‡ç­‰çš„ï¼Œå› æ­¤ç­‰å¼å³è¾¹æ˜¯ $1/\lvert X \rvert$ ã€‚&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å¾—åˆ° $Pr(min({\pi}(C_1)) = min({\pi}(C_2))) = \frac{\lvert A \cap B\rvert}{\lvert B \cup A\rvert} = sim(C_1, C_2)$&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;è¯æ˜äºŒ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å¯ä»¥å°†ä¸¤ä¸ªé›†åˆä¸­æ˜¯å¦æœ‰æŸç§å…¬å…±å…ƒç´ çš„æƒ…å†µåˆ†ä¸ºå››ç±»&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;/th&gt;
          &lt;th&gt;D1&lt;/th&gt;
          &lt;th&gt;D2&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;A&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;B&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;C&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;D&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;å‡è®¾ [a-d] è¡¨ç¤ºè¿™å››ç±»æƒ…å†µçš„ä¸ªæ•°&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯ä»¥å‘ç° $sim(C_1, C_2) = a/(a +b +c)$&lt;/p&gt;
&lt;p&gt;å¦‚æœå°†ä¸¤ä¸ªé›†åˆä»¥ç›¸åŒçš„æ–¹å¼æ‰“ä¹±ï¼Œå†ä»ä¸Šå‘ä¸‹æ‰«æï¼Œç¬¬ä¸€ä¸ªç¢°åˆ°çš„å«æœ‰ 1 çš„è¡Œæ˜¯ A ç±»ï¼Œåˆ™è¯´æ˜ $h(D_1) = h(D_2)$ ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;&lt;img alt=&#34;example&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/min-hashing-example.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å– 100 ä¸ª $\pi$ å‡½æ•°ç”¨æ¥æ‰“ä¹±ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªæ–‡æ¡£ç”Ÿæˆ 100 ä¸ªç­¾åï¼Œé‚£å°±å¯ä»¥æŠŠå¤§é‡çš„æ•°æ®å‹ç¼©åˆ°å¯ä»¥æ¥å—çš„ç¨‹åº¦äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨ä¹¦ä¸­æœ‰å…³äº Min-Hash å®ç°æ—¶éœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Œå¯ä»¥ä»¥åå†æ°´ä¸€ç¯‡åšå®¢&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;locality-sensitive-hashing&#34;&gt;Locality Sensitive Hashing&lt;/h2&gt;
&lt;h3 id=&#34;åŸºæœ¬æ€è·¯-1&#34;&gt;åŸºæœ¬æ€è·¯&lt;/h3&gt;
&lt;p&gt;æ‰¾åˆ°ç›¸ä¼¼åº¦è‡³å°‘ä¸º $s$ çš„æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;å³ä½¿æˆ‘ä»¬å·²ç»å°†æ‰€æœ‰çš„æ–‡æ¡£è½¬æ¢æˆäº†å¾ˆå°çš„ç­¾åï¼Œç„¶è€Œæ–‡æ¡£ä¸€ä¸€é…å¯¹æ¯”è¾ƒçš„æ•°é‡è¿˜æ˜¯å¤ªå¤šäº†ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦ã€Œå“ˆå¸Œã€å’Œã€Œæ¡¶ã€è¿™ä¸¤ä½è€æœ‹å‹ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•° $f(\cdot)$ ï¼Œ$f(x, y)$ å¯ä»¥åˆ†è¾¨ x å’Œ y æ˜¯ä¸æ˜¯ç›¸ä¼¼æ–‡æ¡£çš„å€™é€‰è€…ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†çŸ©é˜µçš„åˆ—åˆ†è£…åˆ°ä¸åŒçš„ã€Œæ¡¶ã€ä¸­&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰è£…åœ¨ç›¸åŒçš„ã€Œæ¡¶ã€ä¸­çš„æ–‡æ¡£æ˜¯å€™é€‰è€…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥æŠŠä¸€åˆ—åˆ†æˆä¸åŒçš„æ¡å¸¦ï¼ˆbandï¼‰ï¼Œç„¶åè¿›è¡Œå¤šæ¬¡å“ˆå¸Œæ“ä½œã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ†æˆæ›´å°çš„æ¡å¸¦ä½œç”¨æ˜¯æé«˜æ•ˆç‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt=&#34;lsh-bands&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/lsh-bands.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;åªè¦æœ‰ä¸€æ¬¡è¢«åˆ†é…åˆ°ç›¸åŒçš„ã€Œæ¡¶ã€ï¼Œå°±å¯ä»¥æˆä¸ºå€™é€‰è€…&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;lsh-bands1&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/lsh-bands_1.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å‡é˜´æ€§å’Œå‡é˜³æ€§&#34;&gt;ã€Œå‡é˜´æ€§ã€å’Œã€Œå‡é˜³æ€§ã€&lt;/h3&gt;
&lt;p&gt;ã€Œå‡é˜´æ€§ã€ï¼šæœ¬åº”è¢«é€‰å…¥è€Œæ²¡æœ‰è¢«é€‰å…¥&lt;/p&gt;
&lt;p&gt;ã€Œå‡é˜³æ€§ã€ï¼šæœ¬ä¸åº”è¢«é€‰å…¥è€Œè¢«é€‰å…¥&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ä¸€ä¸ªæ¡å¸¦ä¸­çš„ r è¡Œéƒ½åŒ¹é…çš„æ¦‚ç‡ä¸º $s^r$&lt;/li&gt;
&lt;li&gt;åœ¨ä¸€ä¸ªæ¡å¸¦ä¸­è‡³å°‘æœ‰ä¸€è¡Œä¸åŒ¹é…çš„æ¦‚ç‡ä¸º $1 - s^r$&lt;/li&gt;
&lt;li&gt;åœ¨æ‰€æœ‰æ¡å¸¦ä¸­éƒ½æœ‰è‡³å°‘ä¸€è¡Œä¸åŒ¹é…çš„æ¦‚ç‡ä¸º $(1 - s^r)^b$&lt;/li&gt;
&lt;li&gt;è‡³å°‘æœ‰ä¸€ä¸ªæ¡å¸¦çš„ r è¡Œéƒ½åŒ¹é…ï¼ˆæˆä¸ºå€™é€‰è€…ï¼‰çš„æ¦‚ç‡ä¸º $1 - (1 - s^r)^b$&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ s ä¸ºæ¨ªåæ ‡ï¼Œæˆä¸ºå€™é€‰è€…çš„æ¦‚ç‡ä¸ºçºµåº§æ ‡ï¼Œb å’Œ r ä¸ºå¸¸é‡ï¼Œå¯ä»¥è·å¾—ä¸€æ¡ S å‹æ›²çº¿ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;lsh-s-curve&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/lsh-s-curve.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ b å–å€¼ä¸º 1 æ—¶ï¼ŒS å‹æ›²çº¿å°†ä¼šé€€åŒ–æˆä¸ºè¿‡åŸç‚¹çš„ç›´çº¿&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å–å€™é€‰è€…æ¦‚ç‡ä¸º 0.5 ï¼Œå³ $1 - (1 - s^r)^b = 1/2$&lt;/p&gt;
&lt;p&gt;è®¡ç®—å¾—åˆ° $s = (1 - (\frac{1}{2})^{\frac{1}{b}})^{\frac{1}{r}}$&lt;/p&gt;
&lt;p&gt;ç”±äº $(\frac{1}{2})^{\frac{1}{b}}$ æ¯”è¾ƒæ¥è¿‘ 0 ï¼Œå¯ä»¥åˆ©ç”¨ç­‰ä»·æ— ç©·å°æ¥ä¼°ç®— $s \sim (\frac{1}{b})^{\frac{1}{r}}$&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸‹ï¼ˆä¸å¯æ”¾è¿‡æŠ„è¢­ï¼‰ï¼Œå¥½çš„æ¡å¸¦åˆ’åˆ†åº”è¯¥å‡å°‘å‡é˜´æ€§å¹¶å¹³è¡¡å‡é˜³æ€§çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾åˆ’åˆ†æˆä¸º b ä¸ªæ¡å¸¦ï¼Œæ¯ä¸ªæ¡å¸¦æœ‰ r è¡Œï¼Œå‡è®¾éœ€è¦æ¯”è¾ƒçš„ä¸¤åˆ—ç›¸ä¼¼åº¦ä¸º s ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;lsh-s-curve1&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/lsh-s-curve_1.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.mmds.org&#34;&gt;CS246&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Jaccard_index&#34;&gt;Jaccard index&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/MinHash&#34;&gt;MinHash&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Shingled_magnetic_recording&#34;&gt;SMR&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://oeis.org/wiki/List_of_LaTeX_mathematical_symbols&#34;&gt;Latex mathematical symbols&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>MIT6.S081 Lab: Xv6 and Unix Utilities</title>
      <link>https://vaaandark.top/posts/mit6.s081-labxv6-and-unix-utilities/</link>
      <pubDate>Thu, 02 Mar 2023 23:14:38 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/mit6.s081-labxv6-and-unix-utilities/</guid>
      <description>&lt;p&gt;è¿™æ˜¯ MIT6.S081 çš„ç¬¬ä¸€ä¸ª Lab ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©å­¦ç”Ÿç†Ÿæ‚‰ Xv6 å’Œ Unix çš„ä¸€äº›å®ç”¨ç¨‹åºï¼Œä¾‹å¦‚ &lt;code&gt;sleep&lt;/code&gt; &lt;code&gt;find&lt;/code&gt; &lt;code&gt;xargs&lt;/code&gt; ç­‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;sleep&#34;&gt;sleep&lt;/h2&gt;
&lt;p&gt;è¿™ä¸€å…³æ˜¯å®ç° &lt;code&gt;sleep&lt;/code&gt; å‘½ä»¤ã€‚ç”±äºåœ¨ &lt;code&gt;user/user.h&lt;/code&gt; ç›®å½•ä¸­ç»™å‡ºæ¥äº†å¯ä»¥ç›´æ¥ç”± C è¯­è¨€è°ƒç”¨çš„å‡½æ•° &lt;code&gt;int sleep(int)&lt;/code&gt; ï¼Œè¿™ä¸€å…³éå¸¸ç®€å•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/types.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/stat.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;user/user.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; sec;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (argc != &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    fprintf(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Usage: sleep secends&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  sec = atoi(argv[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (sec &amp;gt;= &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sleep(sec);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    fprintf(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Usage: sleep secends&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;pingpong&#34;&gt;pingpong&lt;/h2&gt;
&lt;p&gt;è¿™ä¸€å…³æ˜¯ä¸ºäº†è®©æˆ‘ä»¬ç†Ÿæ‚‰ç®¡é“çš„ä½¿ç”¨ï¼Œæ–‡æ¡£ä¸­å¼ºè°ƒäº† &lt;code&gt;uses UNIX system calls to &#39;&#39;ping-pong&#39;&#39; a byte between two processes over a pair of pipes, one for each direction&lt;/code&gt; ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥åˆ›å»ºä¸¤ä¸ªç®¡é“ï¼Œå°†çˆ¶å­è¿›ç¨‹çš„è¯»å†™äº¤å‰è¿æ¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/types.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/stat.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;user/user.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; buf[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;100&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// parent to child
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; p2c[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// child to parent
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; c2p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  pipe(p2c);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  pipe(c2p);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (fork()) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// parent
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    close(p2c[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    close(c2p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    write(p2c[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;ping&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    read(c2p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;], buf, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;%d: received pong&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, getpid());
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    close(p2c[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    close(c2p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// child
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    close(p2c[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    close(c2p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    read(p2c[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;], buf, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;%d: received ping&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, getpid());
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    write(p2c[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;pong&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    close(p2c[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    close(c2p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;primes&#34;&gt;primes&lt;/h2&gt;
&lt;p&gt;è¿™ä¸€å…³æ˜¯ä½¿ç”¨å¤šè¿›ç¨‹æ¥å®ç°ç­›æ³•ã€‚æœ¬æ¥ä¸€å¼€å§‹æ²¡æ‡‚ä»–æ˜¯ä»€ä¹ˆæ„æ€ï¼Œç»“æœçœ‹åˆ°äº†æ–‡æ¡£ä¸­çš„ä¸€å¹…å›¾å°±æ‡‚äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;sieve&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/sieve.gif&#34;&gt;&lt;/p&gt;
&lt;p&gt;å†™äº†ä¸ªé€’å½’è°ƒç”¨çš„å‡½æ•°ï¼Œä½†æ˜¯åˆä¸æƒ³å†åŒ…è£…ä¸€å±‚ï¼Œæ‰€ä»¥å½“ä¼ å…¥çš„æ–‡ä»¶æè¿°ç¬¦ä¸º &lt;code&gt;-1&lt;/code&gt; æ—¶è¡¨ç¤ºåˆå§‹åŒ–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/types.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/stat.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;user/user.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define UPPER_BOUND 35
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; send_and_close(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; fd, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; *num, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; count) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  write(fd, num, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;) * count);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  close(fd);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; receive_and_close(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; fd, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; *num) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; res = read(fd, num, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;) * UPPER_BOUND);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  close(fd);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; res / &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; sieve(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; fd) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; num[UPPER_BOUND];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; rec_count = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// if fd &amp;lt; 0, init by building the array first
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (fd &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;; i &amp;lt;= UPPER_BOUND; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      num[rec_count++] = i;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    rec_count = receive_and_close(fd, num);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (rec_count &amp;lt;= &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  pipe(p);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (fork() &amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// parent: send numbers
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    close(p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; filter_num = num[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;prime %d&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, filter_num);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; send_count = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; rec_count; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (num[i] % filter_num != &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        num[send_count++] = num[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    send_and_close(p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;], num, send_count);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    wait(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// child: receive numbers
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    close(p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sieve(p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  sieve(-&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;find&#34;&gt;find&lt;/h2&gt;
&lt;p&gt;æ–‡æ¡£ä¸­æç¤ºäº†å¯ä»¥å‚è€ƒ &lt;code&gt;user/ls.c&lt;/code&gt; ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ç…§ç€å®ƒæŠ„æŠ„æ”¹æ”¹ï¼Œè¿å‡½æ•° &lt;code&gt;fmtname&lt;/code&gt; éƒ½å¯ä»¥æ”¹å†™æˆ &lt;code&gt;filename&lt;/code&gt; å¤ç”¨ã€‚è€Œä¸”ç”±äºæ˜¯æ”¹å†™çš„ &lt;code&gt;ls&lt;/code&gt; å‘½ä»¤ï¼Œæ‰€ä»¥é”™è¯¯å¤„ç†å°±ä¸ç”¨è‡ªå·±åŠ¨æ‰‹äº†ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨é€’å½’è°ƒç”¨ä¸­è¦å¿½ç•¥æ‰ &lt;code&gt;.&lt;/code&gt; å’Œ &lt;code&gt;..&lt;/code&gt; ç›®å½•ï¼Œä¸ç„¶ä¼šæœ‰æ— é™é€’å½’çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/types.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/stat.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;user/user.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/fs.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *filename(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *path) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; buf[DIRSIZ + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *p;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (p = path + strlen(path); p &amp;gt;= path &amp;amp;&amp;amp; *p != &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;; --p)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  p++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (strlen(p) &amp;gt;= DIRSIZ) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; p;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  memmove(buf, p, strlen(p));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  buf[strlen(p)] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; buf;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; find(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *path, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *pattern) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; fd;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; ((fd = open(path, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;)) &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    fprintf(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;find: cannot open %s&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, path);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (strcmp(filename(path), pattern) == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;%s&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, path);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; stat st;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (fstat(fd, &amp;amp;st) &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    fprintf(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;find: cannot stat %s&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, path);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; buf[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;512&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; dirent de;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (st.type == T_DIR) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt;(strlen(path) + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; + DIRSIZ + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; &amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt; buf){
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;ls: path too long&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      strcpy(buf, path);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *p = buf + strlen(buf);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      *p++ = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (read(fd, &amp;amp;de, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(de)) == &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(de)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (de.inum == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;continue&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (strcmp(de.name, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;) == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt; || strcmp(de.name, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;..&amp;#34;&lt;/span&gt;) == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;continue&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        memmove(p, de.name, strlen(de.name));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        p[strlen(de.name)] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        find(buf, pattern);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  close(fd);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (argc != &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;find: wrong argumens&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  find(argv[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;], argv[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“æˆ‘åˆ æ‰å¯¹ &lt;code&gt;.&lt;/code&gt; å’Œ &lt;code&gt;..&lt;/code&gt; ç›®å½•çš„åˆ¤æ–­æ—¶ï¼Œå‘ç° Xv6 å¯ä»¥åœ¨å´©æºƒåæŠ¥é”™è¿™æ˜¯ä¸ªæ— é™é€’å½’ï¼Œæœ‰æ—¶é—´å¯ä»¥ç ”ç©¶ä¸€ä¸‹æ˜¯æ€ä¹ˆå®ç°çš„ã€‚æˆ‘çŒœæµ‹æ˜¯å¯¹æ ˆå’Œ &lt;code&gt;call&lt;/code&gt; æŒ‡ä»¤è¿›è¡Œäº†ç»Ÿè®¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;xargs&#34;&gt;xargs&lt;/h2&gt;
&lt;p&gt;è¿™ä¸€å…³æ˜¯å®Œæˆå‘½ä»¤ &lt;code&gt;xargs&lt;/code&gt; ï¼Œæ–‡æ¡£å¯¹è¿™ä¸ªå®ç°çš„è¦æ±‚å¾ˆä½ï¼Œä¸è¦æ±‚å®ç° &lt;code&gt;-n&lt;/code&gt; é€‰é¡¹ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥å°†æ‰€æœ‰çš„ &lt;code&gt;&#39; &#39;&lt;/code&gt; å’Œ &lt;code&gt;&#39;\t&#39;&lt;/code&gt; æ¢æˆ &lt;code&gt;&#39;\0&#39;&lt;/code&gt; ï¼Œè¿™æ ·ä¸€æ¥å°±å¯ä»¥å¤ç”¨ç¼“å†²åŒºï¼Œç›´æ¥å°† &lt;code&gt;cmd&lt;/code&gt; æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æŒ‡å‘ &lt;code&gt;buf&lt;/code&gt; çš„æŸä¸ªä½ç½®å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/param.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;kernel/types.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;#34;user/user.h&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; argc, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *argv[])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *cmd[MAXARG];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; buf[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1024&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; cmd_cnt = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i &amp;lt; argc; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cmd[cmd_cnt++] = argv[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; len = read(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, buf, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt; buf);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  buf[len] = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (len &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    fprintf(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;xargs: input error&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *start = buf;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *p = buf; *p != &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;; ++p) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (*p == &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; || *p == &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\t&amp;#39;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      *p++ = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      cmd[cmd_cnt++] = start;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      start = p;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (*p == &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      *p++ = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      cmd[cmd_cnt++] = start;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      cmd[cmd_cnt] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      start = p;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      cmd_cnt = argc - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (fork() == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        exec(cmd[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;], cmd);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        wait(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Awesome WM åŸºäºè¿­ä»£å™¨çš„å°ç»„ä»¶</title>
      <link>https://vaaandark.top/posts/awesomewm-widget-with-iterator/</link>
      <pubDate>Sat, 25 Feb 2023 13:26:44 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/awesomewm-widget-with-iterator/</guid>
      <description>&lt;p&gt;ç”±äº i3wm æ”¯æŒçš„åŠŸèƒ½æœ‰é™ï¼Œå®šåˆ¶æ€§å¹¶æ²¡æœ‰é‚£ä¹ˆå¼ºå¤§ï¼Œæœ€è¿‘æ¢æˆä½¿ç”¨ Awesome WM äº†ï¼Œå®ƒä½¿ç”¨ Lua ä½œä¸ºé…ç½®è¯­è¨€ï¼Œæ‰€ä»¥å¯é…ç½®æ€§æå¼ºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œi3wm é…ç½®æ— æ³•åƒçœŸæ­£çš„ç¼–ç¨‹è¯­è¨€ä¸€æ ·ä½¿ç”¨ &lt;code&gt;if ... else&lt;/code&gt; è¯­å¥ç­‰ï¼Œä½† Awesome WM å¯ä»¥ï¼Œå¯¹äºåŒä¸€ä¸ªå¿«æ·é”®å°±å¯ä»¥åœ¨ä¸åŒæ—¶å€™æœ‰ä¸åŒçš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;Awesome WM å¯¹å¤šæ˜¾ç¤ºå™¨æ”¯æŒå¾ˆå¥½ï¼Œåœ¨å®˜ç½‘ä¸Šè¿˜æœ‰ä¸€ä¸ªä¾¿æ·åˆ‡æ¢æ˜¾ç¤ºå™¨çš„&lt;a href=&#34;https://awesomewm.org/recipes/xrandr/&#34;&gt;è„šæœ¬&lt;/a&gt;ã€‚è¿™ä¸ªè„šæœ¬å†™å¾—éå¸¸åœ°å·§å¦™ï¼Œå¯ä»¥ç»‘å®šåˆ°ä¸€ä¸ªå¿«æ·é”®ï¼Œæ¯æ¬¡æŒ‰éƒ½èƒ½å¼¹å‡ºé€šçŸ¥ï¼Œæ˜¾ç¤ºå³å°†ä½¿ç”¨çš„æ˜¾ç¤ºå™¨å¸ƒå±€ï¼Œå½“åˆ‡æ¢åˆ°æƒ³è¦çš„å¸ƒå±€ååœæ­¢æŒ‰é”®å°±å¯ä»¥åº”ç”¨è¿™ä¸€å¸ƒå±€äº†ã€‚è¿™åˆ©ç”¨çš„æ˜¯ Notification å¼¹çª—å¦‚æœæ²¡æœ‰è¢«å“åº”æ—¶è°ƒç”¨å›è°ƒå‡½æ•°çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;demo&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/notify.gif&#34;&gt;&lt;/p&gt;
&lt;p&gt;Awesome WM çš„é€šçŸ¥ä½¿ç”¨çš„æ˜¯ &lt;code&gt;naughty&lt;/code&gt; æ¨¡å—ï¼Œå®ƒåŒ…è£…äº†ä¸€ç³»åˆ—å¾ˆæœ‰ç”¨çš„åŠŸèƒ½ï¼Œåœ¨ Awesome WM çš„ API æ–‡æ¡£ä¸­ä»‹ç»äº† &lt;code&gt;naughty.notify&lt;/code&gt; çš„&lt;a href=&#34;https://awesomewm.org/doc/api/libraries/naughty.html#notify&#34;&gt;ç”¨æ³•&lt;/a&gt;ï¼Œå¦‚ä¸‹æ˜¯ä¼ å…¥å‚æ•°çš„ä¸€äº›å­—æ®µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;replaces_id&lt;/code&gt;: (int) Replace the notification with the given ID. (optional)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;destroy&lt;/code&gt;: (func) Function to run when notification is destroyed. (optional)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;replaces_id&lt;/code&gt; å¯ä»¥ç”¨äºæ›¿ä»£ä¸Šä¸€ä¸ª Notification ï¼Œè¿™æ ·å°±æœ‰ä¸€ç§è½®æ¢çš„æ•ˆæœäº†ï¼›&lt;code&gt;destroy&lt;/code&gt; æ˜¯å½“è¿™ä¸ªé€šçŸ¥æ¶ˆå¤±æ—¶çš„åŠ¨ä½œï¼Œå®ƒæœ‰ä¸€ä¸ªä¼ å…¥çš„å‚æ•° &lt;code&gt;reason&lt;/code&gt; è¡¨ç¤ºå®ƒæ¶ˆå¤±çš„åŸå› ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ¥è¿‡æ»¤éè¶…æ—¶æ¶ˆå¤±çš„æƒ…å†µï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; naughty_destroy_callback(reason)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; reason == naughty.notificationClosedReason.expired &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥ç…§çŒ«ç”»è™ï¼Œå®ç°ä¸€ä¸ª &lt;code&gt;exit.lua&lt;/code&gt; ï¼Œåœ¨æ¨¡å—å†…éƒ¨å®ç°ä¸€ä¸ªç±»ä¼¼è¿­ä»£çš„æ•ˆæœï¼Œæ¯æ¬¡è°ƒç”¨ &lt;code&gt;exit&lt;/code&gt; å‡½æ•°éƒ½ä¼šæ”¹å˜æ¨¡ç»„å†…éƒ¨å˜é‡çš„çŠ¶æ€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; spawn = require(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;awful.spawn&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; naughty = require(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;naughty&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; icon_path = os.getenv(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;HOME&amp;#34;&lt;/span&gt;) .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;/.config/awesome/images/power.png&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; state = { cid = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;nil&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; lock_command = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;$HOME/.local/bin/fancy-lock &amp;amp;&amp;amp; sleep 1 &amp;amp;&amp;amp; &amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; lock = { &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Lock&amp;#34;&lt;/span&gt;, lock_command }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; shutdown = { &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Shut down&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;shutdown now&amp;#34;&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; reboot = { &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Reboot&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;systemctl reboot&amp;#34;&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; suspend = { &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Suspend&amp;#34;&lt;/span&gt;, lock_command .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;systemctl suspend&amp;#34;&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; hibernate = { &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Hibernate&amp;#34;&lt;/span&gt;, lock_command .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;systemctl hibernate&amp;#34;&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; menu()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; { lock, shutdown, reboot, suspend }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; naughty_destroy_callback(reason)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; reason == naughty.notificationClosedReason.expired &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; action = state.index and state.menu[state.index - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;][&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; action &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      spawn(string.format(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;sh -c &lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, action), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;false&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      state.index = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; exit()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; not state.index &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    state.menu = menu()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    state.index = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; label, action
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; next = state.menu[state.index]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  state.index = state.index + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; not next &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    label = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;Do nothing&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    state.index = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    label, action = next[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;], next[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  state.cid = naughty.notify({
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    title = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Awesome WM Exit&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    text = string.format(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;  &amp;lt;span color=&amp;#39;yellow&amp;#39; weight=&amp;#39;bold&amp;#39;&amp;gt;%-10s ?&amp;lt;/span&amp;gt;&amp;#34;&lt;/span&gt;, label),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    icon = icon_path,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    timeout = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    screen = mouse.screen,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    replaces_id = state.cid,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    destroy = naughty_destroy_callback
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }).id
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  exit = exit,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  commands = {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    lock = lock,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    shutdown = shutdown,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    reboot = reboot,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    suspend = suspend,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    hibernate = hibernate
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Btrfs ä¸ºä»€ä¹ˆæ˜¯ç¥ï¼Ÿ</title>
      <link>https://vaaandark.top/posts/why-btrfs-is-awesome/</link>
      <pubDate>Sat, 25 Feb 2023 13:06:17 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/why-btrfs-is-awesome/</guid>
      <description>&lt;p&gt;æœ€è¿‘å‘ç° Windows è¿™å‡ ä¸ªæœˆå¼€æœºä¸è¶…è¿‡ 10 æ¬¡ï¼Œå¯»æ€ç€å°† Windows ä¸­çš„ç©ºé—´æŒªä¸€ç‚¹åˆ° Linux ä¸­æ¥ã€‚è¯´å¹²å°±å¹²ï¼Œåœ¨ Windows é‡Œé¢åˆ’å‡ºæ¥äº† 80 GB çš„ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;é—æ†¾åœ°ï¼Œè¿™ 80 GB ç©ºé—´ç‰©ç†ä¸Šåœ¨æˆ‘éœ€è¦æ‰©å®¹çš„ç©ºé—´çš„å‰é¢ï¼Œç”±äºå¼€å¤´çš„æ‰‡åŒºå­˜æ”¾æœ‰å¾ˆå¤šå…ƒæ•°æ®ï¼Œå› æ­¤æ˜¯ä¸èƒ½ç®€å•æ‰©å®¹çš„ï¼Œåªèƒ½å¯»æ±‚å…¶ä»–çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¤šäºäº†æˆ‘ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ Btrfs ï¼Œç›´æ¥ä¸€æ¡å‘½ä»¤å°±å¯ä»¥äº† &lt;code&gt;btrfs device add /dev/nvme0n1p9 /home&lt;/code&gt; ï¼Œæ ¹æœ¬ä¸éœ€è¦ä¿®æ”¹ &lt;code&gt;/etc/fstab&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;Btrfs çš„å…¶ä»–ç‰¹æ€§ï¼Œå°±ç•™åˆ°ä»¥åæ¢ç´¢å§ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Rust è‡ªå¼•ç”¨ç»“æ„</title>
      <link>https://vaaandark.top/posts/rust-self-referencing-structure/</link>
      <pubDate>Thu, 23 Feb 2023 21:44:37 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/rust-self-referencing-structure/</guid>
      <description>&lt;p&gt;ä»Šå¤©å’Œæœ‹å‹äº¤æµçš„æ—¶å€™é‡åˆ°äº†è‡ªå¼•ç”¨é—®é¢˜ï¼Œä¹‹å‰å°±åœ¨çœ‹ &lt;em&gt;Rust Bible&lt;/em&gt; çš„æ—¶å€™çœ‹åˆ°è¿‡ï¼Œä½†æ˜¯ä¸€ç›´æ²¡ç”¨ Rust å†™è¿‡ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Œæ‰€ä»¥æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªçš„æœºä¼šï¼Œæ‰€ä»¥ä»Šå¤©å°±æ¥å°è¯•ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦å®ç°çš„ç»“æ„ä½“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; Person {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    name: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;String&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    first_name: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    last_name: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„ &lt;code&gt;first_name&lt;/code&gt; å’Œ &lt;code&gt;last_name&lt;/code&gt; çš„ç”Ÿå‘½å‘¨æœŸåº”è¯¥çŸ­äº &lt;code&gt;name&lt;/code&gt; å’Œæ•´ä¸ªç»“æ„ä½“çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™é‡Œä½¿ç”¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨å…¶å®æ„ä¹‰ä¸å¤§ï¼Œå®ƒæ€ä¹ˆä¹Ÿä¸èƒ½åœ¨ä¸€ä¸ªå‡½æ•°ä¸­æˆåŠŸåˆ›å»ºå¹¶è¿”å›ã€‚å› ä¸ºæƒ³è¦ç”Ÿæˆä¸€ä¸ª slice å¿…é¡»å€Ÿç”¨ä¸€ä¸ª String ï¼Œä½†å½“è¿™ä¸ª String è¢« move è¿›å…¥ &lt;code&gt;Person&lt;/code&gt; ç»“æ„ä½“æ—¶ï¼Œä¸ä¹‹ç›¸å…³çš„ slice å…¨éƒ¨å¤±æ•ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è½¯çš„ä¸è¡Œåªèƒ½æ¥ç¡¬çš„ï¼Œç›´æ¥ä½¿ç”¨ &lt;code&gt;unsafe&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#[derive(Debug)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#[allow(unused)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; Person&amp;lt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt;&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    name: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;String&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    first_name: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    last_name: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;impl&lt;/span&gt;&amp;lt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt;&amp;gt; Person&amp;lt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt;&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; new(s: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;String&lt;/span&gt;) -&amp;gt; Person&amp;lt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt;&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; (first, last) = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;match&lt;/span&gt; s.find(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(pos) =&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                s.split_at(pos)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;None&lt;/span&gt; =&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (s.as_str(), s.as_str())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; first = first &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; *&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; last = last &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; *&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsafe&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            Person { name: s, first_name: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;*first, last_name: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;*last }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; main() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; p = Person::new(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Linus Torvalds&amp;#34;&lt;/span&gt;.to_string());
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    println!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;{:?}&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, p);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…ˆå°†å¼•ç”¨è½¬æˆ raw point ï¼Œè¿™å°±é¿å…äº†å®ƒåœ¨ ponitee è¢«ç§»åŠ¨åå¤±æ•ˆã€‚ä¹‹åç›´æ¥ä½¿ç”¨ unsafe ï¼Œå†å°†æŒ‡é’ˆè½¬æˆå¼•ç”¨å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶å¾ˆè›‹ç–¼ï¼Œä½†è¿™å°±æ˜¯ Rust ï¼Œ&lt;strong&gt;Love it or leave it!&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>MIT6.S081 å®éªŒç¯å¢ƒé…ç½®</title>
      <link>https://vaaandark.top/posts/mit6.s081-setup-environment/</link>
      <pubDate>Tue, 21 Feb 2023 14:59:14 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/mit6.s081-setup-environment/</guid>
      <description>&lt;p&gt;æœ€è¿‘å¼€å§‹å­¦ä¹ æ“ä½œç³»ç»Ÿçš„ç›¸å…³çŸ¥è¯†ï¼Œé€‰æ‹©å­¦ MIT6.S081 çš„è¯¾ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåœ¨ &lt;a href=&#34;https://pdos.csail.mit.edu/6.S081/2020/labs/util.html&#34;&gt;è¯¾ç¨‹å®˜æ–¹ç½‘ç«™&lt;/a&gt; ä¸Šæ‹‰å–ä»“åº“é…ç½®ç¯å¢ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ git clone git://g.csail.mit.edu/xv6-labs-2020
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;cd&lt;/span&gt; xv6-labs-2020
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ git checkout util
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ make qemu
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;make&lt;/code&gt; æ—¶å‘ç°æœ‰æŠ¥é”™ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user/sh.c: In function â€˜runcmdâ€™:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user/sh.c:58:1: error: infinite recursion detected [-Werror=infinite-recursion]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   58 | runcmd(struct cmd *cmd)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      | ^~~~~~
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰“å¼€è¯¥æ–‡ä»¶å‘ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// Execute cmd.  Never returns.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;runcmd(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; cmd *cmd)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œå·²ç»æ³¨é‡Šè¯´æ˜äº†è¿™ä¸ªå‡½æ•°ä¸è¿”å›ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå› æ­¤åº”è¯¥åŠ ä¸Šæ³¨è§£ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// Execute cmd.  Never returns.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;__attribute__ ((noreturn))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;runcmd(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; cmd *cmd)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨å°±å¯ä»¥ &lt;code&gt;make&lt;/code&gt; æˆåŠŸäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åˆæœ‰äº†æ–°çš„é—®é¢˜ï¼Œ &lt;code&gt;qemu&lt;/code&gt; æ— æ³•åŠ è½½ç³»ç»Ÿï¼Œå‘ç°è¯¥é¡¹ç›®æœ€å¥½åœ¨ Ubuntu20.04 ä¸Šè¿è¡Œï¼Œæˆ‘æŸ¥çœ‹äº†ä¸€ä¸‹ Ubuntu20.04 çš„ qemu ç‰ˆæœ¬ï¼Œæ˜¯ 4.2.1 ï¼Œæ¯” Fedora 36 çš„ä½å¾ˆå¤šï¼Œæˆ‘å¹²è„†ç›´æ¥ç¼–è¯‘å®‰è£…å¾—äº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;a href=&#34;https://download.qemu.org/&#34;&gt;qemu å®˜ç½‘&lt;/a&gt; å®‰è£… 4.2.1 ï¼Œå¹¶å®‰è£…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ./configure --prefix=/home/vandark/.local
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ make -j8 &amp;amp;&amp;amp; make install
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æŠ¥é”™æ²¡æœ‰é€‰é¡¹ &lt;code&gt;-nopie&lt;/code&gt; å¾ˆæ˜æ˜¾æ˜¯ &lt;code&gt;GCC&lt;/code&gt; çš„ç‰ˆæœ¬é«˜äº†ï¼Œç°åœ¨çš„é€‰é¡¹æ˜¯ &lt;code&gt;--no-pie&lt;/code&gt; ï¼Œåœ¨ &lt;code&gt;config-host.mak&lt;/code&gt; ä¿®æ”¹å°±å¯ä»¥ç¼–è¯‘æˆåŠŸäº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åå°±å¯ä»¥è¿›å…¥äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ make qemu
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;xv6 kernel is booting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f00&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f00&#34;&gt;&lt;/span&gt;hart 1 starting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hart 2 starting
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;init: starting sh
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Lua æ‰“å° Table</title>
      <link>https://vaaandark.top/posts/lua-print-table/</link>
      <pubDate>Sat, 11 Feb 2023 14:36:27 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/lua-print-table/</guid>
      <description>&lt;p&gt;ä¹‹å‰åœ¨ Lua ä»£ç çš„ç¼–å†™ä¸­å†™è¿‡ä¸€äº›æ‰“å°è¡¨çš„å‡½æ•°ç”¨äºè°ƒè¯•ï¼Œè¿™æ¬¡åœ¨çœ‹ z.lua çš„å®ç°ä¸­çœ‹åˆ°äº†éå¸¸å®Œç¾çš„æ‰“å°è¡¨çš„æ–¹æ³•ï¼Œäºæ˜¯åœ¨å°†ä»£ç æ”¹å¾—æ›´è§„èŒƒåè®°å½•ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;luacheck&lt;/code&gt; æ£€æŸ¥ Lua ä»£ç ä¸­çš„é”™è¯¯å’Œä¸è§„èŒƒä¹‹å¤„&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; print_table(table, level)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; key = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; func
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  func = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt;(t, l)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    l = l or &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; indent = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; _ = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, l &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt; indent = indent .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;  &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; key ~= &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      print(indent .. key .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt; .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;=&amp;#34;&lt;/span&gt; .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt; .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;{&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      print(indent .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;{&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    key = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; k, v &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; pairs(t) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; type(v) == &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;table&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        key = k
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        func(v, l + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; content = string.format(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;%s%s = %s&amp;#34;&lt;/span&gt;, indent .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;  &amp;#34;&lt;/span&gt;, tostring(k),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                      tostring(v))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        print(content)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    print(indent .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;}&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  func(table, level)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print_table({{&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;}, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;})
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æœè¾“å‡ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    1 = {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      1 = 1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      2 = 2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      3 = 3
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    2 = 4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    3 = 5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Lua ä¸­çš„ä¸‰ç›®è¿ç®—</title>
      <link>https://vaaandark.top/posts/lua-ternary-arithmetic/</link>
      <pubDate>Thu, 09 Feb 2023 13:52:51 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/lua-ternary-arithmetic/</guid>
      <description>&lt;p&gt;åœ¨çœ‹ &lt;a href=&#34;https://github.com/skywind3000&#34;&gt;skywind3000&lt;/a&gt; å¤§ç¥å†™çš„ z.lua æ—¶å‘ç°äº†ç¥ç§˜å†™æ³•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;os.argv = arg ~= &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;nil&lt;/span&gt; and arg or {}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;os.path.sep = windows and &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;&lt;/span&gt; or &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸éœ€è¦æ€ä¹ˆæ€è€ƒå°±èƒ½çŸ¥é“è¿™ä¸ªæ˜¯ä¸‰ç›®è¿ç®—ã€‚ä½†æ˜¯åœ¨æˆ‘è®¤çŸ¥ä¸­ï¼ŒLua æ˜¯ä¸æ”¯æŒä¸‰ç›®è¿ç®—ç¬¦çš„ï¼Œå®šç›ä¸€çœ‹æ‰å‘ç°è¿™ä¸ªæ˜¯é€šè¿‡ Lua å¸ƒå°”è¿ç®—ä¸­çš„çŸ­è·¯ç‰¹æ€§æ¨¡æ‹Ÿçš„ä¸‰ç›®è¿ç®—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;lua-ä¸­çš„çŸ­è·¯ç‰¹æ€§&#34;&gt;Lua ä¸­çš„çŸ­è·¯ç‰¹æ€§&lt;/h2&gt;
&lt;p&gt;çŸ­è·¯è¿ç®—çš„æ„æ€æ˜¯åªæœ‰åœ¨éœ€è¦çš„æƒ…å†µä¸‹æ‰å»æ£€æŸ¥æ¡ä»¶ï¼Œä¾‹å¦‚ &lt;code&gt;a and b&lt;/code&gt; å½“ &lt;code&gt;a = false&lt;/code&gt; æ—¶å°±ä¸éœ€è¦æ£€æŸ¥ &lt;code&gt;b&lt;/code&gt; äº†ï¼Œæˆ–è€…æ˜¯ &lt;code&gt;a or b&lt;/code&gt; å½“ &lt;code&gt;a = true&lt;/code&gt; æ—¶ä¹Ÿä¸ç”¨æ£€æŸ¥ &lt;code&gt;b&lt;/code&gt; äº†ã€‚&lt;/p&gt;
&lt;p&gt;Lua ä¸­çš„çŸ­è·¯ç‰¹æ€§ä¸ C ä¸åŒç‚¹åœ¨äºï¼ŒLua çš„å¸ƒå°”æ“ä½œç»“æœå¹¶ä¸åªæ˜¯ã€ŒçœŸã€å’Œã€Œå‡ã€ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚åœ¨ C ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; a = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt; || &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#007f7f&#34;&gt;// a çš„å€¼æ˜¯ 1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è€Œåœ¨ Lua ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; a = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt; or &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;-- a çš„å€¼æ˜¯ 4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; b = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt; and &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#007f7f&#34;&gt;-- a çš„å€¼æ˜¯ 2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Lua å°† &lt;code&gt;nil&lt;/code&gt; å’Œ &lt;code&gt;false&lt;/code&gt; å½“ä½œã€Œå‡ã€ï¼Œå…¶ä½™å€¼éƒ½è§†ä½œã€ŒçœŸã€ï¼ˆåŒ…æ‹¬ 0 ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç„¶è€Œï¼ŒLua çš„å¸ƒå°”è¿ç®—è¿”å›çš„æ˜¯åŸå€¼ï¼Œè€Œä¸æ˜¯ &lt;code&gt;true&lt;/code&gt; æˆ– &lt;code&gt;false&lt;/code&gt; ã€‚æˆ‘æ¨æµ‹è¿™ä¸ Lua å°† &lt;code&gt;nil&lt;/code&gt; å’Œ &lt;code&gt;false&lt;/code&gt; éƒ½å½“ä½œã€Œå‡ã€æœ‰å…³ï¼Œå¦‚æœå¸ƒå°”è¿ç®—è¿”å›äº† &lt;code&gt;false&lt;/code&gt; ï¼Œé‚£ &lt;code&gt;nil&lt;/code&gt; çš„è¯­æ„å°±å˜åŒ–äº†ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;nil æ˜¯ Lua ç‰¹æ®Šçš„ç±»å‹ï¼Œå®ƒå¯èƒ½çš„å€¼åªæœ‰ nil ï¼Œå®ƒä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´ä¹‹ä¸­&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;lua-ä¸‰ç›®è¿ç®—çš„åŸç†&#34;&gt;Lua ä¸‰ç›®è¿ç®—çš„åŸç†&lt;/h2&gt;
&lt;p&gt;ä¸‹é¢å¯ä»¥é€šè¿‡ä¾‹å­æ¥è¯´æ˜ &lt;code&gt;a and b or c&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ &lt;code&gt;a = true&lt;/code&gt; æ—¶ï¼Œè¿™æ—¶ &lt;code&gt;a and b&lt;/code&gt; çš„å€¼ä¸º a ï¼Œç”±äºåç»­æ˜¯ &lt;code&gt;or&lt;/code&gt; ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ˜¯ c&lt;/li&gt;
&lt;li&gt;å½“ &lt;code&gt;a = false&lt;/code&gt; æ—¶ï¼Œè¿™æ—¶ &lt;code&gt;a and b&lt;/code&gt; çš„å€¼ä¸º b ï¼Œç”±äºåç»­æ˜¯ &lt;code&gt;or&lt;/code&gt; ï¼Œ&lt;del&gt;æ‰€ä»¥å¯ä»¥ç›´æ¥æ˜¯ b&lt;/del&gt; ï¼Œ&lt;strong&gt;æ³¨æ„è¿™é‡Œæœ‰ä¸ªå‘ç­‰ä¸‹è¯´&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;lua-ä¸‰ç›®è¿ç®—çš„é™·é˜±&#34;&gt;Lua ä¸‰ç›®è¿ç®—çš„é™·é˜±&lt;/h2&gt;
&lt;p&gt;åœ¨å‰æ–‡ä¸­æåˆ°ï¼Œå½“ &lt;code&gt;a = true&lt;/code&gt; æ—¶æœ‰å‘ã€‚å½“ b ä¸º false æ—¶ï¼Œåç»­æ˜¯ &lt;code&gt;or&lt;/code&gt; æ‰€ä»¥æœ€åçš„å€¼æ˜¯ c ã€‚è¿™å°±æ˜¯ Lua çš„ä¸‰ç›®è¿ç®—æ¨¡æ‹Ÿæ–¹æ³•å¤±æ•ˆçš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº Lua æ˜¯ä¸€é—¨ä¸ table ç»“åˆéå¸¸æ·±çš„è¯­è¨€ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°åˆ©ç”¨ table æ¥è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå› ä¸º table åœ¨å¸ƒå°”è¿ç®—ä¸­åªå¯èƒ½æ˜¯ &lt;code&gt;nil&lt;/code&gt; å’Œ é&lt;code&gt;nil&lt;/code&gt; ï¼ˆè¡¨æ˜¯å¦ä¸ºç©ºï¼‰ï¼Œåªè¦åˆ›é€ å‡ºä¸€ä¸ªä¸ä¸ºç©ºçš„è¡¨ï¼Œå°±å¯ä»¥é¿å…ä¹‹å‰çš„ &lt;code&gt;b = false&lt;/code&gt; çš„æƒ…å†µå‡ºç°äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æœ€åçš„è§£å†³åŠæ³•å°±æ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(a and {b} or {c})[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºè¡¨ &lt;code&gt;{b}&lt;/code&gt; å’Œ &lt;code&gt;{c}&lt;/code&gt; ä¸å¯èƒ½æ˜¯ç©ºè¡¨ï¼Œæ‰€ä»¥å°±ä¸ä¼šã€Œæ‰å‘ã€ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åè¯´ä¸€å¥ï¼ŒLua çœŸæ˜¯å¤ªå¥‡å¦™äº†ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ç”¨ Rust é‡å†™æ˜Ÿé™…è¯‘ç‹</title>
      <link>https://vaaandark.top/posts/rewrite-stardict-in-rust/</link>
      <pubDate>Wed, 25 Jan 2023 13:21:35 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/rewrite-stardict-in-rust/</guid>
      <description>&lt;p&gt;æˆ‘ç»å¸¸æœ‰åœ¨ç»ˆç«¯æŸ¥å•è¯çš„éœ€æ±‚ï¼Œä¹‹å‰ä½¿ç”¨çš„æ˜¯è‡ªå·±å†™çš„ç½‘ç»œçˆ¬è™«ï¼ŒåŸç†æ˜¯æ„é€ ç½‘å€ &amp;ldquo;&lt;a href=&#34;https://www.youdao.com/result?word=%7B%7D&amp;amp;lang=en%22&#34;&gt;https://www.youdao.com/result?word={}&amp;amp;lang=en&amp;quot;&lt;/a&gt; å¹¶è®¿é—®ï¼Œå†é€šè¿‡è§£æ Html æ–‡ä»¶è·å¾—å•è¯è§£é‡Šã€‚ä¸€ä¸ªæœ‹å‹è¯´ä»–ç”¨çš„æ˜¯ sdcv ï¼Œæ˜Ÿé™…è¯‘ç‹çš„ç»ˆç«¯ç‰ˆæœ¬ï¼Œå¯ä»¥æ”¯æŒç¦»çº¿è¯å…¸ã€‚æˆ‘ä¹Ÿæ—¶å¸¸è„±æœºå·¥ä½œï¼Œå¯¹ç¦»çº¿è¯å…¸çš„éœ€æ±‚ä¹Ÿä¸å°ï¼Œæ‰€ä»¥æ‰“ç®—è‡ªå·±å†™ä¸€ä¸ªæ”¯æŒ StarDict æ ¼å¼ç¦»çº¿è¯å…¸çš„è½¯ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç ä»“åº“ï¼šhttps://github.com/vaaandark/rmall&lt;/p&gt;
&lt;h2 id=&#34;stardict-æ ¼å¼&#34;&gt;StarDict æ ¼å¼&lt;/h2&gt;
&lt;p&gt;ä»¥æœ—é“è‹±æ±‰å­—å…¸ä¸ºä¾‹ï¼Œåœ¨è§£å‹ä¸‹è½½å¾—åˆ°çš„å‹ç¼©åŒ…ä¹‹åå¯ä»¥çœ‹åˆ°å…¶ç›®å½•ç»“æ„ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;langdao-ec-gb
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€ langdao-ec-gb.dict.dz
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€ langdao-ec-gb.idx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€ langdao-ec-gb.ifo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1 directory, 3 files
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­æœ‰ä¸‰ç§æ–‡ä»¶ï¼š&lt;code&gt;.dict.dz&lt;/code&gt; æ˜¯å‹ç¼©åçš„å­—å…¸æ–‡ä»¶ï¼Œ&lt;code&gt;.idx&lt;/code&gt; æ˜¯ç´¢å¼•æ–‡ä»¶ï¼Œ&lt;code&gt;.ifo&lt;/code&gt; ä¿å­˜äº†è¯¥å­—å…¸çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ifo-æ–‡ä»¶&#34;&gt;.ifo æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆå¯ä»¥çœ‹ä¸€ä¸‹ &lt;code&gt;langdao-ec-gb.ifo&lt;/code&gt; æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;StarDict&amp;#39;s dict ifo file
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;version=2.4.2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wordcount=435468
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;idxfilesize=10651674
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bookname=æœ—é“è‹±æ±‰å­—å…¸5.0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;author=ä¸Šæµ·æœ—é“ç”µè„‘ç§‘æŠ€å‘å±•æœ‰é™å…¬å¸
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;description=ç½—å°è¾‰ç ´è§£æ–‡ä»¶æ ¼å¼ï¼Œèƒ¡æ­£åˆ¶ä½œè½¬æ¢ç¨‹åºã€‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;date=2003.08.26
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sametypesequence=m
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æŸ¥æ‰¾ç›¸å…³èµ„æ–™åå¯ä»¥çœ‹åˆ°è¿™äº›å­—æ®µçš„å¡«å†™è¦æ±‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bookname=      // required
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wordcount=     // required
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;synwordcount=  // required if &amp;#34;.syn&amp;#34; file exists.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;idxfilesize=   // required
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;idxoffsetbits= // New in 3.0.0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;author=
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;email=
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;website=
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;description=    // You can use &amp;lt;br&amp;gt; for new line.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;date=
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sametypesequence= // very important.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dicttype=
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€ä¸ºé‡è¦çš„æ˜¯ &lt;code&gt;version&lt;/code&gt; å­—æ®µï¼Œå› ä¸ºå¦‚ä»Šåªæ”¯æŒ &lt;code&gt;2.4.2&lt;/code&gt; å’Œ &lt;code&gt;3.0.0&lt;/code&gt; ä¸¤ä¸ªç‰ˆæœ¬ï¼Œè€Œè¿™ä¸¤ä¸ªç‰ˆæœ¬ç´¢å¼•æ–‡ä»¶æ ¼å¼åˆç•¥æœ‰ä¸åŒã€‚&lt;/p&gt;
&lt;h3 id=&#34;idx-æ–‡ä»¶&#34;&gt;.idx æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å†çœ‹çœ‹ &lt;code&gt;.idx&lt;/code&gt; çš„ç´¢å¼•æ–‡ä»¶ï¼ŒStarDict çš„æ–‡æ¡£è¯´å®ƒæ˜¯ç”±å¾ˆå¤šæ¡ç›®(entries)ç»„æˆï¼Œæ¯ä¸ªæ¡ç›®ç”±ä¸€ä¸ªä¸å®šé•¿çš„å•è¯å­—ç¬¦ä¸²åŠ ä¸¤ä¸ªæ•°å­—ç»„æˆã€‚å…¶ä¸­å­—ç¬¦ä¸²ä»¥ &lt;code&gt;\0&lt;/code&gt; ç»“å°¾ï¼Œä¸¤ä¸ªæ•°å­—åˆ†åˆ«ä¸ºè¯¥å•è¯åœ¨å­—å…¸æ–‡ä»¶ä¸­çš„åç§»(offset)å’Œå¤§å°(size)ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šæ–‡æåˆ°äº†ä¸åŒç‰ˆæœ¬çš„ç´¢å¼•æ–‡ä»¶ç•¥æœ‰ä¸åŒï¼Œåœ¨ &lt;code&gt;2.4.2&lt;/code&gt; ä¸­æ•°å­—æ˜¯ 32 ä½çš„æ— ç¬¦å·æ•´å‹ï¼Œåœ¨ &lt;code&gt;3.0.0&lt;/code&gt; ä¸­æ•°å­—æ˜¯ 64 ä½çš„æ— ç¬¦å·æ•´å‹ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘å¯ä»¥å…ˆç”¨ Lua è„šæœ¬å¤§è‡´çœ‹ä¸€ä¸‹å®ƒçš„ç»“æ„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#!/usr/bin/env lua&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- Usage: ./idx.lua path/to/idx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;--        or version 3.0.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;--        ./idx.lua path/to/idx -3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; f = arg[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; pattern = arg[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;] == &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;-3&amp;#39;&lt;/span&gt; and &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&amp;gt;zI8I8&amp;#34;&lt;/span&gt; or &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&amp;gt;zI4I4&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;f = assert(io.open(f, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;rb&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; contents = f:read(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; now
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; word, offset, size
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; not now or now &amp;lt; #contents &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  word, offset, size, now = string.unpack(pattern, contents, now)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  print(string.format(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;%-50s | %8d | %4d&amp;#34;&lt;/span&gt;, word, offset, size))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;f:close()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿è¡Œè¿™ä¸ªå°å·¥å…·å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ./idx.lua ~/.config/rmall/00-langdao-ec-gb/langdao-ec-gb.idx | head
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a                                                  |        0 |  132
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A and B agglutinogens                              |      132 |   24
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A AND NOT B gate                                   |      156 |   19
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A as well as B                                     |      175 |   28
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A B. S. pill                                       |      203 |   45
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a back number                                      |      248 |   29
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a bad actor                                        |      277 |   20
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a bad egg                                          |      297 |    6
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a bad hat                                          |      303 |    6
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a bad job                                          |      309 |   15
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;dictdz-æ–‡ä»¶&#34;&gt;.dict.dz æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªæ–‡ä»¶æœ¬è´¨æ˜¯ç”± gzip å‹ç¼©åçš„æ–‡ä»¶ï¼Œæ‰€ä»¥åªéœ€ä½¿ç”¨ &lt;code&gt;gzip -d&lt;/code&gt; è§£å‹ä¹‹åå°±å¯ä»¥çœ‹åˆ°å®ƒå…¶å®æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬éœ€è¦æŸ¥è¯æ—¶ï¼Œæ ¹æ®ä¸Šæ–‡æåˆ°çš„ç´¢å¼•æ–‡ä»¶ä¸­çš„ &lt;code&gt;offset&lt;/code&gt; å’Œ &lt;code&gt;size&lt;/code&gt; å°±ç›´æ¥çŸ¥é“äº†å•è¯é‡Šä¹‰çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å°æ’æ›²&#34;&gt;å°æ’æ›²&lt;/h2&gt;
&lt;h3 id=&#34;ä½¿ç”¨-rust-è¯»å–-idx&#34;&gt;ä½¿ç”¨ Rust è¯»å– .idx&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ Rust è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶å¹¶ä¸æ˜¯ä»¶å¾ˆéš¾çš„äº‹æƒ…ï¼Œä½†æ˜¯ç”±äºæœ‰ä¸¤ç§ç‰ˆæœ¬çš„ StarDict æ–‡ä»¶ï¼Œå¦‚æœä½¿ç”¨ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«è§£æå°±å¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ Rust çš„æ³›å‹ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¼„æ˜ç™½éœ€æ±‚ï¼Œéœ€æ±‚å°±æ˜¯è¯¥å‡½æ•°åŒæ—¶æ”¯æŒè¯»å– 4 ä¸ªå­—èŠ‚å’Œ 8 ä¸ªå­—èŠ‚çš„æ•°å­—ï¼ŒåŒæ—¶è¦æ»¡è¶³è¯»å–ä¸å®šé•¿çš„å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºä½¿ç”¨äº†å‡½æ•° &lt;code&gt;from_be_bytes&lt;/code&gt; æ¥é€šè¿‡å¤§ç«¯åºè¯»å…¥ï¼Œå®ƒæ˜¯ &lt;code&gt;u32&lt;/code&gt; å’Œ &lt;code&gt;u64&lt;/code&gt; ç­‰æ•°å­—ç±»å‹çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;u32::from_be_bytes&lt;/code&gt; çš„å‡½æ•°ç­¾åæ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Rust&#34; data-lang=&#34;Rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; from_be_bytes(bytes: [&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u8&lt;/span&gt;; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;]) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;u64::from_be_bytes&lt;/code&gt; çš„å‡½æ•°ç­¾åæ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Rust&#34; data-lang=&#34;Rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; from_be_bytes(bytes: [&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u8&lt;/span&gt;; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;8&lt;/span&gt;]) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é—æ†¾åœ°ï¼Œç”±äºè¿™ä¸ªå‡½æ•°ç­¾åçš„åŸå› ï¼Œæˆ‘æ²¡æœ‰æƒ³åˆ°åªä½¿ç”¨ä¸€ä¸ªæ³›å‹å‚æ•°çš„æ–¹æ³•ï¼Œåªèƒ½ä½¿ç”¨ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ç±»å‹ T ï¼Œä¸€ä¸ªæ˜¯è¡¨ç¤ºæ•°ç»„é•¿åº¦çš„å¸¸é‡ N ã€‚&lt;/p&gt;
&lt;p&gt;æ›´åŠ é—æ†¾åœ°ï¼Œæ ‡å‡†åº“ä¸­çš„ &lt;code&gt;from_be_bytes&lt;/code&gt; ä¸å±äºä»»ä½•ä¸€ä¸ª trait ï¼Œæƒ³è¦å°† &lt;code&gt;u32&lt;/code&gt; å’Œ &lt;code&gt;u64&lt;/code&gt; è¿™æ ·èƒ½ä»å­—èŠ‚è¯»å…¥çš„æ•°æ®æŠ½è±¡åˆ°ä¸€èµ·è¿˜å¹¶ä¸ç®€å•ã€‚å¥½åœ¨ç»è¿‡ Google æ‰¾åˆ°äº†ä¸€ä¸ªå«åš &lt;code&gt;eio&lt;/code&gt; çš„ crate ï¼Œå®ƒæœ‰ç€ trait &lt;code&gt;FromBytes&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Rust&#34; data-lang=&#34;Rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;trait&lt;/span&gt; FromBytes&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; N: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;usize&lt;/span&gt;&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; from_be_bytes(bytes: [&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u8&lt;/span&gt;; N]) -&amp;gt; Self;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; from_le_bytes(bytes: [&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u8&lt;/span&gt;; N]) -&amp;gt; Self;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰€ä»¥æˆ‘çš„ &lt;code&gt;read_bytes&lt;/code&gt; å‡½æ•°ç»ˆäºæˆå‹äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Rust&#34; data-lang=&#34;Rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; read_bytes&amp;lt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; N: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;usize&lt;/span&gt;, T&amp;gt;(path: PathBuf) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Result&lt;/span&gt;&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;&amp;lt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;String&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;usize&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;usize&lt;/span&gt;)&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    T: FromBytes&amp;lt;N&amp;gt; + TryInto&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;usize&lt;/span&gt;&amp;gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &amp;lt;T &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; TryInto&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;usize&lt;/span&gt;&amp;gt;&amp;gt;::Error: Debug,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; f = File::open(path).map_err(|_| Error::CannotOpenIdxFile)?;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; f = BufReader::new(f);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; items: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;&amp;lt;_&amp;gt; = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;::new();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; buf: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u8&lt;/span&gt;&amp;gt; = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;::new();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Ok&lt;/span&gt;(n) = f.read_until(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; buf) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; n == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        buf.pop();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; word = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;String&lt;/span&gt;::new();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        buf.iter().for_each(|x| word.push(*x &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        buf.clear();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; b = [&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; N];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        f.read(&amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; b).map_err(|_| Error::IdxFileParsingError)?;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; offset = T::from_be_bytes(b).try_into().unwrap();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; b = [&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; N];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        f.read(&amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; b).map_err(|_| Error::IdxFileParsingError)?;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; size = T::from_be_bytes(b).try_into().unwrap();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        items.push((word, offset, size))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Ok&lt;/span&gt;(items)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨è¿™é‡Œå°† &lt;code&gt;u32&lt;/code&gt; å’Œ &lt;code&gt;u64&lt;/code&gt; ç±»å‹ &lt;code&gt;try_into&lt;/code&gt; æˆ usize ï¼Œä½¿ç”¨äº† &lt;code&gt;unwrap()&lt;/code&gt; ï¼Œå› æ­¤éœ€è¦ &lt;code&gt;&amp;lt;T as TryInto&amp;lt;usize&amp;gt;&amp;gt;::Error: Debug&lt;/code&gt; ï¼Œè€Œå®é™…ä¸Šè¿™é‡Œçš„è½¬æ¢æ˜¯å¹¶ä¸ä¼š panic çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…³äºå­—å…¸åºçš„ä¹Œé¾™&#34;&gt;å…³äºã€Œå­—å…¸åºã€çš„ä¹Œé¾™&lt;/h3&gt;
&lt;p&gt;å­—å…¸åºæ˜¯æŒ‡æŒ‰ç…§å•è¯å‡ºç°åœ¨å­—å…¸çš„é¡ºåºè¿›è¡Œæ’åºçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å­¦è¿‡ç¦»æ•£æ•°å­¦çš„éƒ½çŸ¥é“å­—å…¸åºæ˜¯ä¸€ç§å…¨åºï¼Œå­¦è¿‡ä»»ä½•ä¸€ç§ç¼–ç¨‹è¯­è¨€çš„ä¹ŸçŸ¥é“ï¼Œåœ¨ç¼–ç¨‹è¯­è¨€ä¸­æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°ä¸€èˆ¬éƒ½æ˜¯åˆ©ç”¨å­—å…¸åºã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ C è¯­è¨€ä¸­ï¼Œ&lt;code&gt;strcmp()&lt;/code&gt; å‡½æ•°å°±æ˜¯å¯¹æ¯ä¸ªå­—ç¬¦çš„å¤§å°è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå½“å‰å­—ç¬¦ç›¸åŒå°±æ¯”è¾ƒä¸‹ä¸€ä¸ªï¼Œç›´åˆ°æ¯”è¾ƒå‡ºæ¥å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·çš„ä¸¥æ ¼æŒ‰ ASCII è¡¨çš„å­—å…¸åºå…¶å®ä¸æ˜¯ç°å®ä¸–ç•Œä¸­å­—å…¸çš„æ ·å­ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå•è¯ China å’Œ china è¿™ä¸¤ä¸ªå•è¯å¦‚æœæŒ‰ç…§ç¼–ç¨‹è¯­è¨€çš„å­—å…¸åºæ¥æ’ç»ä¸ä¼šåœ¨ç›¸é‚»çš„åœ°æ–¹ã€‚å› ä¸º C æ˜¯ 103 è€Œ c æ˜¯ 143 ï¼Œå¯¹ä»¥ c(C) å¼€å¤´çš„å•è¯æ’åºï¼Œä¸€å®šæ˜¯æ‰€æœ‰ä»¥å¤§å†™ C å¼€å¤´çš„å•è¯æ’åˆ—å®Œæˆåå†æ˜¯ä»¥å°å†™ c å¼€å¤´çš„å•è¯ï¼Œè¿™å’Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ°çš„è‹±æ–‡è¯å…¸å®é™…æƒ…å†µä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ç°å®ä¸–ç•Œä¸­çš„ã€Œå­—å…¸åºã€åº”è¯¥æ˜¯å…ˆå¿½ç•¥å¤§å°å†™è¿›è¡Œæ’åºï¼Œç›¸åŒå•è¯å†è€ƒè™‘å¤§å°å†™ï¼Œè¿™æ ·èƒ½ä¿è¯åªæ˜¯å¤§å°å†™ä¸åŒçš„å•è¯ä¼šåœ¨ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€å¼€å§‹å†™æŸ¥æ‰¾å•è¯çš„æ—¶å€™ï¼Œæˆ‘ç›´æ¥ä½¿ç”¨ &lt;code&gt;binary_search_by_key&lt;/code&gt; æ¥æŸ¥æ‰¾ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Rust&#34; data-lang=&#34;Rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; lookup(&amp;amp;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt; self, word: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Ok&lt;/span&gt;(pos) = self.idx.items.binary_search_by_key(&amp;amp;word, |x| &amp;amp;x.&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; (_, offset, size) = self.idx.items[pos];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self.dict.get(offset, size)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        panic!();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·åšçš„åæœå°±æ˜¯æŸ¥ä¸åˆ°å¤§éƒ¨åˆ†çš„å•è¯ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯ &lt;code&gt;.idx&lt;/code&gt; æ–‡ä»¶ä¸è§„èŒƒï¼Œä½†æˆ‘ä»”ç»†æ€è€ƒåå‘ç°äº†ã€Œå­—å…¸åºã€çš„ä¹Œé¾™åå°±æ”¹å˜äº†å†™æ³•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Rust&#34; data-lang=&#34;Rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; lookup(&amp;amp;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt; self, word: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Result&lt;/span&gt;&amp;lt;&amp;amp;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;str&lt;/span&gt;&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Ok&lt;/span&gt;(pos) = self.idx.items.binary_search_by(|probe| {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        probe
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            .&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            .to_lowercase()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            .cmp(&amp;amp;word.to_lowercase())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            .then(probe.&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.&lt;/span&gt;as_str().cmp(&amp;amp;word))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; (_, offset, size) = self.idx.items[pos];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Ok&lt;/span&gt;(self.dict.get(offset, size))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Err&lt;/span&gt;(Error::WordNotFound(self.ifo.bookname.to_string()))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å¤šå­—å…¸æ”¯æŒ&#34;&gt;å¤šå­—å…¸æ”¯æŒ&lt;/h3&gt;
&lt;p&gt;ä¹‹å‰æš‚æ—¶æ²¡æœ‰åœ¨ç¨‹åºä¸­é›†æˆå¤šå­—å…¸ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ Shell è„šæœ¬å®ç°ç±»ä¼¼çš„æ•ˆæœï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;word=&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;$1&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; i in langdao-ec-gb oxford-gb cdict-gb kdic-computer-gb; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; rmall lookup -l &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;$HOME&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;/.config/rmall/&lt;/span&gt;$i&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;$word&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;exit&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;rmall lookup &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;$word&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æŸ¥è¯æ—¶å°±ä¼šæŒ‰ç…§ç›¸åº”çš„ç¦»çº¿è¯å…¸ä¼˜å…ˆçº§æŸ¥æ‰¾ï¼Œå¦‚æœéƒ½æ²¡æ‰¾åˆ°åˆ™ä½¿ç”¨ç”µå­è¯å…¸ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨é›†æˆäº†å¤šå­—å…¸åŠŸèƒ½ï¼Œå¯ä»¥å°†è¯å…¸ç›®å½•åˆ†åˆ«å‘½åä¸º &lt;code&gt;00-XXX&lt;/code&gt;, &lt;code&gt;01-YYY&lt;/code&gt;, &amp;hellip;, &lt;code&gt;99-ZZZ&lt;/code&gt; è¿™æ ·çš„æ ¼å¼æ¥å®ç°ä¼˜å…ˆçº§ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ rmall -L terraria
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Error: WordNotFound(&amp;#34;æœ—é“è‹±æ±‰å­—å…¸5.0&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Error: WordNotFound(&amp;#34;ç‰›æ´¥ç°ä»£è‹±æ±‰åŒè§£è¯å…¸&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Error: WordNotFound(&amp;#34;CDICT5è‹±æ±‰è¾å…¸&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Error: WordNotFound(&amp;#34;è®¡ç®—æœºè¯æ±‡&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;terraria
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;è‹± / tÉ›ËˆrÉ›ËrÉªÉ™ / ç¾ / tÉ›ËˆrÉ›ËrÉªÉ™ /
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; æ³°æ‹‰ç‘äºšï¼ˆæ¸¸æˆåï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Xbox Live ArcadeMarch 27, 2013PlayStation VitaLate Fall 2013iOSAugust 29, 2013http://www.terrariaonline.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/huzheng001/stardict-3/blob/master/dict/doc/StarDictFileFormat&#34;&gt;StarDict å­—å…¸æ ¼å¼&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Mailx å’Œ Swaks çš„ä½¿ç”¨</title>
      <link>https://vaaandark.top/posts/mailx-and-swaks/</link>
      <pubDate>Wed, 18 Jan 2023 21:12:39 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/mailx-and-swaks/</guid>
      <description>&lt;p&gt;æŒ‰ç…§ Mailx è‡ªå·±çš„ä»‹ç»ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¢å¼ºäº†çš„ Mail å‘½ä»¤ï¼Œæä¾›äº†æ›´å¤šçš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸è§„ç”¨æ³•æ˜¯ï¼š &lt;code&gt;mailx -s &amp;quot;{{subject}}&amp;quot; {{to_addr}}&lt;/code&gt;ï¼Œé€šè¿‡é…ç½®ä¹‹åå¯ä»¥ä½¿ç”¨é‚®ç®±è¿è¥å•†çš„æœåŠ¡å™¨å‘é€é‚®ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä½¿ç”¨ QQ é‚®ç®±ä¸ºä¾‹ï¼Œå¯ä»¥ç¼–è¾‘ &lt;code&gt;/etc/mail.rc&lt;/code&gt; çš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç¼–è¾‘ &lt;code&gt;~/.mailrc&lt;/code&gt; çš„æœ¬åœ°é…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨æœ¬åœ°çš„é…ç½®æ–‡ä»¶ï¼Œé¦–å…ˆè¦å°†å…¨å±€é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°æœ¬åœ°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cp /etc/mail.rc .mailrc
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åç¼–è¾‘ &lt;code&gt;.mailrc&lt;/code&gt; æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# ~/.mailrc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;set from={{your_email_address}}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;set smtp=smtps://smtp.qq.com:465
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;set smtp-auth=login
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;set smtp-auth-user={{your_email_address}}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;set smtp-auth-password={{authorization_code}}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;set ssl-verify=ignore
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„æˆæƒç æ˜¯ QQ é‚®ç®±ç”¨äºç™»å½•ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯çš„ï¼Œå¹¶ä¸æ˜¯ QQ é‚®ç®±å¯†ç ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;mailx&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/mailx.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ€åå¯ä»¥å‘ä¸ªé‚®ä»¶æµ‹è¯•ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ mailx -s &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;Mailx Test&amp;#39;&lt;/span&gt; {{to_addr}} &amp;lt;&amp;lt;&amp;lt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;This is a test to check if mailx works well.&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æœ‹å‹çš„æ¨èä¸‹ï¼Œæˆ‘çŸ¥é“äº†æœ‰å¦ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§è€Œä¸” standalone çš„åŒ… &lt;code&gt;swaks&lt;/code&gt; ï¼Œå®ƒåªä¾èµ–äº perl è§£é‡Šå™¨ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;swaks&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/swaks.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å’Œ &lt;code&gt;mailx&lt;/code&gt; çš„é…ç½®ç±»ä¼¼ï¼Œå®ƒéœ€è¦ä¿®æ”¹ &lt;code&gt;.swaksrc&lt;/code&gt; æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--from {{your_email_address}}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--server smtp.qq.com
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--auth-user {{your_qq}}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--auth-password {{authorization_code}}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŒæ ·å¯ä»¥å‘ä¸ªé‚®ä»¶æµ‹è¯•ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;swaks --to {{to_addr}} --h-Subject &amp;#39;Swaks Test&amp;#39; --body &amp;#39;This is a test for swaks&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>SQLite å…¥é—¨ï¼ˆæŒç»­æ›´æ–°ï¼‰</title>
      <link>https://vaaandark.top/posts/sqlite-introduction/</link>
      <pubDate>Thu, 05 Jan 2023 17:37:03 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/sqlite-introduction/</guid>
      <description>&lt;p&gt;æœ€è¿‘æƒ³å†™ä¸€ä¸ªå°å·¥å…·ï¼Œéœ€è¦ç”¨åˆ° SQLite ã€‚ä¹‹å‰åªä¼šä¸€ç‚¹ç‚¹çš„ &lt;code&gt;INSERT&lt;/code&gt; å’Œ &lt;code&gt;DELETE&lt;/code&gt; ï¼Œç°åœ¨æƒ³æ­£å¼å…¥é—¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç‚¹å‘½ä»¤&#34;&gt;ç‚¹å‘½ä»¤&lt;/h2&gt;
&lt;p&gt;ç‚¹å‘½ä»¤ä¸ä»¥ &lt;code&gt;;&lt;/code&gt; ç»“æŸï¼Œå®ƒä»¬ä¸€èˆ¬å¹¶ä¸ç›´æ¥æ“ä½œæ•°æ®åº“ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ &lt;code&gt;.help&lt;/code&gt; æ¥çœ‹å¯ä»¥ä½¿ç”¨çš„ç‚¹å‘½ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.runoob.com/sqlite/sqlite-commands.html&#34;&gt;èœé¸Ÿæ•™ç¨‹ SQLite ç‚¹å‘½ä»¤&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;sqlite-è¯­å¥&#34;&gt;SQLite è¯­å¥&lt;/h2&gt;
&lt;p&gt;è¿™äº›ä¸æ•°æ®åº“ç›´æ¥è¿›è¡Œäº¤äº’çš„å‘½ä»¤åŒ…æ‹¬ &lt;code&gt;CREATE&lt;/code&gt;, &lt;code&gt;SELECT&lt;/code&gt;, &lt;code&gt;INSERT&lt;/code&gt;, &lt;code&gt;UPDATE&lt;/code&gt;, &lt;code&gt;DELETE&lt;/code&gt;, å’Œ &lt;code&gt;DROP&lt;/code&gt; ï¼Œå¯ä»¥æ ¹æ®æ“ä½œæ€§è´¨åˆ†ä¸ºä¸‰ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DDL - æ•°æ®å®šä¹‰è¯­è¨€&lt;/li&gt;
&lt;li&gt;DML - æ•°æ®æ“ä½œè¯­è¨€&lt;/li&gt;
&lt;li&gt;DQL - æ•°æ®æŸ¥è¯¢è¯­è¨€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€æœ‰çš„ SQLite è¯­è¨€å¯ä»¥ä»¥ä»»ä½•å…³é”®å­—å¼€å§‹ï¼Œä»¥ &lt;code&gt;;&lt;/code&gt; ç»“æŸã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.runoob.com/sqlite/sqlite-intro.html&#34;&gt;èœé¸Ÿæ•™ç¨‹ SQLite&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.sqlite.org/index.html&#34;&gt;SQLite å®˜æ–¹æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.sqlitetutorial.net/&#34;&gt;SQLite Tutorial&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å†…è”æ±‡ç¼–</title>
      <link>https://vaaandark.top/posts/inline-assembly/</link>
      <pubDate>Mon, 02 Jan 2023 16:27:19 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/inline-assembly/</guid>
      <description>&lt;p&gt;é«˜ä¸­ç¬¬ä¸€æ¬¡çœ‹åˆ°åœ¨ C è¯­è¨€ä¸­åµŒå…¥æ±‡ç¼–è¯­è¨€æ—¶ï¼Œæˆ‘å°±è§‰å¾—å®ƒéå¸¸å¥½ç©ï¼Œåˆ°å¤§å­¦åˆšå¼€å­¦çš„æ—¶å€™ï¼Œæˆ‘ç”šè‡³æœ‰ä½¿ç”¨å®ƒçš„éœ€æ±‚ï¼Œå¯æƒœç›´åˆ°ç°åœ¨æˆ‘æ‰æŠ½å‡ºæ—¶é—´å¼€å§‹å­¦ä¹ å®ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;åˆ†ç±»&#34;&gt;åˆ†ç±»&lt;/h2&gt;
&lt;p&gt;åœ¨ GNU çš„ GCC ä¸­ï¼Œå†…è”æ±‡ç¼–è¢«åˆ†ä¸ºä¸¤ç±»ï¼š&lt;strong&gt;Basic asm&lt;/strong&gt; å’Œ &lt;strong&gt;Extended asm&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;p&gt;GCC çš„å®˜æ–¹æ–‡æ¡£ä¸­å†™åˆ°ï¼Œåœ¨å‡½æ•°ä¸­æ··åˆä½¿ç”¨ C è¯­è¨€å’Œæ±‡ç¼–è¯­è¨€æ—¶ï¼Œæœ€å¥½ä½¿ç”¨æ‰©å±•å½¢å¼ï¼›ä½†æ˜¯è¦åœ¨é¡¶å±‚(top level)åŒ…å«æ±‡ç¼–è¯­è¨€ï¼Œåˆ™å¿…é¡»ä½¿ç”¨åŸºæœ¬å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„ &lt;strong&gt;top level&lt;/strong&gt; ä¸€è¯éå¸¸è¯¡å¼‚ï¼Œè®©æˆ‘æ‘¸ä¸ç€å¤´è„‘ï¼Œä¹‹åæˆ‘åœ¨å®˜æ–¹æ–‡æ¡£çš„åæ–‡å‘ç°äº†è››ä¸é©¬è¿¹ï¼š&lt;/p&gt;
&lt;p&gt;ä¸¤ç§å¿…é¡»ä½¿ç”¨ Basic asm çš„æƒ…å½¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Extended asm å£°æ˜å¿…é¡»åœ¨ C å‡½æ•°å†…ï¼Œæ‰€ä»¥å¦‚æœåœ¨æ–‡ä»¶ä½œç”¨åŸŸ(top-level)ï¼Œåœ¨å‡½æ•°ä¹‹å¤–ä½¿ç”¨æ±‡ç¼–ï¼Œå¿…é¡»ä½¿ç”¨ Basic asm ã€‚ä½ å¯ä»¥ä½¿ç”¨æ­¤æŠ€æœ¯å‘å‡ºæ±‡ç¼–ç¨‹åºæŒ‡ä»¤ï¼Œå®šä¹‰å¯åœ¨æ–‡ä»¶çš„å…¶ä»–ä½ç½®è°ƒç”¨çš„æ±‡ç¼–è¯­è¨€å®ï¼Œæˆ–ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™æ•´ä¸ªå‡½æ•°ã€‚&lt;/li&gt;
&lt;li&gt;å‡½æ•°çš„å±æ€§(attribute)è¢«å£°æ˜ä¸º naked æ—¶å¿…é¡»ä½¿ç”¨ Basic asm ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;naked attribute åœ¨æ­¤ä¸åšå±•å¼€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è°œåº•æ­å¼€äº†ï¼ŒåŸæ¥ top level æŒ‡çš„å°±æ˜¯æ–‡ä»¶è¿™ä¸€å±‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;basic-asm&#34;&gt;Basic asm&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨å…³é”®å­— &lt;code&gt;asm&lt;/code&gt; æ¥å£°æ˜ä¸€æ®µå†…è”æ±‡ç¼–ï¼Œä¸è¿‡è¿™æ˜¯ GNU çš„æ‹“å±•ï¼Œå¦‚æœåœ¨ç¼–è¯‘æ¡ä»¶ä¸­ä½¿ç”¨äº† &lt;code&gt;-std&lt;/code&gt; æˆ–è€… &lt;code&gt;-ansi&lt;/code&gt; æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ &lt;code&gt;__asm__&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¿®é¥°&#34;&gt;ä¿®é¥°&lt;/h3&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ &lt;code&gt;volatile&lt;/code&gt; å’Œ &lt;code&gt;inline&lt;/code&gt; æ¥ä¿®é¥°ï¼Œä¸è¿‡ &lt;code&gt;volatile&lt;/code&gt; æ²¡æœ‰ä½œç”¨ï¼Œæ‰€æœ‰çš„å†…è”æ±‡ç¼–ä»£ç æ®µéƒ½æ˜¯é»˜è®¤ &lt;code&gt;volatile&lt;/code&gt; çš„ã€‚å¦‚æœä½¿ç”¨ &lt;code&gt;inline&lt;/code&gt; ï¼Œé‚£ä¹ˆä¸ºäº†å†…è”çš„ç›®çš„ï¼Œå†…è”æ±‡ç¼–è¯­å¥çš„å¤§å°è¢«å½“ä½œæ˜¯å¯èƒ½çš„æœ€å°å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ¶‰åŠåˆ°äº†å†…è”æ±‡ç¼–çš„å¤§å°ä¼°è®¡ï¼Œè¿™æ˜¯å› ä¸ºå†…è”æ±‡ç¼–ç”Ÿæˆçš„æœ€ç»ˆä»£ç åªç”±æ±‡ç¼–å™¨(Assembler)çŸ¥æ™“ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨éœ€è¦è‡ªå·±ä¼°ç®—ï¼Œé€šè¿‡æŸ¥æ‰¾ &lt;code&gt;&#39;\n\t&#39;&lt;/code&gt;, &lt;code&gt;&#39;;&#39;&lt;/code&gt; ç­‰ç¬¦å·æ¥ä¼°è®¡æŒ‡ä»¤æ•°ï¼ˆè¡Œæ•°ï¼‰ï¼Œå†ä¹˜ä»¥å¯èƒ½çš„æœ€é•¿æŒ‡ä»¤é•¿åº¦æ¥è·å¾—ä¼°ç®—å¤§å°ã€‚æ‰€ä»¥å¦‚æœåœ¨ &lt;code&gt;inline&lt;/code&gt; çš„ Basic asm ä¸­ä½¿ç”¨äº†ä¼ªæŒ‡ä»¤ç­‰èƒ½ç”Ÿæˆæ±‡ç¼–è¯­å¥çš„æˆåˆ†ï¼Œæ±‡ç¼–å™¨å¯èƒ½ä¼šæŠ¥é”™ unreachable ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ˜¯å¦éœ€è¦ä¼°è®¡å†…è”æ±‡ç¼–çš„å¤§å°ï¼Œè¿™ä¸ªä¸å¹³å°æœ‰å…³ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;å‚æ•°&#34;&gt;å‚æ•°&lt;/h3&gt;
&lt;p&gt;åˆè¢«ç§°ä¸º &lt;code&gt;AssemblerTemplate&lt;/code&gt; ï¼Œç”±å­—ç¬¦ä¸²å­—é¢å€¼ç»„æˆï¼Œè¯¥å­—ç¬¦ä¸²ç”±æ±‡ç¼–è¯­å¥ç»„æˆï¼Œå¯ä»¥åŒ…æ‹¬ä¼ªæŒ‡ä»¤ï¼ŒGCC çš„ç¼–è¯‘å™¨å¹¶ä¸æ£€æŸ¥å®ƒä»¬çš„æœ‰æ•ˆæ€§ï¼ŒæŒ‡ä»¤ä¼šè¢«ç›´æ¥ä¼ é€’åˆ°æ±‡ç¼–å™¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€æ®µå†…è”æ±‡ç¼–ä¸­ä½¿ç”¨å¤šæ¡æ±‡ç¼–è¯­å¥æ—¶è¦æ³¨æ„è‡ªå·±ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæ±‡ç¼–å™¨ï¼ˆä»¥åŠå®ƒä»¬ä½¿ç”¨çš„æ˜¯ä½•ç§æ±‡ç¼–æ–¹è¨€ï¼‰ï¼Œä¸€èˆ¬éƒ½å¯ä»¥ç”¨ &lt;code&gt;&#39;\n\t&#39;&lt;/code&gt; æ¥åˆ†éš”ï¼Œæœ‰äº›æ±‡ç¼–å™¨å¯ä»¥ä½¿ç”¨ &lt;code&gt;&#39;;&#39;&lt;/code&gt; ï¼Œä½†è¦æ³¨æ„åœ¨è¿™ç§æ±‡ç¼–æ–¹è¨€ä¸­åˆ†å·æ˜¯ä¸æ˜¯æ³¨é‡Šå¼€å§‹çš„ç¬¦å·ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ³¨æ„&#34;&gt;æ³¨æ„&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç”±äºè°ƒç”¨å‡½æ•°ä»¥åŠè®¿é—® C æ•°æ®å¯èƒ½å¾ˆå¤æ‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨ Extended asm æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨ç¼–è¯‘å™¨ä¼˜åŒ–åè¿ç»­çš„ asm å£°æ˜å¯èƒ½ä¸å†è¿ç»­ï¼Œæ‰€ä»¥å¦‚è¦éœ€è¦è¿ç»­è¯­å¥ï¼Œè¯·å†™åœ¨åŒä¸€ä¸ª asm è¯­å¥ä¸­ã€‚å°¤å…¶æ˜¯ä¸¤ä¸ª asm å£°æ˜ä¸­åŒ…å«äº†è·³è½¬æ—¶ï¼Œå¦‚æœè¢«ç¼–è¯‘å™¨è°ƒæ•´é¡ºåºåˆ™ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„åæœã€‚å¦‚æœè¦è·³è½¬åˆ° C æ ‡ç­¾ï¼Œè¿˜æ˜¯ä½¿ç”¨ Extended asm æ›´å¥½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœåœ¨æ±‡ç¼–è¯­å¥ä¸­å®šä¹‰äº†ç¬¦å·æˆ–è€…æ ‡ç­¾ï¼Œå¯èƒ½ä¼šå¯¼è‡´é‡å¤ç¬¦å·çš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;extended-asm&#34;&gt;Extended asm&lt;/h2&gt;
&lt;p&gt;æ‹“å±•å†…è”æ±‡ç¼–æœ‰ä¸¤ç§æ¨¡æ¿ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;asm&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;asm&lt;/span&gt;-qualifiers ( AssemblerTemplate 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 : OutputOperands 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 [ : InputOperands
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                 [ : Clobbers ] ])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;asm&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;asm&lt;/span&gt;-qualifiers ( AssemblerTemplate 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      : OutputOperands
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      : InputOperands
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      : Clobbers
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      : GotoLabels)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŒæ ·åœ°ï¼Œåœ¨ä¸ä½¿ç”¨ GNU æ‹“å±•æ—¶è¦ç”¨ &lt;code&gt;__asm__&lt;/code&gt; ä»£æ›¿ &lt;code&gt;asm&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¿®é¥°-1&#34;&gt;ä¿®é¥°&lt;/h3&gt;
&lt;p&gt;é™¤äº† &lt;code&gt;volatile&lt;/code&gt; å’Œ &lt;code&gt;inline&lt;/code&gt; å¤–ï¼Œè¿˜æœ‰ &lt;code&gt;goto&lt;/code&gt; ï¼Œè¡¨ç¤ºè¿™æ®µå†…è”æ±‡ç¼–ä»£ç å¯èƒ½ä¼šè·³è½¬åˆ° &lt;code&gt;GotoLabels&lt;/code&gt; ä¸­çš„æŸä¸€ä¸ªæ ‡ç­¾ä¸Šã€‚&lt;/p&gt;
&lt;h3 id=&#34;å‚æ•°-1&#34;&gt;å‚æ•°&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;input&lt;/code&gt;, &lt;code&gt;output&lt;/code&gt;, &lt;code&gt;goto&lt;/code&gt; çš„æ“ä½œæ•°åŠ èµ·æ¥ä¸èƒ½è¶…è¿‡ 30 ä¸ªã€‚&lt;/p&gt;
&lt;h4 id=&#34;assemblertemplate&#34;&gt;AssemblerTemplate&lt;/h4&gt;
&lt;p&gt;åŒæ ·æ˜¯ç”±å­—ç¬¦ä¸²å­—é¢å€¼ç»„æˆï¼Œä½†æ˜¯é‡Œé¢åŒ…å«äº†ä¸€äº›æ ‡è¯†ç¬¦ï¼Œå®ƒä»¬æŒ‡å‘äº† &lt;code&gt;output&lt;/code&gt;, &lt;code&gt;input&lt;/code&gt;, &lt;code&gt;goto&lt;/code&gt; ä¸­çš„æ“ä½œæ•°ã€‚&lt;/p&gt;
&lt;h4 id=&#34;outputoperands&#34;&gt;OutputOperands&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸èƒ½å°†å…¶å•çº¯ç†è§£ä¸ºè¾“å‡ºï¼Œè€Œæ˜¯ç†è§£ä¸ºä¼šè¢«ä¿®æ”¹çš„å˜é‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”± &lt;code&gt;AssemblerTemplate&lt;/code&gt; ä¸­çš„æŒ‡ä»¤ä¿®æ”¹çš„ C å˜é‡åˆ—è¡¨ï¼Œç”±é€—å·åˆ†éš”ï¼Œå¯ä»¥ä¸ºç©ºã€‚&lt;/p&gt;
&lt;p&gt;ç»“æ„ä¸€èˆ¬ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[ [asmSymbolicName]  ] constraint (cvariablename)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h5 id=&#34;asmsymbolicname&#34;&gt;asmSymbolicName&lt;/h5&gt;
&lt;p&gt;å¯ä»¥ç†è§£ä¸ºåœ¨è¿™æ®µæ‹“å±•å†…è”æ±‡ç¼–ä¸­çš„ç¬¦å·åˆ«åï¼Œå®ƒå¯ä»¥å’Œä¸Šä¸‹æ–‡ä¸­çš„ C è¯­è¨€ç¬¦å·é‡å¤ï¼Œä¹Ÿå¯ä»¥å’Œå…¶ä»–å†…è”æ±‡ç¼–ä»£ç ä¸­çš„ç¬¦å·åé‡å¤ã€‚åœ¨ &lt;code&gt;AssemblerTemplate&lt;/code&gt; ä¸­çš„ä½¿ç”¨æ–¹æ³•ä¸º &lt;code&gt;%[Value]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸ä½¿ç”¨ç¬¦å·åˆ«åï¼Œåˆ™å¿…é¡»ä½¿ç”¨ä½ç½®ç¼–å·æ¥æŒ‡ç¤ºç¬¦å·ï¼Œä¾‹å¦‚ &lt;code&gt;OutputOperands&lt;/code&gt; ä¸­æœ‰ä¸‰é¡¹ï¼Œåˆ™ç”¨ &lt;code&gt;%0&lt;/code&gt;, &lt;code&gt;%1&lt;/code&gt; å’Œ &lt;code&gt;%2&lt;/code&gt; è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;h5 id=&#34;constraint&#34;&gt;constraint&lt;/h5&gt;
&lt;p&gt;Output çš„çº¦æŸä¿®é¥°ç¬¦å¿…é¡»æ˜¯ä»¥ &lt;code&gt;&#39;=&#39;&lt;/code&gt; å¼€å§‹ï¼ˆè¡¨ç¤ºå°†ä¼šè¦†å†™è¿™ä¸ªå˜é‡ï¼‰ï¼Œå¦‚æœè¿™ä¸ªå˜é‡æ—¢è¢«è¯»ä¹Ÿè¢«å†™å°±éœ€è¦ &lt;code&gt;&#39;+&#39;&lt;/code&gt; ã€‚å½“ä½¿ç”¨ &lt;code&gt;&#39;=&#39;&lt;/code&gt; æ—¶ä¸è¦å‡å®šå¯ä»¥è¯»å–åˆ°å°†è¢«è¦†å†™çš„å˜é‡çš„å½“å‰å€¼ï¼Œé™¤éè¿™ä¸ªå˜é‡ä¹Ÿåœ¨ Input åˆ—è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨äº† &lt;code&gt;&#39;+&#39;&lt;/code&gt; çš„æ“ä½œæ•°è§†ä½œä¸¤ä¸ªï¼ˆåœ¨è®¡ç®—æ€»ä¸ªæ•°åŠä½ç½®æ—¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜éœ€è¦å¯¹å€¼æ‰€åœ¨çš„ä½ç½®è¿›è¡Œçº¦æŸï¼Œä¾‹å¦‚ &lt;code&gt;&#39;r&#39;&lt;/code&gt; è¡¨ç¤ºå¯„å­˜å™¨ï¼Œ&lt;code&gt;&#39;m&#39;&lt;/code&gt; è¡¨ç¤ºåœ¨å†…å­˜ã€‚å¦‚æœä½¿ç”¨äº†ä¸€ä¸ªä»¥ä¸Šçš„ä½ç½®çº¦æŸä¿®é¥°ç¬¦ï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©å®ƒè®¤ä¸ºæœ€å¥½çš„æ–¹å¼è¿›è¡Œä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°å­—è¿›è¡Œçº¦æŸï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;asm&lt;/span&gt; (&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;incl %0&amp;#34;&lt;/span&gt; :&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;=a&amp;#34;&lt;/span&gt;(var):&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;(var));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¡¨ç¤ºè¾“å…¥ä¸­çš„ &lt;code&gt;var&lt;/code&gt; ä½¿ç”¨çš„æ˜¯å’Œè¾“å‡ºä¸­çš„ &lt;code&gt;var&lt;/code&gt; ç›¸åŒçš„çº¦æŸï¼Œè¿™é‡Œçš„ 0 è¡¨ç¤ºä¸ºç¼–å·ä¸º 0 çš„æ“ä½œæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸ç”¨çš„çº¦æŸï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ç¬¦å·&lt;/th&gt;
          &lt;th&gt;å«ä¹‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;I&lt;/td&gt;
          &lt;td&gt;a constant&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;a&lt;/td&gt;
          &lt;td&gt;use eax&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;b&lt;/td&gt;
          &lt;td&gt;use ebx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;c&lt;/td&gt;
          &lt;td&gt;use ecx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;d&lt;/td&gt;
          &lt;td&gt;use edx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;S&lt;/td&gt;
          &lt;td&gt;use esi&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;D&lt;/td&gt;
          &lt;td&gt;use edi&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;r&lt;/td&gt;
          &lt;td&gt;use one of eax, ebx, ecx or edx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;q&lt;/td&gt;
          &lt;td&gt;use one of eax, ebx, ecx, edx, esi or edi&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å…¶ä½™è§ GCC æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;h5 id=&#34;cvariablename&#34;&gt;cvariablename&lt;/h5&gt;
&lt;p&gt;ä¸€ä¸ª C å·¦å€¼è¡¨è¾¾å¼ï¼Œä¸€èˆ¬ä¸ºå˜é‡ã€‚&lt;/p&gt;
&lt;h4 id=&#34;inputoperands&#34;&gt;InputOperands&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸èƒ½å°†å…¶å•çº¯ç†è§£ä¸ºè¾“å…¥ï¼Œè€Œæ˜¯ç†è§£ä¸ºä¼šè¢«è¯»å–çš„å˜é‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”± &lt;code&gt;AssemblerTemplate&lt;/code&gt; ä¸­çš„æŒ‡ä»¤è¯»å–çš„ C è¡¨è¾¾å¼åˆ—è¡¨ï¼Œç”±é€—å·åˆ†éš”ï¼Œå¯ä»¥ä¸ºç©ºã€‚&lt;/p&gt;
&lt;p&gt;ç»“æ„ä¹Ÿä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[ [asmSymbolicName]  ] constraint (cvariablename)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h5 id=&#34;asmsymbolicname-1&#34;&gt;asmSymbolicName&lt;/h5&gt;
&lt;p&gt;å¦‚æœæœ‰ä¸¤ä¸ªè¾“å…¥æ“ä½œæ•°ï¼Œä¸‰ä¸ªè¾“å‡ºæ“ä½œæ•°ï¼Œåˆ™ç¬¬ä¸€ä¸ªè¾“å…¥æ“ä½œæ•°ä¸º &lt;code&gt;%2&lt;/code&gt; ï¼Œç¬¬äºŒä¸ªä¸º &lt;code&gt;%3&lt;/code&gt; ï¼Œç¬¬ä¸‰ä¸ªä¸º &lt;code&gt;%4&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;asm&lt;/span&gt; (&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;cmoveq %1, %2, %[result]&amp;#34;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        : [result] &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;=r&amp;#34;&lt;/span&gt;(result) 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        : &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;r&amp;#34;&lt;/span&gt; (test), &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;r&amp;#34;&lt;/span&gt; (new), &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;[result]&amp;#34;&lt;/span&gt; (old));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;clobbers&#34;&gt;Clobbers&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;In software engineering and computer science, clobbering a file, processor register or a region of computer memory is the process of overwriting its contents completely, whether intentionally or unintentionally, or to indicate that such an action will likely occur.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»¥é€—å·åˆ†éš”çš„å¯„å­˜å™¨åˆ—è¡¨ï¼Œä¸€èˆ¬ä¸º &lt;code&gt;AssemblerTemplate&lt;/code&gt; æ›´æ”¹çš„å…¶ä»–å€¼ï¼ˆæ²¡æœ‰è¢«åˆ—å…¥ &lt;code&gt;OutputOperands&lt;/code&gt; çš„éƒ¨åˆ†ï¼‰ã€‚ä¾‹å¦‚ä¸€äº›æ±‡ç¼–æŒ‡ä»¤ï¼ˆä¾‹å¦‚ &lt;code&gt;cld&lt;/code&gt; ï¼‰æœ‰å‰¯ä½œç”¨ï¼Œä¼šä½¿ç”¨åˆ°é¢å¤–çš„å¯„å­˜å™¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ clobber ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;cc&lt;/code&gt; - è¡¨ç¤ºå°†ä¼šä¿®æ”¹ flag å¯„å­˜å™¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;memory&lt;/code&gt; - è¿™ä¸ª clobber å¯ä»¥å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™æ®µå†…è”æ±‡ç¼–ä»£ç å°†å¯¹è¾“å…¥å’Œè¾“å‡ºæ“ä½œæ•°ä¹‹å¤–çš„é¡¹æ‰§è¡Œå†…å­˜è¯»å–æˆ–å†™å…¥æ“ä½œï¼ˆä¾‹å¦‚ï¼Œè¾“å…¥æ“ä½œæ•°æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œéœ€è¦è®¿é—®å®ƒæŒ‡å‘çš„å†…å­˜ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;memory&lt;/code&gt; æ—¶ï¼Œä¸ºäº†ç¡®ä¿å†…å­˜ä¸­åŒ…å«æ­£ç¡®çš„å€¼ï¼ŒGCC å¯èƒ½éœ€è¦åœ¨æ‰§è¡Œè¿™æ®µå†…è”æ±‡ç¼–ä¹‹å‰ï¼Œå°†ç‰¹å®šçš„å¯„å­˜å™¨å€¼åˆ·æ–°åˆ°å†…å­˜ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œåœ¨æ‰§è¡Œä¸€ä¸ªæå‰è¯»å–æ“ä½œä¹‹å‰ï¼Œç¼–è¯‘å™¨ä¸ä¼šå‡å®šä»å†…å­˜ä¸­è¯»å–çš„å€¼åœ¨æ‰§è¡Œè¯¥æå‰è¯»å–æ“ä½œä¹‹åä¿æŒä¸å˜ï¼Œè€Œæ˜¯ä¼šæ ¹æ®éœ€è¦é‡æ–°åŠ è½½è¿™äº›å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;memory&lt;/code&gt; è¿™ä¸ª clobber æœ‰æ•ˆåœ°ä¸ºç¼–è¯‘å™¨å½¢æˆäº†è¯»/å†™å†…å­˜éšœç¢ã€‚ä½†è¿™å¹¶ä¸èƒ½é˜»æ­¢å¤„ç†å™¨åœ¨å†…è”æ±‡ç¼–è¯­å¥ä¹‹åæ‰§è¡Œæ¨æµ‹æ€§è¯»æ“ä½œã€‚è¿™ç§æƒ…å†µä¸‹è¿˜æ˜¯éœ€è¦ &lt;code&gt;fence&lt;/code&gt; æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;h4 id=&#34;gotolabels&#34;&gt;GotoLabels&lt;/h4&gt;
&lt;p&gt;æ­¤éƒ¨åˆ†åŒ…å« C æ ‡ç­¾çš„åˆ—è¡¨ï¼Œå½“ä½¿ç”¨ &lt;code&gt;goto&lt;/code&gt; å½¢å¼æ—¶ï¼Œ&lt;code&gt;AssemblerTemplate&lt;/code&gt; ä¸­çš„ä»£ç å¯ä»¥è·³è½¬åˆ°è¿™äº›æ ‡ç­¾ã€‚&lt;/p&gt;
&lt;p&gt;è¦å¼•ç”¨æ±‡ç¼–ç¨‹åºæ¨¡æ¿ä¸­çš„æ ‡ç­¾ï¼Œéœ€è¦åœ¨å®ƒå‰é¢åŠ ä¸Š &lt;code&gt;&#39;l&#39;&lt;/code&gt; ï¼Œåé¢åŠ ä¸Šå®ƒåœ¨ &lt;code&gt;GotoLabels&lt;/code&gt; ä¸­çš„ä½ç½®ä¸è¾“å…¥å’Œè¾“å‡ºæ“ä½œæ•°çš„æ•°ç›®ä¹‹å’Œã€‚å¸¦çº¦æŸä¿®é¥°ç¬¦ &lt;code&gt;&#39;+&#39;&lt;/code&gt; çš„è¾“å‡ºæ“ä½œæ•°è¢«è§†ä¸ºä¸¤ä¸ªæ“ä½œæ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸‰ä¸ªè¾“å…¥æ“ä½œæ•°ï¼Œä¸€ä¸ªè¾“å‡ºæ“ä½œæ•°å¸¦æœ‰çº¦æŸä¿®é¥°ç¬¦ &lt;code&gt;&#39;+&#39;&lt;/code&gt;ï¼Œä¸€ä¸ªè¾“å‡ºæ“ä½œæ•°å¸¦æœ‰çº¦æŸä¿®é¥°ç¬¦ &lt;code&gt;&#39;=&#39;&lt;/code&gt; ï¼Œé‚£ä¹ˆ &lt;code&gt;GotoLabels&lt;/code&gt; çš„ç¬¬ä¸€ä¸ªæ ‡ç­¾ç§°ä¸º &lt;code&gt;%l6&lt;/code&gt; ï¼Œç¬¬äºŒä¸ªç§°ä¸º &lt;code&gt;%l7&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨å®é™…çš„ C æ ‡ç­¾åï¼Œä¾‹å¦‚å¦‚æœè¦å¼•ç”¨ &lt;code&gt;GotoLabels&lt;/code&gt; ä¸­çš„ &lt;code&gt;carry&lt;/code&gt; æ ‡ç­¾ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;%l[carry]&lt;/code&gt; ï¼Œè¿™ä¹Ÿæ˜¯æ¨èçš„æ–¹æ³•ï¼Œé¿å…äº†å¯¹ç¼–å·çš„è®¡ç®—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®ä¾‹&#34;&gt;å®ä¾‹&lt;/h2&gt;
&lt;p&gt;ä¸¤æ•°ä¹‹å’Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; foo = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10&lt;/span&gt;, bar = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;15&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    __asm__ __volatile__(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;addl  %%ebx,%%eax&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                         :&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;=a&amp;#34;&lt;/span&gt;(foo)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                         :&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;(foo), &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;b&amp;#34;&lt;/span&gt;(bar)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                         );
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;foo+bar=%d&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, foo);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–è€…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; __asm__ __volatile__(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;   lock       ;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;   addl %1,%0 ;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      : &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;=m&amp;#34;&lt;/span&gt;  (my_var)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      : &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;ir&amp;#34;&lt;/span&gt;  (my_int), &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;m&amp;#34;&lt;/span&gt; (my_var)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      :                                 &lt;span style=&#34;color:#007f7f&#34;&gt;/* no clobber-list */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                      );
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;lock&lt;/code&gt; è¡¨ç¤ºè¿™æ˜¯ä¸ªåŸå­æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å­—ç¬¦ä¸²å¤åˆ¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;inline&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; * strcpy(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; * dest,&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *src)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; d0, d1, d2;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;__asm__ __volatile__(  &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;1:&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\t&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;lodsb&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n\t&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                       &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;stosb&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n\t&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                       &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;testb %%al,%%al&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n\t&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                       &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;jne 1b&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                     : &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;=&amp;amp;S&amp;#34;&lt;/span&gt; (d0), &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;=&amp;amp;D&amp;#34;&lt;/span&gt; (d1), &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;=&amp;amp;a&amp;#34;&lt;/span&gt; (d2)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                     : &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt; (src),&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt; (dest) 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                     : &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;memory&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; dest;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define mov_blk(src, dest, numwords) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;__asm__ __volatile__ (                                          \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                       &amp;#34;cld\n\t&amp;#34;                                \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                       &amp;#34;rep\n\t&amp;#34;                                \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                       &amp;#34;movsl&amp;#34;                                  \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                       :                                        \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                       : &amp;#34;S&amp;#34; (src), &amp;#34;D&amp;#34; (dest), &amp;#34;c&amp;#34; (numwords)  \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                       : &amp;#34;%ecx&amp;#34;, &amp;#34;%esi&amp;#34;, &amp;#34;%edi&amp;#34;                 \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                       )
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Linux ç³»ç»Ÿè°ƒç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define _syscall3(type,name,type1,arg1,type2,arg2,type3,arg3) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;type name(type1 arg1,type2 arg2,type3 arg3) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;{ \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;long __res; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;__asm__ volatile (  &amp;#34;int $0x80&amp;#34; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                  : &amp;#34;=a&amp;#34; (__res) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                  : &amp;#34;0&amp;#34; (__NR_##name),&amp;#34;b&amp;#34; ((long)(arg1)),&amp;#34;c&amp;#34; ((long)(arg2)), \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                    &amp;#34;d&amp;#34; ((long)(arg3))); \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;__syscall_return(type,__res); \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Linux é€€å‡ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;asm&lt;/span&gt;(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;movl $1,%%eax;         /* SYS_exit is 1 */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         xorl %%ebx,%%ebx;      &lt;span style=&#34;color:#007f7f&#34;&gt;/* Argument is in ebx, it is 0 */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt;  &lt;span style=&#34;color:#f00&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x80&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;            /* Enter kernel mode */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         );
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;p&gt;å†…è”æ±‡ç¼–æ·±å…¥èµ·æ¥éå¸¸ç¹æ‚ï¼Œæœ‰äº›åŠŸèƒ½éœ€è¦ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥æŸ¥çœ‹ GNU çš„æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html&#34;&gt;GCC Inline Assembly HOWTO&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://web.archive.org/web/20110514100544/http://gcc.gnu.org/onlinedocs/gnat_ugn_unw/Inline-Assembler.html&#34;&gt;GCC doc in web archive&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gcc.gnu.org/onlinedocs/gcc/Using-Assembly-Language-with-C.html#Using-Assembly-Language-with-C&#34;&gt;How to Use Inline Assembly Language in C Code&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gcc.gnu.org/onlinedocs/gcc/Basic-Asm.html#Basic-Asm&#34;&gt;Basic Asm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html&#34;&gt;Extended Asm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://dmalcolm.fedorapeople.org/gcc/2015-08-31/rst-experiment/how-to-use-inline-assembly-language-in-c-code.html&#34;&gt;How to Use Inline Assembly Language in C Code&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://dmalcolm.fedorapeople.org/gcc/2015-08-31/rst-experiment/declaring-attributes-of-functions.html&#34;&gt;Declaring Attributes of Functions&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gcc.gnu.org/onlinedocs/gcc/Local-Register-Variables.html&#34;&gt;Local Register Variables&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2022 Bilibili å¹´åº¦æŠ¥å‘Š</title>
      <link>https://vaaandark.top/posts/2022-bilibili-report/</link>
      <pubDate>Sat, 31 Dec 2022 00:34:32 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/2022-bilibili-report/</guid>
      <description>&lt;p&gt;çœ‹è¿™å¹´ç»ˆæ€»ç»“ï¼Œå‘ç°å‡ ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ˜¯æˆ‘å€Ÿåˆ«äººå·çš„åŸå› è¿˜æ˜¯æˆ‘çœŸçš„ä¸¥é‡æ‰‹æœºä¸Šç˜¾äº†ï¼Œæ€ä¹ˆçœ‹äº†è¿™ä¹ˆå¤šè§†é¢‘ï¼Œä¸€å¤©çš„æŒç»­ä¸Šçº¿æ—¶é—´è¿™ä¹ˆé•¿ï¼Ÿä¸è¿‡å½“æˆ‘çœ‹åˆ°æˆ‘çœ‹äº† 153 éƒ¨ç”µå½±ï¼Œ26 éƒ¨ç”µè§†å‰§ï¼Œ21 éƒ¨åŠ¨ç”»ï¼Œ21 éƒ¨çºªå½•ç‰‡ï¼Œå°±å¯ä»¥ç¡®å®šäº†åº”è¯¥æ˜¯å€Ÿå·çš„åŸå› ï¼Œæˆ‘é™¤äº†åƒé¥­ç¡è§‰å¤–éƒ½æ²¡æœ‰è¿™ä¹ˆå¤šæ—¶é—´æ¥çœ‹ã€‚&lt;/li&gt;
&lt;li&gt;æ˜¯ä¸æ˜¯ä»€ä¹ˆè§†é¢‘éƒ½è¦å¼„ä¸ªçŸ¥è¯†çš„æ ‡ç­¾ï¼Ÿå›é¡¾ä¸€å¹´æå¾—åƒæˆ‘æ˜¯æ¥bç«™ä¸Šè¯¾äº†ï¼ŒçŸ¥è¯†åŒºæˆ‘çœ‹å¾—æœ€å¤šçš„ä¸€ä¸ª UP ç«Ÿç„¶æ˜¯ã€Œå›åœ¨è¥¿å®‰ã€ï¼Œä»–æ˜¯ä¸€ä½ç¾é£Ÿ UP ã€‚&lt;/li&gt;
&lt;li&gt;æˆåˆ†æœ‰æ²¡æœ‰å¿…è¦è¿™ä¹ˆæ˜æ˜¾ï¼Ÿçœ‹å¾—æœ€å¤šæ ‡ç­¾æ˜¯ã€Œçš‡é©¬ã€ã€ã€ŒCç½—ã€ã€ã€Œè¶³çƒã€ã€ã€Œå†å²ã€ã€ã€Œæˆ˜äº‰ã€ï¼ŒæŠ•å¸æœ€å¤šçš„ UP æ˜¯ã€Œçš‡é©¬Ninoã€å’Œã€Œæ¯”ä¸ä¸­è¯´ç¯®çƒã€ï¼Œæ„Ÿè§‰è‡ªå·±çš„ç½—è¿·ã€è©¹é»‘æˆåˆ†éå¸¸æ˜æ˜¾ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®å®ç†¬å¤œå¤ªå¤šäº†ï¼Œæœ€è¿‘å‡ å¤©æœ‰æŠŠbç«™å½“ä½œæŠ–éŸ³åˆ·çš„è¶‹åŠ¿ï¼Œç‹‚çœ‹å°è§†é¢‘ã€‚&lt;/li&gt;
&lt;li&gt;çœ‹äº†æŒºå¤šç”µå½±èµæï¼ˆä¸æ˜¯é‚£ç§â€œæ³¨æ„çœ‹ï¼Œè¿™ä¸ªç”·äººå«å°ç¾â€çš„å‰§æƒ…ä»‹ç»ï¼‰ï¼Œä½†æ˜¯å®é™…çœ‹çš„å®Œæ•´ç”µå½±å¹¶ä¸å¤šï¼Œè€Œä¸”ç±»å‹å¾ˆç‹­éš˜ã€‚ä¸è¿‡å¥½åœ¨æˆ‘ç®—æ˜¯ç³»ç»Ÿæ€§åœ°è¿‡å®Œäº†é»‘å¸®ç‰‡å’Œè¥¿éƒ¨ç‰‡ï¼Œä»¥åŠä¸€äº›ç»å…¸ç§‘å¹»ç‰‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>æ ¡å›­ç½‘è‡ªåŠ¨è®¤è¯</title>
      <link>https://vaaandark.top/posts/hust-network-login/</link>
      <pubDate>Fri, 25 Nov 2022 16:01:20 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/hust-network-login/</guid>
      <description>&lt;p&gt;è‡ªå·±çš„ Wi-Fi6 æ¼æ²¹å™¨ç”¨ç€è¿˜è¡Œï¼Œæ ¡å›­ç½‘å¸¦å®½å¯ä»¥è·‘æ»¡ï¼Œä½†æ˜¯æˆ‘çš„è¿™ä¸ªå‹å·å¹¶ä¸èƒ½åˆ· openwrt ï¼Œæ‰€ä»¥ä¸èƒ½ ssh è¿æ¥ï¼Œæ›´ä¸èƒ½åœ¨ä¸Šé¢è·‘åŒå­¦ä»¬å†™çš„é‚£äº›è‡ªåŠ¨è®¤è¯è„šæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;å»å¹´æŠ˜è…¾ Arduino å’Œ nodemcu æ—¶æƒ³åˆ°å¯ä»¥åˆ©ç”¨ esp8266 çš„è”ç½‘åŠŸèƒ½è®©å®ƒæ¥ä»£æ›¿è¿›è¡Œè®¤è¯å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;è¯´å¹²å°±å¹²&lt;/del&gt;ï¼Œå…¶å®å¹¶ä¸æ˜¯ï¼Œæˆ‘ä»Šå¤©å‡Œæ™¨çœ‹è‘¡è„ç‰™æ¯”èµ›çš„æ—¶å€™æ‰å¼€å§‹å†™ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;è®¤è¯çš„æµç¨‹å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆè®¿é—®ä¸€ä¸ªå¯ä»¥è¢«è·³è½¬åˆ°è®¤è¯é¡µé¢çš„ç½‘ç«™ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ç™¾åº¦ã€‚åœ¨è¿”å›çš„å­—æ®µä¸­æ‰¾åˆ°ä»¥&lt;code&gt;&amp;quot;wlanuerip&amp;quot;&lt;/code&gt;å¼€å¤´ï¼Œç›´åˆ°ï¼ˆä½†ä¸åŒ…æ‹¬ï¼‰&lt;code&gt;&#39;&amp;lt;/scripts&amp;gt;&lt;/code&gt;çš„éƒ¨åˆ†ï¼Œç„¶åæ ¹æ®æŸç§æ–¹å¼ï¼ˆè¯¦è§ä»£ç ï¼‰å’Œå¸å·å¯†ç ç­‰å‚æ•°ç»„åˆåœ¨ä¸€èµ·ï¼Œå‘ç»™&lt;code&gt;192.168.50.3&lt;/code&gt;çš„&lt;code&gt;8080&lt;/code&gt;ç«¯å£å°±å¯ä»¥å®Œæˆè®¤è¯äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç è§ GitHub ä»“åº“ &lt;a href=&#34;https://github.com/vaaandark/hust-network-login-esp&#34;&gt;vaaandark/hust-network-login-esp&lt;/a&gt; ï¼Œé‡Œé¢ä¹Ÿå«æœ‰ä½¿ç”¨ arduino-cli çš„ç¼–è¯‘çƒ§å½•è„šæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;hust-network-login-esp&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/hust-network-login-esp.png&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>é‡å­è®¡ç®—æœº</title>
      <link>https://vaaandark.top/posts/quantum-computer/</link>
      <pubDate>Mon, 21 Nov 2022 11:51:23 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/quantum-computer/</guid>
      <description>&lt;h2 id=&#34;representation-of-data&#34;&gt;Representation of Data&lt;/h2&gt;
&lt;h3 id=&#34;qubits&#34;&gt;Qubits&lt;/h3&gt;
&lt;p&gt;A bit of data is represented by a single atom that is in one of two states denoted by $\ket0$ and $\ket1$.  A single bit of this form is known as a &lt;strong&gt;qubit&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨é‡å­è®¡ç®—æœºä¸­ï¼Œä¸€ä¸ªåŸå­å¯ä»¥é€šè¿‡ $\ket0$ å’Œ $\ket1$ å…¶ä¸­ä¹‹ä¸€çš„çŠ¶æ€æ¥è¡¨ç¤ºä¸€ä¸ªæ¯”ç‰¹ä½çš„æ•°æ®ã€‚ä¸€ä¸ªå½¢å¦‚è¿™æ ·çš„æ¯”ç‰¹ä½è¢«ç§°ä¸º&lt;strong&gt;é‡å­ä½&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;A physical implementation of a qubit could use the two energy levels of an atom.  An excited state representing $\ket1$ and a ground state representing $\ket0$.&lt;/p&gt;
&lt;p&gt;é‡å­ä½çš„ç‰©ç†å®ç°å¯ä»¥é€šè¿‡ä¸€ä¸ªåŸå­çš„ä¸¤ä¸ªèƒ½çº§æ¥è¡¨ç¤ºã€‚æ¿€å‘æ€è¡¨ç¤º $\ket1$ è€ŒåŸºæ€è¡¨ç¤º $\ket0$ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;qubitstate&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/qubitstate.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;superposition&#34;&gt;Superposition&lt;/h3&gt;
&lt;p&gt;A single qubit can be forced into a superposition of the two states denoted by the addition of the state vectors:&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç”¨ä¸€ç»„å‘é‡è¡¨ç¤ºä¸¤ä¸ªçŠ¶æ€çš„å åŠ ï¼Œä»è€Œå¯ä»¥å¼ºåˆ¶é€šè¿‡é‡å­å åŠ è¡¨ç¤ºå•ä¸ªé‡å­ä½ã€‚&lt;/p&gt;
&lt;p&gt;$$\ket\psi=\alpha_1\ket0+\alpha_2\ket1$$&lt;/p&gt;
&lt;p&gt;Where $\alpha_1$ and $\alpha_2$ are complex numbers and $|\alpha_1|^2+|\alpha_2|^2 = 1$&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„ $\alpha_1$ å’Œ $\alpha_2$ æ˜¯å¤æ•°ï¼Œè€Œä¸”æ»¡è¶³ $|\alpha_1|^2+|\alpha_2|^2 = 1$&lt;/p&gt;
&lt;p&gt;A qubit in superposition is in both of the states $\ket1$ and $\ket0$ at the same time&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªé‡å­å åŠ çš„é‡å­ä½åŒæ—¶å¤„äº $\ket1$ å’Œ $\ket0$ çš„çŠ¶æ€&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;superposition&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/superposition.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Consider a 3 bit qubit register.  An equally weighted superposition of all possible states would be denoted by:&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€ä¸ª 3-bit å¤§å°çš„å¯„å­˜å™¨ï¼Œé‡å­å åŠ æ‰€æœ‰çŠ¶æ€çš„ä¸€ä¸ªç­‰ä»·è¡¨ç¤ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;$$\ket\psi = 1/\sqrt8\ket{000}+1/\sqrt8\ket{001}+&amp;hellip;+1/\sqrt8\ket{111}$$&lt;/p&gt;
&lt;h3 id=&#34;data-retrieval&#34;&gt;Data Retrieval&lt;/h3&gt;
&lt;p&gt;In general, an n qubit register can represent the numbers $0$ through $2^n-1$ simultaneously.&lt;/p&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œä¸€ä¸ª n-bit çš„å¯„å­˜å™¨çš„å¯„å­˜å™¨å¯ä»¥åŒæ—¶è¡¨ç¤º $0$ åˆ° $2^n-1$ ã€‚&lt;/p&gt;
&lt;p&gt;Sound too good to be true?â€¦It is!&lt;/p&gt;
&lt;p&gt;å¬èµ·æ¥æ˜¯ä¸æ˜¯è¿‡äºç¾å¦™äº†ï¼Ÿä½†æ˜¯è¿™å°±æ˜¯äº‹å®ã€‚&lt;/p&gt;
&lt;p&gt;If we attempt to retrieve the values represented within a superposition, the &lt;strong&gt;superposition randomly collapses&lt;/strong&gt; to represent just one of the original values.&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å°è¯•å»æŸ¥çœ‹å¤„äºå åŠ çŠ¶æ€çš„å€¼ï¼Œå åŠ çŠ¶æ€ä¼šéšæœºåœ°åç¼©ï¼Œä»…ä»…ä¼šè¡¨ç¤ºåŸå€¼ä¸­çš„ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;In our equation: $\ket\psi=\alpha_1\ket0+\alpha_2\ket1$ , $\alpha_1$ represents the probability of the superposition collapsing to $\ket0$.  The $\alpha_n$&amp;rsquo;s are called probability amplitudes. In a balanced superposition, $\alpha_n=1/\sqrt2$ where n is the number of qubits.&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„æ–¹ç¨‹ä¸­ï¼š$\ket\psi=\alpha_1\ket0+\alpha_2\ket1$ ï¼Œ$\alpha_1$ è¡¨ç¤ºåç¼©åˆ° $\ket0$ çš„æ¦‚ç‡ã€‚$\alpha_n$ è¢«ç§°ä¸ºæ¦‚ç‡å¹…ã€‚åœ¨å¹³è¡¡å åŠ çŠ¶æ€ï¼Œæ»¡è¶³ $\alpha_n=1/\sqrt2$ ï¼Œn æ˜¯é‡å­ä½çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;entanglement&#34;&gt;Entanglement&lt;/h3&gt;
&lt;p&gt;Entanglement is the ability of quantum systems to exhibit correlations between states within a superposition.&lt;/p&gt;
&lt;p&gt;çº ç¼ æ˜¯é‡å­ç³»ç»Ÿåœ¨å åŠ æ€ä¹‹é—´å±•ç°ç›¸äº’å…³ç³»çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;Imagine two qubits, each in the state $\ket0$ + $\ket1$ (a superposition of the 0 and 1.)  We can entangle the two qubits such that the measurement of one qubit is always correlated to the measurement of the other qubit.&lt;/p&gt;
&lt;p&gt;æƒ³è±¡ä¸¤ä¸ªæ¯”ç‰¹ï¼Œæ¯ä¸€ä¸ªéƒ½åœ¨ 0 å’Œ 1 çš„é‡å­å åŠ çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸¤ä¸ªé‡å­ä½çº ç¼ åœ¨ä¸€èµ·ï¼Œä½¿å¾—ä¸€ä¸ªé‡å­ä½çš„æµ‹é‡æ€»æ˜¯ä¸å¦ä¸€ä¸ªé‡å­ä½çš„æµ‹é‡ç›¸å…³è”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;operations-on-qubits&#34;&gt;Operations on Qubits&lt;/h2&gt;
&lt;h3 id=&#34;reversible-logic&#34;&gt;Reversible Logic&lt;/h3&gt;
&lt;p&gt;Due to the nature of quantum physics, the destruction of information in a gate will cause heat to be evolved which can destroy the superposition of qubits.&lt;/p&gt;
&lt;p&gt;ç”±äºé‡å­ç‰©ç†å­¦çš„æ€§è´¨ï¼Œé—¨ä¸­ä¿¡æ¯çš„ç ´åå°†å¯¼è‡´æ”¾å‡ºçƒ­é‡ï¼Œä»è€Œç ´åé‡å­æ¯”ç‰¹çš„å åŠ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;traditional-gate&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/traditional-gate.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;This type of gate cannot be used.  We must use Quantum Gates.&lt;/p&gt;
&lt;p&gt;å› æ­¤ä¸èƒ½ä½¿ç”¨è¿™ç§ç±»å‹çš„é—¨ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨é‡å­é—¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;quantum-gates&#34;&gt;Quantum Gates&lt;/h3&gt;
&lt;p&gt;Quantum Gates are similar to classical gates, but do not have a degenerate output. i.e. their original input state can be derived from their output state, uniquely.  &lt;strong&gt;They must be reversible.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é‡å­é—¨ç±»ä¼¼äºç»å…¸é—¨ï¼Œä½†æ²¡æœ‰é€€åŒ–è¾“å‡ºã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬çš„åŸå§‹è¾“å…¥çŠ¶æ€å¯ä»¥å”¯ä¸€åœ°ä»å®ƒä»¬çš„è¾“å‡ºçŠ¶æ€ä¸­å¯¼å‡ºã€‚ å®ƒä»¬å¿…é¡»æ˜¯å¯é€†çš„ã€‚&lt;/p&gt;
&lt;p&gt;This means that a deterministic computation can be performed on a quantum computer only if it is reversible.  Luckily, it has been shown that any deterministic computation can be made reversible.(Charles Bennet, 1973)&lt;/p&gt;
&lt;p&gt;è¿™æ„å‘³ç€åªæœ‰åœ¨å¯é€†çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½åœ¨é‡å­è®¡ç®—æœºä¸Šæ‰§è¡Œç¡®å®šæ€§è®¡ç®—ã€‚ å¹¸è¿çš„æ˜¯ï¼Œå·²ç»è¯æ˜ä»»ä½•ç¡®å®šæ€§è®¡ç®—éƒ½å¯ä»¥å®ç°å¯é€†ã€‚ï¼ˆCharles Bennetï¼Œ1973ï¼‰&lt;/p&gt;
&lt;h4 id=&#34;hadamard&#34;&gt;Hadamard&lt;/h4&gt;
&lt;p&gt;Simplest gate involves one qubit and is called a &lt;strong&gt;Hadamard Gate&lt;/strong&gt; (also known as a square-root of NOT gate.)  Used to put qubits into superposition.&lt;/p&gt;
&lt;p&gt;æœ€ç®€å•çš„é—¨æ¶‰åŠä¸€ä¸ªé‡å­ä½ï¼Œç§°ä¸º Hadamard é—¨ï¼ˆä¹Ÿç§°ä¸º NOT é—¨çš„å¹³æ–¹æ ¹ï¼‰ï¼Œç”¨äºå°†é‡å­ä½å åŠ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;hadamard&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/hadamard.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Note: Two Hadamard gates used in succession can be used as a NOT gate&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šè¿ç»­ä½¿ç”¨çš„ä¸¤ä¸ª Hadamard é—¨å¯ä»¥ä½œä¸ºä¸€ä¸ªéé—¨&lt;/p&gt;
&lt;h4 id=&#34;controlled-not&#34;&gt;Controlled NOT&lt;/h4&gt;
&lt;p&gt;A gate which operates on two qubits is called a &lt;strong&gt;Controlled-NOT (CN) Gate&lt;/strong&gt;.  If the bit on the control line is 1, invert the bit on the target line.&lt;/p&gt;
&lt;p&gt;åœ¨ä¸¤ä¸ªé‡å­ä½ä¸Šè¿è¡Œçš„é—¨ç§°ä¸ºå—æ§é (CN) é—¨ã€‚ å¦‚æœæ§åˆ¶çº¿ä¸Šçš„ä½ä¸º 1ï¼Œåˆ™å°†ç›®æ ‡çº¿ä¸Šçš„ä½åè½¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;controlled-not&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/controlled-not.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Note: The CN gate has a similar behavior to the XOR gate with some extra information to make it reversible.&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šCN é—¨ä¸ XOR é—¨å…·æœ‰ç›¸ä¼¼çš„è¡Œä¸ºï¼Œä½†æœ‰ä¸€äº›é¢å¤–çš„ä¿¡æ¯ä½¿å…¶å¯é€†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;multiplication-by-2&#34;&gt;Multiplication By 2&lt;/h4&gt;
&lt;p&gt;We can build a reversible logic circuit to calculate multiplication by 2 using CN gates arranged in the following manner:&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªå¯é€†é€»è¾‘ç”µè·¯ï¼Œä½¿ç”¨æŒ‰ä»¥ä¸‹æ–¹å¼æ’åˆ—çš„ CN é—¨æ¥è®¡ç®— 2 çš„ä¹˜æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;multiplication-by-2&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/multiplication-by-2.png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;controlled-controlled-not-ccn&#34;&gt;Controlled Controlled NOT (CCN)&lt;/h4&gt;
&lt;p&gt;A gate which operates on three qubits is called a Controlled Controlled NOT (CCN) Gate.  Iff the bits on both of the control lines is 1,then the target bit is inverted.&lt;/p&gt;
&lt;p&gt;åœ¨ä¸‰ä¸ªé‡å­ä½ä¸Šè¿è¡Œçš„é—¨ç§°ä¸ºå—æ§å—æ§é (CCN) é—¨ã€‚ å¦‚æœä¸¤æ¡æ§åˆ¶çº¿ä¸Šçš„ä½éƒ½æ˜¯ 1ï¼Œåˆ™ç›®æ ‡ä½è¢«åè½¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;controlled-controlled-not&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/controlled-controlled-not.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;a-universal-quantum-computer&#34;&gt;A Universal Quantum Computer&lt;/h3&gt;
&lt;p&gt;The CCN gate has been shown to be a universal reversible logic gate as it can be used as a NAND gate.&lt;/p&gt;
&lt;p&gt;CCN é—¨å·²è¢«è¯æ˜æ˜¯ä¸€ç§é€šç”¨çš„å¯é€†é€»è¾‘é—¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨ä½œä¸éé—¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;universal&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/universal.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;When our target input is 1, our target output is a result of a NAND of B and C.&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬çš„ç›®æ ‡ A è¾“å…¥ä¸º 1 æ—¶ï¼Œæˆ‘ä»¬çš„ç›®æ ‡è¾“å‡º A æ˜¯ B å’Œ C çš„ NAND çš„ç»“æœã€‚&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Joseph Stelmach&lt;/em&gt;, &lt;em&gt;Quantum Computer&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://www.eecis.udel.edu/~saunders/courses/879-03s/quantumComputers.ppt&#34;&gt;https://www.eecis.udel.edu/~saunders/courses/879-03s/quantumComputers.ppt&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;wikipedia, &lt;em&gt;probability amplitudes&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Probability_amplitude&#34;&gt;https://en.wikipedia.org/wiki/Probability_amplitude&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;wikipedia, &lt;em&gt;Quantum superposition&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Quantum_superposition&#34;&gt;https://en.wikipedia.org/wiki/Quantum_superposition&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ps&#34;&gt;PS&lt;/h2&gt;
&lt;p&gt;æ„Ÿè°¢ &lt;a href=&#34;https://note.qidong.name/2018/03/hugo-mathjax/&#34;&gt;https://note.qidong.name/2018/03/hugo-mathjax/&lt;/a&gt; è¿™ç¯‡åšå®¢ï¼Œæˆ‘ç»ˆäºæ‰¾åˆ°äº†åœ¨ hugo ä¸­ä½¿ç”¨å…¬å¼çš„å®Œç¾æ–¹æ¡ˆã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ç‰©ç†åŒåæŒ¯å®éªŒç”»å›¾</title>
      <link>https://vaaandark.top/posts/dual-polarization-experiment-drawing/</link>
      <pubDate>Sun, 20 Nov 2022 12:32:04 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/dual-polarization-experiment-drawing/</guid>
      <description>&lt;p&gt;ä¸Šæ¬¡ç‰©ç†å®éªŒåšçš„æ˜¯åŒåæŒ¯ï¼Œå®éªŒèµ„æ–™ä¸­æ¨èä½¿ç”¨ origin ç”»å›¾ï¼Œæˆ‘æ—¢ä¸æƒ³ä½¿ç”¨ Windows ä¹Ÿä¸æƒ³å¤šä¸‹è½½ä¸€ä¸ªè½¯ä»¶ï¼Œå› æ­¤æˆ‘æ‰“ç®—ç”¨ matplotlib ç”»å›¾ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»£ç &#34;&gt;ä»£ç &lt;/h2&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªå®éªŒç”»å›¾æ˜¯å¾ˆç®€å•çš„çº¿æ€§å›å½’è®¡ç®—ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; np
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; plt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; math
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.rcParams[&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;font.sans-serif&amp;#39;&lt;/span&gt;]=[&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;SimHei&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;angles = [&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;90&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;80&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;70&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;60&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;50&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;40&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;30&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;20&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;x = []
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; a in angles:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x.append(math.cos(a / &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;180&lt;/span&gt; * math.pi) ** &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;y1 = [&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.6&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;6.8&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;21.0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;41.8&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;68.9&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;94.1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;118.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;136.1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;149.7&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;152.8&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;y2 = [&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.6&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;6.8&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;15.7&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;39.6&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;68.4&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;92.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;119.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;130.8&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;142.9&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;147.7&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;x = np.array(x)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;y1 = np.array(y1)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;y2 = np.array(y2)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.scatter(x, y1, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;50&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;black&amp;#34;&lt;/span&gt;, marker = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;o&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.scatter(x, y2, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;50&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;black&amp;#34;&lt;/span&gt;, marker = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;v&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a1, b1 = np.polyfit(x, y1, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a2, b2 = np.polyfit(x, y2, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.plot(x, a1 * x + b1, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;blue&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.plot(x, a2 * x + b2, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;red&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.title(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;å…‰å¼º I ä¸é€å…‰è½´å¤¹è§’ Î¸ çš„å…³ç³»&amp;#34;&lt;/span&gt;, fontsize = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;13&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.xlabel(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;$cos^2Î¸$&amp;#39;&lt;/span&gt;, fontsize = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;12&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.ylabel(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;$I/*10^{-7}$&amp;#39;&lt;/span&gt;, fontsize = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;12&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.tick_params(labelsize = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;11&lt;/span&gt;)  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.grid(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;True&lt;/span&gt;, linestyle = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;--&amp;#34;&lt;/span&gt;, color = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;g&amp;#34;&lt;/span&gt;, linewidth = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;0.5&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.savefig(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;lab1.png&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.show()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¬¬ä¸‰ä¸ªå®éªŒç”»å›¾ä½¿ç”¨äº†æåº§æ ‡ç³»å’Œæåº§æ ‡ç³»ä¸Šçš„æ‹Ÿåˆï¼Œéœ€è¦æŸ¥çœ‹ matplotlib çš„ API ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; plt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;from&lt;/span&gt; scipy.optimize &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; curve_fit
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; np
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.rcParams[&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;font.sans-serif&amp;#39;&lt;/span&gt;]=[&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;SimHei&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;def&lt;/span&gt; form(x, A):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  res = A * A * &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; * (np.cos(x) * np.cos(x) * &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.75&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                  + np.sin(x) * np.sin(x) * &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.25&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; res
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;theta = []
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; i in &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;range&lt;/span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;360&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  theta.append(i / &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;180&lt;/span&gt; * np.pi)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;I = [ &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;93.9&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;90.7&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;84.4&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;75.6&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;65.0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;54.9&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;45.7&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;38.5&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;34.6&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;33.8&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;37.0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;43.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;51.0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;61.1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;71.0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;80.4&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;87.1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;91.3&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;92.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;88.9&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;82.6&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;75.8&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;67.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;56.8&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;47.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;39.9&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;36.0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;35.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;38.1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;44.5&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;53.4&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;63.8&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;72.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;80.4&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;88.2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;91.9&lt;/span&gt; ]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;# ä¸ºäº†æœ€åå°å£&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;theta.append(theta[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;I.append(I[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fig, ax = plt.subplots(subplot_kw={&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;projection&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;polar&amp;#39;&lt;/span&gt;})
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.scatter(theta, I, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;50&lt;/span&gt;, marker = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;o&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.xlabel(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;$I/*10^{-7}$&amp;#39;&lt;/span&gt;, fontsize = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;12&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ax.set_title(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;æ¤­åœ†åæŒ¯å…‰å…‰å¼ºæµ‹é‡æ•°æ®&amp;#34;&lt;/span&gt;, va = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;bottom&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;param, covariance = curve_fit(form, theta, I, method=&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;trf&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.plot(theta, form(theta, *param), &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;blue&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.savefig(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;lab3.png&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;plt.show()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ç¼–å†™ä»£ç è¿‡ç¨‹ä¸­å‘ç°ï¼Œåœ¨&lt;code&gt;form&lt;/code&gt;è¿™ä¸ªå‡½æ•°é‡Œåªèƒ½ä½¿ç”¨ numpy ä¸­çš„å‡½æ•°ï¼Œè€Œä¸èƒ½ä½¿ç”¨ math ä¸­çš„å‡½æ•°ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°ç”¨äºæ‹Ÿåˆï¼Œå¤„ç†çš„æ˜¯ä¸€å †æ•°æ®ç»„æˆçš„å‘é‡ï¼Œå¿…é¡»è¦æ”¯æŒå‘é‡è¿ç®—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•ˆæœ&#34;&gt;æ•ˆæœ&lt;/h2&gt;
&lt;p&gt;&lt;img alt=&#34;lab1&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/lab1.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;lab3&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/lab3.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;matplotlib API Reference&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://matplotlib.org/stable/api/index.html&#34;&gt;https://matplotlib.org/stable/api/index.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://matplotlib.org/stable/gallery/pie_and_polar_charts/polar_demo.html&#34;&gt;https://matplotlib.org/stable/gallery/pie_and_polar_charts/polar_demo.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://matplotlib.org/stable/gallery/lines_bars_and_markers/scatter_custom_symbol.html&#34;&gt;https://matplotlib.org/stable/gallery/lines_bars_and_markers/scatter_custom_symbol.html&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ARMä¸80X86çš„å¼‚åŒ</title>
      <link>https://vaaandark.top/posts/differences-between-arm-and-80x86/</link>
      <pubDate>Tue, 08 Nov 2022 20:35:20 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/differences-between-arm-and-80x86/</guid>
      <description>&lt;p&gt;ä»Šå¤©åˆæ­¥è®¤è¯†äº† ARM æ±‡ç¼–ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;cpu-å†…å¯„å­˜å™¨&#34;&gt;CPU å†…å¯„å­˜å™¨&lt;/h2&gt;
&lt;p&gt;aarch64 æœ‰ 31 ä¸ª 64 ä½é€šç”¨å¯„å­˜å™¨ï¼Œå®ƒä»¬çš„åå­—æ˜¯ä¸º xnï¼ˆn ä¸º 0-30 çš„æ•´æ•°ï¼‰ï¼Œä¸åƒ 80X86 ä¸€æ ·æš—ç¤ºäº†å®ƒä»¬çš„ç”¨é€”ã€‚&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼ rax å’Œ eax çš„å…³ç³»ï¼Œå®ƒä»¬å¯¹åº”çš„ 32 ä½å¯„å­˜å™¨å«åš wnï¼ˆn ä¸º 0-30 çš„æ•´æ•°ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰å‡ ä¸ªç‰¹æ®Šå¯„å­˜å™¨å’Œ 80X86 ç±»ä¼¼ï¼Œä¸è¿‡å¤šå‡ºæ¥äº†é“¾æ¥å¯„å­˜å™¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ®µçš„å®šä¹‰æ–¹æ³•&#34;&gt;æ®µçš„å®šä¹‰æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;æ®µçš„å®šä¹‰æ–¹æ³•ä¸ 80X86 æœ‰å¾ˆå¤§åŒºåˆ«ï¼Œä½†æ˜¯å’Œ nasm è¯­æ³•åŸºæœ¬ä¸€è‡´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æŒ‡ä»¤è¯­å¥åŠå…¶æ ¼å¼&#34;&gt;æŒ‡ä»¤è¯­å¥åŠå…¶æ ¼å¼&lt;/h2&gt;
&lt;p&gt;ç›®å‰å­¦åˆ°çš„ä¸€äº›åŒºåˆ«ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ ¼å¼ä¸Šæ›´ç±»ä¼¼äº Intel çš„è¯­æ³•ï¼Œç¬¬ä¸€ä¸ªæ“ä½œæ•°æ˜¯ç›®çš„å¯„å­˜å™¨ï¼ˆç›®çš„å­˜å‚¨å™¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ARM çš„å¾ˆå¤šæŒ‡ä»¤éƒ½æ˜¯ä¸‰æ“ä½œæ•°çš„ï¼Œè¿™ç»™ç¼–ç å¸¦æ¥äº†æ›´å¤šçš„çµæ´»æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ARM æŒ‡ä»¤æ˜¯å®šé•¿çš„ï¼Œæ¯ä¸€æ¡æŒ‡ä»¤éƒ½æ˜¯å›ºå®šçš„ 4 å­—èŠ‚é•¿åº¦ã€‚&lt;/li&gt;
&lt;li&gt;ç«‹å³æ•°è¡¨ç¤ºä¸ä¸€æ ·ï¼Œä½¿ç”¨äº†&lt;code&gt;#&lt;/code&gt;ä½œä¸ºå‰ç¼€ã€‚&lt;/li&gt;
&lt;li&gt;å¯„å­˜å™¨åŸºå€å˜å€å¯»å€ä¸éœ€è¦åŠ å·ï¼Œä½¿ç”¨&lt;code&gt;[R1, #8]&lt;/code&gt;è¿™æ ·çš„æ ¼å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LDR.W  R0,  [R1,#20]!&lt;/code&gt;ç›¸å½“äº x86 æ±‡ç¼–çš„&lt;code&gt;mov eax [ebx, 20]&lt;/code&gt; &lt;code&gt;mov eax [eax]&lt;/code&gt;ä¸¤å¥ã€‚&lt;/li&gt;
&lt;li&gt;å¯„å­˜å™¨åˆ—è¡¨&lt;code&gt;{}&lt;/code&gt;è¯­æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4005f4:     a9be7bfd        stp     x29, x30, [sp, #-32]!
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4005f8:     910003fd        mov     x29, sp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°æœºå™¨æŒ‡ä»¤&lt;code&gt;a9be7bfd&lt;/code&gt;å’Œ&lt;code&gt;910003fd&lt;/code&gt;æ˜¯å®šé•¿çš„&lt;/p&gt;
&lt;h3 id=&#34;ä¸€äº›ç‰¹æ®Šçš„æŒ‡ä»¤&#34;&gt;ä¸€äº›ç‰¹æ®Šçš„æŒ‡ä»¤&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;LDR  å­—æ•°æ®åŠ è½½æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;LDRB å­—èŠ‚æ•°æ®åŠ è½½æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;LDRH åŠå­—æ•°æ®åŠ è½½æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;STR  å­—æ•°æ®å­˜å‚¨æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;TRB  å­—èŠ‚æ•°æ®å­˜å‚¨æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;STRH åŠå­—æ•°æ®å­˜å‚¨æŒ‡ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å­ç¨‹åºè°ƒç”¨&#34;&gt;å­ç¨‹åºè°ƒç”¨&lt;/h2&gt;
&lt;p&gt;ARM ä½¿ç”¨ bl è·³è½¬è¿›å…¥å­ç¨‹åºï¼Œå¹¶ä¸åƒ 80X86 ä¸€æ ·ä½¿ç”¨ call ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å‚æ•°ä¼ é€’&#34;&gt;å‚æ•°ä¼ é€’&lt;/h3&gt;
&lt;p&gt;æä¾›äº† 8 ä¸ªé€šç”¨å¯„å­˜å™¨ï¼ˆr0-r7ï¼‰ç”¨äºä¼ é€’å‡½æ•°å‚æ•°ï¼Œä¸€æ¬¡å¯¹åº”&lt;code&gt;arg1&lt;/code&gt;åˆ°&lt;code&gt;arg8&lt;/code&gt;ï¼Œè¶…è¿‡ 8 ä¸ªçš„å‚æ•°ä¼šå­˜æ”¾åœ¨å †æ ˆä¸­ã€‚&lt;/p&gt;
&lt;p&gt;GCC ç”Ÿæˆçš„æ±‡ç¼–ä¾ç„¶æ˜¯ Caller Save ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨ GCC ç¼–è¯‘æ—¶ï¼Œå‘ç°è™½ç„¶ä¼ é€’åˆ°å¯„å­˜å™¨çš„é¡ºåºä¸ä¼šå¯¹å‡½æ•°è°ƒç”¨æœ‰å½±å“ï¼Œä½†æ˜¯ GCC è¿˜æ˜¯é€†åºä¼ å…¥å¯„å­˜å™¨ï¼Œå¯èƒ½æ˜¯ä¸ºäº†ç»“æ„åŒ–ç”Ÿæˆä»£ç ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;è¿”å›å€¼&#34;&gt;è¿”å›å€¼&lt;/h3&gt;
&lt;p&gt;å¦‚æœè¿”å›å€¼æ˜¯æ•´å‹ï¼Œåˆ™æ˜¯ x0 ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸-c-è¯­è¨€æ··åˆç¼–ç¨‹&#34;&gt;ä¸ C è¯­è¨€æ··åˆç¼–ç¨‹&lt;/h2&gt;
&lt;p&gt;å°†&lt;code&gt;.s&lt;/code&gt;å’Œ&lt;code&gt;.c&lt;/code&gt;æ–‡ä»¶åˆ†å¼€ç¼–ç¨‹ä¸ 80X86 æ²¡æœ‰åŒºåˆ«ï¼Œå†…è”æ±‡ç¼–ä¹Ÿæ²¡æœ‰åŒºåˆ«ï¼ŒåŒºåˆ«ä¸»è¦åœ¨äº ARM æ±‡ç¼–çš„è¯­æ³•ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>QEMUé…ç½®openEulerçš„aarch64å¼€å‘ç¯å¢ƒ</title>
      <link>https://vaaandark.top/posts/setup-qemu-for-openeuler-aarch64/</link>
      <pubDate>Mon, 07 Nov 2022 16:43:28 +0800</pubDate>
      
      <guid>https://vaaandark.top/posts/setup-qemu-for-openeuler-aarch64/</guid>
      <description>&lt;p&gt;è¿˜æ˜¯è®¡ç®—æœºç³»ç»ŸåŸºç¡€ï¼Œå³å°†å¯¹ arm æ¶æ„å±•å¼€å­¦ä¹ ï¼Œä½¿ç”¨çš„æ˜¯åä¸ºçš„æ‰“å¼€æ¬§æ‹‰(openEuler)æ“ä½œå‘è¡Œç‰ˆã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;è¿›å…¥é•œåƒ&#34;&gt;è¿›å…¥é•œåƒ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆä¸‹è½½è™šæ‹Ÿæœºé•œåƒï¼Œè€å¸ˆå‘çš„æˆ‘å®‰è£…ä¸äº†ï¼Œå°±åœ¨æ¸…åçš„é•œåƒç«™ä¸‹è½½äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ aria2c -x &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;15&lt;/span&gt; -s &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;https://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-20.03-LTS/virtual_machine_img/aarch64/openEuler-20.03-LTS.aarch64.qcow2.xz&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å…ˆè°ƒæ•´ä¸€ä¸‹é•œåƒçš„ç£ç›˜å¤§å°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ qemu-img resize openEuler-20.03-LTS.aarch64.qcow2 +20G
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å¯åŠ¨é•œåƒï¼Œæ³¨æ„éœ€è¦ä½¿ç”¨å¼•å¯¼æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;qemu-system-aarch64 -m 4096 \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -cpu cortex-a57 \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -smp 4 \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -M virt \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -bios edk2-aarch64-code.fd \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -hda openEuler-20.03-LTS.aarch64.qcow2 \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        -nographic \
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;é…ç½®ç½‘ç»œ&#34;&gt;é…ç½®ç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;é…ç½®ç½‘ç»œè¿™éƒ¨åˆ†ï¼Œå°¤å…¶æ˜¯ç½‘å¡é‚£éƒ¨åˆ†æˆ‘ä¸æ˜¯å¾ˆæ‡‚ï¼ŒåŸºæœ¬ä¸Šæ˜¯ç…§ç€æ•™ç¨‹æ¥åšã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ QEMU çš„å­—ç¬¦ç•Œé¢ç”¨èµ·æ¥å¾ˆé¡ºæ‰‹ï¼Œå‡ ä¹å’Œä½¿ç”¨äº† ssh è¿æ¥ä¸€æ ·ï¼Œä½†æ˜¯åœ¨ä¸€äº› curses åº“çš„ TUI ç•Œé¢ä¸­æ˜¾ç¤ºä¸ä½³ï¼Œæˆ‘è¿˜æ˜¯å‡†å¤‡ä½¿ç”¨ ssh ã€‚&lt;/p&gt;
&lt;p&gt;æ€»æ‰€å‘¨çŸ¥ï¼Œè™šæ‹Ÿæœºæœ‰å¤šç§è¿æ¥ç½‘ç»œçš„æ–¹å¼ï¼Œè¿™æ¬¡é…ç½®æˆ‘ä½¿ç”¨çš„æ˜¯â€œç”¨æˆ·ç½‘ç»œâ€çš„æ–¹å¼ï¼Œç„¶åå°†ç«¯å£ 22 å’Œä¸»æœºç«¯å£ 10021 ç»‘å®šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;qemu-system-aarch64 -m &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4096&lt;/span&gt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;        -cpu cortex-a57 &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;        -smp &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;        -M virt &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;        -bios edk2-aarch64-code.fd &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;        -net nic,model=e1000 &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;        -net user,hostfwd=tcp::10021-:22 &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;        -hda openEuler-20.03-LTS.aarch64.qcow2 &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&lt;/span&gt;        -nographic
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨è„šæœ¬è¿›å…¥åå‘ç°æ²¡æœ‰ ip ï¼Œè¯´æ˜ç½‘å¡é…ç½®è¿˜ä¸æ­£ç¡®ã€‚&lt;/p&gt;
&lt;p&gt;åˆ›å»ºå¹¶ç¼–è¾‘&lt;code&gt;/etc/sysconfig/newwork-scipts/ifcfg-eth0&lt;/code&gt;æ–‡ä»¶ã€‚ä½¿ç”¨&lt;code&gt;nmcli c&lt;/code&gt;æŸ¥çœ‹ UUID ï¼Œä½¿ç”¨&lt;code&gt;ifconfig&lt;/code&gt;æŸ¥çœ‹ MAC åœ°å€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;DEVICE=eth0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;HWADDR=52:54:00:12:34:56
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;UUID=e449c48a-45a7-3db7-8cf3-349bd209b064
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;NM_CONTROLLED=yes
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ONBOOT=yes
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;BOOTPROTO=dhcp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;type=Ethernet
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;IPV6INIT=no
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;USERCTL=no
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é‡å¯ NetworkManager å’Œä½¿ ssh è‡ªå¯åŠ¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ systemctl restart NetworkManager
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ systemctl &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;enable&lt;/span&gt; sshd
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰“å¼€ç½‘å¡å¹¶æµ‹è¯•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ifup eth0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ping baidu.com
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨ ssh è¿æ¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ssh -p &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10021&lt;/span&gt; root@localhost
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;é…ç½®è½¯ä»¶&#34;&gt;é…ç½®è½¯ä»¶&lt;/h2&gt;
&lt;p&gt;åˆ›å»ºå¹¶ç¼–è¾‘&lt;code&gt;/etc/yum.repos.d/openEuler.repo&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[OS]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;name=openEuler-$releasever - OS
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;baseurl=https://repo.openeuler.org/openEuler-20.03-LTS/OS/$basearch/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;enabled=1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gpgcheck=1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gpgkey=https://repo.openeuler.org/openEuler-20.03-LTS/OS/$basearch/RPM-GPG-KEY-openEuler
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[update]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;name=openEuler-$releasever - Update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;baseurl=http://repo.openeuler.org/openEuler-20.03-LTS/update/$basearch/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;enabled=1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gpgcheck=1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gpgkey=http://repo.openeuler.org/openEuler-20.03-LTS/update/$basearch/RPM-GPG-KEY-openEuler
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[extras]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;name=openEuler-$releasever - Extras
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;baseurl=http://repo.openeuler.org/openEuler-20.03-LTS/extras/$basearch/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;enabled=0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gpgcheck=1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gpgkey=http://repo.openeuler.org/openEuler-20.03-LTS/extras/$basearch/RPM-GPG-KEY-openEuler
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®‰è£…å¸¸ç”¨è½¯ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ dnf install gcc gcc-c++ libstdc++-devel gdb nasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ–°å»ºç”¨æˆ·ï¼Œé…ç½®ç®¡ç†å‘˜æƒé™ä¹‹ç±»çš„éƒ½æ˜¯å¸¸è§„æ“ä½œäº†ï¼Œå°±ä¸ç”¨èµ˜è¿°äº†ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2022.11.6 ç»´æ‹‰ 3 : 1 æ›¼è”</title>
      <link>https://vaaandark.top/posts/2022.11.6-man-utd-vs-aston-villa/</link>
      <pubDate>Sun, 06 Nov 2022 23:50:00 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/2022.11.6-man-utd-vs-aston-villa/</guid>
      <description>&lt;p&gt;è…¾å“ˆæ ¼ä»Šå¤©ä¸çŸ¥é“åœ¨å¹²å˜›ï¼Œæ²¡æœ‰äº†å¤§Bå“¥å°±å®Œå…¨ä¸ä¼šè¸¢çƒäº†ã€‚è™½ç„¶ä¹‹å‰æ€»æ˜¯æ‰¹è¯„å¤§Bå“¥ä¼ çƒæ¯›èºå†’é™©ï¼Œä½†æ˜¯ä»–è¿˜æ˜¯æœ‰åæ’ä¸Šå’Œå¨èƒçƒçš„èƒ½åŠ›çš„ã€‚ä»Šå¤©çš„èŒƒå¾·è´å…‹å®Œå…¨éšèº«ï¼Œæ´»è¯¥åæ¿å‡³ï¼›è€Œçˆ±ç¥å°±åƒæ˜¯é‡çƒåœºä¸Šçš„è€å¤§çˆ·ï¼Œçœ‹ä¼¼æŠ€æœ¯é«˜ä¸€æ¡£ï¼Œå®é™…ä¸Šå·²ç»è¢«å¯¹é¢å¹´è½»äººå¼ºå‚»äº†å†²çƒ‚äº†ï¼Œä»–ä»Šå¤©ä¸Šåœºä¸»è¦æ˜¯ç»™å®¢åœºçƒè¿·å±•ç¤ºè‡ªå·±çš„æ–œé•¿ä¼ æ°´å¹³çš„ã€‚èƒ–è™ä»Šå¤©ç•¥æœ‰ä¸åœ¨çŠ¶æ€ï¼Œåˆæˆäº†èƒŒé”…ä¾ ï¼Œä¸­åœºå¤±æ§ä»–ä¹Ÿåˆ†èº«ä¹æœ¯ã€‚&lt;/p&gt;
&lt;p&gt;ååœºæ›´æ˜¯é‡é‡çº§ï¼Œåˆ©é©¬ä»Šå¤©ä¹ä¸€çœ‹åƒä¸ªé‡å…½ï¼Œéå¸¸å…·æœ‰ä¾µç•¥æ€§ã€‚ä½†æ˜¯ä¹Ÿå°±åªæœ‰ä¾µç•¥æ€§äº†ï¼Œä¸¤æ¬¡å¤±çƒä¸ä»–æœ‰å…³ï¼Œä¸‹åŠåœºç”šè‡³ä¸¤è¿è‚˜å‡»å¯¹é¢çƒå‘˜ã€‚æˆ‘æ¯æ¬¡çœ‹åˆ°ä»–éƒ½æ˜¯æ€’æ°”å†²å†²åœ°ä¸Šå»ï¼Œå¥”ç€æ‰“æ¶å»å¯¹æŠ—ã€‚ä¸è¿‡è¿™å®‰ä¸œå°¼æ³°å‹’æœç„¶æ˜¯ç›²ä¾ ã€‚&lt;/p&gt;
&lt;p&gt;å‰åœºä¼—å‰é”‹æ‹¿ä¸åˆ°çƒï¼Œè¾¹è·¯çš„ç»„åˆå®Œå…¨æ²¡æœ‰é…åˆï¼ŒåŠ çº³ä¹”æœ‰å°æŠ€æœ¯ä½†æ˜¯æ²¡æœ‰é…åˆï¼Œçˆ†å‘åŠ›ä¹Ÿå¾ˆæ¬ ç¼ºã€‚Cç½—è¿˜æ˜¯åœ¨æ‰“ä¸­é”‹ä½ç½®ï¼Œçœ‹å¾—ä»–æ€¥æˆ‘ä¹Ÿæ€¥ã€‚&lt;/p&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œä»Šå¤©çš„æ›¼è”å¾ˆåƒå½“æ—¶èŒƒå¤§å¨çš„â€œå¤§åœˆæˆ˜æœ¯â€ï¼Œä¸­åœºæ²¡äººæˆ–è€…åªæœ‰ä¸€ä¸ªäººï¼Œç„¶è€Œè¾¹è·¯çš„æ¨è¿›ååˆ†ä¾¿ç§˜ï¼Œæ¯æ¬¡éƒ½åªèƒ½å†æ–œé•¿ä¼ æ‰“åˆ°å¼±ä¾§ï¼Œå¼±ä¾§çƒå‘˜ä¹Ÿæ²¡æœ‰ç»´å°¼ä¿®æ–¯ä¸€æ ·çš„çˆ†è¾¹èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ”¯æ›¼è”è¿˜æœ‰æ•‘å—ï¼Ÿ&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CSAPP Bomb Lab</title>
      <link>https://vaaandark.top/posts/csapp-bomb-lab/</link>
      <pubDate>Sat, 29 Oct 2022 22:24:22 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/csapp-bomb-lab/</guid>
      <description>&lt;p&gt;ä¹‹å‰çš„ Bomb Lab æ²¡æœ‰åšï¼Œç°åœ¨åˆšå¥½åœ¨ä¸Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€è¿™é—¨è¯¾ï¼Œå­¦æ ¡ä½¿ç”¨äº† CSAPP çš„ Bomb Lab ï¼Œå¯ä»¥è¡¥äº¤ä¸€ä¸‹ CSAPP çš„ä½œä¸šï¼Œä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ GDB çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®éªŒç®€è¿°&#34;&gt;å®éªŒç®€è¿°&lt;/h2&gt;
&lt;p&gt;é—æ†¾åœ°ï¼ŒCSAPP çš„ Bomb Lab æ—©å·²æä¾›çš„æ˜¯ Linux çš„ 64 ä½å¯æ‰§è¡Œç¨‹åºï¼Œè€Œæˆ‘æ ¡çš„ Lab è¿˜æ˜¯ 32 ä½çš„ Windows PE32 ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯æ‰¾è€å¸ˆè¦åˆ°äº†å®ƒçš„ Linux ç‰ˆæœ¬ï¼Œä¸è¿‡ä¹Ÿæ˜¯ ELF32 ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—å«&lt;code&gt;bomb_32&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥ Lab æ˜¯ CSAPP Bomb Lab çš„è€ç‰ˆ 32 ä½ç¨‹åºï¼Œæ‰€ä»¥ä¹‹åæˆ‘è¿˜æ˜¯çœ‹ä¸€ä¸‹æ–°ç‰ˆçš„ Bomb Lab è¾ƒå¥½ï¼Œä¸èƒ½å®Œå…¨ä¸äº†è§£ 64 ä½æ±‡ç¼–å˜› :(&lt;/p&gt;
&lt;h2 id=&#34;å®éªŒç¯å¢ƒ&#34;&gt;å®éªŒç¯å¢ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;GNU gdb (GDB) Fedora 12.1-2.fc36&lt;/li&gt;
&lt;li&gt;GNU objdump version 2.37-36.fc36&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å®éªŒè¿‡ç¨‹&#34;&gt;å®éªŒè¿‡ç¨‹&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆåæ±‡ç¼–ç”Ÿæˆæ±‡ç¼–ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ objdump -S -C bomb_32 &amp;gt; bomb.disas
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºæˆ‘ä¸æ˜¯å¾ˆä¼šçœ‹ AT&amp;amp;T çš„æ±‡ç¼–ä»£ç ï¼Œæ‰€ä»¥æˆ‘çš„ objdump æ˜¯ aliased çš„ï¼Œé»˜è®¤ä½¿ç”¨ Intel çš„è¯­æ³•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ which objdump
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;objdump=&amp;#39;objdump --disassembler-options=intel&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        /usr/bin/objdump
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;gdb ä¹Ÿé»˜è®¤ä½¿ç”¨ Intel çš„è¯­æ³•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cat ~/.gdbinit
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;set disassembly-flavor intel
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å†ä½¿ç”¨ gdb å¼€å§‹è°ƒè¯•ç¨‹åºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ gdb --args ./bomb_32 input
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;phase_1&#34;&gt;phase_1&lt;/h3&gt;
&lt;p&gt;ç”±äºè€å¸ˆç»™äº†è¿™ä¸ªç¨‹åºè¿è¡Œçš„æµç¨‹å›¾ï¼Œæˆ‘ä¹Ÿçœ‹è¿‡ Bomb Lab ä¸­æä¾›çš„ .c æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘çŸ¥é“æ¯ä¸ªå­—ç¬¦ä¸²éƒ½åœ¨&lt;code&gt;phase_n&lt;/code&gt;çš„å‡½æ•°ä¸­è¾“å…¥æˆ–è€…æ£€éªŒã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ç›´æ¥æŸ¥çœ‹&lt;code&gt;phase_1&lt;/code&gt;å‡½æ•°çš„åæ±‡ç¼–ä»£ç ï¼Œå¹¶æ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°ä¸­çš„ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) disas phase_1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Dump of assembler code for function phase_1:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   ......
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   0x08048b2c &amp;lt;+12&amp;gt;:	push   0x80497c0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   0x08048b31 &amp;lt;+17&amp;gt;:	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   0x08048b32 &amp;lt;+18&amp;gt;:	call   0x8049030 &amp;lt;strings_not_equal&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   ......
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°å®ƒåœ¨å‹å…¥ä¸¤ä¸ªå‚æ•°ä¹‹åè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°&lt;code&gt;strings_not_equal&lt;/code&gt;ï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥çœ‹&lt;code&gt;0x80497c0&lt;/code&gt;é‡Œé¢æ˜¯ä»€ä¹ˆå†…å®¹ï¼Œæˆ‘é¦–å…ˆçŒœæµ‹å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) p (char *)0x80497c0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$1 = 0x80497c0 &amp;#34;Public speaking is very easy.&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ä¹‹åçš„æµ‹è¯•ä¸­ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä¹Ÿè®©æˆ‘è¿‡äº†ç¬¬ä¸€å…³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;phase_2&#34;&gt;phase_2&lt;/h3&gt;
&lt;p&gt;ç›´æ¥æŸ¥çœ‹&lt;code&gt;phase_2&lt;/code&gt;çš„æ±‡ç¼–ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; phase_2 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048b48 &amp;lt;phase_2&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b48:	55                   	push   ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b49:	89 e5                	mov    ebp,esp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸ºå±€éƒ¨å˜é‡è…¾å‡ºç©ºé—´
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b4b:	83 ec 20             	sub    esp,0x20
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¯èƒ½æ˜¯å†…éƒ¨è°ƒç”¨çš„å‡½æ•°éœ€è¦ä½¿ç”¨è¿™ä¸¤ä¸ªå¯„å­˜å™¨
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‰€ä»¥æ ¹æ® caller save åœ¨è¿™é‡Œä¿å­˜
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b4e:	56                   	push   esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b4f:	53                   	push   ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† input æ”¾å…¥ edx ä¸­
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b50:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç­‰äº sub esp, 0x8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b53:	83 c4 f8             	add    esp,0xfffffff8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°†å±€éƒ¨å˜é‡çš„åœ°å€ [ebp-0x18] æ”¾å…¥ eax ä¸­
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ç»™å®ƒèµ·åä¸ºå˜é‡ A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç”±äºç»™å±€éƒ¨å˜é‡é¢„ç•™çš„ä½ç½®å¾ˆå¤§ï¼ŒçŒœæµ‹ A æ˜¯ä¸€ä¸ªæ•°ç»„
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b56:	8d 45 e8             	lea    eax,[ebp-0x18]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å‹æ ˆä¼ å‚ï¼Œä¼ å…¥çš„æ˜¯ input, A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b59:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b5a:	52                   	push   edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; è°ƒç”¨å‡½æ•° read_six_numbers æ ¹æ®åå­—åˆç†æ€€ç–‘è¿™é‡Œæ˜¯è¯»å…¥å…­ä¸ªæ•°å­—ï¼ŒA å¯èƒ½æœ‰ 6 ä¸ªå…ƒç´ 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b5b:	e8 78 04 00 00       	call   8048fd8 &amp;lt;read_six_numbers&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; è¿™é‡Œ esp åŠ äº† 0x10 ç›¸å½“äºæŠŠä¹‹å‰çš„å‚æ•°é€€æ ˆäº†ï¼Œè¿˜æŠŠä¹‹å‰ add esp,0xfffffff8 çš„åŠ å›å»äº†ã€‚æˆ‘çŒœæµ‹ä¹‹å‰çš„ add å¯èƒ½å’Œå†…å­˜å¯¹é½æœ‰å…³
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b60:	83 c4 10             	add    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† A[0] ä¸ 1 æ¯”è¾ƒ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç”±äºä¹‹å‰ä¼ é€’çš„æ˜¯åœ°å€ï¼Œè¿™ä¸ªå˜é‡åº”è¯¥åœ¨ read_six_numbers ä¸­è¢«ä¿®æ”¹äº†
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b63:	83 7d e8 01          	cmp    DWORD PTR [ebp-0x18],0x1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœæ˜¯ 1 åˆ™æˆåŠŸï¼Œä¸æ˜¯ 1 åˆ™å¼•çˆ†ç‚¸å¼¹
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b67:	74 05                	je     8048b6e &amp;lt;phase_2+0x26&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b69:	e8 8e 09 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ebx &amp;lt;- 0x1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b6e:	bb 01 00 00 00       	mov    ebx,0x1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† A æ”¾å…¥ esi ä¸­
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b73:	8d 75 e8             	lea    esi,[ebp-0x18]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- 0x2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b76:	8d 43 01             	lea    eax,[ebx+0x1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; è¿™æ­¥éª¤æ“ä½œä¹‹å eax çš„å€¼ä¸º (ebx + 1) * A[ebx - 1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ebx åˆå§‹ä¸º 1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b79:	0f af 44 9e fc       	imul   eax,DWORD PTR [esi+ebx*4-0x4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç›¸å½“äºåˆ¤æ–­ A[ebx] æ˜¯ä¸æ˜¯ A[ebx - 1] ä¸¤å€
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b7e:	39 04 9e             	cmp    DWORD PTR [esi+ebx*4],eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b81:	74 05                	je     8048b88 &amp;lt;phase_2+0x40&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b83:	e8 74 09 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b88:	43                   	inc    ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b89:	83 fb 05             	cmp    ebx,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æˆ‘è¯»åˆ°è¿™é‡Œæ‰å‘ç°æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œç»ˆæ­¢æ¡ä»¶ä¸º ebx &amp;gt; 5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b8c:	7e e8                	jle    8048b76 &amp;lt;phase_2+0x2e&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‰€ä»¥æ ¹æ®é€’æ¨å…¬å¼å¯çŸ¥å­—ç¬¦ä¸²ä¸º 1 2 6 24 120 720
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b8e:	8d 65 d8             	lea    esp,[ebp-0x28]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b91:	5b                   	pop    ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b92:	5e                   	pop    esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b93:	89 ec                	mov    esp,ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b95:	5d                   	pop    ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b96:	c3                   	ret    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b97:	90                   	nop
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒè°ƒç”¨äº†å‡½æ•°&lt;code&gt;read_six_numbers&lt;/code&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿåˆ†æä¸€ä¸‹å®ƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; å‚æ•°ä¸ºå­—ç¬¦ä¸² input å’Œæ•°ç»„ A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048fd8 &amp;lt;read_six_numbers&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fd8:	55                   	push   ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fd9:	89 e5                	mov    ebp,esp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fdb:	83 ec 08             	sub    esp,0x8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¼ å…¥çš„è¾“å…¥å­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fde:	8b 4d 08             	mov    ecx,DWORD PTR [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¼ å…¥çš„æ•°ç»„ A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fe1:	8b 55 0c             	mov    edx,DWORD PTR [ebp+0xc]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; A[5]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fe4:	8d 42 14             	lea    eax,[edx+0x14]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fe7:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; A[4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fe8:	8d 42 10             	lea    eax,[edx+0x10]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048feb:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; A[3]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fec:	8d 42 0c             	lea    eax,[edx+0xc]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fef:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; A[2]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ff0:	8d 42 08             	lea    eax,[edx+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ff3:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; A[1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ff4:	8d 42 04             	lea    eax,[edx+0x4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ff7:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; A[0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ff8:	52                   	push   edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; format å­—ç¬¦ä¸² &amp;#34;%d %d %d %d %d %d&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ff9:	68 1b 9b 04 08       	push   0x8049b1b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; input è¾“å…¥å­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ffe:	51                   	push   ecx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048fff:	e8 5c f8 ff ff       	call   8048860 &amp;lt;sscanf@plt&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049004:	83 c4 20             	add    esp,0x20
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049007:	83 f8 05             	cmp    eax,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 804900a:	7f 05                	jg     8049011 &amp;lt;read_six_numbers+0x39&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 804900c:	e8 eb 04 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049011:	89 ec                	mov    esp,ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049013:	5d                   	pop    ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049014:	c3                   	ret    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049015:	8d 76 00             	lea    esi,[esi+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨å­—ç¬¦ä¸²&lt;code&gt;1 2 6 24 120 720&lt;/code&gt;æˆåŠŸé€šè¿‡ç¬¬äºŒå…³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;phase_3&#34;&gt;phase_3&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; phase_3 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048b98 &amp;lt;phase_3&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b98:	55                   	push   ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b99:	89 e5                	mov    ebp,esp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; é¢„ç•™ 20 ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b9b:	83 ec 14             	sub    esp,0x14
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b9e:	53                   	push   ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† input æ”¾å…¥ edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048b9f:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; sub esp, 0x4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ba2:	83 c4 f4             	add    esp,0xfffffff4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; int_b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ba5:	8d 45 fc             	lea    eax,[ebp-0x4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ba8:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; char_c
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ba9:	8d 45 fb             	lea    eax,[ebp-0x5]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bac:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; int_a
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bad:	8d 45 f4             	lea    eax,[ebp-0xc]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bb0:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; é€šè¿‡ GBD è°ƒè¯•å¯ä»¥çŸ¥é“è¿™ä¸ªåœ°å€å†…å®¹ä¸º &amp;#34;%d %c %d&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bb1:	68 de 97 04 08       	push   0x80497de
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; input
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bb6:	52                   	push   edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bb7:	e8 a4 fc ff ff       	call   8048860 &amp;lt;sscanf@plt&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bbc:	83 c4 20             	add    esp,0x20
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœ sscanf åŒ¹é…å¹¶èµ‹å€¼çš„ä¸ªæ•°ä¸å¤šäº 2 ï¼Œåˆ™çˆ†ç‚¸
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bbf:	83 f8 02             	cmp    eax,0x2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bc2:	7f 05                	jg     8048bc9 &amp;lt;phase_3+0x31&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bc4:	e8 33 09 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† int_a ä¸ 0x7 æ¯”è¾ƒ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ€€ç–‘æ˜¯ä¸€ä¸ªé˜²æ­¢æ•°ç»„è¶Šç•Œçš„æ“ä½œ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bc9:	83 7d f4 07          	cmp    DWORD PTR [ebp-0xc],0x7
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœå¤§äºåˆ™çˆ†ç‚¸
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bcd:	0f 87 b5 00 00 00    	ja     8048c88 &amp;lt;phase_3+0xf0&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† int_a èµ‹å€¼ç»™ eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bd3:	8b 45 f4             	mov    eax,DWORD PTR [ebp-0xc]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè·³è½¬è¡¨ï¼Œå¯¹åº”åˆ° C è¯­è¨€ä¸­åº”è¯¥æ˜¯ä¸€ä¸ª switch-case ç»“æ„
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¯ä»¥åœ¨ gdb é‡Œé¢æŸ¥çœ‹ä¸€ä¸‹å¯¹åº”çš„è¡¨ `(gdb) p/x *(int *)0x80497e8`
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; [0x80497e8] å¯¹åº” 8048be0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; [0x80497e8+1*4] å¯¹åº” 8048c00
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; [0x80497e8+2*4] å¯¹åº” 8048c16
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; [0x80497e8+3*4] å¯¹åº” 8048c28
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; [0x80497e8+4*4] å¯¹åº” 8048c40
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; [0x80497e8+5*4] å¯¹åº” 8048c52
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; [0x80497e8+6*4] å¯¹åº” 8048c64
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; [0x80497e8+7*4] å¯¹åº” 8048c76
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; switch-case(int_a)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bd6:	ff 24 85 e8 97 04 08 	jmp    DWORD PTR [eax*4+0x80497e8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bdd:	8d 76 00             	lea    esi,[esi+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; case 0:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; bl &amp;lt;- 0x71
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048be0:	b3 71                	mov    bl,0x71
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† int_b ä¸ 0x309 æ¯”è¾ƒ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048be2:	81 7d fc 09 03 00 00 	cmp    DWORD PTR [ebp-0x4],0x309
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœç­‰äºå°± break
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048be9:	0f 84 a0 00 00 00    	je     8048c8f &amp;lt;phase_3+0xf7&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bef:	e8 08 09 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bf4:	e9 96 00 00 00       	jmp    8048c8f &amp;lt;phase_3+0xf7&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eiz æ˜¯ä¸€ä¸ªä¼ªå¯„å­˜å™¨ï¼Œå®ƒå§‹ç»ˆä¸º 0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048bf9:	8d b4 26 00 00 00 00 	lea    esi,[esi+eiz*1+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; åé¢å‡ ä¸ª case éƒ½æ˜¯ç›¸åŒçš„é“ç†
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ......
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; bl ä¸ char_c æ¯”è¾ƒ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048c8f:	3a 5d fb             	cmp    bl,BYTE PTR [ebp-0x5]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‰€ä»¥åŸºæœ¬æµç¨‹å°±æ˜¯æ ¹æ® int_a çš„å€¼ç¡®å®šè¿›å»å“ªä¸€ä¸ª case ï¼Œ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç„¶ååœ¨è¯¥åˆ†æ”¯ä¸­å°† int_b å’ŒæŸä¸€å€¼æ¯”è¾ƒï¼Œå¹¶ç¡®å®š char_c åº”è¯¥ç­‰äºçš„å€¼
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‰€ä»¥ç­”æ¡ˆåº”è¯¥ä¸å”¯ä¸€ï¼Œé€šè¿‡ int_a çš„å€¼ç¡®å®šåé¢ä¸¤ä¸ªç­”æ¡ˆ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ......
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä½¿ç”¨&lt;code&gt;0 q 777&lt;/code&gt;é€šè¿‡äº†è¿™ä¸€å…³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;phase_4&#34;&gt;phase_4&lt;/h3&gt;
&lt;p&gt;è¿™ä¸€å…³åŒ…å«äº†é€’å½’å‡½æ•°ï¼Œä½†æ˜¯æŒ‘æˆ˜æ€§ä¸æ˜¯å¾ˆå¤§ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; phase_4 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048ce0 &amp;lt;phase_4&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ce0:	55                   	push   ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ce1:	89 e5                	mov    ebp,esp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ce3:	83 ec 18             	sub    esp,0x18
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; input -&amp;gt; edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ce6:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; sub esp, 0xc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ce9:	83 c4 fc             	add    esp,0xfffffffc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸º A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cec:	8d 45 fc             	lea    eax,[ebp-0x4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cef:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ ¹æ® GDB `p (char *)0x8049808` å¯å¾—è¯¥å­—ç¬¦ä¸²ä¸º `%d`
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cf0:	68 08 98 04 08       	push   0x8049808
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cf5:	52                   	push   edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cf6:	e8 65 fb ff ff       	call   8048860 &amp;lt;sscanf@plt&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cfb:	83 c4 10             	add    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; åˆ¤æ–­ sscanf æ˜¯å¦æˆåŠŸ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cfe:	83 f8 01             	cmp    eax,0x1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d01:	75 06                	jne    8048d09 &amp;lt;phase_4+0x29&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; åˆ¤æ–­ A å’Œ 0x0 ï¼Œå¦‚æœä¸å¤§äº 0 åˆ™çˆ†ç‚¸
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d03:	83 7d fc 00          	cmp    DWORD PTR [ebp-0x4],0x0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d07:	7f 05                	jg     8048d0e &amp;lt;phase_4+0x2e&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d09:	e8 ee 07 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; sub esp, 0x4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d0e:	83 c4 f4             	add    esp,0xfffffff4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; A -&amp;gt; eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d11:	8b 45 fc             	mov    eax,DWORD PTR [ebp-0x4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å‚æ•°å…¥æ ˆå¹¶è°ƒç”¨ func4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d14:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d15:	e8 86 ff ff ff       	call   8048ca0 &amp;lt;func4&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d1a:	83 c4 10             	add    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; è¿”å›å€¼å¦‚æœä¸æ˜¯ 55 åˆ™çˆ†ç‚¸
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d1d:	83 f8 37             	cmp    eax,0x37
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d20:	74 05                	je     8048d27 &amp;lt;phase_4+0x47&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d22:	e8 d5 07 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d27:	89 ec                	mov    esp,ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d29:	5d                   	pop    ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d2a:	c3                   	ret    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d2b:	90                   	nop
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹&lt;code&gt;func4&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; phase_4 çš„å‚æ•°ä¸ºæ•´å‹ A ï¼Œåœ¨ [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048ca0 &amp;lt;func4&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ca0:	55                   	push   ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ca1:	89 e5                	mov    ebp,esp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ca3:	83 ec 10             	sub    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ca6:	56                   	push   esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ca7:	53                   	push   ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ebx &amp;lt;- A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ca8:	8b 5d 08             	mov    ebx,DWORD PTR [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœ A ä¸å¤§äº 1 åˆ™è·³è½¬åˆ° é€€å‡ºï¼Œè¿™é‡Œåº”è¯¥æ˜¯é€’å½’å‡ºå£ï¼Œè¿”å›å€¼ä¸º 1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cab:	83 fb 01             	cmp    ebx,0x1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cae:	7e 20                	jle    8048cd0 &amp;lt;func4+0x30&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cb0:	83 c4 f4             	add    esp,0xfffffff4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cb3:	8d 43 ff             	lea    eax,[ebx-0x1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cb6:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; func(A - 1)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cb7:	e8 e4 ff ff ff       	call   8048ca0 &amp;lt;func4&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cbc:	89 c6                	mov    esi,eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cbe:	83 c4 f4             	add    esp,0xfffffff4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cc1:	8d 43 fe             	lea    eax,[ebx-0x2]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cc4:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; func(A - 2)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å†™åˆ°è¿™é‡Œå¯ä»¥çŒœåˆ°è¿™æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¹‹å‰è¦æ±‚è¿”å›å€¼æ˜¯ 55 ï¼Œæ‰€ä»¥è¾“å…¥åº”è¯¥æ˜¯ 9
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cc5:	e8 d6 ff ff ff       	call   8048ca0 &amp;lt;func4&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cca:	01 f0                	add    eax,esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ccc:	eb 07                	jmp    8048cd5 &amp;lt;func4+0x35&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cce:	89 f6                	mov    esi,esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cd0:	b8 01 00 00 00       	mov    eax,0x1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cd5:	8d 65 e8             	lea    esp,[ebp-0x18]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cd8:	5b                   	pop    ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cd9:	5e                   	pop    esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cda:	89 ec                	mov    esp,ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cdc:	5d                   	pop    ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cdd:	c3                   	ret    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048cde:	89 f6                	mov    esi,esi
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å…¥&lt;code&gt;9&lt;/code&gt;æˆåŠŸé€šè¿‡äº†è¿™ä¸€å…³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;phase_5&#34;&gt;phase_5&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; phase_5 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048d2c &amp;lt;phase_5&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d2c:	55                   	push   ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d2d:	89 e5                	mov    ebp,esp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d2f:	83 ec 10             	sub    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d32:	56                   	push   esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d33:	53                   	push   ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; input -&amp;gt; ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d34:	8b 5d 08             	mov    ebx,DWORD PTR [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d37:	83 c4 f4             	add    esp,0xfffffff4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d3a:	53                   	push   ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; è®¡ç®— input å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¦‚æœé•¿åº¦ä¸ä¸º 6 åˆ™çˆ†ç‚¸
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d3b:	e8 d8 02 00 00       	call   8049018 &amp;lt;string_length&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d40:	83 c4 10             	add    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d43:	83 f8 06             	cmp    eax,0x6
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d46:	74 05                	je     8048d4d &amp;lt;phase_5+0x21&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d48:	e8 af 07 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°çŸ¥è¯†ï¼šç”±äºä¸¤æ•°ç›¸åŒï¼Œæ‰€ä»¥ä½¿ç”¨ xor æ¥æ¸…é›¶å¿«ä¸€äº›
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d4d:	31 d2                	xor    edx,edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ä»¤è¿™ä¸ªå˜é‡ä¸º str_a
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d4f:	8d 4d f8             	lea    ecx,[ebp-0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; åœ°å€ 0x804b220 &amp;#34;isrveawhobpnutfg\260\001&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ€€ç–‘æ˜¯é€šè¿‡ä¸€äº›æ“ä½œä»ä¸Šè¿°å­—ç¬¦ä¸²ä¸­å–å‡ºå­—ç¬¦é‡æ–°æ‹¼æ¥
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ä»¤è¿™ä¸ªå­—ç¬¦ä¸²ä¸º dict
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d52:	be 20 b2 04 08       	mov    esi,0x804b220
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä»è¿™é‡Œå¼€å§‹æ˜¯å¾ªç¯å…­æ¬¡ï¼Œåé¢çš„å­—ç¬¦ä¸²å¸¸é‡é•¿åº¦ä¹Ÿåˆšå¥½ä¸º 6
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; al &amp;lt;- input[edx]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d57:	8a 04 1a             	mov    al,BYTE PTR [edx+ebx*1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å– al ä½å››ä½
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d5a:	24 0f                	and    al,0xf
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‹“å±•é•¿åº¦åˆ° 32 ä½
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d5c:	0f be c0             	movsx  eax,al
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; al &amp;lt;- dict[eax]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d5f:	8a 04 30             	mov    al,BYTE PTR [eax+esi*1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; str_a[edx] &amp;lt;- al
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d62:	88 04 0a             	mov    BYTE PTR [edx+ecx*1],al
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d65:	42                   	inc    edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d66:	83 fa 05             	cmp    edx,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d69:	7e ec                	jle    8048d57 &amp;lt;phase_5+0x2b&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¾ªç¯ç»“æŸ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç»™å­—ç¬¦ä¸² str_a ç»“å°¾è¡¥ä¸Š &amp;#39;\0&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d6b:	c6 45 fe 00          	mov    BYTE PTR [ebp-0x2],0x0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d6f:	83 c4 f8             	add    esp,0xfffffff8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; åœ°å€ 0x804980b &amp;#34;giants&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d72:	68 0b 98 04 08       	push   0x804980b
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d77:	8d 45 f8             	lea    eax,[ebp-0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d7a:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ¯”è¾ƒ str_a å’Œ &amp;#34;giants&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‰€ä»¥è¾“å…¥å­—ç¬¦ä¸²åªçœ‹æœ€ä½å››ä½åº”è¯¥æ˜¯ 15 0 5 11 13 1 ï¼Œåå…­è¿›åˆ¶æ˜¯ f 0 5 b d 1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æŸ¥çœ‹ ASCII è¡¨ï¼Œæ‰¾åˆ°æ–¹ä¾¿è¾“å…¥çš„å†…å®¹ï¼Œa-z åŠå…¶é™„è¿‘çš„å­—ç¬¦å¾ˆç¬¦åˆè¦æ±‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‰€ä»¥ä½¿ç”¨ o`ekma
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048d7b:	e8 b0 02 00 00       	call   8049030 &amp;lt;strings_not_equal&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ......
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å…¥&lt;code&gt;o`ekma&lt;/code&gt;æˆåŠŸé€šè¿‡äº†è¿™ä¸€å…³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;phase_6&#34;&gt;phase_6&lt;/h3&gt;
&lt;p&gt;è¿™ä¸€å…³æ¯”è¾ƒé•¿ï¼Œæˆ‘å°†å®ƒåˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹å°±èƒ½çœ‹åˆ°å±€éƒ¨å˜é‡è¢«èµ‹å€¼åˆ°ä¸€ä¸ªç¥ç§˜çš„åœ°å€ï¼Œè¿™åº”è¯¥è§£è¿™é¢˜çš„å…³é”®ã€‚ä¹‹åä½¿ç”¨äº†&lt;code&gt;read_six_numbers&lt;/code&gt;è¿™ä¸ªå‡½æ•°è¯»å…¥å…­ä¸ªæ•°å­—ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; phase_6 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048d98 &amp;lt;phase_6&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ......
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; input &amp;lt;- edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048da1:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; *(int *)0x804b26c 153
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæŒ‡é’ˆ C
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; C &amp;lt;- 0x804b26c
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å®ƒç›´æ¥æŒ‡å‘äº†ä¸€ä¸ªç¥ç§˜çš„ç»“æ„
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048da4:	c7 45 cc 6c b2 04 08 	mov    DWORD PTR [ebp-0x34],0x804b26c
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dab:	83 c4 f8             	add    esp,0xfffffff8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæ•°ç»„ A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dae:	8d 45 e8             	lea    eax,[ebp-0x18]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048db1:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048db2:	52                   	push   edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048db3:	e8 20 02 00 00       	call   8048fd8 &amp;lt;read_six_numbers&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¢°åˆ°çš„ç¬¬ä¸€ä¸ªå¾ªç¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; for (int i = 0; i &amp;lt;= 5; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     if (A[i] &amp;gt; 6)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;         explode_bomb();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     for (int j = i + 1; j &amp;lt;= 5; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;        if (A[i] == A[j])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;            explode_bomb();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; edi &amp;lt;- 0 ä¸å¦¨ä»¤å…¶ä¸º i
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048db8:	31 ff                	xor    edi,edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dba:	83 c4 10             	add    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dbd:	8d 76 00             	lea    esi,[esi+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¾ªç¯ 6 æ¬¡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dc0:	8d 45 e8             	lea    eax,[ebp-0x18]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- A[i]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dc3:	8b 04 b8             	mov    eax,DWORD PTR [eax+edi*4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- A[i] - 1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dc6:	48                   	dec    eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœ eax å¤§äº 5 å°±çˆ†ç‚¸ï¼Œä¸èƒ½å¤§äº 6
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dc7:	83 f8 05             	cmp    eax,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dca:	76 05                	jbe    8048dd1 &amp;lt;phase_6+0x39&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dcc:	e8 2b 07 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ebx &amp;lt;- i + 1 ä¸å¦¨ä»¤å…¶ä¸º j
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dd1:	8d 5f 01             	lea    ebx,[edi+0x1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; if (j &amp;lt;= 5)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dd4:	83 fb 05             	cmp    ebx,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dd7:	7f 23                	jg     8048dfc &amp;lt;phase_6+0x64&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- 4 * edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dd9:	8d 04 bd 00 00 00 00 	lea    eax,[edi*4+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ä»¤è¿™ä¸ªå±€éƒ¨å˜é‡ä¸º B
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; B &amp;lt;- 4 * edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048de0:	89 45 c8             	mov    DWORD PTR [ebp-0x38],eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; esi &amp;lt;- A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048de3:	8d 75 e8             	lea    esi,[ebp-0x18]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å†…å±‚å¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048de6:	8b 55 c8             	mov    edx,DWORD PTR [ebp-0x38]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- A[i]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048de9:	8b 04 32             	mov    eax,DWORD PTR [edx+esi*1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ¯”è¾ƒ A[i] å’Œ A[j]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dec:	3b 04 9e             	cmp    eax,DWORD PTR [esi+ebx*4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœç›¸ç­‰åˆ™å¼•çˆ†ç‚¸å¼¹
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048def:	75 05                	jne    8048df6 &amp;lt;phase_6+0x5e&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048df1:	e8 06 07 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048df6:	43                   	inc    ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048df7:	83 fb 05             	cmp    ebx,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dfa:	7e ea                	jle    8048de6 &amp;lt;phase_6+0x4e&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç»“æŸå†…å±‚å¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dfc:	47                   	inc    edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048dfd:	83 ff 05             	cmp    edi,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e00:	7e be                	jle    8048dc0 &amp;lt;phase_6+0x28&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç»“æŸå¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è‡³æ­¤å¯ä»¥å¾—å‡ºåˆæ­¥ç»“è®ºï¼Œç¬¬ä¸€ä¸ªæ•°å­—ä¸€å®šä¸å¤§äº 6 ï¼Œè€Œä¸”ä»»æ„ä¸¤ä¸ªæ•°å­—ä¸ç›¸ç­‰&lt;/p&gt;
&lt;p&gt;ç¢°åˆ°ç¬¬äºŒä¸ªå¾ªç¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; E = D;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; for (int i = 0, p = C; i &amp;lt;= 5; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     j = 1;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     while (j &amp;lt; A[i]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;         p = p-&amp;gt;next;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;         j++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     E[i] = p;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; edi &amp;lt;- 0 ä¸å¦¨ä»¤å…¶ä¸º i
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e02:	31 ff                	xor    edi,edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ecx &amp;lt;- A
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e04:	8d 4d e8             	lea    ecx,[ebp-0x18]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæ•°ç»„ D
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e07:	8d 45 d0             	lea    eax,[ebp-0x30]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæŒ‡é’ˆ E
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; E &amp;lt;- D
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e0a:	89 45 c4             	mov    DWORD PTR [ebp-0x3c],eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e0d:	8d 76 00             	lea    esi,[esi+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¾ªç¯ 6 æ¬¡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; esi &amp;lt;- C ä¸å¦¨ä»¤å…¶ä¸ºæŒ‡é’ˆ p
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; C åˆå€¼ä¸º 0x804b26c
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e10:	8b 75 cc             	mov    esi,DWORD PTR [ebp-0x34]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ebx &amp;lt;- 1 ä¸å¦¨ä»¤å…¶ä¸º j
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e13:	bb 01 00 00 00       	mov    ebx,0x1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e18:	8d 04 bd 00 00 00 00 	lea    eax,[edi*4+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e1f:	89 c2                	mov    edx,eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† j ä¸ A[i] æ¯”è¾ƒ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e21:	3b 1c 08             	cmp    ebx,DWORD PTR [eax+ecx*1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e24:	7d 12                	jge    8048e38 &amp;lt;phase_6+0xa0&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœå°äºåˆ™æ‰§è¡Œä¸‹é¢è¿™æ®µ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- A[i]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e26:	8b 04 0a             	mov    eax,DWORD PTR [edx+ecx*1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e29:	8d b4 26 00 00 00 00 	lea    esi,[esi+eiz*1+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å†…å±‚å¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ„Ÿè§‰æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; çŒœæµ‹åç§»ä¸º 0x8 çš„ä½ç½®æ˜¯ next å­—æ®µ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; p &amp;lt;- p-&amp;gt;next
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e30:	8b 76 08             	mov    esi,DWORD PTR [esi+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; j++
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e33:	43                   	inc    ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; while (j &amp;lt; A[i])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e34:	39 c3                	cmp    ebx,eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e36:	7c f8                	jl     8048e30 &amp;lt;phase_6+0x98&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç»“æŸå†…å±‚å¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; edx &amp;lt;- E
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e38:	8b 55 c4             	mov    edx,DWORD PTR [ebp-0x3c]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; E[i] &amp;lt;- p
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e3b:	89 34 ba             	mov    DWORD PTR [edx+edi*4],esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; i++
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e3e:	47                   	inc    edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; while (i &amp;lt;= 5)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e3f:	83 ff 05             	cmp    edi,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e42:	7e cc                	jle    8048e10 &amp;lt;phase_6+0x78&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç»“æŸå¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨ GDB æŸ¥çœ‹ä¸€ä¸‹é‚£ä¸ªç¥ç§˜åœ°å€æœç„¶æœ‰äº†æ”¶è·ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x804b26c
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b26c &amp;lt;node1&amp;gt;:	0x000000fd	0x00000001	0x0804b260
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x804b260
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b260 &amp;lt;node2&amp;gt;:	0x000002d5	0x00000002	0x0804b254
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x804b254
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b254 &amp;lt;node3&amp;gt;:	0x0000012d	0x00000003	0x0804b248
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x804b248
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b248 &amp;lt;node4&amp;gt;:	0x000003e5	0x00000004	0x0804b23c
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x804b23c
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b23c &amp;lt;node5&amp;gt;:	0x000000d4	0x00000005	0x0804b230
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x804b230
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b230 &amp;lt;node6&amp;gt;:	0x000001b0	0x00000006	0x00000000
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ä¸€å…±æœ‰å…­ä¸ªèŠ‚ç‚¹
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;çŒœæµ‹ä¸‰ä¸ªå­—æ®µåˆ†åˆ«ä¸ºï¼š&lt;code&gt;value&lt;/code&gt;, &lt;code&gt;id&lt;/code&gt;, &lt;code&gt;next&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç¢°åˆ°ç¬¬ä¸‰ä¸ªå¾ªç¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; p = D;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; C = D;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; for (int i = 1; i &amp;lt;= 5; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     p-&amp;gt;next = D[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     p = p-&amp;gt;next;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; esi &amp;lt;- D ä¸å¦¨ä»¤å…¶ä¸ºæŒ‡é’ˆ p
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e44:	8b 75 d0             	mov    esi,DWORD PTR [ebp-0x30]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; C &amp;lt;- D
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e47:	89 75 cc             	mov    DWORD PTR [ebp-0x34],esi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; edi &amp;lt;- 1 ä»¤å…¶ä¸º i
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e4a:	bf 01 00 00 00       	mov    edi,0x1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; edx &amp;lt;- D
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e4f:	8d 55 d0             	lea    edx,[ebp-0x30]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¾ªç¯ 6 æ¬¡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- D[i]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e52:	8b 04 ba             	mov    eax,DWORD PTR [edx+edi*4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; p-&amp;gt;next &amp;lt;- D[i]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e55:	89 46 08             	mov    DWORD PTR [esi+0x8],eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; p &amp;lt;- p-&amp;gt;next
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e58:	89 c6                	mov    esi,eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; i++
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e5a:	47                   	inc    edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; while (i &amp;lt;= 5)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e5b:	83 ff 05             	cmp    edi,0x5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e5e:	7e f2                	jle    8048e52 &amp;lt;phase_6+0xba&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç»“æŸå¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; p-&amp;gt;next = NULL;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e60:	c7 46 08 00 00 00 00 	mov    DWORD PTR [esi+0x8],0x0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢è¿™éƒ¨åˆ†ä»£ç ç›¸å½“äºæŠŠæ•°ç»„&lt;code&gt;D&lt;/code&gt;ä¸²èµ·æ¥å˜ä¸ºä¸€ä¸ªé“¾è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;ç¢°åˆ°ç¬¬å››ä¸ªå¾ªç¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; p = C;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; for (int i = 0; i &amp;lt;= 4; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     if (p-&amp;gt;value &amp;lt; p-&amp;gt;next-&amp;gt;value) 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;         explode_bomb();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     p = p-&amp;gt;next;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ;     i++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ•°ç»„ D ç»„æˆçš„æ•°åˆ—åº”è¯¥é€’å‡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† 6 ä¸ª node æ’åº
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ä»å¤§åˆ°å°ï¼šnode4 node2 node 6 node3 node1 node5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e67:	8b 75 cc             	mov    esi,DWORD PTR [ebp-0x34]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e6a:	31 ff                	xor    edi,edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e6c:	8d 74 26 00          	lea    esi,[esi+eiz*1+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¾ªç¯ 5 æ¬¡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; edx &amp;lt;- p-&amp;gt;next
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e70:	8b 56 08             	mov    edx,DWORD PTR [esi+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; eax &amp;lt;- p-&amp;gt;value
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e73:	8b 06                	mov    eax,DWORD PTR [esi]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°† p-&amp;gt;value å’Œ p-&amp;gt;next-&amp;gt;value æ¯”è¾ƒ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å³å¦‚æœå°äºï¼Œåˆ™çˆ†ç‚¸
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e75:	3b 02                	cmp    eax,DWORD PTR [edx]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e77:	7d 05                	jge    8048e7e &amp;lt;phase_6+0xe6&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e79:	e8 7e 06 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; p &amp;lt;- p-&amp;gt;next 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e7e:	8b 76 08             	mov    esi,DWORD PTR [esi+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; i++
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e81:	47                   	inc    edi
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; while (i &amp;lt;= 4)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e82:	83 ff 04             	cmp    edi,0x4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e85:	7e e9                	jle    8048e70 &amp;lt;phase_6+0xd8&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç»“æŸå¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºä»å¤§åˆ°å°æ˜¯&lt;code&gt;node4&lt;/code&gt;, &lt;code&gt;node2&lt;/code&gt;, &lt;code&gt;node6&lt;/code&gt;, &lt;code&gt;node3&lt;/code&gt;, &lt;code&gt;node1&lt;/code&gt;, &lt;code&gt;node5&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¾“å…¥å­—ç¬¦ä¸²&lt;code&gt;4 2 6 3 1 5&lt;/code&gt;ä¾¿èƒ½é€šè¿‡è¿™å…³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;secret_phase&#34;&gt;secret_phase&lt;/h3&gt;
&lt;p&gt;å…¶å®åœ¨ 6 å…³ä¹‹åè¿˜æœ‰ä¸€ä¸ªéšè—å…³å¡ï¼Œéœ€è¦ä¸€å®šçš„æ¡ä»¶è§¦å‘ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ç›´æ¥åœ¨&lt;code&gt;bomb.disas&lt;/code&gt;é‡Œé¢æŸ¥æ‰¾å‡½æ•°&lt;code&gt;secret_phase&lt;/code&gt;ï¼Œç„¶åå¯ä»¥å‘ç°å®ƒåœ¨å‡½æ•°&lt;code&gt;phase_defused&lt;/code&gt;ä¸­è¢«è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåœ¨&lt;code&gt;phase_6&lt;/code&gt;æ‰“ä¸Šæ–­ç‚¹ï¼Œå‘ç°åœ¨&lt;code&gt;phase_defused&lt;/code&gt;ä¸­å‘ç°æœ‰æ€ªå¼‚ä¹‹å¤„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049543:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ ¼å¼åŒ–å­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; (gdb) x/s 0x8049d03
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; 0x8049d03:	&amp;#34;%d %s&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049544:	68 03 9d 04 08       	push   0x8049d03
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ²¡æœ‰è§£é”éšè—å…³å¡æ—¶ï¼Œè¾“å…¥å­—ç¬¦ä¸²åªæœ‰ä¸€ä¸ª 9 ï¼Œè¿™ä¸ä¸¤ä¸ªå ä½ç¬¦çš„ä¸ç›¸ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; æ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨ 9 åé¢è¡¥ä¸Šä¸€ä¸ªå­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; åœ¨ phase_6 æ‰“ä¸Šæ–­ç‚¹
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; (gdb) break phase_6
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; (gdb) run
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; (gdb) x/s 0x804b770
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; 0x804b770 &amp;lt;input_strings+240&amp;gt;:	&amp;#34;9&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049549:	68 70 b7 04 08       	push   0x804b770
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 804954e:	e8 0d f3 ff ff       	call   8048860 &amp;lt;sscanf@plt&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049553:	83 c4 10             	add    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‘ç°è¿™é‡Œæœ‰ä¸ªç”¨äºè°ƒè¯•çš„æ ‡ç­¾&lt;code&gt;input_strings&lt;/code&gt;ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹&lt;code&gt;input_strings&lt;/code&gt; +0 +80 +160 éƒ½æ˜¯ä»€ä¹ˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/s 0x804b770-240
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b680 &amp;lt;input_strings&amp;gt;:	&amp;#34;Public speaking is very easy.&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/s 0x804b770-240+80
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b6d0 &amp;lt;input_strings+80&amp;gt;:	&amp;#34;1 2 6 24 120 720&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/s 0x804b770-240+160
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b720 &amp;lt;input_strings+160&amp;gt;:	&amp;#34;0 q 777&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‘ç°æ˜¯å‰ä¸‰å…³è¾“å…¥çš„å­—ç¬¦ï¼Œæ‰€ä»¥&amp;quot;9&amp;quot;å¯¹åº”çš„æ˜¯æˆ‘ä»¬ç¬¬å››å…³çš„è¾“å…¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœæˆåŠŸç»™ä¸¤ä¸ªå‚æ•°èµ‹å€¼
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049556:	83 f8 02             	cmp    eax,0x2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8049559:	75 37                	jne    8049592 &amp;lt;phase_defused+0x66&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 804955b:	83 c4 f8             	add    esp,0xfffffff8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å­—ç¬¦ä¸²æ¯”å¯¹
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; (gdb) x/s 0x8049d09
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; 0x8049d09:	&amp;#34;austinpowers&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¯ä»¥å¾—çŸ¥ç¬¬å››å…³æ—¶åé¢åº”è¯¥æ·»åŠ ä¸€ä¸ª&amp;#34;austinpowers&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç”±æ­¤å¯ä»¥è¿›å…¥éšè—å…³å¡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ......
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 804958d:	e8 56 f9 ff ff       	call   8048ee8 &amp;lt;secret_phase&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¼€å§‹çœ‹å‡½æ•°&lt;code&gt;secret_phase&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048ee8 &amp;lt;secret_phase&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ee8:	55                   	push   ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ee9:	89 e5                	mov    ebp,esp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eeb:	83 ec 14             	sub    esp,0x14
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eee:	53                   	push   ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å°†è¾“å…¥çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; è¿”å›å€¼åœ¨ eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eef:	e8 08 03 00 00       	call   80491fc &amp;lt;read_line&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ef4:	6a 00                	push   0x0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ef6:	6a 0a                	push   0xa
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ef8:	6a 00                	push   0x0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048efa:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048efb:	e8 f0 f8 ff ff       	call   80487f0 &amp;lt;__strtol_internal@plt&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f00:	83 c4 10             	add    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f03:	89 c3                	mov    ebx,eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f05:	8d 43 ff             	lea    eax,[ebx-0x1]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœ input-1 å¤§äº 0x3e8 åˆ™çˆ†ç‚¸
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f08:	3d e8 03 00 00       	cmp    eax,0x3e8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f0d:	76 05                	jbe    8048f14 &amp;lt;secret_phase+0x2c&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f0f:	e8 e8 05 00 00       	call   80494fc &amp;lt;explode_bomb&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f14:	83 c4 f8             	add    esp,0xfffffff8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f17:	53                   	push   ebx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; è¯¥åœ°å€å¯èƒ½æŒ‡å‘ä¸€ä¸ªæ•°ç»„æˆ–è€…ç»“æ„
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f18:	68 20 b3 04 08       	push   0x804b320
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f1d:	e8 72 ff ff ff       	call   8048e94 &amp;lt;fun7&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f22:	83 c4 10             	add    esp,0x10
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; å¦‚æœè¿”å›å€¼ä¸º 7 åˆ™æˆåŠŸ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f25:	83 f8 07             	cmp    eax,0x7
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048f28:	74 05                	je     8048f2f &amp;lt;secret_phase+0x47&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ......
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºè°ƒç”¨äº†å‡½æ•°&lt;code&gt;fun7&lt;/code&gt;ï¼Œæˆ‘ä»¬ç›´æ¥æ¥çœ‹å®ƒã€‚&lt;code&gt;func7&lt;/code&gt;æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„é€’å½’å‡½æ•°ï¼Œä¸»è¦æ˜¯ç»“æ„ä½“è¾ƒä¸ºå¤æ‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;08048e94 &amp;lt;fun7&amp;gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e94:	55                   	push   ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e95:	89 e5                	mov    ebp,esp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e97:	83 ec 08             	sub    esp,0x8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e9a:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048e9d:	8b 45 0c             	mov    eax,DWORD PTR [ebp+0xc]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ea0:	85 d2                	test   edx,edx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ea2:	75 0c                	jne    8048eb0 &amp;lt;fun7+0x1c&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ea4:	b8 ff ff ff ff       	mov    eax,0xffffffff
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ea9:	eb 37                	jmp    8048ee2 &amp;lt;fun7+0x4e&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eab:	90                   	nop
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eac:	8d 74 26 00          	lea    esi,[esi+eiz*1+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eb0:	3b 02                	cmp    eax,DWORD PTR [edx]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eb2:	7d 11                	jge    8048ec5 &amp;lt;fun7+0x31&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eb4:	83 c4 f8             	add    esp,0xfffffff8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eb7:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç±»ä¼¼é“¾è¡¨çš„ç»“æ„
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048eb8:	8b 42 04             	mov    eax,DWORD PTR [edx+0x4]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ebb:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ebc:	e8 d3 ff ff ff       	call   8048e94 &amp;lt;fun7&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ec1:	01 c0                	add    eax,eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ec3:	eb 1d                	jmp    8048ee2 &amp;lt;fun7+0x4e&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ec5:	3b 02                	cmp    eax,DWORD PTR [edx]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ec7:	74 17                	je     8048ee0 &amp;lt;fun7+0x4c&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ec9:	83 c4 f8             	add    esp,0xfffffff8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ecc:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; ; ç±»ä¼¼é“¾è¡¨çš„ç»“æ„
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ecd:	8b 42 08             	mov    eax,DWORD PTR [edx+0x8]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ed0:	50                   	push   eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ed1:	e8 be ff ff ff       	call   8048e94 &amp;lt;fun7&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ed6:	01 c0                	add    eax,eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ed8:	40                   	inc    eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ed9:	eb 07                	jmp    8048ee2 &amp;lt;fun7+0x4e&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048edb:	90                   	nop
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048edc:	8d 74 26 00          	lea    esi,[esi+eiz*1+0x0]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ee0:	31 c0                	xor    eax,eax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ee2:	89 ec                	mov    esp,ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ee4:	5d                   	pop    ebp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ee5:	c3                   	ret    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 8048ee6:	89 f6                	mov    esi,esi
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°æœ‰ç±»ä¼¼é“¾è¡¨çš„ç»“æ„ï¼Œä½†æ˜¯å®ƒæ‹¥æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæƒ³è±¡ä¸ºä¸€æ£µæ ‘ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// fun7 è¾“å…¥å‚æ•°ï¼šæŒ‡é’ˆ p å’Œ æ•´å‹ n
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// p å¯ä»¥ç†è§£ä¸ºäºŒå‰æ ‘çš„èŠ‚ç‚¹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; TreeNode {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; value;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; TreeNode *left;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; TreeNode *right;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} TreeNode;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·ä¸€æ¥&lt;code&gt;fun7&lt;/code&gt;é©¬ä¸Šå¯ä»¥å†™æˆ C è¯­è¨€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; fun7(TreeNode *p, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (p == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; -&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (n-&amp;gt;value &amp;lt; p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; * fun7(p-&amp;gt;left, n);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (n == p[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; * fun7(p-&amp;gt;right, n) + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºéœ€è¦é€’å½’å‡½æ•°è¿”å› 7 (å‚æ•°&lt;code&gt;(p, n)&lt;/code&gt;)ï¼Œæ‰€ä»¥å†…ä¸€å±‚åªèƒ½è¿”å› 3 (å‚æ•°&lt;code&gt;(p-&amp;gt;right, n)&lt;/code&gt;)ï¼Œ å†å†…ä¸€å±‚åªèƒ½è¿”å› 1 &lt;code&gt;(p-&amp;gt;right-&amp;gt;right, n)&lt;/code&gt;ï¼Œæœ€é‡Œé¢ä¸€å±‚è¿”å› 0 &lt;code&gt;(p-&amp;gt;right-&amp;gt;right-&amp;gt;right, n)&lt;/code&gt;ã€‚ æ‰€ä»¥ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶&lt;code&gt;p-&amp;gt;righ-&amp;gt;right-&amp;gt;right-&amp;gt;value&lt;/code&gt;åº”è¯¥ä¸&lt;code&gt;n&lt;/code&gt;ç›¸ç­‰&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡ GDB å¾ˆå¿«æ‰¾åˆ°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;#                   value         left          right
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x804b320
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b320 &amp;lt;n1&amp;gt;:     0x00000024    0x0804b314    0x0804b308
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x0804b308
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b308 &amp;lt;n22&amp;gt;:    0x00000032    0x0804b2f0    0x0804b2d8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x0804b2d8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b2d8 &amp;lt;n34&amp;gt;:    0x0000006b    0x0804b2b4    0x0804b278
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(gdb) x/3x 0x0804b278
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0x804b278 &amp;lt;n48&amp;gt;:    0x000003e9    0x00000000    0x00000000
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰€ä»¥åº”è¯¥è¾“å…¥&lt;code&gt;3e9&lt;/code&gt;ä¹Ÿå°±æ˜¯åè¿›åˆ¶&lt;code&gt;1001&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¾“å…¥æ–‡ä»¶&#34;&gt;è¾“å…¥æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å¦‚ä¸‹æ˜¯æœ€åé€šè¿‡æµ‹è¯•çš„è¾“å…¥æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cat input
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Public speaking is very easy.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1 2 6 24 120 720
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0 q 777
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;9 austinpowers
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;o`ekma
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4 2 6 3 1 5
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1001
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å®éªŒæ„Ÿå—&#34;&gt;å®éªŒæ„Ÿå—&lt;/h2&gt;
&lt;p&gt;è¿™å…­å…³åˆ†åˆ«æ¶‰åŠäº†å­—ç¬¦ä¸²å¸¸é‡ã€å¾ªç¯ã€switch-caseï¼ˆè·³è½¬è¡¨ï¼‰ã€é€’å½’ã€æ•°ç»„ã€é“¾è¡¨ç­‰çŸ¥è¯†ï¼Œéš¾åº¦æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆå¤§ï¼Œè€å¿ƒçœ‹æ±‡ç¼–ä»£ç å…¶å®æ˜¯å¾ˆå®¹æ˜“çœ‹æ‡‚çš„ã€‚è€Œéšè—å…³å¡éœ€è¦ç»†å¿ƒæˆ–è€…è¿æ°”å‘ç°ï¼Œä½†æ˜¯è§£å†³å®ƒå¹¶ä¸æ˜¯é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;åš Lab æ—¶æ²¡æœ‰åŠ¨æ€è°ƒè¯•è¿™ä¸ªç¨‹åºï¼Œæ„Ÿè§‰ä¹Ÿæ²¡æœ‰åŠ¨æ€è°ƒè¯•çš„å¿…è¦ï¼Œåªè¦çœ‹åˆ°äº†â€œé­”æ³•â€åœ°å€å°±å¯ä»¥ç›´æ¥ GDB æŸ¥çœ‹å®ƒã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ç¨å¾®æ·±å…¥VLA</title>
      <link>https://vaaandark.top/posts/dive-in-vla/</link>
      <pubDate>Thu, 20 Oct 2022 10:50:10 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/dive-in-vla/</guid>
      <description>&lt;p&gt;æœ€è¿‘åœ¨å­¦ä¹ æ±‡ç¼–è¯­è¨€ï¼Œå’Œæœ‹å‹èŠå¤©æ—¶èŠåˆ°äº† C è¯­è¨€ä¸­çš„å˜é•¿æ•°ç»„ï¼Œæƒ³çŸ¥é“åœ¨æ±‡ç¼–åæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;å˜é•¿æ•°ç»„variable-length-array&#34;&gt;å˜é•¿æ•°ç»„(Variable-length array)&lt;/h2&gt;
&lt;p&gt;å¯å˜é•¿æ•°ç»„æ˜¯æŒ‡åœ¨è®¡ç®—æœºç¨‹åºè®¾è®¡ä¸­ï¼Œæ•°ç»„å¯¹è±¡çš„é•¿åº¦åœ¨è¿è¡Œæ—¶ï¼ˆè€Œä¸æ˜¯ç¼–è¯‘æ—¶ï¼‰ç¡®å®šã€‚&lt;/p&gt;
&lt;p&gt;C/C++çš„çµæ´»æ•°ç»„ç±»å‹ï¼ˆåˆç§°æŸ”æ€§æ•°ç»„æˆå‘˜ï¼‰æ˜¯å¦å¤–ä¸€ä¸ªè¯­è¨€ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åæ±‡ç¼–-vla&#34;&gt;åæ±‡ç¼– VLA&lt;/h2&gt;
&lt;p&gt;C è¯­è¨€ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; a[n];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åæ±‡ç¼–ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-asm&#34; data-lang=&#34;asm&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mov    eax,DWORD PTR [ebp-0x14] &lt;span style=&#34;color:#007f7f&#34;&gt;; eax &amp;lt;- [n]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;lea    edx,[eax-0x1]            &lt;span style=&#34;color:#007f7f&#34;&gt;; edx &amp;lt;- [n - 1]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;mov    DWORD PTR [ebp-0xc],edx  &lt;span style=&#34;color:#007f7f&#34;&gt;; [n - 8] &amp;lt;- edx
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;lea    edx,[eax*&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#f00&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x0&lt;/span&gt;]          &lt;span style=&#34;color:#007f7f&#34;&gt;; edx &amp;lt;- [n * 4 + 0] VLA çš„é•¿åº¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;mov    eax,&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x10&lt;/span&gt;                 &lt;span style=&#34;color:#007f7f&#34;&gt;; eax &amp;lt;- 16
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;sub    eax,&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x1&lt;/span&gt;                  &lt;span style=&#34;color:#007f7f&#34;&gt;; eax -= 1 =&amp;gt; eax = 15
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;add    eax,edx                  &lt;span style=&#34;color:#007f7f&#34;&gt;; eax += edx =&amp;gt; eax = 15 + nbytes
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;mov    ecx,&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x10&lt;/span&gt;                 &lt;span style=&#34;color:#007f7f&#34;&gt;; ecx &amp;lt;- 16
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;mov    edx,&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x0&lt;/span&gt;                  &lt;span style=&#34;color:#007f7f&#34;&gt;; edx &amp;lt;- 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;div    ecx                      &lt;span style=&#34;color:#007f7f&#34;&gt;; eax /= 16
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;imul   eax,eax,&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x10&lt;/span&gt;             &lt;span style=&#34;color:#007f7f&#34;&gt;; eax *= 16
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;                                &lt;span style=&#34;color:#007f7f&#34;&gt;; (15 + nbytes) / 16 * 16 ç”¨äºå¯¹é½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;                                &lt;span style=&#34;color:#007f7f&#34;&gt;; å› æ­¤ä¸Šé¢å‡ æ¡æŒ‡ä»¤æ²¡æœ‰æŠµæ¶ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;sub    esp,eax                  &lt;span style=&#34;color:#007f7f&#34;&gt;; esp -= eax åœ¨æ ˆä¸­ä¸º VLA é¢„ç•™ç©ºé—´
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;mov    eax,esp                  &lt;span style=&#34;color:#007f7f&#34;&gt;; eax &amp;lt;- esp VLA çš„åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;add    eax,&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x3&lt;/span&gt;                  &lt;span style=&#34;color:#007f7f&#34;&gt;; eax += 3 =&amp;gt; eax = 18 + nbytes
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;shr    eax,&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x2&lt;/span&gt;                  &lt;span style=&#34;color:#007f7f&#34;&gt;; eax &amp;gt;&amp;gt;= 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;shl    eax,&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x2&lt;/span&gt;                  &lt;span style=&#34;color:#007f7f&#34;&gt;; eax &amp;lt;&amp;lt;= 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;                                &lt;span style=&#34;color:#007f7f&#34;&gt;; (eax + 3) / 2 * 2 ç”¨äºå¯¹é½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;                                &lt;span style=&#34;color:#007f7f&#34;&gt;; å› æ­¤ä¸Šé¢å‡ æ¡æŒ‡ä»¤æ²¡æœ‰æŠµæ¶ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;mov    DWORD PTR [ebp-0x10],eax &lt;span style=&#34;color:#007f7f&#34;&gt;; [n + 4] &amp;lt;- eax ç»™ a èµ‹ä¸Š VLA çš„åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤åœ¨åˆ›å»º VLA æ—¶å…ˆåœ¨æ ˆä¸Šåˆ†é…å†…å­˜åŒæ—¶è¦æ³¨æ„å¯¹é½ï¼Œå†å°†åˆ†é…å¥½çš„å†…å­˜åœ°å€èµ‹å€¼ç»™æ•°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ç›´æ¥åˆ›å»ºåœ¨æ ˆä¸Šçš„å®šé•¿æ•°ç»„ä¸åŒï¼Œå˜é•¿æ•°ç»„è®¿é—®å…ƒç´ æ—¶éœ€è¦ä¸¤æ¬¡å¯»å€ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>80X86æ±‡ç¼–è¯­è¨€å­¦ä¹ </title>
      <link>https://vaaandark.top/posts/80x86-learning/</link>
      <pubDate>Tue, 27 Sep 2022 14:47:57 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/80x86-learning/</guid>
      <description>&lt;p&gt;æ±‡ç¼–è¯­è¨€å­¦ä¹ ç¬”è®°&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;é¢„å¤‡çŸ¥è¯†&#34;&gt;é¢„å¤‡çŸ¥è¯†&lt;/h2&gt;
&lt;h3 id=&#34;intel-æœºå™¨&#34;&gt;Intel æœºå™¨&lt;/h3&gt;
&lt;h4 id=&#34;å¾®å‹è®¡ç®—æœºçš„æ„æˆ&#34;&gt;å¾®å‹è®¡ç®—æœºçš„æ„æˆ&lt;/h4&gt;
&lt;p&gt;&lt;img alt=&#34;å¾®å‹è®¡ç®—æœºçš„æ„æˆ&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/asm-intel-x86.png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;80x86-å¾®å¤„ç†å™¨çš„åŸºæœ¬ç»“æ„&#34;&gt;80X86 å¾®å¤„ç†å™¨çš„åŸºæœ¬ç»“æ„&lt;/h4&gt;
&lt;p&gt;&lt;img alt=&#34;80X86å¾®å¤„ç†å™¨çš„åŸºæœ¬ç»“æ„&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/asm-80x86.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ•°æ®å¯„å­˜å™¨ç»„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;æ•°æ®å¯„å­˜å™¨ç»„&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/asm-data-registers.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ®µå¯„å­˜å™¨ç»„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;æ®µå¯„å­˜å™¨ç»„&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/asm-seg-registers.png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;80x86-çš„ä¸‰ç§å·¥ä½œæ–¹å¼&#34;&gt;80X86 çš„ä¸‰ç§å·¥ä½œæ–¹å¼&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;å®åœ°å€æ¨¡å¼&lt;/li&gt;
&lt;li&gt;ä¿æŠ¤æ¨¡å¼&lt;/li&gt;
&lt;li&gt;è™šæ‹Ÿ 8086 æ–¹å¼ï¼ˆV86æ–¹å¼ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;æ•°æ®åœ¨è®¡ç®—æœºå†…çš„è¡¨ç¤ºå½¢å¼&#34;&gt;æ•°æ®åœ¨è®¡ç®—æœºå†…çš„è¡¨ç¤ºå½¢å¼&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰ç¬¦å·æ•°ã€æ— ç¬¦å·æ•°ã€æµ®ç‚¹æ•°ç­‰ç›¸å…³çŸ¥è¯†è§ CSAPP&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;bcd-ç &#34;&gt;BCD ç &lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨äºŒè¿›åˆ¶æ•°è¡¨ç¤ºåè¿›åˆ¶æ•°ï¼Œå³ä½¿ç”¨ 4 ä½äºŒè¿›åˆ¶æ•°è¡¨ç¤ºä¸€ä½ 10 è¿›åˆ¶æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ 8086 ä¸­æœ‰ä¸¤ç§å­˜æ”¾ BCD ç çš„æ–¹å¼ï¼Œå‹ç¼©å’Œéå‹ç¼©ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ ‡å¿—å¯„å­˜å™¨&#34;&gt;æ ‡å¿—å¯„å­˜å™¨&lt;/h3&gt;
&lt;p&gt;&lt;img alt=&#34;æ ‡å¿—å¯„å­˜å™¨&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/asm-flag-reg.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸»è¦éœ€è¦æŒæ¡ SF ZF OF CF AF PF&lt;/p&gt;
&lt;h2 id=&#34;å¯»å€æ–¹å¼&#34;&gt;å¯»å€æ–¹å¼&lt;/h2&gt;
&lt;h3 id=&#34;å¯„å­˜å™¨å¯»å€&#34;&gt;å¯„å­˜å™¨å¯»å€&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨æ ¼å¼ï¼š&lt;code&gt;R&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;inc bx&lt;/code&gt; æ“ä½œæ•°åœ°å€ä¸ºå¯„å­˜å™¨ BX ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯„å­˜å™¨é—´æ¥å¯»å€&#34;&gt;å¯„å­˜å™¨é—´æ¥å¯»å€&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨æ ¼å¼ï¼š&lt;code&gt;[R]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯„å­˜å™¨ R çš„å†…å®¹ä¸ºæ“ä½œæ•°çš„åç§»åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥æŒ‡æ˜æ“ä½œæ•°æ‰€åœ¨çš„æ®µï¼Œå¦‚&lt;code&gt;ss:[R]&lt;/code&gt;ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šæ®µï¼Œå½“ R é€‰ç”¨ BP, EBP, ESP ï¼Œåˆ™é»˜è®¤åœ¨å †æ ˆæ®µä¸­ï¼Œå¦‚æœé€‰ç”¨å…¶ä»–å¯„å­˜å™¨åˆ™é»˜è®¤åœ¨ DS æ‰€æŒ‡ç¤ºçš„æ®µä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mov ax, [si]&lt;/code&gt; å°†æ•°æ®æ®µä¸Šåç§»&lt;code&gt;[si]&lt;/code&gt;çš„æ•°æ®ä¼ é€åˆ° AX ä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å˜å€å¯»å€&#34;&gt;å˜å€å¯»å€&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨æ ¼å¼ï¼š&lt;code&gt;[R * F + V]&lt;/code&gt;, &lt;code&gt;[R * F] + V&lt;/code&gt;, &lt;code&gt;V[R * F]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åŠŸèƒ½ï¼šå¯„å­˜å™¨ R çš„å†…å®¹ä¹˜ä»¥æŒ‡å®šçš„æ¯”ä¾‹å› å­ F ï¼ˆå¯ä»¥ä¸º 1, 2, 4, 8ï¼‰ååŠ ä¸Šç»™å®šçš„ä½ç§»é‡ V ä½œä¸ºæ“ä½œæ•°çš„åç§»åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;å½“ R ä¸º 16 ä¸ºå¯„å­˜å™¨æˆ– ESP æ—¶ï¼ŒF åªèƒ½ä¸º 1 å¹¶çœç•¥ä¸å†™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mov al, [ebx * 2] + 5&lt;/code&gt; ç”±äºä½¿ç”¨çš„å˜å€å¯„å­˜å™¨æ˜¯ EBX ï¼Œæ•…é»˜è®¤æ®µå¯„å­˜å™¨ DS ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŸºå€åŠ å˜å€å¯»å€&#34;&gt;åŸºå€åŠ å˜å€å¯»å€&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨æ ¼å¼ï¼š&lt;code&gt;[BR + IR * F + V]&lt;/code&gt;, &lt;code&gt;V[BR][IR * F]&lt;/code&gt;, &lt;code&gt;V[BR + IR * F]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åŠŸèƒ½ï¼šå°†å˜å€å¯„å­˜å™¨ IR çš„å†…å®¹ä¹˜ä»¥æ¯”ä¾‹å› å­ F ï¼Œä¸åŸºå€å¯„å­˜å™¨ BR çš„å†…å®¹å’Œä½ç§»é‡ V ç›¸åŠ ï¼Œä½œä¸ºæ“ä½œæ•°çš„åç§»åœ°å€ EA ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mov ax, 8[bx][si]&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç«‹å³å¯»å€&#34;&gt;ç«‹å³å¯»å€&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨æ ¼å¼ï¼š&lt;code&gt;n&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åŠŸèƒ½ï¼šæŒ‡å®šæŒ‡ä»¤æœ€åä¸€éƒ¨åˆ†å•å…ƒä¸­çš„å†…å®¹ä¸ºæ“ä½œæ•°ï¼Œå³åœ¨å½“å‰æ‰§è¡Œåˆ°çš„æœºå™¨ä»£ç éƒ¨åˆ†æ‰¾åˆ°æ“ä½œæ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mov word ptr [si], 12h&lt;/code&gt; WORD PTR è¯´æ˜æ“ä½œæ•°çš„ç±»å‹ä¸ºå­—ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç›´æ¥å¯»å€&#34;&gt;ç›´æ¥å¯»å€&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨æ ¼å¼ï¼š&lt;code&gt;æ®µå¯„å­˜å™¨å: [n]&lt;/code&gt;, &lt;code&gt;å˜é‡&lt;/code&gt;, &lt;code&gt;å˜é‡ + å¸¸é‡&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¸€äº›é—®é¢˜&#34;&gt;ä¸€äº›é—®é¢˜&lt;/h3&gt;
&lt;p&gt;æœ‰ä¸€äº›æŒ‡ä»¤æ˜¾å¼åœ°æŒ‡å®šæ“ä½œæ•°ï¼Œå¦ä¸€äº›éšå«åœ°æŒ‡å®šæ“ä½œæ•°ã€‚å¦‚&lt;code&gt;CBW&lt;/code&gt;å°† AL å¯„å­˜å™¨ä¸­çš„ç¬¦å·ä½æ‰©å±•åˆ° AH ä¸­ï¼Œåˆå¦‚&lt;code&gt;push bufa&lt;/code&gt;å‹å…¥æ ˆé¡¶ï¼Œéšå«äº†ç›®çš„æ“ä½œæ•°ï¼Œæ˜¯ä½¿ç”¨ SP/ESP çš„å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ“ä½œæ•°æŒ‡ä»¤çš„æºæ“ä½œæ•°å’Œç›®çš„æ“ä½œæ•°çš„å¯»å€æ–¹å¼å¿…é¡»æ»¡è¶³ä»¥ä¸‹äº”ç§ç»„åˆä¹‹ä¸€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯„å­˜å™¨å¯¹å¯„å­˜å™¨ï¼›&lt;/li&gt;
&lt;li&gt;å¯„å­˜å™¨å¯¹å­˜å‚¨å™¨ï¼›&lt;/li&gt;
&lt;li&gt;å­˜å‚¨å™¨å¯¹å¯„å­˜å™¨ï¼›&lt;/li&gt;
&lt;li&gt;ç«‹å³æ–¹å¼å¯¹å¯„å­˜å™¨ï¼Œç«‹å³æ–¹å¼åªèƒ½ç”¨äºæºæ“ä½œæ•°ï¼›&lt;/li&gt;
&lt;li&gt;ç«‹å³æ–¹å¼å¯¹å­˜å‚¨å™¨ï¼Œç«‹å³æ–¹å¼åªèƒ½ç”¨äºæºæ“ä½œæ•°ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æºæ“ä½œæ•°å’Œç›®çš„æ“ä½œæ•°ä¸èƒ½åŒæ—¶ç”¨å­˜å‚¨å™¨æ–¹å¼è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸å«å˜é‡çš„å­˜å‚¨å™¨æ–¹å¼æ‰€è¡¨ç¤ºçš„æ“ä½œæ•°ç±»å‹æ˜¯ä¸æ˜ç¡®çš„ï¼Œç«‹å³æ•°æ˜¯æ²¡æœ‰ç±»å‹çš„ã€‚å¦‚æœæŒ‡ä»¤è¯­å¥ä¸­æ²¡æœ‰ä¸€ä¸ªæ“ä½œæ•°çš„ç±»å‹æ˜¯æ˜ç¡®çš„ï¼Œåˆ™å¿…é¡»ä½¿ç”¨å±æ€§å®šä¹‰ç®—ç¬¦ PTRï¼ˆå­—èŠ‚ç±»å‹ BYTE PTR ï¼Œå­—ç±»å‹ WORD PTR ï¼ŒåŒå­—ç±»å‹ DWORD PTRï¼‰&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å‡ ç§æƒ…å†µä½¿ç”¨çš„ç¼ºçœæ®µä¸å—æ®µè¶…è¶Šå‰ç¼€å½±å“ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å–æŒ‡ä»¤ï¼ˆåŒ…æ‹¬ç«‹å³æ•°ï¼‰æ—¶åªèƒ½ä½¿ç”¨ CS æ®µï¼›&lt;/li&gt;
&lt;li&gt;å‹æ ˆæ—¶ç›®çš„åœ°å€å’Œå‡ºæ ˆæ—¶æºåœ°å€åªèƒ½ä½¿ç”¨ SS æ®µï¼›&lt;/li&gt;
&lt;li&gt;ä¸²æ“ä½œæŒ‡ä»¤ä¸­çš„ç›®çš„ä¸²åªä½¿ç”¨ ES æ®µï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å®æ±‡ç¼–è¯­è¨€&#34;&gt;å®æ±‡ç¼–è¯­è¨€&lt;/h2&gt;
</description>
    </item>
    
    <item>
      <title>åƒåœ¾å›æ”¶</title>
      <link>https://vaaandark.top/posts/gc/</link>
      <pubDate>Sat, 17 Sep 2022 11:27:19 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/gc/</guid>
      <description>&lt;p&gt;ä¹‹å‰å­¦ä¹ äº† Lua çš„ Table å’Œåç¨‹ï¼Œå¯¹ Lua ä¸­å¦ä¸€ä¸ªé‡è¦æ¨¡å— GC è¿˜æœ‰å¾ˆå¤šç–‘é—®ï¼Œè¿™æ¬¡å°±æ¥å­¦ä¹ ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;gc-ç®€ä»‹ä¸ç­–ç•¥åˆ†ç±»&#34;&gt;GC ç®€ä»‹ä¸ç­–ç•¥åˆ†ç±»&lt;/h2&gt;
&lt;p&gt;åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œåƒåœ¾æ”¶é›†(GC)æ˜¯ä¸€ç§è‡ªåŠ¨å†…å­˜ç®¡ç†å½¢å¼ã€‚åƒåœ¾æ”¶é›†å™¨å°è¯•å›æ”¶ç¨‹åºåˆ†é…ä½†ä¸å†å¼•ç”¨çš„å†…å­˜ï¼›è¿™æ ·çš„å†…å­˜è¢«ç§°ä¸ºåƒåœ¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¿½è¸ªtracing&#34;&gt;è¿½è¸ª(Tracing)&lt;/h3&gt;
&lt;p&gt;Tracing çš„ç­–ç•¥ç®€å•è®²å°±æ˜¯ä½¿ç”¨ä¸€äº›æ ¹å¯¹è±¡æ¥éå†æ‰€æœ‰çš„å¼•ç”¨ï¼Œå¯ä»¥è®¿é—®åˆ°çš„å°±ä¸æ˜¯åƒåœ¾ï¼Œä¸èƒ½è®¿é—®åˆ°çš„å°±æ˜¯éœ€è¦å›æ”¶çš„åƒåœ¾ã€‚è™½ç„¶è¿™ä¸ªè¯´èµ·æ¥å’Œå®ç°èµ·æ¥å¾ˆç®€å•ï¼Œä½†æ˜¯æƒ³è¦ä½¿å…¶æœ‰è¾ƒå¥½çš„æ€§èƒ½å¹¶ä¸æ˜¯ä¸€ä»¶å¾ˆå®¹æ˜“çš„äº‹æƒ…ã€‚Tracing æœ‰å¾ˆå¤šéœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œä¾‹å¦‚æ”¶é›†çš„å‘¨æœŸ(æ­¥è¿› Pace)æ˜¯ä»€ä¹ˆï¼Œæ˜¯æŒ‰ç…§æ—¶é—´ç‰‡è¿˜æ˜¯æŒ‰ç…§å·²ç»åˆ†é…è¿‡çš„å†…å­˜ï¼Œæ˜¯å¦ä¼šå‡ºç°ä¸ºäº†æ”¶é›†åƒåœ¾ç¨‹åºæ‰§è¡Œå‡ºç°æ˜æ˜¾å¡æ­»ç°è±¡ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åç”¨åˆ°çš„ Lisp å’Œ Lua çš„ä¾‹å­éƒ½ä»¥ Tracing ç­–ç•¥ä¸ºä¸»ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¼•ç”¨è®¡æ•°reference-counting&#34;&gt;å¼•ç”¨è®¡æ•°(Reference counting)&lt;/h3&gt;
&lt;p&gt;å¼•ç”¨è®¡æ•°åƒåœ¾æ”¶é›†æ˜¯æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå¯¹å®ƒçš„å¼•ç”¨æ•°çš„è®¡æ•°ã€‚åƒåœ¾é€šè¿‡å¼•ç”¨è®¡æ•°ä¸ºé›¶æ¥æ ‡è¯†ã€‚å¯¹è±¡çš„å¼•ç”¨è®¡æ•°åœ¨åˆ›å»ºå¯¹å®ƒçš„å¼•ç”¨æ—¶å¢åŠ ï¼Œåœ¨å¼•ç”¨è¢«é”€æ¯æ—¶å‡å°‘ã€‚å½“è®¡æ•°è¾¾åˆ°é›¶æ—¶ï¼Œå¯¹è±¡çš„å†…å­˜è¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å¾ªç¯å¼•ç”¨&#34;&gt;å¾ªç¯å¼•ç”¨&lt;/h4&gt;
&lt;p&gt;å¦‚æœæœ‰ä¸¤ä¸ªå¯¹è±¡ç›¸äº’å¼•ç”¨ï¼Œå°±ä¼šå¯¼è‡´å®ƒä»¬çš„å¼•ç”¨è®¡æ•°æ°¸è¿œå¤§äºç­‰äº 1 ï¼Œå®ƒä»¬æ°¸è¿œä¸ä¼šè¢«å›æ”¶ã€‚å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆã€‚ä¸€ç§æ¯”è¾ƒç›´è§‚ï¼Œç›´æ¥æ£€æµ‹æ˜¯å¦å‡ºç°å¾ªç¯ï¼Œcpython å°±ä½¿ç”¨çš„è¿™ç§æ–¹æ³•ï¼›å¦ä¸€ç§å°±æ˜¯å¼•å…¥å¼±å¼•ç”¨çš„æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;å¼±å¼•ç”¨ä¸ä¼šå¢åŠ å¼•ç”¨è®¡æ•°ï¼Œè€Œä¸”æŒ‡å‘çš„å¯¹è±¡å¯èƒ½æ˜¯å·²ç»è¢«å›æ”¶çš„ï¼Œå› æ­¤å¯ä»¥ç®€å•åœ°æ£€æµ‹å‡ºæ˜¯å¦å¤±æ•ˆï¼Œè€Œä¸æ˜¯ä¿æŒå¼•ç”¨æ‚¬å‚ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é¢å¤–ç©ºé—´å¼€é”€&#34;&gt;é¢å¤–ç©ºé—´å¼€é”€&lt;/h4&gt;
&lt;p&gt;æ˜æ˜¾åœ°ï¼Œå¦‚æœä½¿ç”¨å¼•ç”¨è®¡æ•°çš„ç­–ç•¥å°±éœ€è¦é¢å¤–çš„ç©ºé—´æ¥å­˜å‚¨è®¡æ•°ã€‚æœ‰çš„æ˜¯å­˜åœ¨å¯¹è±¡ä¸­ï¼Œæœ‰çš„æ˜¯å­˜åœ¨ä¸€ä¸ªè¡¨ä¹‹ä¸­ã€‚åœ¨ä¸€äº›è¯­è¨€ä¾‹å¦‚ objective-c ä¸­ï¼Œå®ƒä»¬å°†å¼•ç”¨è®¡æ•°å­˜åœ¨æŒ‡é’ˆåœ°å€æœªä½¿ç”¨çš„ä½å½“ä¸­ï¼ˆæˆ‘è®¤ä¸ºè¿™å¯¹ä¸åŒå¤„ç†å™¨é—´å¯ç§»æ¤æ€§æœ‰å½±å“ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é¢å¤–æ—¶é—´å¼€é”€&#34;&gt;é¢å¤–æ—¶é—´å¼€é”€&lt;/h4&gt;
&lt;p&gt;ä¾‹å¦‚å¦‚æœä½¿ç”¨&lt;code&gt;for item in something&lt;/code&gt;çš„æ–¹æ³•éå†ï¼Œåœ¨æ¯ä¸ªå¾ªç¯å¼€å§‹éƒ½æœ‰&lt;code&gt;rc++&lt;/code&gt;æ¯ä¸ªç»“å°¾éƒ½æœ‰&lt;code&gt;rc--&lt;/code&gt;ï¼Œä¼˜ç§€çš„ GC åº”è¯¥æŠŠè¿™ä¸ªæ¶ˆé™¤æ‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å¹¶è¡Œ&#34;&gt;å¹¶è¡Œ&lt;/h4&gt;
&lt;p&gt;å¦‚æœéœ€è¦ç¼–å†™å¹¶è¡Œä»£ç åˆ™éœ€è®© rc çš„æ“ä½œå…·æœ‰åŸå­æ€§ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹æ˜¯å®ƒä»¬ä¸å¯ä»¥æ˜¯å…¨å±€å˜é‡äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;è‡ªåŠ¨å¼•ç”¨è®¡æ•°automatic-reference-counting&#34;&gt;è‡ªåŠ¨å¼•ç”¨è®¡æ•°(Automatic Reference counting)&lt;/h4&gt;
&lt;p&gt;è‡ªåŠ¨å¼•ç”¨è®¡æ•°æ— éœ€è¿è¡Œæ—¶ï¼Œä¼šåœ¨ç¼–è¯‘é˜¶æ®µå¤„ç†å¼•ç”¨è®¡æ•°å¹¶å®ç°å†…å­˜ç®¡ç†ï¼Œä½†æ˜¯éš¾ä»¥å¤„ç†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚ç¥å¥‡çš„ Rust è¾ƒå¥½åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæ–¹æ³•è¿˜æ˜¯ä½¿ç”¨å¼±å¼•ç”¨ï¼Œå¯ä»¥çœ‹ &lt;a href=&#34;https://doc.rust-lang.org/std/sync/struct.Arc.html&#34;&gt;Arc çš„å®ç°&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Breaking cycles with Weak&lt;/p&gt;
&lt;p&gt;The downgrade method can be used to create a non-owning Weak pointer. A Weak pointer can be upgraded to an Arc, but this will return None if the value stored in the allocation has already been dropped. In other words, Weak pointers do not keep the value inside the allocation alive; however, they do keep the allocation (the backing store for the value) alive.&lt;/p&gt;
&lt;p&gt;A cycle between Arc pointers will never be deallocated. For this reason, Weak is used to break cycles. For example, a tree could have strong Arc pointers from parent nodes to children, and Weak pointers from children back to their parents.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸è¿‡ï¼Œæ— è®ºæ˜¯æœ´ç´ çš„å¼•ç”¨è®¡æ•°è¿˜æ˜¯è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼Œä¸€æ—¦å¼•å…¥å¼±å¼•ç”¨å°±å¯èƒ½å¢åŠ ä»£ç ç¼–å†™è€…çš„å¿ƒæ™ºè´Ÿæ‹…å’Œç²¾ç¥å†…è€—ï¼Œè®©åƒåœ¾å›æ”¶æ²¡æœ‰é‚£ä¹ˆçœå¿ƒçœåŠ›ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€ƒé€¸åˆ†æescape-analysis&#34;&gt;é€ƒé€¸åˆ†æ(Escape analysis)&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ï¼Œå®ƒçš„åŸç†å°±æ˜¯å°†ä¸€äº›ä¸å¿…è¦çš„å †åˆ†é…å˜æˆæ ˆåˆ†é…ï¼Œä¾‹å¦‚åœ¨ä¸€ä¸ªå‡½æ•°ä¹‹ä¸­ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä¸ä¼šè¢«ä¼ é€’åˆ°å¤–éƒ¨ï¼ŒEscape analysis å°±å¯ä»¥å°†å®ƒä»å †åˆ†é…å˜ä¸ºæ ˆåˆ†é…ä»è€Œå‡å°‘æ‰€éœ€è¦çš„åƒåœ¾æ”¶é›†é‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ulisp-gc&#34;&gt;ulisp GC&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ç§å¾ˆ naive çš„ GC ï¼Œé‡‡ç”¨çš„æ˜¯æœ€ä¸ºæœ´ç´ çš„ mark-and-sweep ä¸­çš„åŒè‰²æ ‡è®°æ³•ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè°ƒç”¨ markobject() å‡½æ•°å¯¹æ‰€æœ‰è¿˜èƒ½å¤Ÿè®¿é—®çš„å¯¹è±¡è¿›è¡Œæ ‡è®°&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ulisp æ˜¯ä¸€ç§å¹¿æ³›ç”¨äºåµŒå…¥å¼çš„ lisp æ–¹è¨€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; markobject (object *obj) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;MARK:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (obj == &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;NULL&lt;/span&gt;) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (marked(obj)) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  object* arg = car(obj);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; type = obj-&amp;gt;type;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  mark(obj);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (type &amp;gt;= PAIR || type == ZERO) { &lt;span style=&#34;color:#007f7f&#34;&gt;// cons
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    markobject(arg);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    obj = cdr(obj);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;goto&lt;/span&gt; MARK;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„ cons æ˜¯ä¸€ç§å¹¿ä¹‰è¡¨ï¼Œç”±ä¸¤ä¸ªæŒ‡é’ˆç»„æˆï¼Œcar æå–ç¬¬ä¸€ä¸ªæŒ‡é’ˆï¼Œcdr æå–ç¬¬äºŒä¸ªæŒ‡é’ˆã€‚ä¸Šé¢è¿™ä¸ªå‡½æ•°ç”¨äº†ä¸€ç§ä¸å¤Ÿç¾è§‚çš„æ–¹å¼æ¶ˆé™¤äº†éƒ¨åˆ†é€’å½’ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„ mark(x) å®åˆ©ç”¨å†…å­˜å¯¹é½ä½¿ç”¨äº†ä¸€ä¸ªæŠ€å·§ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define mark(x)            (car(x) = (object *)(((unsigned int)(car(x))) | 0x0001))
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› ä¸ºå†…å­˜å¯¹é½åˆ°å¶æ•°ä½ï¼Œæ‰€ä»¥æœ€ä½ä½ä¸º 0 ï¼Œå°† car(x) çš„æœ€ä½ä½ç½®ä¸º 1 çš„æ ‡è®°æ“ä½œæ˜¯åˆç†çš„ï¼Œè€Œä¸”èŠ‚çº¦äº†å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;sweep() å‡½æ•°åˆ™ç”¨äºæ¸…ç†å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; sweep () {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Freelist = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Freespace = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i=WORKSPACESIZE-&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; i&amp;gt;=&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i--) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    object *obj = &amp;amp;Workspace[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (!marked(obj)) myfree(obj); &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; unmark(obj);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;inline&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; myfree (object *obj) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  car(obj) = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  cdr(obj) = Freelist;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Freelist = obj;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Freespace++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„æ¸…ç†æ²¡æœ‰ä½¿ç”¨ free ç­‰åº“å‡½æ•°æ˜¯å› ä¸º ulisp ä¸€èˆ¬ç”¨äºåµŒå…¥å¼ç¯å¢ƒä¸­ï¼Œå®ƒçš„å†…å­˜ç®¡ç†å°±æ˜¯ç®¡ç†ä¸€ä¸ªä¿å­˜å¯¹è±¡åœ°å€çš„é™æ€å¤§æ•°ç»„ï¼Œå…¨å±€å˜é‡ Freelist æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªä¸ºç©ºçš„åœ°æ–¹ï¼ŒFreespace è¡¨ç¤ºè¿˜å‰©ä½™å¤šå°‘ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;ulisp çš„ gc å‘¨æœŸè®¾ç½®ä¹Ÿæ¯”è¾ƒæœ´ç´ ï¼Œæ¯æ¬¡ eval è¢«è°ƒç”¨æ—¶æ£€æµ‹ä¸€ä¸‹å‰©ä½™å†…å­˜ç©ºé—´ï¼Œå¦‚æœå°äº 20 ä¸ªå¯¹è±¡çš„å¤§å°å°±åƒåœ¾æ”¶é›†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (Freespace &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;20&lt;/span&gt;) gc(form, env);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;lua-gc&#34;&gt;Lua GC&lt;/h2&gt;
&lt;p&gt;Lua GC ä¹Ÿé‡‡ç”¨äº† mark-and-sweep çš„ç­–ç•¥ï¼Œä½†æ˜¯å®ƒä½¿ç”¨çš„ä¸å†æ˜¯åŒè‰²æ ‡è®°ï¼Œè€Œæ˜¯æ›´åŠ ä¼˜ç§€çš„ä¸‰è‰²æ ‡è®°æ³•ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lua 5.0 ä¹‹å‰ä½¿ç”¨çš„æ˜¯åŒè‰²æ ‡è®°æ³•ï¼Œå’Œ ulisp å¤§åŒå°å¼‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;lua-gc-è§„åˆ™&#34;&gt;Lua GC è§„åˆ™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Lua ä¸­æ‰€æœ‰å¯¹è±¡éœ€è¦åƒåœ¾å›æ”¶ï¼ŒåŒ…æ‹¬äº† table ã€å‡½æ•°ã€åç¨‹ã€æ¨¡ç»„ã€‚&lt;/li&gt;
&lt;li&gt;åªæœ‰é€šè¿‡æ ¹é›†(root set)å¯ä»¥è®¿é—®åˆ°çš„å¯¹è±¡æ‰ä¼šè¢«ä¿å­˜ã€‚
&lt;ul&gt;
&lt;li&gt;root set ::= registry + shared metatables&lt;/li&gt;
&lt;li&gt;registry ::= global table(_G) + main thread + package.loaded&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Lua åƒåœ¾æ”¶é›†è°ƒç”¨çš„æ˜¯æ ‡å‡†åº“å†…å­˜åˆ†é…å‡½æ•°ï¼ˆå…¶å®æ•´ä¸ª Lua éƒ½åªç”¨äº†æ ‡å‡†åº“ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰çš„å¯¹è±¡éƒ½è¢«ä¸€ä¸ªé“¾è¡¨å‚¨å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;lua-gc-pace&#34;&gt;Lua GC Pace&lt;/h3&gt;
&lt;p&gt;å¦‚æœ GC ä»ä¸è¿è¡Œå°±æ²¡æœ‰æ¶ˆè€—é¢å¤–çš„ CPU å‘¨æœŸï¼Œä½†æ˜¯ä¼šæµªè´¹å¤§é‡å†…å­˜ï¼›å¦‚æœ GC ä¸€ç›´è¿è¡Œå°±ä¸ä¼šæµªè´¹é¢å¤–çš„å†…å­˜ï¼Œä½†æ˜¯ä¼šæ¶ˆè€—å¤§é‡ CPU å‘¨æœŸã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ GC è¿è¡Œé—´éš”ã€‚&lt;/p&gt;
&lt;p&gt;Lua 5.0 é‡‡å–çš„æ–¹æ³•æ˜¯å½“æ­¤æ¬¡å†…å­˜åˆ†é…è¾¾åˆ°ä¸Šæ¬¡å†…å­˜åˆ†é…çš„ä¸¤å€æ—¶è°ƒç”¨ GC ã€‚ä½†è¿™å°±é€ æˆäº†ä¸€ä¸ªé—®é¢˜ï¼Œè™šæ‹Ÿæœºä¼šåœä¸‹æ¥æ”¶é›†å®Œåƒåœ¾å†ç»§ç»­æ‰§è¡Œ(stop the world)ï¼Œè¿™ä¹Ÿå°±æ˜¯ Lua 5.0 åŠä¹‹å‰éƒ½åªèƒ½ä½œä¸ºå°å°èƒ¶æ°´è¯­è¨€ä½¿ç”¨çš„åŸå› ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¢é‡æ”¶é›†&#34;&gt;å¢é‡æ”¶é›†&lt;/h3&gt;
&lt;p&gt;åœ¨ 5.1 ç‰ˆæœ¬ä¸­ï¼ŒLua æœ‰äº†ä¸€ä¸ªå¢é‡æ”¶é›†å™¨ï¼Œå°†æ”¶é›†å™¨çš„æ‰§è¡Œä¸ä¸»ç¨‹åºäº¤é”™æ‰§è¡Œã€‚è¿™ä¹Ÿå¯¼è‡´ GC å†…ä¿å­˜çš„ä¸å†æ˜¯ä¸€ä¸ªå¯ä»¥ç›´æ¥åˆ†æçš„é™æ€æ•°æ®ï¼Œå¿…é¡»å¼•å…¥ä¸‰è‰²æ ‡è®°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸‰è‰²æ ‡è®°æ³•&#34;&gt;ä¸‰è‰²æ ‡è®°æ³•&lt;/h3&gt;
&lt;p&gt;é‡‡ç”¨äº†ä¸€ç§ä¸‰è‰²æ ‡è®°çš„ç®—æ³•ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼šæ— æ³•è¢«è®¿é—®åˆ°çš„å¯¹è±¡æ˜¯ç™½è‰²ï¼Œå¯è®¿é—®åˆ°ï¼Œä½†æ²¡æœ‰é€’å½’æ‰«æå®Œå…¨çš„å¯¹è±¡æ˜¯ç°è‰²ï¼Œå®Œå…¨æ‰«æè¿‡çš„å¯¹è±¡æ˜¯é»‘è‰²ã€‚ç†æƒ³çŠ¶å†µä¸‹ï¼ŒGC åªéœ€è¦å……åˆ†éå†ç°è‰²å¯¹è±¡å°±å¯ä»¥å®Œæˆæ”¶é›†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;mutator-å¯¼è‡´çš„é—®é¢˜&#34;&gt;Mutator å¯¼è‡´çš„é—®é¢˜&lt;/h4&gt;
&lt;p&gt;è€ƒè™‘ä¸€ç§æƒ…å†µï¼Œä¸€ä¸ªå˜é‡ x å·²ç»è¢«æ ‡è®°ä¸ºé»‘è‰²ï¼Œä½†æ˜¯è§£é‡Šæ‰§è¡Œ&lt;code&gt;x.a = {}&lt;/code&gt;ï¼Œå¾ˆæ˜æ˜¾&lt;code&gt;{}&lt;/code&gt;æ˜¯ä¸€ä¸ªç™½è‰²å¯¹è±¡ï¼Œè¿™å°±å½¢æˆäº†é»‘è‰²å¯¹è±¡æŒ‡å‘ç™½è‰²å¯¹è±¡çš„é—®é¢˜ï¼ˆå¯¼è‡´è¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯å¯¹è±¡çš„å¯å˜æ€§ï¼‰ã€‚æ­¤æ—¶æˆ‘ä»¬ä¸å¾—ä¸æ”¹å˜ x çš„é¢œè‰²ï¼Œ&lt;del&gt;ç»™æ­»å»çš„å˜é‡æ‰“å¤æ´»èµ›&lt;/del&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ—¶æ˜¯å°† {} æ”¹å˜ä¸ºç°è‰²ï¼Œè¿˜æ˜¯æŠŠ x å˜æˆç°è‰²æ˜¯ä¸ªé—®é¢˜ï¼Œåˆšå¥½ Lua æä¾›äº†è¿™ä¸¤ä¸ªæ¥å£ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LUAI_FUNC &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; luaC_barrier_ (lua_State *L, GCObject *o, GCObject *v);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LUAI_FUNC &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; luaC_barrierback_ (lua_State *L, GCObject *o);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½•æ—¶ä½¿ç”¨ä½•ç§æ–¹æ³•å…¶å®æ˜¯çœ‹è®¾è®¡è€…çš„ç»éªŒã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åˆšåˆšè¯´çš„è¿™ç§æƒ…å†µä¸­ï¼ŒLua é‡‡ç”¨çš„æ˜¯å°† x å˜ä¸ºç°è‰²çš„æ–¹æ³•ï¼Œå› ä¸ºç»™ä¸€ä¸ª table ä¸­çš„å­—æ®µèµ‹å€¼è¯´æ˜è¿™ä¸ª table å¾ˆæœ‰å¯èƒ½è¿˜è¦è¢«å¤ç”¨ï¼›è€Œåœ¨ metatable ä¸­é‡åˆ°è¿™ç§æƒ…å†µå°±é‡‡å–çš„æ˜¯å¦ä¸€ç§æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆ†ä»£å¼-gc&#34;&gt;åˆ†ä»£å¼ GC&lt;/h3&gt;
&lt;p&gt;æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬åœ¨ä»£ç çš„æŸå¤„ï¼ˆç”šè‡³å¯ä»¥æƒ³è±¡å°±æ˜¯ä»£ç å¼€å¤´ï¼‰ä½¿ç”¨äº†ä¸€ä¸ªå·¨å¤§çš„çŸ©é˜µï¼Œä¹‹åå†ä¹Ÿæ²¡æœ‰æ¯”å®ƒæ›´å¤§çš„å†…å­˜åˆ†é…äº†ï¼Œé‚£ä¹ˆ Lua 5.1 çš„ GC å¯èƒ½åªä¼šè¿è¡Œä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤åŸºäºå‡è®¾å¤§éƒ¨åˆ†å¯¹è±¡åœ¨åˆ›å»ºå‡ºæ¥åä¸ä¹…å°±è¢«å›æ”¶æ‰(m&lt;em&gt;ost objects die young&lt;/em&gt;)çš„å‡è®¾ï¼ŒLua 5.2 è®¾è®¡äº†åˆ†ä»£å¼ GC ï¼Œå¹¶åœ¨ 5.4 ä¸­å®Œå–„ã€‚&lt;/p&gt;
&lt;h4 id=&#34;old-and-young&#34;&gt;Old and Young&lt;/h4&gt;
&lt;p&gt;æ‰€æœ‰çš„å¯¹è±¡è¢«åˆ’åˆ†ä¸ºå¹´è½»çš„(young)å’Œå¹´è€çš„(old)ï¼šå¯¹è±¡åˆšè¢«åˆ›å»ºæ—¶æ˜¯å¹´è½»çš„ï¼Œå½“å­˜æ´»è¿‡ä¸¤è½®åƒåœ¾æ”¶é›†åˆ™å˜ä¸ºå¹´è€çš„ã€‚åœ¨æ¯æ¬¡æ¬¡çº§åƒåœ¾æ”¶é›†ä¸­ï¼ŒGC åªéå†å¹¶æ¸…é™¤å¹´è½»çš„å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åœ¨åˆ†ä»£ä¸­çš„é‡è¦è§„åˆ™ï¼šè€å¯¹è±¡ä¸èƒ½æŒ‡å‘æ–°å¯¹è±¡ã€‚å› æ­¤é‡åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œå¦‚æœæˆ‘ä»¬å°†æ–°å¯¹è±¡å˜ä¸ºè€å¯¹è±¡(forward)å°±å¯èƒ½å‡ºç°å¤§é‡çš„è€å¯¹è±¡ï¼Œè®©åˆ†ä»£å¼é€€åŒ–åˆ°åŸæ¥çš„ç‰ˆæœ¬ï¼›å¦‚æœæˆ‘ä»¬å°†è€å¯¹è±¡å˜ä¸ºæ–°å¯¹è±¡(backward)ï¼Œå°±å¯èƒ½åœ¨åˆ«çš„åœ°æ–¹ç ´åè§„åˆ™ï¼ˆä¾‹å¦‚è¿™ä¸ªè€å¯¹è±¡è¢«åˆ«çš„å¯¹è±¡å¼•ç”¨ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;the-touched-objects&#34;&gt;The Touched Objects&lt;/h4&gt;
&lt;p&gt;ä¸ºäº†è§£å†³ä¸Šè¿°çš„é—®é¢˜ï¼ŒLua å¼•å…¥äº†è¢«è§¦ç¢°è¿‡çš„å¯¹è±¡è¿™ä¸€æ¦‚å¿µï¼Œåœ¨åˆšåˆšçš„æƒ…æ™¯ä¸‹ï¼Œè€å¯¹è±¡ä¼šè¢«æ ‡è®°ä¸ºè¢«è§¦ç¢°è¿‡çš„å¯¹è±¡å¹¶è¢«æ”¾å…¥ä¸€ä¸ªç‰¹æ®Šçš„åˆ—è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¯æ¬¡æ¬¡çº§åƒåœ¾æ”¶é›†ä¸­ï¼Œè¢«è§¦ç¢°è¿‡çš„å˜é‡ä¼šè¢«éå†ï¼Œä½†ä¸ä¼šè¢«æ”¶é›†ï¼ˆå¯èƒ½ä¼šæ”¶é›†å®ƒä»¬æŒ‡å‘çš„æ–°å¯¹è±¡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç»å†ä¸¤æ¬¡åƒåœ¾æ”¶é›†ï¼ˆéæ¬¡çº§ï¼‰åï¼Œè¢«è§¦ç¢°è¿‡çš„å˜é‡æŒ‡å‘çš„å­å¯¹è±¡éƒ½å˜æˆè€å¯¹è±¡äº†ï¼Œå› æ­¤ä»–ä»¬ä¹Ÿä¼šæ¢å¤æˆä¸ºè€å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h4 id=&#34;lua-52-åˆ†ä»£çš„é—®é¢˜&#34;&gt;Lua 5.2 åˆ†ä»£çš„é—®é¢˜&lt;/h4&gt;
&lt;p&gt;åœ¨ Lua 5.3 çš„è®¾è®¡ä¸­ï¼Œä¸€ä¸ªæ–°å¯¹è±¡ç»å†ä¸€æ¬¡æ”¶é›†è€Œä¸è¢«å›æ”¶å°±ä¼šæˆä¸ºè€å¯¹è±¡ã€‚å¦‚æœå®ƒåˆšå¥½åœ¨ä¸€æ¬¡å›æ”¶å‰è¢«åˆ›å»ºè€Œä¸”æœ¬åº”è¯¥åœ¨é‚£æ¬¡å›æ”¶ä¹‹åä¸ä¹…è¢«å›æ”¶ï¼Œæœ¬ä¸åº”è¯¥æˆä¸ºè€å¯¹è±¡çš„å®ƒå°±ä¼šæˆä¸ºè€å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;è¿‡å¤šçš„è€å¯¹è±¡å°±å¯¼è‡´ 5.2 çš„æ€§èƒ½å ªå¿§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;userdata-å¯¼è‡´çš„é—®é¢˜&#34;&gt;userdata å¯¼è‡´çš„é—®é¢˜&lt;/h3&gt;
&lt;p&gt;ç”±äº Lua æ˜¯ä¸€ç§å¯ä»¥ä¸ C äº’ç›¸åµŒå…¥çš„è¯­è¨€ï¼Œå› æ­¤ä¸å¯é¿å…åœ°ä¼šä½¿ç”¨åˆ° C ä¸­çš„æ•°æ®ç»“æ„(userdata)ï¼Œä½†åˆç”±äº Lua æ”¯æŒç»™ userdata å®šä¹‰ __gc æ–¹æ³•ï¼Œæ•…è¦åŒºåˆ†æœ‰æ—  __gc æ–¹æ³•çš„ userdata ã€‚&lt;/p&gt;
&lt;p&gt;æ ‡è®°æµç¨‹è¦åˆ†ä¸ºä¸¤æ­¥ï¼Œå…ˆæ˜¯æŠŠåŒ…æ‹¬ userdata çš„æ­»å¯¹è±¡æ ‡è®°ï¼Œå†å°† userdata ä¸­æœ‰ __gc æ–¹æ³•çš„å¤æ´»ï¼Œè®©å®ƒä»¬åœ¨ä¸‹ä¸€è½®è¢«æ”¶é›†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.ulisp.com/show?1BD3&#34;&gt;ulisp&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://doc.rust-lang.org/std/sync/struct.Arc.html&#34;&gt;Rust Arc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)&#34;&gt;wikipedia&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.codingnow.com/2018/10/lua_gc.html&#34;&gt;äº‘é£çš„BLOG&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.lua.org/wshop18/Ierusalimschy.pdf&#34;&gt;Lua ä¹‹çˆ¶çš„æ¼”è®²ppt&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>FreeDOSå’Œmasmå¼€å‘ç¯å¢ƒé…ç½®</title>
      <link>https://vaaandark.top/posts/freedos-and-masm-environment/</link>
      <pubDate>Fri, 16 Sep 2022 16:22:34 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/freedos-and-masm-environment/</guid>
      <description>&lt;p&gt;æ­£åœ¨ä¸Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€ï¼Œç›®å‰ä¸»è¦æ˜¯åœ¨è®²æ±‡ç¼–è¯­è¨€ï¼Œä½¿ç”¨çš„å¼€å‘ç¯å¢ƒè‡ªç„¶æ˜¯åˆè€åˆè‡­çš„ DOS åŠ ä¸Š MASM ã€‚ä¹‹å‰æˆ‘çœ‹åˆ°è¿‡ FreeDOS è¿™ä¸ªè‡ªç”±çš„ DOS å‘è¡Œç‰ˆï¼Œæ‰“ç®—è¯•åƒä¸€ä¸‹ï¼Œä¹‹åçš„æ±‡ç¼–å®éªŒä¹Ÿå°†åœ¨è¿™ä¸Šé¢è¿›è¡Œã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;å®‰è£…ä¸é…ç½®&#34;&gt;å®‰è£…ä¸é…ç½®&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆåœ¨&lt;a href=&#34;https://www.freedOS.org/download/&#34;&gt;FreeDOS å®˜ç½‘&lt;/a&gt;ä¸Šä¸‹è½½æœ€æ–°çš„ç³»ç»Ÿé•œåƒï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ FreeDOS 1.3 LiveCD ã€‚ä¸‹è½½ä¹‹åå°†å…¶è§£å‹åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹å†…ï¼Œæœ‰ä¸‰ä¸ªæ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;% ls
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;FD13BOOT.img  FD13LIVE.iso  readme.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å†ä½¿ç”¨è™šæ‹Ÿæœºå®‰è£… FreeDOS ï¼Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;% qemu-img create freedos.img 500M &lt;span style=&#34;color:#007f7f&#34;&gt;# åˆ›å»º QEMU çš„è™šæ‹Ÿç£ç›˜&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;% qemu-system-i386 -m 32M -drive file=freedos.img,media=disk,format=raw -drive file=FD13LIVE.iso,media=cdrom -boot order=d &lt;span style=&#34;color:#007f7f&#34;&gt;# å¯åŠ¨é•œåƒ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹‹åå°±æ˜¯å’Œå®‰è£… Linux å‘è¡Œç‰ˆå¤§åŒå°å¼‚çš„æ“ä½œäº†ã€‚&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;æŒ‚è½½è™šæ‹Ÿç£ç›˜åˆ° Host ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;% sudo mkdir -p /mnt/freedos
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;% sudo mount -t msdos -o uid=1000,loop,offset=&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;32256&lt;/span&gt; freedos.img /mnt/freedos
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;å®‰è£… MASM ï¼Œå¯ä»¥ç›´æ¥å°†æ–‡ä»¶æ”¾ç½®åˆ°æŒ‚è½½çš„åœ°æ–¹ï¼Œé‡å¯ FreeDOS åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚ä½¿ç”¨æ—¶ä¸å†éœ€è¦ LiveCD çš„é•œåƒï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;% qemu-system-i386 -m 32M -drive file=freedos.img,media=disk,format=raw -boot order=d
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ç–‘æƒ‘&#34;&gt;ç–‘æƒ‘&lt;/h2&gt;
&lt;p&gt;å¯èƒ½æ˜¯ FreeDOS æ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿå¯èƒ½æ˜¯ qemu çš„ç¼“å­˜é—®é¢˜ï¼Œæˆ‘åœ¨ Host å¯¹æ–‡ä»¶çš„æ“ä½œåªæœ‰åœ¨é‡å¯ FreeDOS ä¹‹åæ‰ä¼šåœ¨ guest ä¸­ç”Ÿæ•ˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ª&lt;a href=&#34;https://unix.stackexchange.com/questions/485822/how-to-mount-a-linux-host-filesystem-with-freedos-running-in-qemu&#34;&gt;å¸–å­&lt;/a&gt;ä¸­ä¹Ÿæœ‰äººé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;&lt;em&gt;However, it&amp;rsquo;s limited to 512MB, and doesn&amp;rsquo;t reflect any changes made to the directory from the host system after QEMU starts.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ª&lt;a href=&#34;https://superuser.com/questions/1630317/how-to-transfer-files-from-host-to-dos-qemu-c-drive&#34;&gt;å¸–å­&lt;/a&gt;ä¹Ÿæœ‰äººæåˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;em&gt;You should never write to the FAT directory on the host system while accessing it with the guest system. If want to add new files to &amp;lsquo;share&amp;rsquo;, shutdown the virtual machine before.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;æ‰“ç®—æœ‰æ—¶é—´çœ‹ä¸€ä¸‹&lt;a href=&#34;https://www.qemu.org/docs/master/system/images.html#virtual-fat-disk-images&#34;&gt;QEMU çš„ FAT æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•ä½¿ç”¨Luaå†™ä¸€ä¸ªNeoVimæ’ä»¶</title>
      <link>https://vaaandark.top/posts/how-to-write-a-plugin-for-neovim-in-lua/</link>
      <pubDate>Thu, 18 Aug 2022 17:18:42 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/how-to-write-a-plugin-for-neovim-in-lua/</guid>
      <description>&lt;p&gt;ä¹‹å‰å­¦ä¹ äº†å¦‚ä½•å†™ Lua ç¨‹åºï¼Œåˆå› ä¸º NeoVim çš„æ’ä»¶å¯ä»¥ç”¨ Lua å†™ï¼Œæ‰€ä»¥æƒ³å­¦ä¹ ä¸€ä¸‹æ’ä»¶å¼€å‘ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;æ’ä»¶ç›®å½•ç»“æ„&#34;&gt;æ’ä»¶ç›®å½•ç»“æ„&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çš„æ’ä»¶åº”å½“æœ‰è‡³å°‘ä¸¤ä¸ªç›®å½•ï¼š&lt;code&gt;plugin&lt;/code&gt;ç”¨äºæ”¾&lt;code&gt;main&lt;/code&gt;ä»£ç æ–‡ä»¶ï¼Œ&lt;code&gt;lua&lt;/code&gt;æ”¾å…¶ä½™çš„æ‰€æœ‰ä»£ç ã€‚å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬çœŸçš„æƒ³æŠŠæ‰€æœ‰ä»£ç æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä½†æ˜¯è¯·ä¸è¦è¿™æ ·ã€‚å› æ­¤ï¼Œä½¿ç”¨&lt;code&gt;plugin/whid.vim&lt;/code&gt;å’Œ&lt;code&gt;lua/whid.lua&lt;/code&gt;è¿™ä¸¤ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-vim&#34; data-lang=&#34;vim&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#34; plugin/whid.vim æ–‡ä»¶&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; exists(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;g:loaded_whid&amp;#39;&lt;/span&gt;) | finish | &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;endif&lt;/span&gt; &lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#34; é˜²æ­¢æ’ä»¶åŠ è½½ä¸¤æ¬¡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; s:save_cpo = &amp;amp;cpo &lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#34; ä¿å­˜ç”¨æˆ·è‡ªå®šä¹‰é€‰é¡¹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;set&lt;/span&gt; cpo&amp;amp;vim &lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#34; é‡ç½®åˆ°é»˜è®¤é€‰é¡¹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#34; è¿è¡Œæ’ä»¶&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;command! Whid lua require&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;whid&amp;#39;&lt;/span&gt;.whid()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &amp;amp;cpo = s:save_cpo &lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#34; æ¢å¤ç”¨æˆ·è‡ªå®šä¹‰é€‰é¡¹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;unlet s:save_cpo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; g:loaded_whid = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;let s:save_cpo = &amp;amp;cpo&lt;/code&gt;æ˜¯é˜²æ­¢è‡ªå®šä¹‰é€‰é¡¹å¹²æ‰°æ’ä»¶çš„å¸¸è§åšæ³•ã€‚ä¾æ®æˆ‘ä»¬è¦ç¼–å†™çš„ä»£ç ï¼Œç¼ºå°‘è¿™ä¸€è¡Œå¯èƒ½ä¸ä¼šæœ‰ä»€ä¹ˆåå¤„ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ç§å¥½çš„ä¹ æƒ¯ï¼ˆè‡³å°‘æ ¹æ® Vim å¸®åŠ©æ–‡ä»¶æ˜¯è¿™æ ·ï¼‰ã€‚&lt;code&gt;command! Whid lua require &#39;whid&#39;.whid()&lt;/code&gt;éœ€è¦æ’ä»¶çš„ Lua æ¨¡å—å¹¶è°ƒç”¨å®ƒçš„ä¸»å‡½æ•°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æµ®åŠ¨çª—å£&#34;&gt;æµ®åŠ¨çª—å£&lt;/h2&gt;
&lt;p&gt;NeoVim å’Œå¦‚ä»Šçš„æ–°ç‰ˆ Vim éƒ½æœ‰æµ®åŠ¨çª—å£çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- lua/whid.lua æ–‡ä»¶&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; api = vim.api
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; buf, win
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; open_window()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  buf = api.nvim_create_buf(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;false&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;true&lt;/span&gt;) &lt;span style=&#34;color:#007f7f&#34;&gt;-- åˆ›å»ºä¸€ä¸ªç©ºç¼“å†²åŒº&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  api.nvim_buf_set_option(buf, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;bufhidden&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;wipe&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;-- è·å–çª—å£çš„è¡Œå’Œåˆ—&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; width = api.nvim_get_option(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;columns&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; height = api.nvim_get_option(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;lines&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;-- è®¡ç®—å‡ºæµ®åŠ¨çª—å£çš„è¡Œå’Œåˆ—&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; win_height = math.ceil(height * &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.8&lt;/span&gt; - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; win_width = math.ceil(width * &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.8&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;-- è®¡ç®—å‡ºæµ®åŠ¨çª—å£çš„å¼€å§‹ä½ç½®&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; row = math.ceil((height - win_height) / &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; col = math.ceil((width - win_width) / &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;-- è®¾ç½®é€‰é¡¹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; opts = {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    style = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;minimal&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    relative = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;editor&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    width = win_width,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    height = win_height,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    row = row,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    col = col
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;-- æœ€ååœ¨ä¸€ä¸ªé™„åŠ çš„ç¼“å†²åŒºåˆ›å»ºæµ®åŠ¨çª—å£&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  win = api.nvim_open_win(buf, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;true&lt;/span&gt;, opts)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;nvim_create_buf&lt;/code&gt;å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯&lt;code&gt;listed&lt;/code&gt;ç¬¬äºŒä¸ªå‚æ•°æ˜¯&lt;code&gt;scratch&lt;/code&gt;ï¼Œåˆ†åˆ«è¢«è®¾ç½®æˆ&lt;code&gt;false&lt;/code&gt;å’Œ&lt;code&gt;true&lt;/code&gt;ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæœªåˆ—å‡ºçš„ç¼“å†²åŒºï¼Œå¹¶ä¸”æ˜¯ &lt;em&gt;throwaway&lt;/em&gt; çš„ï¼ˆéšè—æ—¶å°†ä¼šè¢«åˆ é™¤ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;nvim_open_win&lt;/code&gt;å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çª—å£åŒæ—¶ä¹Ÿå¯ä»¥å°†ä¹‹å‰åˆ›å»ºçš„&lt;code&gt;buf&lt;/code&gt;ç»‘å®šå…¶ä¸Šï¼Œç¬¬äºŒä¸ª&lt;code&gt;bool&lt;/code&gt;ç±»å‹å‚æ•°è¡¨ç¤ºè¿™ä¸ªçª—å£æ˜¯å¦è·å¾—ç„¦ç‚¹ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°&lt;code&gt;opt&lt;/code&gt;æ˜¯ä¸€ä¸ªè¡¨ï¼Œå…¶ä¸­å…ƒç´ &lt;code&gt;width&lt;/code&gt;å’Œ&lt;code&gt;height&lt;/code&gt;çš„ä½œç”¨ä¸è¨€è‡ªæ˜ï¼›&lt;code&gt;row&lt;/code&gt;å’Œ&lt;code&gt;col&lt;/code&gt;æ˜¯çª—å£çš„å¼€å§‹ä½ç½®ï¼ˆç¼–è¾‘å™¨çš„å·¦ä¸Šè§’å¼€å§‹ç®—ï¼‰ã€‚&lt;code&gt;relative=&amp;quot;editor&amp;quot;&lt;/code&gt;å’Œ&lt;code&gt;style=&amp;quot;minimal&amp;quot;&lt;/code&gt;æ˜¯é…ç½®çª—å£å¤–è§‚çš„é€‰é¡¹ï¼Œè¿™æ ·è®¾ç½®å¯ä»¥ç¦ç”¨ä¸€äº›ä¸éœ€è¦çš„é€‰é¡¹ï¼Œä¾‹å¦‚è¡Œå·å’Œæ‹¼å†™é”™è¯¯æç¤ºã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæµ®åŠ¨çª—å£ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå˜å¾—æ›´åŠ å¥½çœ‹ã€‚NeoVim å½“å‰è¿˜ä¸æ”¯æŒè¾¹æ¡†ç­‰å°éƒ¨ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå·±åšå‡ºæ¥ã€‚è¿™å…¶å®ç›¸å½“ç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥å¼„ä¸€ä¸ªæ–°çš„çª—å£ï¼Œæ¯”åŸæ¥çš„çª—å£ç¨å¾®å¤§ä¸€åœˆï¼Œå¹¶æ”¾ç½®åœ¨åº•éƒ¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; border_opts = {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  style = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;minimal&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  relative = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;editor&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  width = win_width + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  height = win_height + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  row = row - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  col = col - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥ç”¨è¾¹æ¡†å­—ç¬¦è®©å®ƒçœ‹èµ·æ¥æ›´å¥½çœ‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; border_buf = api.nvim_create_buf(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;false&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;true&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; border_lines = { &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;â•”&amp;#39;&lt;/span&gt; .. string.rep(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;â•&amp;#39;&lt;/span&gt;, win_width) .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;â•—&amp;#39;&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; middle_line = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;â•‘&amp;#39;&lt;/span&gt; .. string.rep(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;, win_width) .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;â•‘&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; i=&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, win_height &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  table.insert(border_lines, middle_line)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;table.insert(border_lines, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;â•š&amp;#39;&lt;/span&gt; .. string.rep(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;â•&amp;#39;&lt;/span&gt;, win_width) .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;â•&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;api.nvim_buf_set_lines(border_buf, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, -&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;false&lt;/span&gt;, border_lines)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- å‡½æ•°åŸå‹ä¸º nvim_buf_set_lines({buffer}, {start}, {end}, {strict_indexing}, {replacement})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- è®¾ç½®ç¼“å†²åŒº(border_buf)å¡«å……èŒƒå›´ä¸ºç¬¬ä¸€è¡Œ(0)åˆ°æœ€åä¸€è¡Œ(-1)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- å¿½ç•¥è¶Šç•Œé”™è¯¯(false)å¹¶å¡«å……(border_lines)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ˜¾ç„¶æˆ‘ä»¬å¿…é¡»æŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ‰“å¼€çª—å£ï¼Œå¹¶ä¸”ä¸€èµ·å…³é—­çª—å£ã€‚å½“å‰æœ€å¥½çš„è§£å†³åŠæ³•æ˜¯ä½¿ç”¨&lt;code&gt;viml autocomand&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; border_win = api.nvim_open_win(border_buf, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;true&lt;/span&gt;, border_opts)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;win = api.nvim_open_win(buf, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;true&lt;/span&gt;, opts)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;api.nvim_command(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;au BufWipeout &amp;lt;buffer&amp;gt; exe &amp;#34;silent bwipeout! &amp;#34;&amp;#39;&lt;/span&gt;..border_buf)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;è·å–æ•°æ®&#34;&gt;è·å–æ•°æ®&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çš„æ’ä»¶ç”¨äºå±•ç¤ºæˆ‘ä»¬å¤„ç†è¿‡çš„æœ€æ–°æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ git å‘½ä»¤è¾¾åˆ°è¿™æ ·çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git diff-tree --no-commit-id -name-only -r HEAD
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ›å»ºå‡½æ•°å°†æ•°æ®æ’å…¥åˆ°çª—å£ä¹‹ä¸­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç”¨æˆ·è¾“å…¥&#34;&gt;ç”¨æˆ·è¾“å…¥&lt;/h2&gt;
&lt;h2 id=&#34;å…¬å…±å‡½æ•°&#34;&gt;å…¬å…±å‡½æ•°&lt;/h2&gt;
&lt;h2 id=&#34;å®Œæ•´ä»£ç &#34;&gt;å®Œæ•´ä»£ç &lt;/h2&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.2n.pl/blog/how-to-write-neovim-plugins-in-lua.md&#34;&gt;How to write neovim plugins in Lua&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/rafcamlet/nvim-whid&#34;&gt;GitHub rafcamlet/nvim-whid&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>å·¥ç¨‹å¸ˆæ–‡åŒ–ã€å·¥åŒ ç²¾ç¥å’Œèµ›åšä¸çœŸ</title>
      <link>https://vaaandark.top/posts/engineer-and-dingzhen/</link>
      <pubDate>Mon, 15 Aug 2022 12:27:41 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/engineer-and-dingzhen/</guid>
      <description>&lt;p&gt;æœ€è¿‘ä½•åŒå­¦å’Œç¨šæ™–å›éƒ½å‘è§†é¢‘äº†ï¼Œå·§åˆçš„æ˜¯ä»–ä»¬åšçš„é¡¹ç›®éƒ½æ˜¯å…³äºé”®ç›˜çš„é­”æ”¹ï¼Œä¸è¿‡äººæ¯”äººè¿˜æ˜¯æ°”æ­»äººå—·ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;ä½•åŒå­¦æœ¬è´¨ä¸Šèµ°çš„è¿˜æ˜¯ç½‘çº¢ç”šè‡³è¯´æ˜¯é¥­åœˆè·¯çº¿ï¼Œå¹¶æ²¡æœ‰å¾ˆç¡¬çš„å®åŠ›ï¼Œä¹Ÿå°±å¯¼è‡´äº†å¤§éƒ¨åˆ†ç†å·¥ç§‘çš„â€œç›´ç”·â€éƒ½ä¼šçœ‹ä¸èµ·ç”šè‡³è®¨åŒä»–ã€‚&lt;/p&gt;
&lt;p&gt;è€Œç¨šæ™–å›å°±ä¸ä¸€æ ·äº†ï¼Œä»–æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä½ä¸“èŒ UP ï¼Œä»–æœ‰è‡ªå·±çš„æœ¬èŒå·¥ä½œï¼Œå¹¶ä¸éœ€è¦å°†æµé‡å˜ç°ï¼Œå› æ­¤ä»–æ²¡æœ‰å¤§èŒƒå›´ç‚’ä½œè¿‡è‡ªå·±çš„é¡¹ç›®ï¼Œè€Œä¸”ä»–çš„è§†é¢‘ä¹Ÿä¸ä¼šä¸ºäº†æ›´å¤šçš„æ’­æ”¾é‡å»æä¸€äº›æ‰€è°“çš„â€œäººæ–‡â€å‡åï¼Œä»–è‡ªæœ‰è‡ªå·±çš„ç›®æ ‡è§‚ä¼—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;ç¨šæ™–å›GitHub&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/zhihui.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘å¹¶ä¸çŸ¥é“å¯¹ä½•åŒå­¦å† ä»¥èµ›åšä¸çœŸçš„ç»°å·æ˜¯å¦æœ‰ç‚¹è¿‡äº†ï¼Œä½†æˆ‘å¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œå¤šä¸€ä¸¤ä¸ªèƒ½åŠ›åªå¤Ÿåšå¼€ç®±è§†é¢‘çš„ç½‘çº¢å¯¹å½¢æˆå·¥ç¨‹å¸ˆæ–‡åŒ–æ˜¯æ¯«æ— ä½œç”¨çš„ã€‚å¯¹äºæœªæ¥çœŸçš„åœ¨å·¥ç¨‹å¸ˆå²—ä½ä¸Šçš„è§‚ä¼—ç¾¤ä½“æ¥è¯´ï¼Œä½•åŒå­¦çš„ä½œç”¨æœ€å¤šåªæ˜¯è®©äººæ‰¹åˆ¤æ€§åœ°è§‚çœ‹ã€‚ç›¸ååœ°ï¼Œå¤šå‡ ä½å–„äºè¡¨è¾¾ã€ä¼šåšå‡ºä¼˜è´¨è§†é¢‘çš„çœŸæ­£â€œå¤©æ‰å°‘å¹´â€å´æ˜¯éå¸¸éš¾å¾—çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;åˆšåˆšè¯´åˆ°äº†å·¥ç¨‹å¸ˆæ–‡åŒ–ï¼Œå¯æ˜¯æˆ‘ä»¬æ€»åœ¨è¯´å®ƒï¼Œå®ƒç©¶ç«Ÿæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°äº†ä¸€ä¸ªå¾ˆå¥½çš„å®šä¹‰ï¼š&lt;strong&gt;ä¸€åˆ‡ä»¥è§£å†³é—®é¢˜ä¸ºå¯¼å‘çš„å·¥ä½œæ–‡åŒ–&lt;/strong&gt;ã€‚å¾ˆæ˜æ˜¾çš„æ˜¯ï¼Œè¿™æ ·çš„æ–‡åŒ–å¯ä»¥é«˜è´¨é«˜é‡åœ°è§£å†³é—®é¢˜ï¼Œä¹Ÿå¯ä»¥æé«˜ä¸€çº¿äººå‘˜çš„è¯è¯­æƒå’Œåœ°ä½ï¼ˆå¹¶ä¸è¦æ±‚ä¸€çº¿äººå‘˜æ˜¯ä¸€ä½å·¥ç¨‹å¸ˆï¼‰ã€‚ä¸€ä¸ªä¼˜ç§€çš„ä¸€çº¿é—®é¢˜è§£å†³è€…çš„å·¥èµ„å°±åº”è¯¥é«˜äºä¸­å±‚ç®¡ç†äººå‘˜ï¼ˆç±»ä¼¼äºè‹è”æ—©æœŸå…¬åŠ¡å‘˜çš„å·¥èµ„ä¸èƒ½è¶…è¿‡ç†Ÿç»ƒå·¥äººï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆæ˜æ˜¾ï¼Œä½•åŒå­¦èº«ä¸Šä¸èƒ½ä½“ç°å·¥ç¨‹å¸ˆæ–‡åŒ–ã€‚æˆ‘ä»¬å¹¶ä¸è¦æ±‚å·¥ç¨‹å¸ˆâ€œè®·äºè¨€â€ï¼Œä»–çš„ç¡®å¯ä»¥è¯´å¾—å¤©èŠ±ä¹±å ï¼Œä½†æ˜¯â€œæ•äºè¡Œâ€å´æ˜¯å¿…è¦çš„ã€‚è€Œä¸”ï¼Œä½•åŒå­¦å¯¹èƒŒåä¸ºä»–è§£å†³é—®é¢˜çš„å›¢é˜Ÿæ‰€æç”šå°‘ï¼Œä»æ²¡æœ‰æ„Ÿè°¢ä»–ä»¬çš„è´¡çŒ®ã€‚å¹¶ä¸”ï¼Œä»–æ‰€åšçš„ä¸œè¥¿æ ¹æœ¬æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œç”šè‡³æ˜¯ä¸ºäº†ä¸€ä¸ªâ€œä¼ªéœ€æ±‚â€è€Œåˆ¶é€ é—®é¢˜ã€‚ä»¥è¿™æ¬¡çš„é”®ç›˜ä¸ºä¾‹ï¼Œè¿™ä¹ˆå¤šç”µæœºçš„å †ç Œï¼Œæœ€ç»ˆçš„ç»“æœå°±æ˜¯ä¸€ä¸ªå‘çƒ­æƒŠäººçš„â€œç”µè€è™â€ã€‚å¦‚æœä»–çœŸçš„æƒ³è§£å†³é—®é¢˜ï¼Œä½¿ç”¨çƒ­æ’æ‹”é”®ç›˜å°±å¯ä»¥äº†ã€‚ä¸€å®šè¦åšä¸€ä¸ªå¯å˜é”®ç¨‹çš„é”®ç›˜çš„è¯ï¼Œé‚£ä»–å°±éœ€è¦è®¾è®¡ä¸“é—¨çš„æ§åˆ¶ã€ç”µæºèŠ¯ç‰‡ç­‰ã€‚å¦å¤–è¯´ä¸€å¥ï¼Œæˆ‘å¯¹é”®ç›˜çš„é›†æˆåº¦æŒæ€€ç–‘æ€åº¦ï¼Œæ€€ç–‘é”®ç›˜çš„æ§åˆ¶éƒ½åœ¨æ¡Œå­ä¸‹é¢ã€‚&lt;strong&gt;æ€»è€Œè¨€ä¹‹ï¼Œä½•åŒå­¦å¹¶ä¸å…·æœ‰ä½œä¸ºç§‘æŠ€åšä¸»çš„è§£å†³é—®é¢˜èƒ½åŠ›ï¼Œåªæœ‰ä½œä¸ºæ•°ç åšä¸»çš„æµ‹è¯„èƒ½åŠ›ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å†è¯´è¯´æˆ‘ä»¬å›½å®¶æ€»åœ¨è¯´çš„â€œå·¥åŒ ç²¾ç¥â€ã€‚å·¥åŒ ç²¾ç¥å›ºç„¶æ˜¯å¥½çš„ï¼Œä½†æ˜¯å®ƒçš„å†…æ¶µä¹Ÿè¦è·Ÿéšæ—¶ä»£è€Œå˜åŒ–ã€‚ä»¥å¤®è§†çºªå½•ç‰‡ã€Šå¤§å›½å·¥åŒ ã€‹ä¸ºä¾‹ï¼Œå®ƒæ€»æ˜¯ä¸è‡ªè§‰åœ°ç»™äººä¸€ç§è§‚ç‚¹ï¼Œè€å¸ˆå‚…å°±æ˜¯å¥½çš„ï¼Œæ‰‹å·¥åˆ¶ä½œå°±æ˜¯å¥½çš„ã€‚è¿™ç§å®£ä¼ å¯¼å‘çœŸçš„å¥½å—ï¼Ÿæˆ‘çœ‹ä¸ä¸€å®šã€‚èƒ½ç†Ÿç»ƒè¿ç”¨æœºå™¨è¾¾åˆ°è¦æ±‚çš„å¸ˆå‚…æ˜¯å¥½å¸ˆå‚…å—ï¼Ÿå¹´è½»çš„å¸ˆå‚…å°±ä¸æ˜¯å¥½å¸ˆå‚…å—ï¼Ÿåˆ¶é€ å‡ºèƒ½ä»£æ›¿äººå·¥çš„ä¼˜ç§€æœºå™¨çš„æ˜¯å¥½å‘æ˜å®¶å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šå®˜åª’è®²ä¸å¥½æ•…äº‹ï¼Œè¿™å¯èƒ½æ˜¯å®£ä¼ éƒ¨é—¨ä¸å·¥ä¸šç•Œè„±èŠ‚é€ æˆçš„ã€‚ä½†å—äººçƒ­æ§çš„æ˜¯â€œå°ä¸‘â€è®²æ•…äº‹ï¼Œè¿™æ˜¯å¦å’Œæ•´ä¸ªç¤¾ä¼šçš„æ°›å›´æœ‰å…³å‘¢ï¼Ÿ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;çŸ¥ä¹é—®ç­”ï¼š&lt;a href=&#34;https://www.zhihu.com/question/22168420/answer/36904920&#34;&gt;å·¥ç¨‹å¸ˆæ–‡åŒ–&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>è¯´è¯´é“¾è¡¨</title>
      <link>https://vaaandark.top/posts/facts-about-linklist/</link>
      <pubDate>Sun, 14 Aug 2022 16:01:24 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/facts-about-linklist/</guid>
      <description>&lt;p&gt;æœ€è¿‘çœ‹åˆ°äº†ä¸€äº›å…³äºä¾µå…¥å¼å’Œéä¾µå…¥å¼é“¾è¡¨çš„è®¨è®ºï¼Œå†³å®šç ”ç©¶ä¸€ä¸‹å®ƒä»¬ä¸¤ä¸ªã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;ä¾µå…¥å¼å’Œéä¾µå…¥å¼é“¾è¡¨çš„åŒºåˆ«&#34;&gt;ä¾µå…¥å¼å’Œéä¾µå…¥å¼é“¾è¡¨çš„åŒºåˆ«&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œçš„ä¾µå…¥æ˜¯ç›¸å¯¹äºé“¾è¡¨çš„æŒ‡é’ˆåŸŸæ¥è¯´ï¼Œæ‰€ä»¥æœ€ä¸»è¦çš„åŒºåˆ«å°±æ˜¯éä¾µå…¥å¼çš„é“¾è¡¨å®¹å™¨ä¸­ä¿å­˜äº†ä¸€ä»½ç”¨æˆ·ä¼ å…¥çš„å€¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;class&lt;/span&gt; list_node {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    list_node *next, *previous;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    MyClass value;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°éä¾µå…¥å¼çš„é“¾è¡¨åœ¨åˆ†é…èŠ‚ç‚¹æ—¶è¦åŒ…å«æŒ‡é’ˆåŸŸå’Œæ•°æ®åŸŸã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;è€Œä¾µå…¥å¼é“¾è¡¨å°±ä¸éœ€è¦ä¿å­˜ä¼ é€’å¯¹è±¡çš„æ‹·è´ï¼Œè€Œæ˜¯ä¿å­˜å¯¹è±¡æœ¬èº«ã€‚å¯¹è±¡æ’å…¥é“¾è¡¨ä¸­çš„æ‰€éœ€è¦çš„é™„åŠ æ•°æ®ç”±å¯¹è±¡æœ¬èº«æä¾›ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹ &lt;strong&gt;Linux&lt;/strong&gt; æä¾›çš„&lt;code&gt;listnode&lt;/code&gt;ç»“æ„ä½“ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; listnode {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; listnode *next, *prev;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨æ—¶ï¼Œéœ€è¦å°†ä¸€ä¸ª&lt;code&gt;listnode&lt;/code&gt;ç»“æ„ä½“æ”¾å…¥åˆ°éœ€è¦ç»„æˆé“¾è¡¨çš„ç»“æ„ä½“ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; data {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; a;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; b;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *c;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; listnode _list;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨ä¸€äº›å®æ¥æ–¹ä¾¿ä»£ç ä¹¦å†™ï¼Œå°¤å…¶æ˜¯åœ¨é€šè¿‡&lt;code&gt;listnode&lt;/code&gt;æ¥å¯»æ‰¾æ•´ä¸ª&lt;code&gt;data&lt;/code&gt;ç»“æ„ä½“æ—¶ï¼Œå°±éœ€è¦åˆ©ç”¨åç§»é‡ï¼ˆä½¿ç”¨&lt;code&gt;offsetof&lt;/code&gt;å…³é”®å­—ï¼‰å’ŒæŒ‡é’ˆçš„å¼ºåˆ¶è½¬æ¢çš„å®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸¤ç§å®¹å™¨çš„ä¼˜ç¼ºç‚¹&#34;&gt;ä¸¤ç§å®¹å™¨çš„ä¼˜ç¼ºç‚¹&lt;/h2&gt;
&lt;h3 id=&#34;éä¾µå…¥å¼&#34;&gt;éä¾µå…¥å¼&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€å•æ˜“æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªèŠ‚ç‚¹åªéœ€è¦åˆ†é…ä¸€æ¬¡ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ‰€ä»¥ç”Ÿå‘½å‘¨æœŸå’Œå†…å­˜æ‰‹åŠ¨ç®¡ç†æ¯”è¾ƒå‹å¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªå¯¹è±¡åªèƒ½å±äºä¸€ä¸ªå®¹å™¨ï¼Œå¦‚è¦å…±äº«äºä¸¤ä¸ªå®¹å™¨ï¼ˆä¾‹å¦‚åŒæ—¶æ”¾åœ¨åŒå‘é“¾è¡¨å’Œçº¢é»‘æ ‘ä¸­ï¼‰ï¼Œå°±åªèƒ½æ‹·è´è¿™ä¸ªå¯¹è±¡æˆ–è€…ä½¿ç”¨æŒ‡é’ˆé—´æ¥è®¿é—®ã€‚å¦‚æœä½¿ç”¨æ‹·è´çš„æ–¹æ³•å°±ä¼šé™ä½æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;æ— æ³•ä¿ç•™åŸå§‹ç±»å‹çš„åŒæ—¶å°†æ´¾ç”Ÿå¯¹è±¡å­˜å‚¨åœ¨STLå®¹å™¨ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ä¾µå…¥å¼&#34;&gt;ä¾µå…¥å¼&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜ç‚¹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ä¼šè°ƒç”¨å†…å­˜åˆ†é…ï¼Œå¯ä»¥å°†åŠ¨æ€åˆ†é…çš„å¼€é”€æœ€å°åŒ–ï¼Œä¹Ÿåœ¨æ’å…¥å’Œæ“¦é™¤å¯¹è±¡æ—¶æœ‰å¯é¢„æµ‹æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¾ˆå°çš„ä»£ä»·å°±å¯ä»¥å°†åŒä¸€ä¸ªå¯¹è±¡æ’å…¥åˆ°å¤šä¸ªå®¹å™¨ä¹‹ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;è¿­ä»£çš„é€Ÿåº¦å¾ˆå¿«ï¼Œå†…å­˜è®¿é—®æ›´å°‘ï¼Œä»æŒ‡é’ˆæˆ–å…ƒç´ å¼•ç”¨åˆ°è¯¥å…ƒç´ çš„è¿­ä»£å™¨çš„è®¡ç®—æ˜¯ä¸€ä¸ªå¸¸æ•°æ—¶é—´ï¼Œï¼ˆ&lt;code&gt;std::list&amp;lt;T*&amp;gt;&lt;/code&gt;æ˜¯çº¿æ€§å¤æ‚åº¦ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºç‚¹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ›´æ”¹å¯¹è±¡æ—¶æ—¶åˆ»è¦æ³¨æ„æ˜¯å¦ä¼šå¸¦æ¥å‰¯ä½œç”¨ã€‚&lt;/li&gt;
&lt;li&gt;éœ€è¦ç‹¬ç«‹äºå®¹å™¨ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä»¥åŠå†…å­˜åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;å› ä¸ºå¯¹è±¡å¯ä»¥åœ¨ä»å®¹å™¨è¢«åˆ é™¤ä¹‹å‰é‡Šæ”¾ï¼Œå› æ­¤è¿­ä»£å™¨å®¹æ˜“å¤±æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;åˆ†æä½¿ç”¨å®¹å™¨çš„ç¨‹åºçš„çº¿ç¨‹å®‰å…¨æ€§æ›´åŠ å›°éš¾ï¼Œå› ä¸ºå®¹å™¨å¯èƒ½ä¼šåœ¨æ²¡æœ‰æ˜¾å¼è°ƒç”¨å®¹å™¨æˆå‘˜çš„æƒ…å†µä¸‹è¢«é—´æ¥ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ¥è‡ª-boost-çš„å¯¹æ¯”è¡¨æ ¼&#34;&gt;æ¥è‡ª boost çš„å¯¹æ¯”è¡¨æ ¼&lt;/h3&gt;
&lt;p&gt;&lt;img alt=&#34;ä¸åŒå®¹å™¨ç±»å‹çš„å¯¹æ¯”&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/list-differences.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.boost.org/doc/libs/1_80_0/doc/html/intrusive/intrusive_vs_nontrusive.html&#34;&gt;boost document&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>OpenMPè¿›é˜¶</title>
      <link>https://vaaandark.top/posts/openmp-advance/</link>
      <pubDate>Tue, 02 Aug 2022 22:08:34 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/openmp-advance/</guid>
      <description>&lt;p&gt;ç»§ç»­å­¦ä¹  OpenMP çš„ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯ä¸€äº›è¾ƒæ–°ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;openmp-40&#34;&gt;OpenMP 4.0&lt;/h2&gt;
&lt;h3 id=&#34;controlling-openmp-thread-affinity&#34;&gt;Controlling OpenMP thread Affinity&lt;/h3&gt;
&lt;p&gt;å› ä¸ºå¾ˆå¤šç¡¬ä»¶å¦‚ä»Šæ˜¯ NUMA ç»“æ„ï¼Œåˆ†é…çº¿ç¨‹çš„ä½ç½®å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸æ ¸ç»‘å®šæœ‰å…³çš„ OpenMP ç»“æ„ proc_bind (master | close | spread)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;master&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»§æ‰¿ä¸²è¡Œéƒ¨åˆ†çš„æ ¸ç»‘å®šï¼Œç”¨è¿è¡Œä¹‹å‰ä¸²è¡Œçº¿ç¨‹çš„æ ¸æ¥æ‰§è¡Œæ‰€æœ‰çš„çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;close&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¼˜å…ˆåˆ†é…ä¸ä¸²è¡Œçº¿ç¨‹ç›¸ä¸´è¿‘çš„æ ¸ã€‚å½“å¹¶è¡Œçº¿ç¨‹æ•°é‡å¤§äºæ ¸å¿ƒæ•°é‡æ—¶ï¼Œåˆ†é…æ–¹å¼ä¸ spread ç›¸è¿‘ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;spread&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¨€ç–ã€å‡åŒ€åœ°è¿›è¡Œç»‘å®šã€‚å¦‚æœæœ‰ M ä¸ªçº¿ç¨‹ï¼Œ N ä¸ªæ ¸å¿ƒï¼Œé‚£ä¹ˆä»ä¸²è¡Œçº¿ç¨‹è¿è¡Œçš„é‚£ä¸ªæ ¸å¼€å§‹åˆ†å¸ƒï¼Œæ¯ä¸ªæ ¸ä¸Šè¿è¡Œ $M/N$ ä¸ªçº¿ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;task-constructor&#34;&gt;Task constructor&lt;/h3&gt;
&lt;p&gt;OpenMP 4.0 å¯ä»¥æŒ‡å®š task ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚&lt;/p&gt;
&lt;h4 id=&#34;taskwait&#34;&gt;taskwait&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; fib(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i, j;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (n &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; n;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma opm task shared(i) firstprivate(n)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        i = fib(n - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task shared(j) firstprivate(n)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        j = fib(n - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp taskwait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; i + j
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    opm_set_num_threads(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel shared(n)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp single
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;fib (%d) = %d&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, n, fib(n));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¿°ä»£ç ä¸­çš„ taskwait æŒ‡ä»¤å¯ä»¥ä¿è¯åœ¨ return ä¹‹å‰è¦è®¡ç®—å®Œæˆ i å’Œ j ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è™½ç„¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šæ‰§è¡Œ fib çš„è°ƒç”¨ï¼Œä½†æ˜¯åœ¨ fib å‡½æ•°ä¹‹ä¸­çš„ task æ‰§è¡Œæ˜¯å››ä¸ªçº¿ç¨‹éƒ½å‚ä¸çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;task-dependencies&#34;&gt;Task dependencies&lt;/h4&gt;
&lt;p&gt;å¯¹åŒä¸€çˆ¶çº§ä»»åŠ¡çš„è°ƒåº¦å¢åŠ é¢å¤–çš„çº¦æŸã€‚&lt;/p&gt;
&lt;p&gt;#pragma omp task depend(type: list)&lt;/p&gt;
&lt;p&gt;type := in | out | inout&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼äºä¾èµ–å›¾ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Flow dependency: read - after - write(RAW)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp single
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task shared (x) depend (out: x)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        x = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task shared (x) depend (in: x)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;x = %d&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, x);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Anti dependency: write - after - read(WAR)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp single
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task shared (x) depend (in: x)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        x = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task shared (x) depend (out: x)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;x = %d&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, x);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Output dependency: write - after - write(WAW)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp single
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task shared (x) depend (out: x)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        x = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task shared (x) depend (out: x)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;x = %d&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, x);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¿°ä»£ç ä¸­çš„ä¸¤ä¸ª task å¯ä»¥ä»¥ä»»æ„æ–¹å¼æ‰§è¡Œï¼Œå› æ­¤å¯èƒ½ä¼šå‡ºç°æ•°æ®ç«äº‰çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨çŸ©é˜µä¸­ä½¿ç”¨ï¼Œåˆ©ç”¨æ•°ç»„åˆ†ç‰‡ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªåŸºäº task çš„çŸ©é˜µ(N * N)åˆ†å—ï¼Œåˆ†æˆ BS * BS çš„åˆ†å—çŸ©é˜µã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// Assume BS divides N perfectly
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; matmul_depend(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; N, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; BS, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;float&lt;/span&gt; A[N][N], &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;float&lt;/span&gt; B[N][N], &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;float&lt;/span&gt; C[N][N))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i, j, k, ii, jj, kk;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt;(i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; N; i += BS)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt;(j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; j &amp;lt; N; j += BS)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt;(k = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; k &amp;lt; N; k += BS) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                    depend (in: A[i:BS][k:BS], B[k:BS][j:BS]) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;                    depend (inout: C[i:BS][j:BS])
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;                &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt;(ii = i; ii &amp;lt; i + BS; ii++)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt;(jj = j; jj &amp;lt; j + BS; jj++)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt;(kk = k; kk &amp;lt; k + BS; kk++)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            C[ii][jj] = C[ii][jj] + A[ii][kk] * B[kk][jj];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;taskyield-construct&#34;&gt;Taskyield construct&lt;/h3&gt;
&lt;p&gt;ä½¿å½“å‰çš„ task è®©å‡ºï¼Œæ–¹ä¾¿å…¶ä»–çš„ task æ‰§è¡Œã€‚ä¸€èˆ¬å’Œ while è¯­å¥æ­é…ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; N; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        something_useful();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (!omp_test_lock(lock)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp taskyield
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        something_critical();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        omp_unset_lock(lock); &lt;span style=&#34;color:#007f7f&#34;&gt;// é‡Šæ”¾é”
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;taskgroup-construct&#34;&gt;Taskgroup Construct&lt;/h3&gt;
&lt;p&gt;taskwait vs. taskgroup&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;taskwait åª join å­ä»»åŠ¡&lt;/li&gt;
&lt;li&gt;taskgroup join æ‰€æœ‰å­ä»»åŠ¡å’Œå­ä»»åŠ¡æ´¾ç”Ÿçš„ä»»åŠ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;user-define-reductions&#34;&gt;User define reductions&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp declare reduction(reduction-identifier: typename-list: combiner) [initialize-clause]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;reduction-identifier: å¯ä»¥æ˜¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„æ“ä½œï¼Œä¹Ÿå¯ä»¥æ˜¯ +, -, *, &amp;amp;, |, ^, &amp;amp;&amp;amp;, ||&lt;/li&gt;
&lt;li&gt;typename-list: æ“ä½œä½œç”¨çš„å˜é‡&lt;/li&gt;
&lt;li&gt;combiner: æŒ‡å®šå¦‚ä½•ç»“åˆè¿™äº›å˜é‡çš„è¯­å¥&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;reduction&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/openmp-reduction.png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;math.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; reduction1(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;float&lt;/span&gt; *x, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; *y, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i, b, c;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;float&lt;/span&gt; a, d;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	a = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	b = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	c = y[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	d = x[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel for private(i) shared(x, y, n) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;        reduction(+:a) reduction(^:b) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;        reduction(min:c) reduction(max:d)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i=&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i&amp;lt;n; i++) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        a += x[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        b ^= y[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (c &amp;gt; y[i])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            c = y[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        d = fmaxf(d,x[i]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;construct-cancellation&#34;&gt;Construct cancellation&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp cancel construct [if (expr)]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;constructor := parallel | sections | for | taskgroup&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; t = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel firstprivate(t)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp for
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;100&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        t = test();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp cancel for if (t == 5)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp cancel parallel if (t == 5)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp barrier
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Thread %d&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, omp_get_thread_num());
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;cancel åŠŸèƒ½é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¦‚æœéœ€è¦åˆ™è¦æŠŠç¯å¢ƒå˜é‡ OMP_CANCELLATION è®¾ç½®ä¸º trueï¼Œ&lt;code&gt;$OMP_CANCELLATION=true ./test&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;simd-constructs&#34;&gt;SIMD Constructs&lt;/h3&gt;
&lt;p&gt;OpenMP å¯¹å¹¶è¡Œå’Œä¸²è¡Œéƒ½æœ‰å‘é‡åŒ–æ”¯æŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp simd [clauses]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥å¯¹å¾ªç¯ä½¿ç”¨ï¼ŒæŒ‡ç¤ºè¿™ä¸ªå¾ªç¯è¿­ä»£å¯ä»¥ SIMD åˆ†å—æ‰§è¡Œ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp declare simd [clauses]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ ‡è®°è¿™ä¸ªå‡½æ•°å¯ä»¥è¢«ä¸€ä¸ª SIMD å¾ªç¯è°ƒç”¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp for simd [clauses]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¡¨ç¤ºå¾ªç¯å¯ä»¥åˆ†å—åè¢«çº¿ç¨‹ç»„æ‰§è¡Œï¼Œæ¯ä¸€å—éƒ½å¯ä»¥ SIMD å‘é‡åŒ–&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp declare simd
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;double&lt;/span&gt; inc(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; i + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; d1 = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, N = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;100&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;double&lt;/span&gt; a[N], b[N], d2 = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.0f&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp simd reduction(+: d1)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; N; ++i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        d1 += i * inc(i);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel for simd reduction(+: d2)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; N; ++i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        d2 += a[i] * b[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;device-constructs&#34;&gt;Device Constructs&lt;/h3&gt;
&lt;p&gt;OpenMP 4.0 å¼€å§‹æ”¯æŒå¼‚æ„è®¡ç®—ï¼Œå¯ä»¥å°†è®¡ç®—éƒ¨åˆ†æ”¾åˆ°å…¶ä½™çš„ target ä¸Šå®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ map è¯­å¥ä¸­ï¼Œæœ‰ä¸¤ç§æ˜ å°„ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ to å’Œ fromï¼Œå®šä¹‰äº† original(host) å’Œ target(device) ä¹‹é—´çš„æ•°æ®æ˜ å°„&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;to: åœ¨ device ä¸Šåªè¯»&lt;/li&gt;
&lt;li&gt;from: åœ¨ device ä¸Šåªå†™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šè¿‡é™åˆ¶æ•°æ®çš„æƒé™ï¼Œå¯ä»¥å‡å°‘æ•°æ®ä¼ è¾“ä¸­çš„å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;target&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/openmp-target.png&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;#pragma omp target data&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºåé¢çš„ä»£ç åŸŸåˆ›å»ºä¸€ä¸ª device æ•°æ®ç¯å¢ƒï¼Œå®ƒçš„ä½œç”¨åªæ˜¯å°†æ•°æ®ç§»åŠ¨åˆ° target ä¸Šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; vec_mult(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;float&lt;/span&gt; *p, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;float&lt;/span&gt; *v1, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;float&lt;/span&gt; *v2, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; N)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp target data map(to: v1[0:N], v2[0:N]) map(from: p[0:N])
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp target
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel for
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; N; ++i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            p[i] = v1[i] * v2[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    output(p, N);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img alt=&#34;target&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/openmp-target-data-map.png&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;#pragma omp target&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ª device æ•°æ®ç¯å¢ƒï¼Œå¹¶åœ¨è¿™ä¸ª target ä¸Šæ‰§è¡Œä¹‹åç»“æ„ä¸­çš„è¯­å¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;#pragma omp target update&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ target åŸŸä¸­æ›´æ–°æ•°æ®&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp target update to(v1[:N], v2[:N]) &lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// å°†æ–°å€¼åˆ†é…ç»™ target ç¯å¢ƒ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;#pragma omp declare target&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æŒ‡ç¤ºå˜é‡æˆ–è€…å‡½æ•°è¢«æ˜ å°„åˆ°äº† device ä¸Šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp declare target
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; fib(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; N);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp end declare target
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define THRESHOLD 1000000
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; fib_wrapper(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp target if (n &amp;gt; THRESHOLD)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        fib(n);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;openmp-45&#34;&gt;OpenMP 4.5&lt;/h2&gt;
&lt;h3 id=&#34;parallelism--workshare-for-devices&#34;&gt;Parallelism &amp;amp; Workshare for devices&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;omp teams [clause[[,] clause], &amp;hellip;] newline structured-block&lt;/li&gt;
&lt;li&gt;omp distribute [clause[[,] clause], &amp;hellip;] newline for-loops&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;openmp-50&#34;&gt;OpenMP 5.0&lt;/h2&gt;
</description>
    </item>
    
    <item>
      <title>OpenMPå…¥é—¨</title>
      <link>https://vaaandark.top/posts/openmp-introduction/</link>
      <pubDate>Fri, 29 Jul 2022 09:03:18 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/openmp-introduction/</guid>
      <description>&lt;p&gt;å†™ OpenMP çš„æ—¶å€™æ€»æ˜¯æ„Ÿè§‰æ€ªæ€ªçš„ï¼Œä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ä»€ä¹ˆï¼Œæ‰€ä»¥æœ€è¿‘ç³»ç»ŸåŒ–åœ°çœ‹ä¸€é OpenMP çš„ä½¿ç”¨ï¼Œä¸»ä½“ä¸º OpenMP 2.0 å’Œ 3.0ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;what-is-openmp&#34;&gt;What is OpenMP?&lt;/h2&gt;
&lt;h3 id=&#34;openmp-model&#34;&gt;OpenMP Model&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å¯ä»¥è®¿é—®å…¨å±€çš„å…±äº«å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®å¯ä»¥æ˜¯å…±äº«çš„ä¹Ÿå¯ä»¥æ˜¯ç§æœ‰çš„ã€‚&lt;/li&gt;
&lt;li&gt;å…±äº«çš„æ•°æ®å¯ä»¥è¢«æ‰€æœ‰çº¿ç¨‹è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;ç§æœ‰æ•°æ®åªèƒ½è¢«æ‹¥æœ‰å®ƒçš„çº¿ç¨‹è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®çš„ä¼ é€’å¯¹äºç¼–ç¨‹è€…æ˜¯é€æ˜çš„ã€‚&lt;/li&gt;
&lt;li&gt;åŒæ­¥ä¼šå‘ç”Ÿï¼Œä½†æ˜¯å®ƒå¤§éƒ¨åˆ†æ—¶å€™æ˜¯éšå¼çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;OpenMP Model&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/openmp-model.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;data-sharing-attributes&#34;&gt;Data-Sharing Attributes&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸€ä¸ª OpenMP ç¨‹åºä¸­ï¼Œæ•°æ®éœ€è¦è¢«æ‰“ä¸Šæ ‡ç­¾ï¼Œæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…±äº«çš„
&lt;ul&gt;
&lt;li&gt;åªæœ‰ä¸€ä¸ªæ•°æ®çš„å®ä¾‹&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¯ä»¥åŒæ­¥åœ°è¯»æˆ–è€…å†™ï¼Œé™¤éæœ‰ç‰¹å®šçš„ OpenMP ç»“æ„ä¿æŠ¤å®ƒ&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰æ•°æ®å˜åŒ–éƒ½å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½†æ˜¯é™¤éå¼ºåˆ¶ï¼Œå¹¶ä¸éœ€è¦å˜åŒ–ç«‹å³å¯è§&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;ç§æœ‰çš„
&lt;ul&gt;
&lt;li&gt;æ¯ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ä¸€ä»½æ•°æ®çš„æ‹·è´&lt;/li&gt;
&lt;li&gt;å…¶ä»–çº¿ç¨‹æ— æƒè®¿é—®è¯¥æ•°æ®&lt;/li&gt;
&lt;li&gt;æ•°æ®å˜åŒ–åªå¯¹æ‹¥æœ‰è€…çº¿ç¨‹å¯è§&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å…¶ä½™çš„ä¸€äº›ç±»å‹ä¹Ÿæ˜¯åŸºäºä»¥ä¸Šå˜åŒ–è€Œæ¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;the-openmp-execution-model&#34;&gt;The OpenMP Execution Model&lt;/h3&gt;
&lt;p&gt;OpenMP ç¨‹åºæ‰§è¡Œæ¨¡å‹è¢«ç§°ä¸º Fork and Join Modelï¼Œåœ¨ä¸éœ€è¦å¹¶è¡Œæ‰§è¡Œæ—¶åªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œåœ¨éœ€è¦å¹¶è¡Œæ—¶ Fork å‡ºå¤šä¸ª Worker çº¿ç¨‹ï¼Œåœ¨ç»å†äº†åŒæ­¥ä¹‹å Join åˆ°ä¸€ä¸ªä¸»çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;Fork and Join&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/openmp-fork-and-join-model.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;how-to-use-openmp&#34;&gt;How to use OpenMP?&lt;/h2&gt;
&lt;h3 id=&#34;a-first-openmp-example&#34;&gt;A first OpenMP example&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;omp.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;# pragma omp parallel for num_threads(4)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;20&lt;/span&gt;; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Hello from thread %d of %d&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;			omp_get_thread_num(), \
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;			omp_get_num_threads());
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc -o for for.c -fopenmp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./for
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœä¸æŒ‡å®šçº¿ç¨‹æ•°ï¼Œå°±ä¼šé»˜è®¤ä½¿ç”¨ CPU å®é™…èƒ½åŒæ—¶è¿è¡Œçš„ä¸ªæ•°ï¼Œåœ¨æˆ‘çš„ 8 æ ¸ 16 çº¿ç¨‹çš„ç”µè„‘ä¸Šå°±æ˜¯ 16 ä¸ªçº¿ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;matrix-example&#34;&gt;Matrix example&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;# pragma omp parallel for default(none) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;    private(i, j, sum) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;    shared(m, n, a, b, c)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; m; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sum = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0.0f&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (j = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; j &amp;lt; n; ++j) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sum += b[i][j] * c[j];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    a[i] = sum;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;ä»¥ #pragma å¼€å¤´çš„è¯­å¥è¦å†™åœ¨åŒä¸€è¡Œï¼ˆç±»ä¼¼å®ï¼‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;a-more-elaborate-example&#34;&gt;A more elaborate example&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;# pragma omp parallel if (n&amp;gt;limit) default(none) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;    shared(n, a, b, c, x, y, z) private(f, i, scale)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// ä½¿ç”¨ if è¯­å¥æ¥é¿å…å› ä¸ºçŸ©é˜µè¿‡å°å¯¼è‡´çš„å¹¶è¡Œè¡°é€€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    f = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1.0f&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;# pragma omp for nowait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// nowait æ¯ä¸ªçº¿ç¨‹å®Œæˆè‡ªå·±çš„å·¥ä½œåä¸ç­‰å¾…å…¶ä»–çº¿ç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// è€Œæ˜¯ç›´æ¥æ‰§è¡Œåé¢çš„ä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; n; ++i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        z[i] = x[i] + y[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;# pragma omp for nowait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; n; ++i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        a[i] = b[i] + c[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;# pragma omp barrier
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// åœ¨æ­¤å¤„æ˜¾ç¤ºè¯´æ˜è¦åŒæ­¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    scale = sum(a, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, n) + sum(z, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) + f;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;openmp-in-some-more-detail&#34;&gt;OpenMp in Some More Detail&lt;/h2&gt;
&lt;h3 id=&#34;terminology-and-behavior&#34;&gt;Terminology and behavior&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;OpenMP Team := Master + Worker&lt;/li&gt;
&lt;li&gt;å¹¶è¡ŒåŸŸ(Parallel Region)æ˜¯æ‰€æœ‰çº¿ç¨‹åŒæ­¥æ‰§è¡Œçš„ä»£ç å—
&lt;ul&gt;
&lt;li&gt;ä¸»çº¿ç¨‹ ID æ°¸è¿œæ˜¯ 0&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹è°ƒæ•´ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰éƒ½åªä¼šåœ¨è¿›å…¥å¹¶è¡ŒåŸŸä¹‹åå®Œæˆ&lt;/li&gt;
&lt;li&gt;å¹¶è¡ŒåŸŸæ˜¯å¯ä»¥åµŒå¥—çš„&lt;/li&gt;
&lt;li&gt;if è¯­å¥å¯ä»¥ç”¨äºå¹¶è¡ŒåŸŸï¼Œå¦‚æœä¸ºå‡åˆ™ä¼šä¸²è¡Œæ‰§è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€ä¸ª work-sharing ç»“æ„(ä¾‹å¦‚ Single, Sections ç­‰)åœ¨åˆ†é…ä»»åŠ¡ç»™ team ä¸­çš„æˆå‘˜&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;the-if--private--shared-clauses&#34;&gt;The if / private / shared clauses&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;if (scalar expression)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;private(list)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;firstprivate(list)&lt;/code&gt; åœ¨ç¬¬ä¸€ä¸ªå¾ªç¯ç»§æ‰¿å…±äº«å˜é‡çš„å€¼&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lastprivate(list)&lt;/code&gt; æ ¹æ®é€»è¾‘ä¸Šçš„æœ€åä¸€ä¸ªçº¿ç¨‹ç»™å…±äº«å˜é‡èµ‹å€¼ï¼ˆä¸æ˜¯å®é™…è¿è¡Œå®Œçš„æœ€åä¸€ä¸ªçº¿ç¨‹ï¼Œå¯¹äº for å¾ªç¯å°±æ˜¯æœ€åä¸€æ¬¡è¿­ä»£çš„å€¼ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;shared(list)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;the-nowait-clause&#34;&gt;The nowait clause&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†æœ€å°åŒ–åŒæ­¥å¸¦æ¥çš„æŸå¤±ï¼Œå¯ä»¥ä½¿ç”¨ nowait ã€‚å¦‚æœå‡ºç°äº† nowait ï¼Œçº¿ç¨‹å°†åœ¨ç‰¹å®šä»£ç å—ä¹‹åä¸åŒæ­¥æˆ–è€…ç­‰å¾…ã€‚&lt;/p&gt;
&lt;h3 id=&#34;the-sections-directive&#34;&gt;The sections directive&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel default(none) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;    shared(n,a,b,c,d) private(i)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp sections nowait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// ä¸‹é¢ä¸¤ä¸ª section æ˜¯å¹¶è¡Œçš„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp section
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; n - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; ++i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            b[i] = (a[i] + a[i + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;] / &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp section
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; n; ++i)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            d[i] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1.0f&lt;/span&gt; / c[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#007f7f&#34;&gt;/*-- End of sections --*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} &lt;span style=&#34;color:#007f7f&#34;&gt;/*-- End of parallel region --*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;single-processor-region&#34;&gt;Single processor region&lt;/h3&gt;
&lt;p&gt;è¿™ç§ç»“æ„ä½œ I/O æˆ–è€…åˆå§‹åŒ–éå¸¸ç†æƒ³ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚åœ¨ä¸€ä¸ªå¹¶è¡ŒåŸŸä¸­éœ€è¦è¿›è¡Œ IO æ“ä½œï¼Œè¿™æ—¶å¯ä»¥åœ¨è¯»å–åæ”¾ä¸€ä¸ª barrier ï¼Œä½†æ˜¯æ ¹æ® Amdahl å®šç†ï¼Œè¿™ä¼šæˆä¸ºæ‹“å±•è¿™æ®µä»£ç æ—¶çš„ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;bottleneck&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/openmp-single.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶å¯ä»¥ä½¿ç”¨ single æˆ–è€… master å°†ä»»åŠ¡åªåˆ†é…ç»™ä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶ä¸­ master åªä¼šåˆ†é…ç»™ master çº¿ç¨‹ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ— è®ºæ˜¯åœ¨å…¥å£è¿˜æ˜¯å‡ºå£éƒ½æ²¡æœ‰ä½¿ç”¨ barrier ã€‚&lt;/p&gt;
&lt;h3 id=&#34;critical-region&#34;&gt;Critical Region&lt;/h3&gt;
&lt;p&gt;åœ¨å¦‚ä¸‹ä»£ç å—ä¸­ï¼Œå¦‚æœ sum æ˜¯ä¸€ä¸ªå…±äº«å˜é‡ï¼Œé‚£ä¹ˆå°±å¯èƒ½åœ¨å¹¶è¡Œä¸­å‘ç”Ÿæ•°æ®ç«äº‰çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; N; ++i) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    sum += a[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ critical region ï¼Œåœ¨åŒä¸€æ—¶é—´æ®µå†…åªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥è¯­å¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp critical [(name)]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img alt=&#34;critical region&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/openmp-critical-region.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ‰çš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨ Atomic ï¼Œä½†æ˜¯è¦æ³¨æ„ Atomic åªæ˜¯åŸå­åœ°è½½å…¥å’Œå­˜å‚¨ï¼Œå®ƒä»¬å¹¶ä¸å®Œå…¨ç­‰æ•ˆã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;èƒ½ç”¨ Atomic æ—¶å°½é‡ä½¿ç”¨ Atomic ï¼Œå› ä¸ºå…¶æ›´åŠ è½»é‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp atomic [(name)]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;openmp-30-supports-for-tasks&#34;&gt;OpenMP 3.0 supports for TASKS&lt;/h2&gt;
&lt;p&gt;åœ¨ 3.0 ç‰ˆæœ¬ä¸­ï¼ŒOpenMP å¢åŠ äº†å¯¹ task çš„æ”¯æŒï¼Œæ›´å¤šçš„ä¸œè¥¿å¯ä»¥å¹¶è¡ŒåŒ–äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;a-linked-list-example&#34;&gt;A Linked List Example&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt;(my_pointer) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;)do_independent_work(my_pointer);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    my_pointer = my_pointer-&amp;gt;next ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} &lt;span style=&#34;color:#007f7f&#34;&gt;// End of while loop
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¿°ä»£ç åœ¨ OpenMP 2.0 ä¸­æƒ³è¦å¹¶è¡ŒåŒ–ä¼šè¾ƒä¸ºå›°éš¾ï¼Œä½†æ˜¯åœ¨ 3.0 å¢åŠ äº†å¯¹ task çš„æ”¯æŒä¹‹åä¾¿å®¹æ˜“äº†è®¸å¤šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp parallel
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp single nowait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (my_pointer) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#pragma omp task firstprivate(my_pointer)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#007f7f&#34;&gt;// task åœ¨æ­¤å¤„å¹¶è¡Œæ‰§è¡Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;)do_independent_work(my_pointer)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            my_pointer = my_pointer-&amp;gt;next;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#007f7f&#34;&gt;// End of single - no implied barrier (nowait)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#007f7f&#34;&gt;// End of parallel region - implied barrier
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.openmp.org/resources/tutorials-articles/&#34;&gt;OpenMP Tutorials&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.openmp.org/wp-content/uploads/ntu-vanderpas.pdf&#34;&gt;An Overview of OpenMP - Ruud van der Pas - Sun Microsystems&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.openmp.org/wp-content/uploads/Intro_To_OpenMP_Mattson.pdf&#34;&gt;Tim Matton&amp;rsquo;s &amp;ldquo;Introduction fo OpenMP&amp;rdquo;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ä¸ƒæœˆéšç¬”</title>
      <link>https://vaaandark.top/posts/essay-in-july/</link>
      <pubDate>Thu, 28 Jul 2022 21:47:18 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/essay-in-july/</guid>
      <description>&lt;p&gt;çªç„¶å‘ç°è‡ªå·±ä»é«˜äºŒä»¥æ¥åŸºæœ¬æ²¡æœ‰è¯»è¿‡â€œé—²ä¹¦â€ï¼Œæ„è¯†åˆ°è¿™å¯èƒ½æ­£æ˜¯ç°åœ¨è¯¸å¤šçƒ¦æ¼çš„åŸå› ä¹‹ä¸€å§â€¦â€¦&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;å…¶å®ä»åˆä¸­ä»¥æ¥ï¼Œæˆ‘æ‰€é˜…è¯»ä¹¦ç±çš„æ–‡å­¦æ€§éƒ½æ˜¯åœ¨ä¸‹é™çš„ï¼Œæˆ‘çœ‹è¿‡çš„å¤§éƒ¨åˆ†æ–‡å­¦åè‘—éƒ½æ˜¯åœ¨åˆä¸­åŠä¹‹å‰çœ‹çš„ï¼Œåœ¨ä¹‹åå°±æ˜¯ç§‘å¹»å’Œä¸€äº›åŠŸèƒ½æ€§çš„ä¹¦äº†ï¼Œå†å°±æ˜¯å„ç§è¯„è®ºæ€§çš„æ–‡ç« ï¼ŒæŠ‘æˆ–æ˜¯çœ‹ä¸æ‡‚ä¹Ÿè¦çœ‹çš„å“²å­¦æˆ–è€…è¯—æ­Œã€‚&lt;/p&gt;
&lt;p&gt;ä»¥æ•£æ–‡ä¸ºä¾‹ï¼Œåœ¨é«˜ä¸­å°±ä¹°äº†çš„ä¸€äº›æˆ‘è¾ƒä¸ºå–œæ¬¢ä½œå®¶çš„æ–‡é›†è¢«æˆ‘å¸¦åˆ°äº†åç§‘ï¼Œä½†åˆ°ç°åœ¨éƒ½è¿˜åªç¿»åŠ¨äº†å‡ é¡µã€‚è€Œé«˜ä¸­è¯­æ–‡è€å¸ˆé€ç»™æˆ‘çš„ã€Šæœˆäº®ä¸å…­ä¾¿å£«ã€‹ã€ã€Šç½—ç”Ÿé—¨ã€‹ä¹Ÿè¢«æˆ‘è¿å¸¦ç€åŒ…è£…å¹³ç§»åˆ°äº†å®¿èˆåƒç°ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªâ€œä¸­åœŸâ€è¿·ï¼Œæˆ‘çš„ã€Šç²¾çµå®é’»ã€‹ä¹Ÿæ˜¯å°šæœªæ‹†å°ï¼Œä¹Ÿæ²¡æœ‰å†èŠ±æ—¶é—´é‡æ¸©ç”µå½±ã€‚è”æƒ³åˆ°æœ€è¿‘åœ¨çœ‹çš„ã€Šå“ˆåˆ©æ³¢ç‰¹ã€‹ï¼Œä¹Ÿæ˜¯è¢«æˆ‘å›«å›µåæ£èˆ¬çœ‹äº†ä¸‰éƒ¨ï¼ŒæœŸé—´å¤¹æ‚ç€å¿«æ”¾ä»¥åŠxxè®²ç”µå½±çš„å‰§é€ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¥½åƒå¤±å»äº†æ¬£èµæ–‡å­¦è‰ºæœ¯çš„èƒ½åŠ›ï¼Œä»¥å‰é‚£ä¸ªæŠŠå°å­¦åŒå­¦ä¹¦éƒ½çœ‹å®Œäº†çš„æˆ‘å¥½åƒä¸è§äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸€ä¸ªé˜…è¯»åªæ³¨é‡æ•ˆæœçš„å·¥å…·ã€ä¸€ä¸ªæ—¶æ—¶åˆ»åˆ»æƒ³çœ‹â€œé”è¯„â€æˆ–è€…å‘è¡¨â€œé”è¯„â€çš„â€œå¤§è¯„è®ºå®¶â€â€œå¤§é˜´é˜³å¸ˆâ€ã€ä¸€ä¸ªåªæƒ³â€œå¼€å¤©çœ¼â€åˆ°ç»“å±€çš„â€œå¿«é¤é£Ÿå®¢â€ã€‚æˆ‘çš„çŸ­è§†ã€æš´æˆ¾ã€å°–é…¸åˆ»è–„ã€æ— çŸ¥å’Œæµ…è–„å¥½åƒå°±æ´¾ç”Ÿäºæ­¤ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›èƒ½å°‘çœ‹ä¸€äº›çœ‹ä¼¼èƒ½æ¶¨çŸ¥è¯†çš„è§†é¢‘ï¼Œå¤šçœ‹ç‚¹ä¹¦å§ï¼Œå°±ä»è¿™å‡ æœ¬å¼€å§‹å§â€¦â€¦&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¹‹åæ‰“ç®—å»è¯»è¯»ä¸€ç›´æƒ³è¯»çš„å¡å°”ç»´è¯ºã€å¡å¤«å¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;ä¹¦&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/essay-2022-07-28.jpg&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Lua Coroutine</title>
      <link>https://vaaandark.top/posts/lua-coroutine/</link>
      <pubDate>Fri, 13 May 2022 15:19:09 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/lua-coroutine/</guid>
      <description>&lt;p&gt;Lua çš„ä¸€å¤§ç‰¹è‰²å°±æ˜¯åç¨‹çš„ä½¿ç”¨ï¼Œåœ¨è§£é‡Šå‹è¯­è¨€ä¸­ï¼Œå¦‚æœä¸è€ƒè™‘åµŒå…¥åˆ°è¾ƒä¸ºä½çº§çš„è¯­è¨€ï¼ˆå¦‚ C è¯­è¨€ï¼‰ä¸­ï¼Œå°±åªéœ€è¦æ“ä½œè°ƒç”¨æ ˆå¹¶ä¿å­˜å¥½ä¸Šä¸‹æ–‡çŠ¶æ€å³å¯ã€‚ä½†æ˜¯ Lua å¹¶ä¸æ˜¯ä¸€é—¨çº¯ç²¹ä¾é å­—èŠ‚ç çš„è§£é‡Šå‹è¯­è¨€ï¼Œå®ƒå¸¸å¸¸ä¸ C è¯­è¨€åå¤åµŒå¥—ï¼Œç”šè‡³å‡ºç° C ä¸­è°ƒç”¨ Lua ï¼ŒLua ä¸­å†è°ƒç”¨ C ä»£ç ï¼Œï¼Œï¼Œçš„æƒ…å†µã€‚ä¸€æ—¦ Lua è°ƒç”¨çš„ C åº“ä¼å›¾ä¸­æ–­çº¿ç¨‹ï¼Œå†æƒ³æ¢å¤ï¼Œå°±ä¼šæ˜¯ä¸€ä¸ªéš¾é¢˜ã€‚å¥½åœ¨ Lua å·§å¦™åœ°è§£å†³äº†è¿™äº›é—®é¢˜ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;lua-è™šæ‹Ÿæœºé‡è¦ç»“æ„ä½“&#34;&gt;Lua è™šæ‹Ÿæœºé‡è¦ç»“æ„ä½“&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;global_State&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;global_State ç”±æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå…¶ä¸­åŒ…å«å­—ç¬¦ä¸²å†…éƒ¨åŒ–ä¿å­˜çš„å“ˆå¸Œè¡¨ã€åƒåœ¾å›æ”¶ã€å¼‚å¸¸å¤„ç†ç­‰ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lua_State&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;lua_State è¡¨ç¤ºä¸€ä¸ª Lua çº¿ç¨‹çš„æ‰§è¡ŒçŠ¶æ€ï¼Œå®ƒæœ‰ç€è‡ªå·±ç‹¬ç«‹çš„æ•°æ®æ ˆå’Œå‡½æ•°è°ƒç”¨æ ˆã€‚æ¯ä¸ª lua_State éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘ global_State çš„æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** &amp;#39;per thread&amp;#39; state
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; lua_State {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  CommonHeader;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lu_byte status;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lu_byte allowhook;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;short&lt;/span&gt; nci;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* number of items in &amp;#39;ci&amp;#39; list */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  StkId top;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* first free slot in the stack */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  global_State *l_G;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  CallInfo *ci;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* call info for current function */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  StkId stack_last;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* end of stack (last element + 1) */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  StkId stack;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* stack base */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  UpVal *openupval;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* list of open upvalues in this stack */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  StkId tbclist;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* list of to-be-closed variables */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  GCObject *gclist;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; lua_State *twups;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* list of threads with open upvalues */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; lua_longjmp *errorJmp;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* current error recover point */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  CallInfo base_ci;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* CallInfo for first level (C calling Lua) */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;volatile&lt;/span&gt; lua_Hook hook;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;ptrdiff_t&lt;/span&gt; errfunc;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* current error handling function (stack index) */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  l_uint32 nCcalls;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* number of nested (non-yieldable | C)  calls */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; oldpc;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* last pc traced */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; basehookcount;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; hookcount;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;volatile&lt;/span&gt; l_signalT hookmask;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;æ•°æ®æ ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹æ•°æ®æ ˆåˆå§‹åŒ–å’Œé‡Šæ”¾åˆ†åˆ«è°ƒç”¨ stack_init å’Œ free_stack å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; stack_init (lua_State *L1, lua_State *L);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; freestack (lua_State *L);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ•°æ®æ ˆåˆå§‹å¤§å°æ˜¯ Lua å†…ç½®æ ˆç»“æ„çš„ä¸¤å€ï¼Œéšç€æ•°æ®çš„å¢å¤šéœ€è¦è°ƒç”¨ growstack è¿›è¡Œæ ˆçš„æ‰©å±•ã€‚å› ä¸ºæœ‰äº›æ•°æ®åŒ…å«äº†å¯¹æ ˆä¸­å…ƒç´ çš„å¼•ç”¨ï¼Œåœ¨æ ˆä¸­å…ƒç´ ç§»ä½ä¹‹åï¼Œåœ¨æ‰©å±•ä¹‹ä¸­è¦å¯¹æ ˆè¿›è¡Œä¿®æ­£ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define BASIC_STACK_SIZE        (2*LUA_MINSTACK)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; correctstack (lua_State *L, StkId oldstack, StkId newstack);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaD_reallocstack (lua_State *L, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; newsize, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; raiseerror);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaD_growstack (lua_State *L, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; n, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; raiseerror);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡æºä»£ç ä¸­çš„æ³¨é‡Šå¯ä»¥å¾ˆæ¸…æ™°çŸ¥æ™“è¿™äº›å‡½æ•°çš„ä½œç”¨ï¼Œå†ç»“åˆæºç ï¼Œå¯ä»¥å‘ç°è¿™ä¸‰ä¸ªå‡½æ•°çš„è°ƒç”¨å…³ç³»ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;luaD_growstack ---&amp;gt; luaD_reallocstack ---&amp;gt; correctstack
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;è°ƒç”¨æ ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‡½æ•°è°ƒç”¨æ ˆä½¿ç”¨çš„æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ç»“æ„ä½“ CallInfo ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; CallInfo {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  StkId func;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* function index in the stack */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  StkId	top;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* top for this function */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; CallInfo *previous, *next;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* dynamic call link */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;union&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* only for Lua functions */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; Instruction *savedpc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;volatile&lt;/span&gt; l_signalT trap;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nextraargs;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* # of extra arguments in vararg functions */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } l;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* only for C functions */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      lua_KFunction k;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* continuation in case of yields */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;ptrdiff_t&lt;/span&gt; old_errfunc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      lua_KContext ctx;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* context info. in case of yields */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } c;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  } u;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;union&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  } u2;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;short&lt;/span&gt; nresults;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* expected number of results from this function */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;short&lt;/span&gt; callstatus;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} CallInfo;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨è”åˆä½“ u ä¸­ï¼šå­—æ®µ l ç”¨äºè°ƒç”¨ Lua å‡½æ•°ï¼Œå­—æ®µ c ç”¨äºè°ƒç”¨ C å‡½æ•°ï¼Œcallstatus ç”¨äºæ ‡å¿—æ˜¯ Lua å‡½æ•°è¿˜æ˜¯ c å‡½æ•°ï¼›è”åˆä½“ u2 å’Œä¿æŠ¤æ¨¡å¼ã€é’©å­å‡½æ•°ç­‰æœ‰å…³ï¼Œæš‚ä¸è€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„åˆ°çš„æ˜¯ï¼Œæ—¢æœ‰ func åˆæœ‰ base çš„åŸå› æ˜¯ï¼ŒLua ä¼ å…¥ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ä¸ªæ•°å¯èƒ½ä¸å®šï¼Œé€šè¿‡å‡½æ•°ä½ç½®å’Œæ ˆåº•ä½ç½®ç›¸å‡å¯ä»¥è®¡ç®—å‡ºå‚æ•°ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;lua-çº¿ç¨‹&#34;&gt;Lua çº¿ç¨‹&lt;/h2&gt;
&lt;h3 id=&#34;åˆ›å»ºçº¿ç¨‹&#34;&gt;åˆ›å»ºçº¿ç¨‹&lt;/h3&gt;
&lt;p&gt;åœ¨ Lua ä¸­ä¹Ÿæœ‰çº¿ç¨‹çš„æ¦‚å¿µï¼Œä½†å®ƒå¹¶ä¸æ˜¯ç³»ç»Ÿçº¿ç¨‹ï¼Œè€Œä¸”ç”±äºæ‰€æœ‰çš„ lua_State éƒ½å…±äº«äº† global_State ï¼Œå› æ­¤å¤šçº¿ç¨‹æ“ä½œè¾ƒéš¾ã€‚åœ¨ Lua ä¸­ï¼Œåç¨‹æ‰æ˜¯æœ€å¼ºå¤§çš„æ­¦å™¨ã€‚&lt;/p&gt;
&lt;p&gt;Lua ç»™ C/C++ ä¿ç•™äº†å¾ˆå¤š API ï¼Œå…¶ä¸­å…³äºåˆ›å»ºçº¿ç¨‹çš„ API å¾ˆæœ‰æ„æ€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LUA_API lua_State *lua_newthread (lua_State *L) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* create new thread */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  L1 = &amp;amp;cast(LX *, luaM_newobject(L, LUA_TTHREAD, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;sizeof&lt;/span&gt;(LX)))-&amp;gt;l;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;//...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ›å»ºçº¿ç¨‹ç»“æ„ä½“æ—¶åˆ†é…ç©ºé—´çš„å¤§å°ä¸æ˜¯ Lua_State çš„å¤§å°ï¼Œè€Œæ˜¯ LX çš„å¤§å°ï¼Œè€Œä¸”å°† Lua_State æ”¾åœ¨äº† LX æ‰€åœ¨å†…å­˜çš„åä¸€éƒ¨åˆ†ï¼Œè¿™æ—¢æ˜¯ç»™è‡ªå®šä¹‰ Lua ä»£ç ç•™ä¸‹äº†ç©ºé—´ï¼Œä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢å‘ç”¨æˆ·æš´éœ² Lua_State çš„å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨å¤šçº¿ç¨‹æ“ä½œä¸­ï¼Œè®¿é—® lua_State ç»“æ„ä¸­æ³¨å†Œè¡¨æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯å¦‚æœä½ å°†ä¸€äº›ä¿¡æ¯æ”¾åœ¨ lua_State çš„å‰é¢ï¼Œå°±å¯ä»¥æ—¢æ–¹ä¾¿è®¿é—®åˆåœ¨æ•°æ®ç«äº‰ä¸­ä¿æŒå®‰å…¨ï¼ˆä¸å¤Ÿè¿™ä¹Ÿå¢åŠ äº†ä»£ç çš„å¤æ‚åº¦ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;çº¿ç¨‹ä¸­æ–­åŠå¼‚å¸¸å¤„ç†&#34;&gt;çº¿ç¨‹ä¸­æ–­åŠå¼‚å¸¸å¤„ç†&lt;/h3&gt;
&lt;p&gt;Lua å…¨éƒ¨æºç éƒ½ç”±æ ‡å‡† C å†™æˆè€Œä¸”åªä½¿ç”¨äº†æ ‡å‡†åº“ï¼Œå› æ­¤å®ƒçš„çº¿ç¨‹ä¸­æ–­å’Œé”™è¯¯å¤„ç†éƒ½ä½¿ç”¨çš„æ˜¯æ ‡å‡†åº“ä¸­çš„ setjmp.h æ¥å®ç°çš„ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å¼‚å¸¸&#34;&gt;å¼‚å¸¸&lt;/h4&gt;
&lt;p&gt;æˆ‘åœ¨ä¹‹å‰çš„ä¸€ç¯‡åšæ–‡ä¸­è®²åˆ°è¿‡ Cè¯­è¨€æ¥å£ä¸å®ç° ä¸­å®ç° C è¯­è¨€å¼‚å¸¸å¤„ç†çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯é€šè¿‡ setjmp.h æ¥å®ç°çš„ã€‚è€Œ Lua æºç æ›´è¿›ä¸€æ­¥ï¼Œé€šè¿‡å®å®šä¹‰å°†å¼‚å¸¸å¤„ç†å’Œ C++ ä¸­çš„åŸç”Ÿå¼‚å¸¸å¤„ç† try/catch è”ç³»èµ·æ¥ï¼Œä¹Ÿæ–¹ä¾¿äº†å¼€å‘è€…ä½¿ç”¨ C++ å¼€å‘ Lua ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;Lua ä¸­çš„å¼‚å¸¸æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼ˆé“¾æ ˆï¼‰ï¼Œå®ƒçš„è¡Œä¸ºä¹Ÿå¾ˆå¥½ç†è§£ï¼šå‡ºç°å¼‚å¸¸ï¼Œå°†å¼‚å¸¸ä¸²åˆ°é“¾è¡¨ä¸Šå¹¶æŠ›å‡ºï¼Œåœ¨å¤„ç†å®Œåå†ä½¿ç”¨ longjmp è·³å›æ¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;/* chain list of long jump buffers */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; lua_longjmp {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; lua_longjmp *previous;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  luai_jmpbuf b;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;volatile&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; status;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* error code */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;å‡½æ•°&#34;&gt;å‡½æ•°&lt;/h4&gt;
&lt;p&gt;Lua çš„å‡½æ•°è°ƒç”¨è¿‡ç¨‹åˆ†ä¸º precall å’Œ poscall ä¸¤ä¸ªéƒ¨åˆ†ï¼šå¯¹äº C è¯­è¨€å‡½æ•°æ¥è¯´ï¼Œprecall è°ƒç”¨äº†å®ƒï¼›è€Œå¯¹äº Lua å‡½æ•°æ¥è¯´ï¼Œprecall æ˜¯ä¸ºäº†å®ƒçš„è°ƒç”¨åšå‡†å¤‡ï¼Œåªæ˜¯æ”¹å˜äº† Lua è™šæ‹Ÿæœºï¼ˆlua_Stateï¼‰çš„çŠ¶æ€è€Œå·²ï¼Œå¹¶æ²¡æœ‰çœŸæ­£è°ƒç”¨ã€‚poscall å¤„ç†äº†å®ƒçš„è¿”å›ï¼Œå¯¹æ•°æ®æ ˆè¿›è¡Œäº†è°ƒæ•´ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CallInfo *luaD_precall (lua_State *L, StkId func, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nresults) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; retry:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;switch&lt;/span&gt; (ttypetag(s2v(func))) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;case&lt;/span&gt; LUA_VCCL:  &lt;span style=&#34;color:#007f7f&#34;&gt;/* C closure */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	  &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;case&lt;/span&gt; LUA_VLCF:  &lt;span style=&#34;color:#007f7f&#34;&gt;/* light C function */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	  &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;case&lt;/span&gt; LUA_VLCL: {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* Lua function */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;default&lt;/span&gt;: {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* not a function */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      func = luaD_tryfuncTM(L, func);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* try to get &amp;#39;__call&amp;#39; metamethod */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#007f7f&#34;&gt;/* return luaD_precall(L, func, nresults); */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;goto&lt;/span&gt; retry;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* try again with metamethod */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; luaD_poscall (lua_State *L, CallInfo *ci, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nres);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;StkId luaD_tryfuncTM (lua_State *L, StkId func);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ° precall é‡Œé¢ switch/case ä¸­çš„ default åˆ†æ”¯ï¼Œé‡Œé¢è°ƒç”¨äº† luaD_tryfuncTM å‡½æ•°ï¼Œè¿™æ¶‰åŠäº† Lua ä¸­çš„å…ƒè¡¨ï¼ˆMeta Tableï¼‰ï¼Œç®€å•æ¥è¯´å°±æ˜¯ï¼Œå½“åœ¨è¡¨ä¸­æ‰¾ä¸åˆ°å…ƒç´ æ—¶å°±ä¼šå°è¯•åœ¨è¡¨å¯¹åº”çš„å…ƒè¡¨ä¸­å¯»æ‰¾ã€‚Lua å°±æ˜¯åˆ©ç”¨å…ƒè¡¨å®ç°äº†ç±»ä¼¼äº Java ä¸­çš„æ¥å£ã€C++ ä¸­çš„è™šå‡½æ•°ã€Rust ä¸­çš„ Traitï¼Œä»¥åŠé‡è½½è¿ç®—ç¬¦ç­‰æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨ C è¯­è¨€å¼€å‘å¹¶å°† Lua ä»£ç åµŒå…¥å…¶ä¸­æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ API luaD_call ï¼Œå®ƒæ˜¯ ccall çš„ä¸€ä¸ªåŒ…è£…ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; luaD_call (lua_State *L, StkId func, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nResults) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ccall(L, func, nResults, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;l_sinline &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; ccall (lua_State *L, StkId func, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nResults, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; inc) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  CallInfo *ci;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  L-&amp;gt;nCcalls += inc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (l_unlikely(getCcalls(L) &amp;gt;= LUAI_MAXCCALLS))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    luaE_checkcstack(L);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; ((ci = luaD_precall(L, func, nResults)) != &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;NULL&lt;/span&gt;) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* Lua function? */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ci-&amp;gt;callstatus = CIST_FRESH;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* mark that it is a &amp;#34;fresh&amp;#34; execute */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    luaV_execute(L, ci);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* call it */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  L-&amp;gt;nCcalls -= inc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‚æ•° inc ä»£è¡¨çš„æ˜¯åœ¨ C å‡½æ•°æ ˆä¸­é€’å½’å‡½æ•°çš„ä¸ªæ•°ï¼Œè€Œ lua_State å®ä¾‹ L ä¸­çš„ nCcalls ä»£è¡¨çš„æ˜¯åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­è¢«ä¸­æ–­åå°±ä¸èƒ½æ¢å¤çš„ C å‡½æ•°ï¼ˆnon-yieldedï¼Œåœ¨è€ç‰ˆæœ¬ä¸­åå­—å«åš nny)ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä»ä¸­æ–­ä¸­æ¢å¤&#34;&gt;ä»ä¸­æ–­ä¸­æ¢å¤&lt;/h4&gt;
&lt;p&gt;ç»ˆäºåˆ°äº†å¦‚ä½•è§£å†³ä»ä¸­æ–­ä¸­æ¢å¤è¿™ä¸ªé—®é¢˜äº†ã€‚Lua ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆå…¶å®ä¹Ÿä¸éš¾ï¼Œå°±æ˜¯è®©ç¼–å†™ C ç¨‹åºçš„å¼€å‘è€…è¾›è‹¦ä¸€ç‚¹è€Œå·²ï¼Œä¹Ÿå°±æ˜¯è®©ä»–ä»¬è‡ªå·±æä¾›ä¸€ä¸ªå»¶ç»­å‡½æ•° k ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å›é¡¾ä¸€ä¸‹ CallInfo ç»“æ„ä½“ä¸­çš„ c å­—æ®µï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* only for C functions */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_KFunction k;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* continuation in case of yields */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;ptrdiff_t&lt;/span&gt; old_errfunc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_KContext ctx;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* context info. in case of yields */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} c;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;k å°±æ˜¯å»¶ç»­å‡½æ•°ï¼Œè€Œ ctx å°±ä¿å­˜æœ‰ yield æ—¶çš„ä¸Šä¸‹æ–‡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä½¿ç”¨ k æ—¶ï¼Œåªéœ€è¦æŠŠå®ƒå½“ä½œå›è°ƒå‡½æ•°ï¼Œå°†å®ƒå’Œè™šæ‹Ÿæœºå®ä¾‹ L ä¸€èµ·ä¼ å…¥ API lua_callk ä¸­å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ C çº¿ç¨‹éœ€è¦æŒ‚èµ·æ—¶å°±è¦è°ƒç”¨ lua_yieldk æ¥ä¿å­˜æ¢å¤æ—¶éœ€è¦çš„ä¸Šä¸‹æ–‡ç­‰ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LUA_API &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; lua_yieldk (lua_State *L, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nresults, lua_KContext ctx, lua_KFunction k);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ lua_yieldk ä¸­ä¿å­˜ä¿¡æ¯å‰è¦è¿›è¡Œ lua_lock(L)ï¼Œä¹‹åè¦ lua_unlock(L) é‡Šæ”¾é”ï¼Œä½†æ˜¯åœ¨æºç ä¸­ è¿™ä¸¤ä¸ªå®éƒ½æ˜¯ä¸å®Œæ•´çš„ï¼Œéƒ½è¢«æ‹“å±•ä¸º&lt;code&gt;(void (0))&lt;/code&gt;ï¼Œåœ¨éœ€è¦åŒæ­¥çš„æ—¶å€™è¦æ³¨æ„å¯¹å®ƒä»¬è¿›è¡Œè¡¥å……ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lua åç¨‹è®©å‡ºæ—¶ä¹Ÿéœ€è¦è°ƒç”¨ lua_yieldk ï¼Œè¿™æ”¾åœ¨åç¨‹éƒ¨åˆ†è®¨è®ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨æ¢å¤æ—¶ Lua å†…éƒ¨è°ƒç”¨çš„å‡½æ•°æ˜¯ resume å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; resume (lua_State *L, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; *ud) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (isLua(ci)) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* yielded inside a hook? */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    L-&amp;gt;top = firstArg;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* discard arguments */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    luaV_execute(L, ci);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* just continue running Lua code */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* &amp;#39;common&amp;#39; yield */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (ci-&amp;gt;u.c.k != &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;NULL&lt;/span&gt;) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* does it have a continuation function? */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      lua_unlock(L);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      n = (*ci-&amp;gt;u.c.k)(L, LUA_YIELD, ci-&amp;gt;u.c.ctx); &lt;span style=&#34;color:#007f7f&#34;&gt;/* call continuation */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      lua_lock(L);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      api_checknelems(L, n);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    luaD_poscall(L, ci, n);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* finish &amp;#39;luaD_call&amp;#39; */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  unroll(L, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;NULL&lt;/span&gt;);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* run continuation */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°å¦‚æœæ˜¯è¦æ¢å¤ä¸€ä¸ª Lua å‡½æ•°å°±ç›´æ¥ç»§ç»­æ‰§è¡Œå°±å¯ä»¥äº†ï¼Œå¦‚æœæ˜¯ä¸€ä¸ª C å‡½æ•°åˆ™éœ€è¦è°ƒç”¨å»¶ç»­å‡½æ•°ï¼Œå†ä½¿ç”¨ poscall å¤„ç†è¿”å›å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ resume ç›¸å…³çš„ API æœ‰ lua_resumeï¼Œåªæ˜¯å¯¹ resume çš„åŒ…è£…è€Œå·²ï¼Œè¾ƒä¸ºç®€å•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;lua-åç¨‹&#34;&gt;Lua åç¨‹&lt;/h2&gt;
&lt;p&gt;è®¨è®ºå®Œäº†ä¸Šé¢çš„çº¿ç¨‹é—®é¢˜ï¼Œç°åœ¨éœ€è¦è®²çš„åç¨‹å°±æ˜¯å°èœä¸€ç¢Ÿäº†ã€‚Lua çš„åç¨‹å®é™…ä¸Šå°±æ˜¯ Lua çº¿ç¨‹é—´çš„åˆ‡æ¢ï¼ˆè€Œéç³»ç»Ÿçº¿ç¨‹ï¼Œæ•…æ€§èƒ½æŸå¤±è¾ƒå°‘ï¼‰ï¼Œéœ€è¦è€ƒè™‘çš„åªæœ‰é”™è¯¯ä¿¡æ¯çš„ move ä»¥åŠæ–°åˆ‡æ¢åˆ°çš„çº¿ç¨‹çš„ resume é—®é¢˜ï¼Œè€Œ resume çš„å®ç°åœ¨å‰æ–‡å·²ç»è®¨è®ºè¿‡äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åç¨‹çš„åˆ›å»º&#34;&gt;åç¨‹çš„åˆ›å»º&lt;/h3&gt;
&lt;p&gt;å¯¹åº” Lua è¯­å¥ï¼š &lt;code&gt;lua coroutine.create()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç”±äº Lua åç¨‹æ˜¯ä¸å¯¹ç§°çš„ï¼Œæ•…åˆ›å»ºåç¨‹æ—¶æœ‰ä¸€ä¸ªå‚æ•°ä¼šæ˜¯åˆ›å»ºåç¨‹çš„åç¨‹ L ï¼Œå¹¶ä» L ä¸­ move å‡½æ•°ä¿¡æ¯åˆ°æ–°åˆ›å»ºçš„ NL ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaB_cocreate (lua_State *L) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_State *NL;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  luaL_checktype(L, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, LUA_TFUNCTION);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  NL = lua_newthread(L);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_pushvalue(L, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* move function to top */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_xmove(L, NL, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* move function from L to NL */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;luaB_cowrap æ˜¯å¯¹å‡½æ•° luaB_coreate çš„ä¸€å±‚å°è£…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaB_cowrap (lua_State *L) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  luaB_cocreate(L);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_pushcclosure(L, luaB_auxwrap, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;åç¨‹çš„è®©å‡º&#34;&gt;åç¨‹çš„è®©å‡º&lt;/h3&gt;
&lt;p&gt;å¯¹åº” Lua è¯­å¥ï¼š &lt;code&gt;lua coroutine.yield()&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define lua_yield(L,n)		lua_yieldk(L, (n), 0, NULL)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaB_yield (lua_State *L) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; lua_yield(L, lua_gettop(L));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;åç¨‹çš„æ¢å¤&#34;&gt;åç¨‹çš„æ¢å¤&lt;/h3&gt;
&lt;p&gt;å¯¹åº” Lua è¯­å¥ï¼š&lt;code&gt;lua coroutine.resume()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨åç¨‹å’Œåç¨‹çš„æ¢å¤ç±»ä¼¼ï¼Œéƒ½ç¦»ä¸å¼€ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaB_coresume (lua_State *L);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; auxresume (lua_State *L, lua_State *co, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; narg);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡½æ•°è°ƒç”¨é“¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;luaB_coresume ---&amp;gt; auxresume ---&amp;gt; lua_resume(API) ---&amp;gt; resume
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;Lua çš„å¼‚å¸¸å¤„ç†å’Œçº¿ç¨‹æœºåˆ¶ä¸ºäº†å’Œ C è¯­è¨€äº’ç›¸åµŒå…¥ç»è¿‡äº†åå¤çš„æƒè¡¡ï¼Œä»£ç çš„å¤æ‚åº¦è¾ƒå¤§ï¼Œæœ€åä½¿ç”¨å»¶ç»­å‡½æ•°çš„è®¾è®¡å…¶å®åªèƒ½ç®—æ˜¯ä¸€ä¸ªå¦¥åçš„ç»“æœï¼Œä½†æ˜¯è¿™å…¶ä¸­çš„è®¾è®¡è¿˜æ˜¯å¾ˆå€¼å¾—æˆ‘ä»¬å»å­¦ä¹ ã€‚&lt;/p&gt;
&lt;p&gt;ä½† Lua çš„åç¨‹åº“çš„ä»£ç éå¸¸ä¹‹çŸ­å°ï¼Œæ€»å…±ä¸¤ç™¾è¡Œå‡ºå¤´ï¼Œè€Œæ ¸å¿ƒéƒ¨åˆ†åªæœ‰æ¥è¿‘ç™¾è¡Œï¼ŒåŸå› ä¹‹ä¸€å°±æ˜¯å®ƒåªéœ€è¦è°ƒç”¨ ldo.h ä¸­æä¾›çš„ API ï¼Œçº¿ç¨‹ä¸­æ–­å’Œæ¢å¤éƒ¨åˆ†çš„ä»£ç å·²ç»ç»™åç¨‹å®ç°æ‰“ä¸‹äº†è‰¯å¥½çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/lua/lua&#34;&gt;Lua 5.4.4 æºç &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://lua-users.org/wiki/LuaDirectory&#34;&gt;Lua-Users-Wiki&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.codingnow.com&#34;&gt;äº‘é£çš„ BLOG&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://vaaandark.top/2022/05/03/C%E8%AF%AD%E8%A8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/&#34;&gt;vaaandark&amp;rsquo;s blog&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://poga.github.io/lua53-notes/coroutine.html&#34;&gt;Notes on the Implementation of Lua 5.3&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Lua Table</title>
      <link>https://vaaandark.top/posts/lua-table/</link>
      <pubDate>Wed, 11 May 2022 23:49:28 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/lua-table/</guid>
      <description>&lt;p&gt;ä¹‹å‰å­¦ä¹  Lua çš„æ—¶å€™å°±å¯¹å®ƒçš„ Table å¾ˆæ„Ÿå…´è¶£ï¼Œæœ€è¿‘åœ¨çœ‹ Lua è§£é‡Šå™¨çš„æºç ï¼Œå› æ­¤å°±æƒ³ç ”ç©¶ä¸€ä¸‹å…·ä½“æ˜¯æ€ä¹ˆå®ç°è¿™ä¸ª Lua ä¹‹ä¸­æœ€ä¸ºé‡è¦çš„æ•°æ®ç»“æ„çš„ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;lua-table-ç®€ä»‹&#34;&gt;Lua Table ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;åœ¨ Lua è¯­è¨€ä¹‹ä¸­ï¼Œæ•°ç»„æ˜¯ table ï¼Œå­—å…¸æ˜¯ table ï¼Œå°±è¿å¯¹è±¡ã€æ¨¡å—ã€åŒ…ä¹Ÿæ˜¯é€šè¿‡ table å®ç°çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ•°ç»„æ˜¯é”®å€¼ä¸ºæ­£æ•´æ•°çš„è¡¨ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±äºé”®å€¼ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç±»å‹ï¼Œæ•…è¡¨ä¹Ÿå¯ä»¥å®ç°å­—å…¸è¿™ç§æ•°æ®ç»“æ„ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±äºå‡½æ•°ä¹Ÿæ˜¯ Lua çš„ç¬¬ä¸€å…¬æ°‘ï¼Œæ‰€ä»¥æˆå‘˜å‡½æ•°ä¹Ÿå¯ä»¥é€šè¿‡è¡¨æ¥å®ç°ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¨¡å—å’ŒåŒ…ä¹‹é—´çš„ä»å±å…³ç³»ä¹Ÿæ˜¯é€šè¿‡ table æ¥è¡¨ç¤ºçš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Lua ä¸­çš„ table ä½¿ç”¨ååˆ†å¹¿æ³›ï¼Œè¿™ä¹Ÿå¯¼è‡´äº† Lua ä½¿ç”¨èµ·æ¥æœ‰ç€ &lt;del&gt;çº¯çœŸçš„ã€é‡æ€§çš„&lt;/del&gt; ç®€æ´çš„ç¾ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æ•°ç»„å’Œå­—å…¸æ‚ç³…çš„æ•°æ®ç»“æ„æœ‰æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿè¿™ç§æ•°æ®ç»“æ„åˆæ˜¯å¦é«˜æ•ˆå‘¢ï¼Ÿæˆ‘ä»¬å°†ä¼šåœ¨ä¸‹æ–‡è¿›è¡Œæ¢ç©¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;lua-è§£é‡Šå™¨ä¸­çš„å“ˆå¸Œå‡½æ•°&#34;&gt;Lua è§£é‡Šå™¨ä¸­çš„å“ˆå¸Œå‡½æ•°&lt;/h2&gt;
&lt;p&gt;ä¼ å…¥å‚æ•°ä¸­çš„ seed æ˜¯é€šè¿‡ lua_newstate å‡½æ•°åœ°å€ã€lua_State å®ä¾‹çš„åœ°å€å’Œå½“å‰æ—¶é—´å…±åŒè®¡ç®—å¾—åˆ°çš„ï¼Œå› æ­¤å…·æœ‰è¾ƒå¼ºçš„éšæœºæ€§ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaS_hash (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *str, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;size_t&lt;/span&gt; l, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; seed) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; h = seed ^ cast_uint(l);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (; l &amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; l--)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    h ^= ((h&amp;lt;&amp;lt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;) + (h&amp;gt;&amp;gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;) + cast_byte(str[l - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; h;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨è€ç‰ˆæœ¬çš„ Lua ä¸­ luaS_hash å‡½æ•°æ¯”ç°åœ¨çš„å¤æ‚ï¼Œæ˜¯å› ä¸ºæ–°ç‰ˆä¸­åªå¯¹çŸ­å­—ç¬¦ä¸²ä½¿ç”¨è¯¥å‡½æ•°ï¼Œè€Œè€ç‰ˆæœ¬å¯¹æ‰€æœ‰å­—ç¬¦ä¸²éƒ½ä½¿ç”¨è¯¥å‡½æ•°ï¼Œä¸ºäº†ä¿è¯æ±‚å“ˆå¸Œæ—¶çš„æ•ˆç‡ï¼Œæ‰€ä»¥å¯¹å­—ç¬¦ä¸²å¤§äº 32 å­—èŠ‚çš„éƒ¨åˆ†è¿›è¡Œè·³è¿‡è‡³å°‘ä¸€ä¸ªå­—èŠ‚çš„å“ˆå¸Œè¿ç®—ï¼ˆæ³¨æ„ step å˜é‡ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaS_hash(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; lua_State* L, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt;* str, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; l, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; h) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    h = h ^ l;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; step = (l &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;) + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt; l; i = i + step) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        h ^= (h &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;) + (h &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;) + cast(lu_byte, str[i]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; h;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡ hash å€¼æ¥å¾—åˆ°ç´¢å¼•çš„æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;index = hash_value &amp;amp; ((&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1U&lt;/span&gt; &amp;lt;&amp;lt; lsizenode) - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­ lsizenode æ˜¯ node é•¿åº¦å…³äº 2 çš„å¯¹æ•°ï¼Œè¿™ç§æ–¹æ³•ç±»ä¼¼äºå–æ¨¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;lua-è§£é‡Šå™¨ä¸­çš„é‡è¦ç±»å‹&#34;&gt;Lua è§£é‡Šå™¨ä¸­çš„é‡è¦ç±»å‹&lt;/h2&gt;
&lt;p&gt;è”åˆä½“ Value èƒ½è¡¨ç¤º Lua æ‰€æœ‰çš„åŸºæœ¬æ•°æ®ç»“æ„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** Union of all Lua values
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;union&lt;/span&gt; Value {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; GCObject *gc;    &lt;span style=&#34;color:#007f7f&#34;&gt;/* collectable objects */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; *p;         &lt;span style=&#34;color:#007f7f&#34;&gt;/* light userdata */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_CFunction f; &lt;span style=&#34;color:#007f7f&#34;&gt;/* light C functions */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_Integer i;   &lt;span style=&#34;color:#007f7f&#34;&gt;/* integer numbers */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_Number n;    &lt;span style=&#34;color:#007f7f&#34;&gt;/* float numbers */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} Value;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æ„ä½“ TValuefields çš„ä¸¤ä¸ªå­—æ®µåˆ†åˆ«è¡¨ç¤º value å’Œ value çš„ç±»å‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define TValuefields	Value value_; lu_byte tt_
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; TValue {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  TValuefields;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} TValue;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;TValue é•¿åº¦ä¸º 12 ä¸ªå­—èŠ‚ï¼Œå¯ä»¥ä½¿ç”¨ NaN Trick èŠ‚çº¦ç©ºé—´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è”åˆä½“ Node æœ‰ä¸¤ä¸ªå­—æ®µï¼Œä¸€ä¸ªæ˜¯ç»“æ„ä½“ NodeKey ä¾æ¬¡åŒ…å«äº†è¿™ä¸ªèŠ‚ç‚¹çš„å€¼ã€é”®çš„ç±»å‹ã€ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ä½ç½®ã€é”®çš„å€¼ä¸ç±»å‹ï¼Œå¦ä¸€ä¸ªå­—æ®µæ˜¯ TValue ç±»å‹çš„ i_val ï¼Œå› ä¸ºæ˜¯è”åˆä½“ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ç›´æ¥è®¿é—® i_val å¾—åˆ°å€¼çš„ç±»å‹å’Œç±»å‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;union&lt;/span&gt; Node {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; NodeKey {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    TValuefields;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* fields for value */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    lu_byte key_tt;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* key type */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; next;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* for chaining */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Value key_val;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* key value */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  } u;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  TValue i_val;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* direct access to node&amp;#39;s value as a proper &amp;#39;TValue&amp;#39; */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} Node;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æ„ä½“ Table ä¸­ CommonHeader å’Œ GCObject ä¸åƒåœ¾å›æ”¶æœ‰å…³ï¼Œmetatable å’Œå…ƒè¡¨æœ‰å…³ï¼Œflags å’Œå…ƒæ–¹æ³•æœ‰å…³ï¼Œéƒ½æš‚æ—¶ä¸è€ƒè™‘ã€‚lsizenode æ˜¯å“ˆå¸Œéƒ¨åˆ†é•¿åº¦å…³äº 2 çš„å¯¹æ•°ï¼Œalimit æ˜¯æ•°ç»„éƒ¨åˆ†çš„é•¿åº¦çš„ä¸‹é™ï¼ˆä¸ä¸€å®šæ˜¯çœŸå®å¤§å°ï¼Œæ˜¯ä¸€ä¸ªä¼°è®¡ï¼‰ï¼Œarray å’Œ node åˆ†åˆ«æŒ‡å‘æ•°ç»„éƒ¨åˆ†å’Œå“ˆå¸Œéƒ¨åˆ†ï¼Œlastfree æŒ‡å‘å“ˆå¸Œéƒ¨åˆ†å­˜åœ¨ç©ºæ§½çš„æœ«å°¾ä½ç½®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; Table {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  CommonHeader;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lu_byte flags;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* 1&amp;lt;&amp;lt;p means tagmethod(p) is not present */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lu_byte lsizenode;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* log2 of size of &amp;#39;node&amp;#39; array */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; alimit;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* &amp;#34;limit&amp;#34; of &amp;#39;array&amp;#39; array */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  TValue *array;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Node *node;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  Node *lastfree;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* any free position is before this position */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; Table *metatable;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  GCObject *gclist;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} Table;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;table-ç›¸å…³æ“ä½œ&#34;&gt;Table ç›¸å…³æ“ä½œ&lt;/h2&gt;
&lt;p&gt;å‰é¢å·²ç»è¯´åˆ°äº† Lua ä¸­çš„ Table æ˜¯ä¸€ä¸ªæ—¢åŒ…å«æ•°ç»„éƒ¨åˆ†åˆåŒ…å«å“ˆå¸Œéƒ¨åˆ†çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå¯¹ Lua æºç ä¸­å…³äº Table çš„ç±»å‹è¿›è¡Œäº†æ¢ç©¶ï¼Œç°åœ¨å°±å¯ä»¥å¯¹ Table çš„ç›¸å…³æ“ä½œè¿›è¡Œè®¨è®ºã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è®¨è®ºä¹‹å‰æœ‰ä¸€äº›å‰ç½®çŸ¥è¯†éœ€è¦äº†è§£ï¼šé¦–å…ˆå°±æ˜¯ Lua çš„å“ˆå¸Œéƒ¨åˆ†åº”å¯¹å“ˆå¸Œå†²çªä½¿ç”¨çš„æ˜¯é“¾æ¥æ³•ï¼Œä½†æ˜¯å®ƒä¸ä¼šå•ç‹¬æ‹‰å‡ºé“¾è¡¨æ¥ï¼Œä¾ç„¶æ˜¯ä¸€ä¸ª Node æ•°ç»„çš„å½¢å¼ã€‚å®ƒæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½åœ¨ Node æ•°ç»„ä¹‹ä¸­ï¼Œé€šè¿‡ next å­—æ®µä¸²èµ·æ¥ï¼Œè¿™å°±å¯¼è‡´ Lua å“ˆå¸Œè¡¨å¯¹å†…å­˜çš„åˆ©ç”¨ååˆ†ç´§å‡‘ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æºç ä¸­ï¼Œä½œè€…å°†é”®å€¼é€šè¿‡å“ˆå¸Œè®¡ç®—ç›´æ¥å¾—åˆ°çš„ä½ç½®å«åš mainpostion ï¼Œä¸‹æ–‡ä¸­ç§°ä¹‹ä¸ºä¸»ä½ç½®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆå§‹åŒ–æ“ä½œ&#34;&gt;åˆå§‹åŒ–æ“ä½œ&lt;/h3&gt;
&lt;p&gt;åˆå§‹åŒ– Table è¾ƒä¸ºç®€å•ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ç»™å­—æ®µèµ‹å€¼ä¸º 0 æˆ–è€… NULLï¼Œä½†éœ€æ³¨æ„ node å­—æ®µå¹¶ä¸åˆå§‹åŒ–ä¸º NULL è€Œæ˜¯åˆå§‹åŒ–ä¸ºä¸€ä¸ªå…¨å±€å˜é‡ dummynode ï¼Œè¿™ç§åšæ³•å¯ä»¥å‡å°‘å¾ˆå¤šæ¬¡åˆ¤ç©ºæ“ä½œã€‚&lt;/p&gt;
&lt;h3 id=&#34;get-æ“ä½œ&#34;&gt;get æ“ä½œ&lt;/h3&gt;
&lt;p&gt;å½“ key ä¸ºä¸€ä¸ªæ•´æ•° i_key æ—¶ï¼Œé¦–å…ˆåˆ¤æ–­ i_key ä¸ alimit çš„å…³ç³»ï¼Œå¦‚æœå°äº alimit è¯´æ˜åœ¨æ•°ç»„éƒ¨åˆ†ï¼Œç›´æ¥è¿”å›ä¸‹æ ‡ä½ç½®çš„å€¼ï¼›å¦‚æœå¤§äº alimit ä½† alimit å¹¶ä¸æ˜¯çœŸå®çš„æ•°ç»„å¤§å°ï¼Œå°±å…ˆæ›´æ–° alimit å†è¿”å›ä¸‹æ ‡ä½ç½®ï¼›ä¸Šè¿°æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œè¯´æ˜åœ¨å“ˆå¸Œéƒ¨åˆ†ï¼Œå¹¶åœ¨å“ˆå¸Œéƒ¨åˆ†æŸ¥æ‰¾ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; TValue *luaH_getint (Table *t, lua_Integer key) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (l_castS2U(key) - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1u&lt;/span&gt; &amp;lt; t-&amp;gt;alimit)  &lt;span style=&#34;color:#007f7f&#34;&gt;/* &amp;#39;key&amp;#39; in [1, t-&amp;gt;alimit]? */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &amp;amp;t-&amp;gt;array[key - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (!limitequalsasize(t) &amp;amp;&amp;amp;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* key still may be in the array part? */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;           (l_castS2U(key) == t-&amp;gt;alimit + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; ||
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            l_castS2U(key) - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1u&lt;/span&gt; &amp;lt; luaH_realasize(t))) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    t-&amp;gt;alimit = cast_uint(key);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* probably &amp;#39;#t&amp;#39; is here now */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &amp;amp;t-&amp;gt;array[key - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Node *n = hashint(t, key);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (;;) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* check whether &amp;#39;key&amp;#39; is somewhere in the chain */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (keyisinteger(n) &amp;amp;&amp;amp; keyival(n) == key)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; gval(n);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* that&amp;#39;s it */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nx = gnext(n);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (nx == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        n += nx;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &amp;amp;absentkey;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœ key ä¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¤„ç†æ–¹æ³•å°±è¾ƒä¸ºç®€å•ï¼Œç›´æ¥å»å“ˆå¸Œéƒ¨åˆ†å¯»æ‰¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;set-æ“ä½œ&#34;&gt;set æ“ä½œ&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆä»‹ç»æ’å…¥é”®å€¼ä¸ºä¸€ä¸ªæ•´æ•°æ—¶çš„æƒ…å†µï¼Œæ­¤æ—¶è°ƒç”¨å‡½æ•° luaH_setint ã€‚æ’å…¥é”®å€¼æ—¶ï¼Œå…ˆé€šè¿‡ä¸Šæ–‡ä»‹ç»è¿‡çš„å‡½æ•° luaH_getint åœ¨ Table ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœä¸ä¸ºç©ºåˆ™ç›´æ¥ set ï¼Œä¸ºç©ºåˆ™è°ƒç”¨å‡½æ•° luaH_newkey ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; luaH_setint (lua_State *L, Table *t, lua_Integer key, TValue *value) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; TValue *p = luaH_getint(t, key);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (isabstkey(p)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    TValue k;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    setivalue(&amp;amp;k, key);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    luaH_newkey(L, t, &amp;amp;k, value);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    setobj2t(L, cast(TValue *, p), value);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;luaH_newkey æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦é€»è¾‘å’Œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** inserts a new key into a hash table; first, check whether key&amp;#39;s main
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** position is free. If not, check whether colliding node is in its main
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** position or not: if it is not, move colliding node to an empty place and
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** put new key in its main position; otherwise (colliding node is in its main
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** position), new key goes to an empty position.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; luaH_newkey (lua_State *L, Table *t, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; TValue *key, TValue *value);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ’å…¥ä¸€ä¸ªé”®å€¼åˆ°å“ˆå¸Œè¡¨ä¸­æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è¿™ä¸ªé”®å€¼å¯¹åº”çš„ä¸»ä½ç½®æ˜¯ä¸æ˜¯ç©ºçš„ã€‚å¦‚æœä¸æ˜¯ç©ºçš„ï¼Œå°±æ£€æŸ¥é‚£ä¸ªå†²çªèŠ‚ç‚¹æ˜¯ä¸æ˜¯åœ¨å®ƒè‡ªèº«çš„ä¸»ä½ç½®ä¸Šï¼šå¦‚æœä¸æ˜¯ï¼Œé‚£å°±è°ƒæ•´è¿™ä¸ªå†²çªèŠ‚ç‚¹åˆ°ç©ºä½ç½®ç„¶åå°†å¾…æ’å…¥èŠ‚ç‚¹æ”¾å…¥è…¾å‡ºæ¥çš„ä½ç½®ï¼›å¦åˆ™ï¼ˆå†²çªèŠ‚ç‚¹åœ¨è‡ªå·±çš„ä¸»ä½ç½®ï¼‰ï¼Œå¾…æ’å…¥é”®å€¼å°±è¦å»ç©ºä½ç½®äº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†²çªèŠ‚ç‚¹åœ¨è‡ªå·±ä¸»ä½ç½®çš„æƒ…å†µï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;æ’å…¥é”®å€¼&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/table-01.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;è§£å†³å“ˆå¸Œå†²çª&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/table-02.png&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†²çªèŠ‚ç‚¹åœ¨è‡ªå·±ä¸»ä½ç½®çš„æƒ…å†µï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;å¦‚æœä¸æ˜¯ä¸»ä½ç½®èŠ‚ç‚¹&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/table-03.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;è°ƒæ•´ä¸åœ¨ä¸»ä½ç½®çš„å†²çªèŠ‚ç‚¹ä½ç½®æ—¶è¦æŠŠå®ƒçš„å‰é©±çš„ next å­—æ®µè¿›è¡Œä¿®æ”¹ï¼Œå¯¹å†²çªèŠ‚ç‚¹çš„ next å­—æ®µä¹Ÿè¦ä¿®æ­£ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”±äºä½¿ç”¨é“¾æ¥æ³•æ—¶ä½¿ç”¨çš„æ˜¯å•å‘é“¾è¡¨ï¼Œå› æ­¤æƒ³è¦è·å–å†²çªèŠ‚ç‚¹çš„å‰é©±éœ€è¦å°†å†²çªèŠ‚ç‚¹çš„é”®å–å‡ºæ¥æ±‚å“ˆå¸Œï¼Œé¦–å…ˆå¾—åˆ°ä¸»ä½ç½®ï¼Œå†é€šè¿‡ä¸€æ­¥ä¸€æ­¥åœ° next ï¼Œæ‰¾åˆ°å†²çªèŠ‚ç‚¹ä¹‹å‰çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt=&#34;è§£å†³å“ˆå¸Œå†²çª&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/table-04.png&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;lastfree çš„ç§»åŠ¨ï¼šåˆå§‹åŒ–æ—¶æŒ‡å‘ node æ•°ç»„çš„æœ€åä¸€ä½ã€‚åœ¨è¿™ä¹‹åï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªä¼šä½¿ç”¨è‡ªå‡æ“ä½œå‘å·¦ç§»åŠ¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;resize-æ“ä½œ&#34;&gt;resize æ“ä½œ&lt;/h2&gt;
&lt;p&gt;å½“è¡¨ç©ºé—´ä¸è¶³æ—¶å°±ä¼šè¿›è¡Œ resize æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥æ˜¯å¯¹ Key ä¸ºæ•´æ•°çš„éƒ¨åˆ†è¿›è¡Œç»Ÿè®¡ï¼Œç»Ÿè®¡çš„æ˜¯åœ¨åŒºé—´ $(2^i, 2^{i+1}]$ ä¸ä¸ºç©ºçš„å…ƒç´ çš„ä¸ªæ•°ï¼Œæ–¹ä¾¿ä¹‹åçš„ resize ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** Count keys in array part of table &amp;#39;t&amp;#39;: Fill &amp;#39;nums[i]&amp;#39; with
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** number of keys that will go into corresponding slice and return
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** total number of non-nil keys.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; numusearray (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; Table *t, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; *nums) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; lg;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; ttlg;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* 2^lg */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; ause = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* summation of &amp;#39;nums&amp;#39; */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* count to traverse all array keys */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; asize = limitasasize(t);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* real array size */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* traverse each slice */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (lg = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, ttlg = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;; lg &amp;lt;= MAXABITS; lg++, ttlg *= &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; lc = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* counter */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; lim = ttlg;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (lim &amp;gt; asize) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      lim = asize;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* adjust upper limit */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (i &amp;gt; lim)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;break&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* no more elements to count */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#007f7f&#34;&gt;/* count elements in range (2^(lg - 1), 2^lg] */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (; i &amp;lt;= lim; i++) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (!isempty(&amp;amp;t-&amp;gt;array[i-&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        lc++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    nums[lg] += lc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ause += lc;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; ause;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é‡æ–°ç¡®å®šæ•°ç»„å¤§å°çš„ä¸€ä¸ªåŸåˆ™å°±æ˜¯ï¼Œæ•°ç»„ä¸­ä¸ä¸ºç©ºçš„å…ƒç´ è¦è¶…è¿‡æ•°ç»„é•¿åº¦çš„ä¸€åŠï¼ŒLua çš„è®¾è®¡è€…ä½¿ç”¨è¿™ç§æ–¹æ³•ä¿è¯æ•ˆç‡å’Œå†…å­˜ä½¿ç”¨çš„å¹³è¡¡ã€‚å‡½æ•° computesizes ç”¨äºè®¡ç®—æ–°æ•°ç»„çš„å¤§å°ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; computesizes (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nums[], &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; *pna) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; twotoi;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* 2^i (candidate for optimal size) */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; a = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* number of elements smaller than 2^i */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; na = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* number of elements to go to array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; optimal = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* optimal size for array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* loop while keys can fill more than half of total size */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, twotoi = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       twotoi &amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; *pna &amp;gt; twotoi / &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       i++, twotoi *= &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    a += nums[i];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (a &amp;gt; twotoi/&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* more than half elements present? */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      optimal = twotoi;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* optimal size (till now) */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      na = a;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* all elements up to &amp;#39;optimal&amp;#39; will go to array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  lua_assert((optimal == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt; || optimal / &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; &amp;lt; na) &amp;amp;&amp;amp; na &amp;lt;= optimal);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  *pna = na;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; optimal;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœè®¡ç®—å‡ºæ¥çš„ newsize å¤§äºåŸæ¥çš„å¤§å°ï¼Œåˆ™å°† Node æ•°ç»„ï¼ˆå“ˆå¸Œéƒ¨åˆ†ï¼‰ä¸­çš„ä¸€éƒ¨åˆ†ç§»åˆ°æ•°ç»„ä¹‹ä¸­ï¼›å¦‚æœå°äºï¼Œåˆ™å°†æ•°ç»„çš„ä¸€éƒ¨åˆ†ç§»åˆ° Node æ•°ç»„ä¸­ã€‚ä½†æ— è®ºå¦‚ä½•éƒ½è¦å¯¹ Node éƒ¨åˆ†è¿›è¡Œ rehash æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šæ–‡ä¸­çš„ numusearray å’Œ computesizes è®¡ç®—éƒ½æ˜¯åœ¨å‡½æ•° rehash ä¸­è°ƒç”¨çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;/*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;** nums[i] = number of keys &amp;#39;k&amp;#39; where 2^(i - 1) &amp;lt; k &amp;lt;= 2^i
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; rehash (lua_State *L, Table *t, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; TValue *ek) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; asize;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* optimal size for array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; na;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* number of keys in the array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; nums[MAXABITS + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; totaluse;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;; i &amp;lt;= MAXABITS; i++) nums[i] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* reset counts */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  setlimittosize(t);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  na = numusearray(t, nums);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* count keys in array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  totaluse = na;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* all those keys are integer keys */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  totaluse += numusehash(t, nums, &amp;amp;na);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* count keys in hash part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* count extra key */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (ttisinteger(ek))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    na += countint(ivalue(ek), nums);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  totaluse++;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* compute new size for array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  asize = computesizes(nums, &amp;amp;na);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* resize the table to new computed sizes */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  luaH_resize(L, t, asize, totaluse - na);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;next-æ“ä½œ&#34;&gt;next æ“ä½œ&lt;/h2&gt;
&lt;p&gt;åœ¨ Lua è§£é‡Šå™¨ä¸­æ²¡æœ‰å®ç°ä¸€ä¸ªæ•°æ®ç»“æ„å¯ä»¥ç»´æŠ¤å¯¹ Table çš„è¿­ä»£ä¿¡æ¯ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå‡½æ•° LuaH_next å¯ä»¥é€šè¿‡ä¼ å…¥ä¸€ä¸ªé”®å€¼ï¼Œè¿”å›ä¸‹ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆå®é™…ä¸Šæ˜¯å°†é”®å€¼å¯¹å‹å…¥ Lua çš„æ ˆä¸­ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; luaH_next (lua_State *L, Table *t, StkId key) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; asize = luaH_realasize(t);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; i = findindex(L, t, s2v(key), asize);  &lt;span style=&#34;color:#007f7f&#34;&gt;/* find original key */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (; i &amp;lt; asize; i++) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* try first array part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (!isempty(&amp;amp;t-&amp;gt;array[i])) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* a non-empty entry? */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      setivalue(s2v(key), i + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      setobj2s(L, key + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &amp;amp;t-&amp;gt;array[i]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; (i -= asize; cast_int(i) &amp;lt; sizenode(t); i++) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* hash part */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (!isempty(gval(gnode(t, i)))) {  &lt;span style=&#34;color:#007f7f&#34;&gt;/* a non-empty entry? */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      Node *n = gnode(t, i);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      getnodekey(L, s2v(key), n);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      setobj2s(L, key + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, gval(n));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;  &lt;span style=&#34;color:#007f7f&#34;&gt;/* no more elements */&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¿°ä»£ç çš„åŸºæœ¬æ€è·¯ä¸ºå¯¹ä¼ å…¥ Key ä¹‹åçš„ä½ç½®è¿›è¡Œéå†ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªéç©ºçš„å…ƒç´ ï¼Œå°†å…¶é”®å€¼å¯¹å‹å…¥æ ˆä¸­ï¼Œéå†ä¾ç„¶æ˜¯æ•°ç»„éƒ¨åˆ†ä¼˜å…ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;é€šè¿‡å¯¹ Lua Table çš„å­¦ä¹ ï¼Œå‘ç°å®ƒçœŸçš„æ˜¯ä¸€é—¨å¾ˆé€‚åˆç”¨äºæ•™å­¦çš„è¯­è¨€ï¼šé¦–å…ˆå®ƒçš„è®¾è®¡ç†å¿µå¾ˆç»Ÿä¸€ï¼Œè€Œä¸”è•´å«äº† &lt;em&gt;Less is more&lt;/em&gt; ç­‰ç®€æ´å“²å­¦ï¼›å…¶æ¬¡ï¼Œå®ƒçš„ä»£ç çŸ­å°è§„èŒƒï¼Œç»“æ„æ¸…æ™°ï¼Œå¯è¯»æ€§æå¼ºï¼ŒæŠ€å·§ä½¿ç”¨ä¹Ÿä¸å¤šï¼Œçœ‹ Lua ä»£ç æœ‰ä¸€ç§ååœ¨æ•™å®¤çœ‹å¹»ç¯ç‰‡çš„æ„Ÿè§‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½†åšåˆ°äº†ç®€æ´ï¼Œä»£ä»·åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘è®¤ä¸º Table åè€Œä¸§å¤±äº†æ•°ç»„çš„é«˜æ•ˆï¼Œä¹Ÿè®©å­—å…¸çš„å†…éƒ¨å®ç°å˜å¾—å¤æ‚äº†èµ·æ¥ã€‚ä¸è¿‡ä½œä¸ºä¸€é—¨å¹¿æ³›ç”¨äºé…ç½®æ–‡ä»¶çš„èƒ¶æ°´è¯­è¨€ï¼Œæ•ˆç‡ä¹Ÿè®¸å¹¶æ²¡æœ‰é‚£ä¹ˆé‡è¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/lua/lua&#34;&gt;Lua 5.4.4 æºç &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://lua-users.org/wiki/LuaDirectory&#34;&gt;Lua-Users-Wiki&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.lua.org/doc/jucs05.pdf&#34;&gt;The Implementation of Lua 5.0&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.codingnow.com&#34;&gt;äº‘é£çš„ BLOG&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Cè¯­è¨€å¼‚å¸¸å¤„ç†</title>
      <link>https://vaaandark.top/posts/c-exception/</link>
      <pubDate>Tue, 03 May 2022 19:36:40 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/c-exception/</guid>
      <description>&lt;p&gt;C è¯­è¨€æ²¡æœ‰åŸç”Ÿæ”¯æŒå¼‚å¸¸å¤„ç†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨&lt;code&gt;setjmp&lt;/code&gt;å’Œ&lt;code&gt;longjmp&lt;/code&gt;å‡½æ•°å®ç°ç±»ä¼¼&lt;code&gt;try ... except&lt;/code&gt;çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦å‚è€ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;C Interfaces and Implementation&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;&lt;a href=&#34;https://www.hpl.hp.com/techreports/Compaq-DEC/SRC-RR-40.pdf&#34;&gt;Implementing exceptions in C&lt;/a&gt;&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;setjmph&#34;&gt;setjmp.h&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;setjmp.h&lt;/code&gt;æ˜¯ C æ ‡å‡†å‡½æ•°åº“ä¸­æä¾›â€œéæœ¬åœ°è·³è½¬â€çš„å¤´æ–‡ä»¶ï¼šæ§åˆ¶æµåç¦»äº†é€šå¸¸çš„å­ç¨‹åºè°ƒç”¨ä¸è¿”å›åºåˆ—ã€‚äº’è¡¥çš„ä¸¤ä¸ªå‡½æ•°&lt;code&gt;setjmp&lt;/code&gt;ä¸&lt;code&gt;longjmp&lt;/code&gt;æä¾›äº†è¿™ç§åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;setjmp&lt;/code&gt;å’Œ&lt;code&gt;longjmp&lt;/code&gt;çš„å…¸å‹ç”¨é€”æ˜¯å¼‚å¸¸å¤„ç†æœºåˆ¶çš„å®ç°ï¼šåˆ©ç”¨&lt;code&gt;longjmp&lt;/code&gt;æ¢å¤ç¨‹åºæˆ–çº¿ç¨‹çš„çŠ¶æ€ï¼Œç”šè‡³å¯ä»¥è·³è¿‡æ ˆä¸­å¤šå±‚çš„å‡½æ•°è°ƒç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é‡è¦å‡½æ•°&#34;&gt;é‡è¦å‡½æ•°&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;int setjmp(jmp_buf env)&lt;/code&gt;ï¼šå»ºç«‹æœ¬åœ°çš„&lt;code&gt;jmp_buf&lt;/code&gt;ç¼“å†²åŒºå¹¶ä¸”åˆå§‹åŒ–ï¼Œç”¨äºå°†æ¥è·³è½¬å›æ­¤å¤„ã€‚è¿™ä¸ªå­ç¨‹åºä¿å­˜ç¨‹åºçš„è°ƒç”¨ç¯å¢ƒäº&lt;code&gt;env&lt;/code&gt;å‚æ•°æ‰€æŒ‡çš„ç¼“å†²åŒºï¼Œ&lt;code&gt;env&lt;/code&gt;å°†è¢«&lt;code&gt;longjmp&lt;/code&gt;ä½¿ç”¨ã€‚å¦‚æœæ˜¯ä»&lt;code&gt;setjmp&lt;/code&gt;ç›´æ¥è°ƒç”¨è¿”å›ï¼Œ&lt;code&gt;setjmp&lt;/code&gt;è¿”å›å€¼ä¸º 0 ã€‚å¦‚æœæ˜¯ä»&lt;code&gt;longjmp&lt;/code&gt;æ¢å¤çš„ç¨‹åºè°ƒç”¨ç¯å¢ƒè¿”å›ï¼Œ&lt;code&gt;setjmp&lt;/code&gt;è¿”å›éé›¶å€¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;void longjmp(jmp_buf env, int value)&lt;/code&gt;ï¼šæ¢å¤&lt;code&gt;env&lt;/code&gt;æ‰€æŒ‡çš„ç¼“å†²åŒºä¸­çš„ç¨‹åºè°ƒç”¨ç¯å¢ƒä¸Šä¸‹æ–‡ï¼Œ&lt;code&gt;env&lt;/code&gt;æ‰€æŒ‡ç¼“å†²åŒºçš„å†…å®¹æ˜¯ç”±&lt;code&gt;setjmp&lt;/code&gt;å­ç¨‹åºè°ƒç”¨æ‰€ä¿å­˜ã€‚&lt;code&gt;value&lt;/code&gt;çš„å€¼ä»&lt;code&gt;longjmp&lt;/code&gt;ä¼ é€’ç»™&lt;code&gt;setjmp&lt;/code&gt;ã€‚&lt;code&gt;longjmp&lt;/code&gt;å®Œæˆåï¼Œç¨‹åºä»å¯¹åº”çš„&lt;code&gt;setjmp&lt;/code&gt;è°ƒç”¨å¤„ç»§ç»­æ‰§è¡Œï¼Œå¦‚åŒ&lt;code&gt;setjmp&lt;/code&gt;è°ƒç”¨åˆšåˆšå®Œæˆã€‚å¦‚æœ&lt;code&gt;value&lt;/code&gt;ä¼ é€’ç»™&lt;code&gt;longjmp&lt;/code&gt;é›¶å€¼ï¼Œ&lt;code&gt;setjmp&lt;/code&gt;çš„è¿”å›å€¼ä¸º 1 ï¼›å¦åˆ™ï¼Œ&lt;code&gt;setjmp&lt;/code&gt;çš„è¿”å›å€¼ä¸º&lt;code&gt;value&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é‡è¦ç±»å‹&#34;&gt;é‡è¦ç±»å‹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;jmp_buf&lt;/code&gt;ï¼šç”¨äºä¿å­˜æ¢å¤è°ƒç”¨ç¯å¢ƒæ‰€éœ€è¦çš„ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æµ…æ¢å¼‚å¸¸å¤„ç†&#34;&gt;æµ…æ¢å¼‚å¸¸å¤„ç†&lt;/h2&gt;
&lt;p&gt;ä¸‹é¢ä¸€æ®µä»£ç ç»™å‡ºäº†ä½¿ç”¨&lt;code&gt;setjmp&lt;/code&gt;å’Œ&lt;code&gt;longjmp&lt;/code&gt;å¤„ç†å¼‚å¸¸çš„åŸºæœ¬æ€è·¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;setjmp.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&amp;lt;assert.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; Allocation_handled = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;jmp_buf Allocate_Failed;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; *allocate(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; n)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; *new = malloc(n);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (new)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; new;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (Allocation_handled)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		longjmp(Allocate_Failed, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	assert(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; main(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *buf;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	Allocation_handled = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (setjmp(Allocate_Failed)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		fprintf(stderr, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;couldn&amp;#39;t allocate the buffer&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		exit(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	buf = allocate(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4096&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	Allocation_handled = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨&lt;code&gt;setjmp&lt;/code&gt;æ—¶å‡½æ•°è¿”å› 0 ï¼Œå› æ­¤ä¸è¿›å…¥&lt;code&gt;if&lt;/code&gt;åçš„åˆ†æ”¯è€Œæ˜¯ç»§ç»­æ‰§è¡Œåç»­æ“ä½œï¼Œåœ¨è°ƒç”¨å‡½æ•°&lt;code&gt;allocate&lt;/code&gt;æ—¶ï¼Œå¦‚æœå†…å­˜åˆ†é…å¤±è´¥ï¼Œå°†ä¼šè°ƒç”¨&lt;code&gt;longjmp&lt;/code&gt;å‡½æ•°ï¼Œè¿™ä¼šå¯¼è‡´&lt;code&gt;setjmp&lt;/code&gt;å‡½æ•°ç¬¬äºŒæ¬¡è¿”å›ï¼Œæ­¤æ—¶çš„è¿”å›å€¼æ˜¯&lt;code&gt;longjmp&lt;/code&gt;å‡½æ•°ç¬¬äºŒä¸ªå‚æ•° 1 ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£ï¼Œ&lt;code&gt;setjmp&lt;/code&gt;å‡½æ•°ä¸€èˆ¬ä¼šè¿”å›ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯ä¸ºäº†ç»™ä¹‹åçš„è·³è½¬æ ‡è®°ä½ç½®å’Œä¿å­˜ä¸Šæ–‡çš„ç¯å¢ƒï¼Œç¬¬äºŒæ¬¡è¿”å›æ˜¯ç”±è°ƒç”¨&lt;code&gt;longjmp&lt;/code&gt;å‡½æ•°å¼•èµ·çš„ï¼Œæ­¤æ—¶çš„è¿”å›å€¼ä¸æ˜¯ 0 ï¼Œå› æ­¤å¯ä»¥è¿›å…¥&lt;code&gt;if&lt;/code&gt;åˆ†æ”¯ä¸­å¤„ç†å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;							                &amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                             ________return_a_non-zero_number ---&amp;gt; exception_handling ---&amp;gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            /
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                           /
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;normal_control_flow ---&amp;gt; setjmp --- first_called --- return_0 ---&amp;gt; do_something ---&amp;gt; longjmp ---&amp;gt; normal_control_flow
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                           \                                                           /
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                            \__________________call_second_time_______________________/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                                    &amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åˆ©ç”¨å®å®ç°ç±»ä¼¼try--exceptçš„åŠŸèƒ½&#34;&gt;åˆ©ç”¨å®å®ç°ç±»ä¼¼&lt;code&gt;try ... except&lt;/code&gt;çš„åŠŸèƒ½&lt;/h2&gt;
&lt;h3 id=&#34;å®ç°æ•ˆæœ&#34;&gt;å®ç°æ•ˆæœ&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;TRY
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	S
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;EXCEPT(E1)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	S1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;EXCEPT(E2)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	S2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;EXCEPT(En)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	Sn
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ELSE
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	S0
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ENDTRY
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// or
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;TRY
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	S
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;FINALLY
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	S1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ENDTRY
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä»£ç å®ç°&#34;&gt;ä»£ç å®ç°&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;https://github.com/vaaandark/cii/tree/main/except&#34;&gt; GitHub ä»“åº“&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;é‡è¦ç»“æ„ä½“&#34;&gt;é‡è¦ç»“æ„ä½“&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;except&lt;/code&gt;ç»“æ„ä½“è¡¨ç¤ºå¼‚å¸¸ç±»å‹&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *reason;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;except_frame&lt;/code&gt;æ˜¯ä¸€ä¸ªé“¾è¡¨çš„èŠ‚ç‚¹ï¼ŒåŒ…å«äº†å¼‚å¸¸æ‰€åœ¨ä½ç½®çš„ç¨‹åºç¯å¢ƒã€ä»£ç æ–‡ä»¶å’Œè¡Œæ•°ï¼Œä»¥åŠå¼‚å¸¸ç±»å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except_frame {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except_frame *prev;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	jmp_buf env;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *file;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; line;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except *exception;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;é‡è¦å…¨å±€å˜é‡&#34;&gt;é‡è¦å…¨å±€å˜é‡&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;except_stack&lt;/code&gt;æ˜¯ä¸€ä¸ªå¼‚å¸¸æ ˆï¼Œæ¯æ¬¡å¤„ç†æ ˆé¡¶çš„å¼‚å¸¸ï¼Œç›´è‡³æ ˆç©ºã€‚å› æ­¤è¿™ä¸ªç»“æ„æ˜¯å®ç°å¼‚å¸¸åµŒå¥—å¤„ç†çš„å…³é”®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except_frame *except_stack;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;é‡è¦å‡½æ•°-1&#34;&gt;é‡è¦å‡½æ•°&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;except_raise&lt;/code&gt;ï¼šç”¨äºæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¹¶è·³è½¬åˆ°&lt;code&gt;setjump&lt;/code&gt;ï¼Œç„¶åè¿›å…¥åˆ°å¼‚å¸¸å¤„ç†åˆ†æ”¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt; except_raise(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except *e, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;char&lt;/span&gt; *file ,&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; line)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;é‡è¦çš„å®&#34;&gt;é‡è¦çš„å®&lt;/h4&gt;
&lt;p&gt;å…¶å®æ ¹æ®&lt;code&gt;except_raise&lt;/code&gt;å‡½æ•°å’Œå…¨å±€å˜é‡å°±å¯ä»¥å®ç°æ‰€æœ‰çš„åŠŸèƒ½äº†ï¼Œä½†ä¸‹æ–‡ä¸­çš„å®ä¹Ÿå¹¶ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Œæ­£æ˜¯å®ƒä»¬è®©æˆ‘ä»¬å¯ä»¥å®ç°&lt;code&gt;TRY ... EXCEPT ... ELSE ... END_TRY&lt;/code&gt;æˆ–è€…&lt;code&gt;TRY ... FINAL ... END_TRY&lt;/code&gt;è¿™æ ·çš„è¯­æ³•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define TRY do { \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	volatile int except_flag; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	struct except_frame except_frame; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	except_frame.prev = except_stack; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	except_stack = &amp;amp;except_frame; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	except_flag = setjmp(except_frame.env); \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	if (except_flag == EXCEPT_ENTERED) {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define EXCEPT(e) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;		if (except_flag == EXCEPT_ENTERED) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;			except_stack = except_stack-&amp;gt;prev; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	} else if (except_frame.exception == &amp;amp;(e)) { \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;		except_flag = EXCEPT_HANDLED;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define ELSE \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;		if (except_flag == EXCEPT_ENTERED) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;			except_stack = except_stack-&amp;gt;prev; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	} else { \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;		except_flag = EXCEPT_HANDLED;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define FINALLY \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;		if (except_flag == EXCEPT_ENTERED) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;			except_stack = except_stack-&amp;gt;prev; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	} { \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;		if (except_flag == EXCEPT_ENTERED) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;			except_flag = EXCEPT_FINALIZED;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define END_TRY \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;		if (except_flag == EXCEPT_ENTERED) \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;			except_stack = except_stack-&amp;gt;prev; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;	} if (except_flag == EXCEPT_RAISEED) RERAISE; \
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;} while (0)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define RAISE(e) except_raise(&amp;amp;(e), __FILE__, __LINE__)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define RERAISE except_raise(except_frame.exception, except_frame.file, except_frame.line)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define RETURN switch (except_stack = except_stack-&amp;gt;prev , 0) default: return
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä½¿ç”¨&#34;&gt;ä½¿ç”¨&lt;/h3&gt;
&lt;p&gt;å…ˆå…¨å±€å®šä¹‰å‡ ç§å¼‚å¸¸ç±»å‹ï¼Œå¯ä»¥å¦‚ä¸‹å®šä¹‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except allocate_fail = {&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Allocate failed&amp;#34;&lt;/span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except div_by_zero = {&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;divided by 0&amp;#34;&lt;/span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; except unknown_exception = {&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;unknown exception&amp;#34;&lt;/span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æŠ›å‡ºå¼‚å¸¸ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (something_happened)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	RAISE(a_except);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; (another_thing_happened)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	RAISE(another_except);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	RAISE(unknown_exception);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ•æ‰å¼‚å¸¸ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;TRY
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;EXCEPT(allocate_fail)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;catch a exception of %s&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, allocate_fail.reason);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;EXCEPT(div_by_zero)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;catch a exception of %s&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, div_by_zero.reason);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ELSE
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	printf(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;catch a exception of %s&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, unknown_exception.reason);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	RERAISE;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;END_TRY;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;åœ¨ C è¯­è¨€ä¸­å¾ˆå¤šæ—¶å€™å¯¹å¼‚å¸¸çš„å¤„ç†å…¶å®æ²¡æœ‰è¿™ä¹ˆéº»çƒ¦ï¼Œç›´æ¥ä½¿ç”¨ if else å‡ ä¸ªåˆ†æ”¯å°±æå®šäº†ï¼Œè€Œä¸”ä¹Ÿä¸ä¼šæœ‰å› ä¸ºè·³è½¬å¯¼è‡´èµ„æºæ— æ³•é‡Šæ”¾çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯é€šè¿‡&lt;code&gt;setjmp.h&lt;/code&gt;å’Œä¸€äº›å®å®ç°&lt;code&gt;try ... exception&lt;/code&gt;åŒæ ·æ˜¯æœ‰ä»·å€¼çš„ï¼Œé™¤äº†é”»ç‚¼æ€ç»´å’Œå†™å®è¯»å®çš„èƒ½åŠ›å¤–ï¼Œå®ƒè¿˜æœ‰å¾ˆå¤šç”¨å¤„ï¼Œå°¤å…¶æ˜¯åœ¨ä¸€äº›ç”± C ç¼–å†™çš„å…¶ä»–è¯­è¨€ä¸­ï¼Œå®ƒå°±èƒ½æä¾›å¼‚å¸¸å¤„ç†ç”šè‡³æ˜¯åç¨‹çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚ Lua ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ç ”ç©¶&lt;code&gt;setjmp.h&lt;/code&gt;å®ç°å¼‚å¸¸å¯¹æˆ‘ä»¬è®¾è®¡æ¶æ„ä¹ƒè‡³ç¼–ç¨‹è¯­è¨€éƒ½å¤§æœ‰è£¨ç›Šã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Rusté—­åŒ…</title>
      <link>https://vaaandark.top/posts/rust-closure/</link>
      <pubDate>Tue, 26 Apr 2022 23:15:48 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/rust-closure/</guid>
      <description>&lt;p&gt;Rust æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼Œå› æ­¤é«˜é˜¶å‡½æ•°ã€é—­åŒ…ç­‰ç‰¹æ€§éƒ½ä¸å¯æˆ–ç¼ºã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦å‚è€ƒäº† &lt;em&gt;&lt;strong&gt;Rust Course&lt;/strong&gt;&lt;/em&gt; å’Œ Rust æ ‡å‡†åº“æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯é—­åŒ…&#34;&gt;ä»€ä¹ˆæ˜¯é—­åŒ…&lt;/h2&gt;
&lt;p&gt;é—­åŒ…æ˜¯åœ¨æ”¯æŒå¤´ç­‰å‡½æ•°çš„ç¼–ç¨‹è¯­è¨€ä¸­å®ç°è¯æ³•ç»‘å®šçš„ä¸€ç§æŠ€æœ¯ï¼Œä¸å‡½æ•°ä¸åŒçš„æ˜¯ï¼Œå®ƒå¯ä»¥æ•æ‰è‡ªç”±å˜é‡ï¼Œè¿™æ„å‘³ç€å³ä½¿è„±ç¦»äº†é—­åŒ…åˆ›å»ºæ—¶çš„ä¸Šä¸‹æ–‡ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;é—­åŒ…çš„ç”¨é€”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é—­åŒ…å®ç°äº†ç±»ä¼¼ç¯å¢ƒå˜é‡çš„åŠŸèƒ½ï¼Œå¤šä¸ªå‡½æ•°ä½¿ç”¨ç›¸åŒçš„ç¯å¢ƒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é—­åŒ…å¯ä»¥å®šä¹‰è‡ªå·±çš„æ§åˆ¶æµç¨‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é—­åŒ…å¯ä»¥å®ç°å¯¹è±¡ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ Rust ä¸­ï¼Œå¯ä»¥åƒå¦‚ä¸‹æ–¹å¼åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„é—­åŒ…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; add1 = |x: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;| x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;assert_eq!(add1(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;), &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå‡½æ•°&lt;code&gt;add1&lt;/code&gt;å¹¶åœ¨ä¹‹åè°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;Rust ä¸­é—­åŒ…çš„ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å‚æ•°åˆ—è¡¨ä¸­ä½¿ç”¨&lt;code&gt;||&lt;/code&gt;ä»£æ›¿&lt;code&gt;()&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœåªæœ‰ä¸€ä¸ªè¯­å¥å¯ä»¥çœç•¥æ‰&lt;code&gt;{}&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥æ•æ‰è‡ªç”±å˜é‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯ä»¥åˆ©ç”¨é—­åŒ…çš„ç±»å‹è‡ªåŠ¨æ¨å¯¼ï¼Œä»¥ä¸‹å‡ ç§æ–¹æ³•æ˜¯ç­‰æ•ˆçš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt;  add_one_v1   (x: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u32&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u32&lt;/span&gt; { x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; add_one_v2 = |x: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u32&lt;/span&gt;| -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;u32&lt;/span&gt; { x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; add_one_v3 = |x|             { x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; add_one_v4 = |x|               x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;  ;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRust è™½ç„¶æœ‰ç±»å‹çš„è‡ªåŠ¨æ¨å¯¼ï¼Œä½†æ˜¯å®ƒåªæ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œè€Œä¸æ˜¯æ³›å‹ï¼Œå½“ç¼–è¯‘å™¨æ¨å¯¼å‡ºä¸€ç§ç±»å‹çš„é—­åŒ…ä¹‹åï¼Œå®ƒä¼šä¸€ç›´ä½¿ç”¨è¯¥ç±»å‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;é—­åŒ…æœ¬è´¨ä¸Šæ˜¯ä¸€ç§è¯æ³•ç»‘å®šï¼Œæ•…å½“é—­åŒ…ä»ç¯å¢ƒä¸­æ•è·ä¸€ä¸ªå€¼æ—¶ï¼Œä¼šåˆ†é…å†…å­˜å»å­˜å‚¨è¿™äº›å€¼ã€‚å¯¹äºæœ‰äº›åœºæ™¯æ¥è¯´ï¼Œè¿™ç§é¢å¤–çš„å†…å­˜åˆ†é…ä¼šæˆä¸ºä¸€ç§è´Ÿæ‹…ã€‚ä¸ä¹‹ç›¸æ¯”ï¼Œå‡½æ•°å°±ä¸ä¼šå»æ•è·è¿™äº›ç¯å¢ƒå€¼ï¼Œå› æ­¤å®šä¹‰å’Œä½¿ç”¨å‡½æ•°ä¸ä¼šæ‹¥æœ‰è¿™ç§å†…å­˜è´Ÿæ‹…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä¸‰ç§fnç‰¹å¾&#34;&gt;ä¸‰ç§&lt;code&gt;Fn&lt;/code&gt;ç‰¹å¾&lt;/h2&gt;
&lt;p&gt;é—­åŒ…æœ‰ä¸‰ç§æ–¹å¼æ•è·è‡ªç”±å˜é‡ï¼Œåˆ†åˆ«æ˜¯ï¼šè½¬ç§»æ‰€æœ‰æƒã€å¯å˜å€Ÿç”¨å’Œä¸å¯å˜å€Ÿç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;FnOnce&lt;/code&gt;ï¼Œé¡¾åæ€ä¹‰ï¼Œè¿™ç§é—­åŒ…åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œå› ä¸ºå®ƒä¼šå¤ºå–æ•è·åˆ°çš„å˜é‡çš„æ‰€æœ‰æƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;trait&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Fn&lt;/span&gt;&amp;lt;Args&amp;gt; : &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnMut&lt;/span&gt;&amp;lt;Args&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;rust-call&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; call(&amp;amp;self, args: Args) -&amp;gt; Self::Output;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;FnMut&lt;/code&gt;ï¼Œä½¿ç”¨å¯å˜å¼•ç”¨æ•è·äº†ç¯å¢ƒä¸­çš„å€¼ï¼Œå› æ­¤å¯ä»¥å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;trait&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnMut&lt;/span&gt;&amp;lt;Args&amp;gt; : &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnOnce&lt;/span&gt;&amp;lt;Args&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;rust-call&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; call_mut(&amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; self, args: Args) -&amp;gt; Self::Output;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Fn&lt;/code&gt;ï¼Œä½¿ç”¨ä¸å¯å˜å¼•ç”¨æ•è·äº†ç¯å¢ƒä¸­çš„å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;trait&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnOnce&lt;/span&gt;&amp;lt;Args&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;type&lt;/span&gt; Output;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;rust-call&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; call_once(self, args: Args) -&amp;gt; Self::Output;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“é—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸå¤§äºéœ€è¦æ•è·çš„è‡ªç”±å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œå¯ä»¥ä½¿ç”¨&lt;code&gt;move&lt;/code&gt;å…³é”®å­—å°†è‡ªç”±å˜é‡çš„æ‰€æœ‰æƒç§»å…¥é—­åŒ…ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v = vec![&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; print_vec = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;move&lt;/span&gt; || println!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;{:?}&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, v);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;é™¤äº†&lt;code&gt;FnMut&lt;/code&gt;éœ€è¦åœ¨åˆ›å»ºå˜é‡æ—¶ä½¿ç”¨&lt;code&gt;mut&lt;/code&gt;ï¼Œåˆ›å»ºé—­åŒ…æ—¶å¹¶ä¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šå®ƒå®ç°çš„ç‰¹å¾ï¼Œå› æ­¤é—­åŒ…çš„ç±»å‹å®é™…ä¸Šæ˜¯ç¼–è¯‘å™¨æ¨å¯¼å‡ºæ¥çš„ï¼Œåªæœ‰å°†é—­åŒ…å½“ä½œå‚æ•°ä¼ é€’éœ€è¦ç±»å‹æ ‡æ³¨æ—¶æ‰éœ€è¦æ˜¾å¼æ ‡è®°ç±»å‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸€ä¸ªé—­åŒ…å®ç°äº†å“ªç§ Fn ç‰¹å¾å–å†³äºè¯¥é—­åŒ…å¦‚ä½•ä½¿ç”¨è¢«æ•è·çš„å˜é‡ï¼Œè€Œä¸æ˜¯å–å†³äºé—­åŒ…å¦‚ä½•æ•è·å®ƒä»¬ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰çš„é—­åŒ…éƒ½è‡ªåŠ¨å®ç°äº†&lt;code&gt;FnOnce&lt;/code&gt;ç‰¹å¾ï¼Œå› æ­¤ä»»ä½•ä¸€ä¸ªé—­åŒ…éƒ½è‡³å°‘å¯ä»¥è¢«è°ƒç”¨ä¸€æ¬¡&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰ç§»å‡ºæ‰€æ•è·å˜é‡çš„æ‰€æœ‰æƒçš„é—­åŒ…è‡ªåŠ¨å®ç°äº†&lt;code&gt;FnMut&lt;/code&gt;ç‰¹å¾&lt;/li&gt;
&lt;li&gt;ä¸éœ€è¦å¯¹æ•è·å˜é‡è¿›è¡Œæ”¹å˜çš„é—­åŒ…è‡ªåŠ¨å®ç°äº†&lt;code&gt;Fn&lt;/code&gt;ç‰¹å¾&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ &lt;em&gt;&lt;strong&gt;Rust Course&lt;/strong&gt;&lt;/em&gt; ä¸­çš„ä¸€ä¸ªä¾‹å­ï¼Œè¯´æ˜äº†é—­åŒ…å®ç°çš„ç‰¹å¾å–å†³äºä½¿ç”¨è‡ªç”±å˜é‡çš„æ–¹æ³•ï¼Œè€Œä¸”å› ä¸ºåªä½¿ç”¨äº†ä¸å¯å˜å¼•ç”¨ï¼Œä¸‰ç§ç‰¹å¾éƒ½å¯ä»¥å®ç°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; main() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; s = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;String&lt;/span&gt;::new();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; update_string =  || println!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;,s);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    exec(update_string);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    exec1(update_string);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    exec2(update_string);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; exec&amp;lt;F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnOnce&lt;/span&gt;()&amp;gt;(f: F)  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    f()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; exec1&amp;lt;F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnMut&lt;/span&gt;()&amp;gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; f: F)  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    f()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; exec2&amp;lt;F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Fn&lt;/span&gt;()&amp;gt;(f: F)  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    f()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ç¼–ç¨‹ä¸­éœ€è¦æˆ‘ä»¬å–„äºåˆ©ç”¨ç¼–è¯‘å™¨çš„æŠ¥é”™ï¼Œå¯ä»¥å…ˆä½¿ç”¨ Fn ç‰¹å¾ï¼Œç„¶åç¼–è¯‘å™¨ä¼šå‘Šè¯‰ä½ æ­£è¯¯ä»¥åŠè¯¥å¦‚ä½•é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é—­åŒ…ä½œä¸ºè¿”å›å€¼&#34;&gt;é—­åŒ…ä½œä¸ºè¿”å›å€¼&lt;/h2&gt;
&lt;p&gt;é—­åŒ…ä½œä¸ºå‡½æ•°è¿”å›å€¼æ—¶ä¸è¦å¿˜äº†ä½¿ç”¨&lt;code&gt;impl&lt;/code&gt;å…³é”®å­—ï¼Œå¯ä»¥ç†è§£ä¸ºå®ç°äº†&lt;code&gt;Fn(xxx) -&amp;gt; yyy&lt;/code&gt;ç‰¹å¾ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; add_num(n: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; impl &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Fn&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;move&lt;/span&gt; |x| x + n
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; main() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; add1 = add_num(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(add1(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;), &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªå±€é™æ€§å°±æ˜¯åªèƒ½è¿”å›ä¸€ç§é—­åŒ…ï¼Œå› ä¸ºå³ä½¿æ˜¯ç›¸åŒå‡½æ•°ç­¾åçš„é—­åŒ…ä¹Ÿæ˜¯ä¸åŒç±»å‹çš„ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨ç‰¹å¾å¯¹è±¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; factory(x:&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Box&lt;/span&gt;&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;dyn&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Fn&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; num = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#007f7f&#34;&gt;// è¦æ³¨æ„é—­åŒ…ä¸­åªæ•è·äº† num è€Œæ²¡æœ‰æ•è· xï¼Œxæ˜¯é—­åŒ…çš„å‚æ•°ï¼Œè€Œä¸æ˜¯ä¸Šæ–‡ä¸­çš„ x
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; x &amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Box&lt;/span&gt;::new(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;move&lt;/span&gt; |x| x + num)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Box&lt;/span&gt;::new(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;move&lt;/span&gt; |x| x - num)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; main() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; add5 = factory(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; sub5 = factory(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(add5(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;), &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(sub5(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;), -&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;é—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸ&#34;&gt;é—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸ&lt;/h2&gt;
&lt;p&gt;Rust ä¸­å‡½æ•°å’Œé—­åŒ…æœ‰ä¸åŒçš„&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸçœç•¥åŸåˆ™ï¼ˆLifetime Elisionï¼‰&lt;/strong&gt;ï¼Œæ•…ä¸¤æ®µå‡ ä¹ç›¸åŒçš„ä»£ç åœ¨å‡½æ•°ä¸­èƒ½ç¼–è¯‘é€šè¿‡ï¼Œåœ¨é—­åŒ…ä¸­ä¸èƒ½é€šè¿‡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; fn_elision(x: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt; { x }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; closure_slision = |x: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;| -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt; { x };
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¼šæŠ¥é”™ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;error: lifetime may not live long enough
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; --&amp;gt; d.rs:&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;:&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;47&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; |     &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; closure_slision = |x: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;| -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt; { x };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  |                               -        -      ^^ returning this value requires that &lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt; must outlive &lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  |                               |        |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  |                               |        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;s&lt;/span&gt; call the lifetime of this reference &lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  |                               &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;s&lt;/span&gt; call the lifetime of this reference &lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœå‡½æ•°å‚æ•°ä¸­åªæœ‰ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œé‚£è¯¥å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸä¼šè¢«è‡ªåŠ¨åˆ†é…ç»™æ‰€æœ‰çš„è¿”å›å¼•ç”¨ã€‚ä½†æ˜¯é—­åŒ…ä¸ä¼šè¿™æ ·ï¼Œè¿™ç‚¹å€¼å¾—æˆ‘ä»¬æ³¨æ„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“æ„ä½“ä¸­ä½¿ç”¨é—­åŒ…&#34;&gt;ç»“æ„ä½“ä¸­ä½¿ç”¨é—­åŒ…&lt;/h2&gt;
&lt;p&gt;å¦‚ä¸‹ä»£ç æ˜¯å®˜æ–¹ç¤ºä¾‹çš„å‡çº§ç‰ˆï¼Œ&lt;code&gt;Cacher&lt;/code&gt;ç»“æ„ä½“åªæœ‰åœ¨éœ€è¦è·å–å€¼ä¸”å°šæœªé‡å¤è®¡ç®—æ—¶æ‰§è¡Œé—­åŒ…ï¼Œåœ¨æ‰§è¡Œåå°†è®¡ç®—ç»“æ„ç¼“å­˜åˆ°ä¸€ä¸ª&lt;code&gt;HashMap&lt;/code&gt;ä¹‹ä¸­ï¼Œè¿™ç§æ¨¡å¼è¢«å«åšæƒ°æ€§æ±‚å€¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;use&lt;/span&gt; std::collections::HashMap;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; Cacher&amp;lt;F&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt; F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Fn&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    val_map: HashMap&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;&amp;gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    calculation: F
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;impl&lt;/span&gt; &amp;lt;F&amp;gt; Cacher&amp;lt;F&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt; F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Fn&lt;/span&gt;(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; new(calculation: F) -&amp;gt; Cacher&amp;lt;F&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Cacher {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            val_map: HashMap::new(),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            calculation
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; value(&amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; self, arg: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(v) = self.val_map.get(&amp;amp;arg) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            *v
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v = (self.calculation)(arg);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            self.val_map.insert(arg, v);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            v
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; main() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; c = Cacher::new(|x| x);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v1 = c.value(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v2 = c.value(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(v1, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(v2, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Rustè¿­ä»£å™¨</title>
      <link>https://vaaandark.top/posts/rust-iterator/</link>
      <pubDate>Mon, 25 Apr 2022 23:22:24 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/rust-iterator/</guid>
      <description>&lt;p&gt;æœ€è¿‘ä¸€ç›´åœ¨å­¦ä¹  Rust è¯­è¨€ï¼Œæ·±æ„Ÿå®ƒçš„å­¦ä¹ æ›²çº¿å¾ˆé™¡å³­ï¼Œå› æ­¤ä¼šå†™å‡ ç¯‡åšå®¢è®°å½•ä¸€ä¸‹å­¦ä¹ è¿›åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦å‚è€ƒäº† &lt;em&gt;&lt;strong&gt;Rust Course&lt;/strong&gt;&lt;/em&gt; å’Œ Rust æ ‡å‡†åº“æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯è¿­ä»£å™¨&#34;&gt;ä»€ä¹ˆæ˜¯è¿­ä»£å™¨&lt;/h2&gt;
&lt;p&gt;è¿­ä»£å™¨ï¼ˆiteratorï¼‰ï¼Œæ˜¯ç¡®ä½¿ç”¨æˆ·å¯åœ¨å®¹å™¨å¯¹è±¡ï¼ˆcontainerï¼Œä¾‹å¦‚é“¾è¡¨æˆ–æ•°ç»„ï¼‰ä¸Šéè®¿çš„å¯¹è±¡ï¼Œè®¾è®¡äººå‘˜ä½¿ç”¨æ­¤æ¥å£æ— éœ€å…³å¿ƒå®¹å™¨å¯¹è±¡çš„å†…å­˜åˆ†é…çš„å®ç°ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Rust ä¸­çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;for&lt;/code&gt;çš„éšå¼è¿­ä»£å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v = vec![&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; &amp;amp;v {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	println!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, i);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;for&lt;/code&gt;è¯­å¥ä¸­æ˜¾å¼ä½¿ç”¨è¿­ä»£å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v = vec![&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; v.into_iter() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        println!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, i);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;Iterator&lt;/code&gt;ç‰¹å¾çš„&lt;code&gt;next&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v = vec![&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; v = v.into_iter();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;assert_eq!(arr_iter.next(), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;assert_eq!(arr_iter.next(), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;assert_eq!(arr_iter.next(), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;assert_eq!(arr_iter.next(), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;None&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“ä½¿ç”¨&lt;code&gt;for a in b&lt;/code&gt;è¯­å¥éå†æ—¶ï¼Œå¦‚æœå¯¹è±¡ b å®ç°äº†&lt;code&gt;IntoIterator&lt;/code&gt;ç‰¹æ€§ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åˆ©ç”¨ Rust ç»™æˆ‘ä»¬æä¾›çš„è¯­æ³•ç³–ï¼Œä¸å¿…æ˜¾å¼ä½¿ç”¨è¿­ä»£å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿­ä»£å™¨æ˜¯æ¶ˆè€—æ€§çš„ï¼Œæ¯éå†åˆ°ä¸€ä¸ªå…ƒç´ å°±ä¼šæ¶ˆè€—æ‰ä¸€ä¸ªå…ƒç´ ï¼Œæœ€ç»ˆè¿­ä»£å™¨ä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ ï¼Œåªèƒ½è¿”å›&lt;code&gt;None&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¦æ³¨æ„ä¸¤ä¸ªç‰¹å¾&lt;code&gt;Iterator&lt;/code&gt;å’Œ&lt;code&gt;IntoIterator&lt;/code&gt;çš„åŒºåˆ«ï¼Œä¸€ä¸ªæ˜¯å®ç°äº†è¿­ä»£å™¨çš„åŸºæœ¬åŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯å¯ä»¥è½¬åŒ–ä¸ºè¿­ä»£å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰è¶£çš„æ˜¯ï¼Œæ¯ä¸ªå®ç°äº†&lt;code&gt;Iterator&lt;/code&gt;çš„ç±»å‹éƒ½å®ç°äº†&lt;code&gt;IntoIterator&lt;/code&gt;ï¼Œè°ƒç”¨&lt;code&gt;into_iter&lt;/code&gt;æ—¶ä¼šè¿”å›è‡ªèº«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å¯¹iteratoræ›´è¿›ä¸€æ­¥&#34;&gt;å¯¹&lt;code&gt;Iterator&lt;/code&gt;æ›´è¿›ä¸€æ­¥&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Iterator&lt;/code&gt;çš„è·¯å¾„ä¸º&lt;code&gt;std::iter::Iterator&lt;/code&gt;ï¼Œæ‹¥æœ‰ä¸€ä¸ªå…³è”ç±»å‹&lt;code&gt;Item&lt;/code&gt;ï¼Œå’Œè¿­ä»£çš„å…ƒç´ ç±»å‹ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;è¯¥ç‰¹æ€§æœ‰ 72 ä¸ªæ–¹æ³•ï¼Œä¸‹é¢ç€é‡ä»‹ç»å‡ ç§å¸¸ç”¨æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;next&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; next(&amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; self) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Option&lt;/span&gt;&amp;lt;Self::Item&amp;gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿”å›&lt;code&gt;Some(Item)&lt;/code&gt;æˆ–è€…&lt;code&gt;None&lt;/code&gt;ï¼ŒåŒæ—¶æ›´æ–°è‡ªå·±åˆ°ä¸‹ä¸€ä¸ªä½ç½®ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;size_hint&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; size_hint(&amp;amp;self) -&amp;gt; (&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;usize&lt;/span&gt;, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Option&lt;/span&gt;&amp;lt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;usize&lt;/span&gt;&amp;gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿”å›ä¸€ä¸ªå…ƒç»„&lt;code&gt;(lower, upper)&lt;/code&gt;ï¼Œ&lt;code&gt;lower&lt;/code&gt;ä¸ºå½“å‰è¿­ä»£å™¨å‰©ä½™å…ƒç´ ä¸ªæ•°çš„ä¸‹ç•Œï¼Œ	&lt;code&gt;upper&lt;/code&gt;ä¸ºå…¶ä¸Šç•Œã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä¸Šç•Œå¾ˆå¤§ï¼Œè¶…è¿‡äº†&lt;code&gt;usize&lt;/code&gt;çš„æœ€å¤§å€¼ï¼Œå°±ä¼šæ˜¯&lt;code&gt;None&lt;/code&gt;ï¼Œå› æ­¤&lt;code&gt;size_hint	&lt;/code&gt;çš„é»˜è®¤å®ç°è¿”å›çš„å°±æ˜¯&lt;code&gt;(0, None)&lt;/code&gt;ï¼Œè¿™æ»¡è¶³ä»»æ„ä¸€ä¸ªè¿­ä»£å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ä½œç”¨æ˜¯ä¼˜åŒ–ä»£ç æ€§èƒ½ï¼Œå¯ä»¥é€šè¿‡è¯¥æ–¹æ³•ä¸ºè¿­ä»£å™¨çš„å…ƒç´ ä¿ç•™ç©ºé—´ã€‚åœ¨&lt;code&gt;std&lt;/code&gt;çš„å®˜æ–¹æ–‡æ¡£ä¸­æåˆ°ï¼Œè¯¥å®ç°åº”å½“æä¾›æ­£ç¡®çš„ä¼°è®¡ï¼Œä¸èƒ½å› ä¸ºå®ç°ä¸æ­£ç¡®å¯¼è‡´å†…å­˜å®‰å…¨æ€§åŸåˆ™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;enumerate&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; enumerate(self) -&amp;gt; Enumerate&amp;lt;Self&amp;gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨çš„å…ƒç´ ä¸ºä¸€ä¸ªå…ƒç»„&lt;code&gt;(i, val)&lt;/code&gt;ï¼Œ&lt;code&gt;i&lt;/code&gt;ä¸ºå½“å‰å…ƒç´ çš„ç´¢å¼•ï¼Œ&lt;code&gt;val&lt;/code&gt;ä¸ºå½“å‰å…ƒç´ ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;map&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; map&amp;lt;B, F&amp;gt;(self, f: F) -&amp;gt; Map&amp;lt;Self, F&amp;gt;&lt;span style=&#34;color:#f00&#34;&gt;â“˜&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnMut&lt;/span&gt;(Self::Item) -&amp;gt; B,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{ ... }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;F&lt;/code&gt;æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œé€šè¿‡å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨è¯¥é—­åŒ…ï¼Œ&lt;code&gt;map&lt;/code&gt;å°†ä¸€ä¸ªè¿­ä»£å™¨è½¬æ¢ä¸ºå¦ä¸€ä¸ªè¿­ä»£å™¨ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ&lt;code&gt;map&lt;/code&gt;æ˜¯ä¸€ä¸ªéå¸¸â€œå‡½æ•°å¼â€çš„æ–¹æ³•ï¼Œå¦‚æœä½¿ç”¨&lt;code&gt;map&lt;/code&gt;æ–¹æ³•è°ƒç”¨ä¸€äº›æœ‰å‰¯ä½œç”¨çš„é—­åŒ…ï¼Œç”±äºæ‡’æƒ°æ‰§è¡Œï¼Œå®ƒå¯èƒ½æ ¹æœ¬ä¸ä¼šèµ·ä½œç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;..&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;).map(|x| println!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, x));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;for_each&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; map&amp;lt;B, F&amp;gt;(self, f: F)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnMut&lt;/span&gt;(Self::Item)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ•ˆæœä¸Šç±»ä¼¼ä¸&lt;code&gt;for&lt;/code&gt;è¯­å¥ï¼Œä½†æ˜¯ä¸èƒ½ä½¿ç”¨&lt;code&gt;break&lt;/code&gt;å’Œ&lt;code&gt;continue&lt;/code&gt;ï¼Œé€‚ç”¨äºå¾ˆé•¿çš„è¿­ä»£å™¨é“¾ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;filter&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; filter&amp;lt;P&amp;gt;(self, predicate: P) -&amp;gt; Filter&amp;lt;Self, P&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    P: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnMut&lt;/span&gt;(&amp;amp;Self::Item) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;bool&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¯¥è¿­ä»£å™¨ä½¿ç”¨é—­åŒ…ç¡®å®šæ˜¯å¦åº”äº§ç”Ÿå…ƒç´ ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;filter_map&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; filter_map&amp;lt;B, F&amp;gt;(self, f: F) -&amp;gt; FilterMap&amp;lt;Self, F&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnMut&lt;/span&gt;(Self::Item) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Option&lt;/span&gt;&amp;lt;B&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ—¢è¿‡æ»¤åˆæ˜ å°„ï¼Œå¯ä»¥ç”¨äºç®€åŒ–è¿­ä»£å™¨é“¾ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;zip&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; zip&amp;lt;U&amp;gt;(self, other: U) -&amp;gt; Zip&amp;lt;Self, &amp;lt;U &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;IntoIterator&lt;/span&gt;&amp;gt;::IntoIter&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    U: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;IntoIterator&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°†ä¸¤ä¸ªè¿­ä»£å™¨å‹ç¼©ä¸ºæˆå¯¹çš„å•ä¸ªè¿­ä»£å™¨ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä»»ä¸€è¿­ä»£å™¨è¿”å›&lt;code&gt;None&lt;/code&gt;ï¼Œåˆ™&lt;code&gt;zipped&lt;/code&gt;è¿­ä»£å™¨ä¸­çš„&lt;code&gt;next&lt;/code&gt;å°†è¿”å›&lt;code&gt;None&lt;/code&gt;ã€‚å¦‚æœç¬¬ä¸€ä¸ªè¿­ä»£å™¨è¿”å›&lt;code&gt;None&lt;/code&gt;ï¼Œåˆ™&lt;code&gt;zip&lt;/code&gt;å°†çŸ­è·¯ï¼Œå¹¶ä¸”ä¸ä¼šåœ¨ç¬¬äºŒä¸ªè¿­ä»£å™¨ä¸Šè°ƒç”¨&lt;code&gt;next&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fold&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; fold&amp;lt;B, F&amp;gt;(self, init: B, f: F) -&amp;gt; B
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    F: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;FnMut&lt;/span&gt;(B, Self::Item) -&amp;gt; B 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;F&lt;/code&gt;è¢«ç§°ä¸ºç´¯åŠ å™¨ï¼Œé€šè¿‡åº”ç”¨æ“ä½œå°†æ¯ä¸ªå…ƒç´  fold åˆ°ä¸€ä¸ªç´¯åŠ å™¨ä¸­ï¼Œè¿”å›æœ€ç»ˆç»“æœã€‚&lt;/p&gt;
&lt;p&gt;çœ‹ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; a = [&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; sum = a.iter().fold(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, |acc, x| acc + x);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;assert_eq!(sum, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;6&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;collect&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; collect&amp;lt;B&amp;gt;(self) -&amp;gt; B
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;where&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    B: FromIterator&amp;lt;Self::Item&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°†è¿­ä»£å™¨è½¬æ¢ä¸ºé›†åˆã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;collect&lt;/code&gt;éœ€è¦ä¸Šä¸‹æ–‡è®©å…¶çŸ¥é“æŒ‰ç…§ä»€ä¹ˆæ–¹å¼æ”¶é›†ï¼Œä¸€ç§æ˜¯é€šè¿‡ç›´æ¥æ˜¾å¼åœ°è¡¨æ˜ç±»å‹ï¼Œä¸€ç§æ˜¯æ˜¾å¼åœ°æŒ‡å®š&lt;code&gt;collect&lt;/code&gt;è°ƒç”¨æ—¶çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v: vec&amp;lt;_&amp;gt; = (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;..&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;).collect();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// or
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;v = (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;..&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;).collect::&amp;lt;vec&amp;lt;_&amp;gt;&amp;gt;();
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;skip&lt;/code&gt;æ–¹æ³•å’Œ&lt;code&gt;take&lt;/code&gt;æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;take(n)&lt;/code&gt;çš„ä½œç”¨æ˜¯å–å‰ n ä¸ªå…ƒç´ ï¼Œè€Œ&lt;code&gt;skip(n)&lt;/code&gt;æ­£å¥½ç›¸åï¼Œè·³è¿‡å‰ n 	ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;&amp;hellip;&amp;hellip; è¿­ä»£å™¨çš„æ–¹æ³•å¾ˆå¤šï¼Œä¸ä¸€è€Œè¶³&lt;/p&gt;
&lt;h2 id=&#34;è¿­ä»£å™¨é€‚é…å™¨å’Œæ¶ˆè´¹è€…é€‚é…å™¨&#34;&gt;è¿­ä»£å™¨é€‚é…å™¨å’Œæ¶ˆè´¹è€…é€‚é…å™¨&lt;/h2&gt;
&lt;p&gt;é¡¾åæ€ä¹‰ï¼Œè¿­ä»£å™¨é€‚é…å™¨å°±æ˜¯äº§ç”Ÿè¿­ä»£å™¨ï¼Œæ¶ˆè´¹è€…é€‚é…å™¨å°±æ˜¯æ¶ˆè€—è¿­ä»£å™¨ã€‚åœ¨ä¹‹å‰è®²&lt;code&gt;map&lt;/code&gt;å’Œ&lt;code&gt;for_each&lt;/code&gt;æ—¶å¯ä»¥çœ‹åˆ°ï¼Œ&lt;code&gt;map&lt;/code&gt;åˆ›å»ºäº†ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè€Œä¸”æ˜¯æ‡’æƒ°çš„ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰ä¸äº§ç”Ÿä»»ä½•è¡Œä¸ºï¼Œå¦‚æœ&lt;code&gt;map&lt;/code&gt;åœ¨è°ƒç”¨é“¾çš„æœ€åä¸€ä¸ªç¼–è¯‘å™¨å°±ä¼šæŠ¥è­¦ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¶ˆè´¹è€…é€‚é…å™¨æ¥æ”¶å°¾ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;warning: unused &lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;Map&lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt; that must be used
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; --&amp;gt; c.rs:&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;:&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt; |     (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;..&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;).map(|x| println!(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;{}&lt;/span&gt;&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;&lt;/span&gt;, x));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  |
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  = note: &lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#[warn(unused_must_use)]&lt;/span&gt;&lt;span style=&#34;color:#f00&#34;&gt;`&lt;/span&gt; on by default
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  = note: iterators are lazy and &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt; nothing unless consumed
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­£ç¡®çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; v: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Vec&lt;/span&gt;&amp;lt;_&amp;gt; = (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;..&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;5&lt;/span&gt;).map(|x| x * &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;).collect();
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;è‡ªå·±åŠ¨æ‰‹å®ç°iteratorç‰¹å¾&#34;&gt;è‡ªå·±åŠ¨æ‰‹å®ç°&lt;code&gt;Iterator&lt;/code&gt;ç‰¹å¾&lt;/h2&gt;
&lt;p&gt;ä¸»è¦æ˜¯è¦å®ç°&lt;code&gt;Iterator&lt;/code&gt;ä¸­çš„&lt;code&gt;next&lt;/code&gt;æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å…¶ä½™æ–¹æ³•çš„åŸºç¡€ï¼Œå®ç°äº†&lt;code&gt;next&lt;/code&gt;æ–¹æ³•åï¼Œå…¶ä½™éƒ½å¯ä»¥é»˜è®¤å®ç°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;struct&lt;/span&gt; Range {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cnt: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    end: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;impl&lt;/span&gt; Range {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; new(cnt: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;, end: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;) -&amp;gt; Range {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        Range {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            cnt,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            end
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;impl&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Iterator&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; Range {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;type&lt;/span&gt; Item = &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; next(&amp;amp;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; self) -&amp;gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Option&lt;/span&gt;&amp;lt;Self::Item&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self.cnt += &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; self.cnt == self.end {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        } &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(self.cnt)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;fn&lt;/span&gt; main() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;mut&lt;/span&gt; r = Range::new(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(r.next(), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(r.next(), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(r.next(), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(r.next(), &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;Some&lt;/span&gt;(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; sum: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt; = Range::new(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10&lt;/span&gt;).sum();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(sum, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;45&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;let&lt;/span&gt; sum: &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;i32&lt;/span&gt; = Range::new(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10&lt;/span&gt;).map(|x| x * &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;).filter(|x| x &amp;lt; &amp;amp;&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;10&lt;/span&gt;).sum();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    assert_eq!(sum, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;20&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;è¿­ä»£å™¨æ˜¯ Rust çš„é›¶æˆæœ¬æŠ½è±¡ä¹‹ä¸€ï¼ŒæŠ½è±¡æ—¶ä¸ä¼šå¼•èµ·è¿è¡Œæ—¶å¼€é”€ï¼Œæ‰€ä»¥è¿­ä»£å™¨æœ‰ç€æé«˜çš„è¿è¡Œæ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œä½¿ç”¨è¿­ä»£å™¨ä¹Ÿèƒ½å¸¦æ¥è‰¯å¥½çš„å‡½æ•°å¼ç¼–ç¨‹çš„ä½“éªŒï¼Œä½¿ç”¨è¿­ä»£å™¨é“¾å¹¶ä¸é—­åŒ…ç»“åˆæ—¶ä½“éªŒæ›´æ˜¯è¶…è¿‡äº† Lisp ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>åç§‘å¯å®¤ç®€æ˜“é—¨ç¦</title>
      <link>https://vaaandark.top/posts/simple-entrance-guard-in-hust/</link>
      <pubDate>Tue, 29 Mar 2022 19:14:13 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/simple-entrance-guard-in-hust/</guid>
      <description>&lt;p&gt;åç§‘å®¿èˆçš„å¤§é—¨é—¨ç¦ç”¨å­¦ç”Ÿå¡å¼€ï¼Œè€Œæ¯ä¸ªå¯å®¤çš„é—¨å´åªèƒ½ä½¿ç”¨é’¥åŒ™æ‰“å¼€ã€‚è¿™å°±å¯¼è‡´äº†æ¯æ¬¡å‡ºé—¨éƒ½è¦å¸¦ä¸Šå­¦ç”Ÿå¡å’Œé’¥åŒ™ï¼Œæ¯æ¬¡å›æ¥éƒ½è¦å…ˆæå‡ºå¡ï¼Œå†æå‡ºé’¥åŒ™ã€‚è¿™æ ·å®åœ¨æ˜¯éº»çƒ¦ï¼Œå› æ­¤æˆ‘æœ‰äº†ç”¨æ ¡å›­å¡å°±èƒ½æ‰“å¼€å®¿èˆé—¨çš„æƒ³æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬é¡¹ç›®åœ°å€ &lt;a href=&#34;https://github.com/vaaandark/smart-door&#34;&gt;Github ä»“åº“&lt;/a&gt;&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;å‡†å¤‡å·¥ä½œ&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/h2&gt;
&lt;h3 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;MFRC522 å®˜æ–¹æ‰‹å†Œ &lt;a href=&#34;https://www.nxp.com.cn/docs/en/data-sheet/MFRC522.pdf&#34;&gt;doc&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æä¹¾æ–‡çš„åšå®¢ &lt;a href=&#34;https://blog.csdn.net/leytton/article/details/73480974&#34;&gt;RFID-RC522è¯»ICå¡&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŒå®¿èˆæ¥¼ä¸Šä¸€ä½å­¦é•¿çš„ &lt;a href=&#34;https://www.bilibili.com/read/cv7832399?spm_id_from=333.999.0.0&#34;&gt;åšæ–‡&lt;/a&gt; åŠ &lt;a href=&#34;https://github.com/yllhwa/nfchello&#34;&gt;GitHub ä»“åº“&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä»–åšå®¢ä¸­å¼•ç”¨çš„é“¾æ¥ &lt;a href=&#34;https://zhuanlan.zhihu.com/p/66467989&#34;&gt;æ–‡ç« &lt;/a&gt; åŠ &lt;a href=&#34;https://github.com/Ghastlcon/Access-Control&#34;&gt;GitHub ä»“åº“&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ææ–™å‡†å¤‡&#34;&gt;ææ–™å‡†å¤‡&lt;/h3&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;ç”¨é€”&lt;/th&gt;
          &lt;th&gt;é¢„ç®—(RMB)&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;USB å»¶é•¿çº¿ï¼ˆå…¬å¯¹æ¯ï¼‰&lt;/td&gt;
          &lt;td&gt;ä¾›ç”µ&lt;/td&gt;
          &lt;td&gt;6&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;USB å¸¦å¼€å…³å»¶é•¿çº¿&lt;/td&gt;
          &lt;td&gt;å¼€å…³&lt;/td&gt;
          &lt;td&gt;10&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Arduino UNO R3 å¼€å‘æ¿&lt;/td&gt;
          &lt;td&gt;æ§åˆ¶&lt;/td&gt;
          &lt;td&gt;12&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;MG996R èˆµæœº&lt;/td&gt;
          &lt;td&gt;å¼€é—¨&lt;/td&gt;
          &lt;td&gt;13&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RC522 IC å¡æ„Ÿåº”æ¨¡å—&lt;/td&gt;
          &lt;td&gt;è¯»å¡&lt;/td&gt;
          &lt;td&gt;5&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æœé‚¦çº¿&lt;/td&gt;
          &lt;td&gt;æ¥çº¿&lt;/td&gt;
          &lt;td&gt;0 ï¼ˆç™½å«–ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;åˆè®¡ï¼š46 RMB&lt;/p&gt;
&lt;h3 id=&#34;å·¥å…·å‡†å¤‡&#34;&gt;å·¥å…·å‡†å¤‡&lt;/h3&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;ç”¨é€”&lt;/th&gt;
          &lt;th&gt;é¢„ç®—(RMB)&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;çƒ­ç†”èƒ¶æªå’Œè‹¥å¹²èƒ¶æ£’&lt;/td&gt;
          &lt;td&gt;å›ºå®š&lt;/td&gt;
          &lt;td&gt;20&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ç„Šå°&lt;/td&gt;
          &lt;td&gt;ç„Šæ¥&lt;/td&gt;
          &lt;td&gt;0 ï¼ˆç™½å«–ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;åˆè®¡ï¼š20 RMB&lt;/p&gt;
&lt;h3 id=&#34;å¼€å‘ç¯å¢ƒ&#34;&gt;å¼€å‘ç¯å¢ƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;arduino-cli&lt;/strong&gt; 0.21.1&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;core&lt;/strong&gt; : arduino:avr 1.8.5&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;lib&lt;/strong&gt; : MFRC522 1.4.10&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Fritzing&lt;/strong&gt; 0.9.9 beta&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è¿çº¿åŠåŸç†å›¾&#34;&gt;è¿çº¿åŠåŸç†å›¾&lt;/h2&gt;
&lt;p&gt;RC522 æ¨¡å—çš„åº“æ˜¯ç½‘ä¸Šæ‰¾çš„ï¼Œåœ¨è¿çº¿å›¾ä¸Šæ ‡è¯†ä¸å¤Ÿæ¸…æ™°ï¼Œå¯ä»¥å‚è€ƒåŸç†å›¾æ¥å¸ƒçº¿ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿çº¿&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;è¿çº¿&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/smart-door.png&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸç†å›¾&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;åŸç†å›¾&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/smart-door_%E5%9B%BE%E7%A4%BA.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;é…ç½®åŠä½¿ç”¨&#34;&gt;é…ç½®åŠä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;ç¼–è¯‘çƒ§å½•è¿è¡Œ&lt;code&gt;./src/get-id/get-id.ino&lt;/code&gt;ä»¥è·å¾—å¡çš„ UIDã€‚&lt;/p&gt;
&lt;p&gt;åˆ›å»ºæ–‡ä»¶&lt;code&gt;./src/access-control/card-group.hpp&lt;/code&gt;ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define CARD_NUM {å¡çš„æ•°é‡}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;#define UID_SIZE 4
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0f0;font-weight:bold&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;const&lt;/span&gt; byte card_group[CARD_NUM][UID_SIZE] =
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    { &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00&lt;/span&gt; },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    { &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00&lt;/span&gt; },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;//    ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¼–è¯‘çƒ§å½•&lt;code&gt;./src/access-control/access-control.ino&lt;/code&gt;åˆ™å¯ä»¥ä½¿ç”¨è¿™ä¸ªç®€æ˜“é—¨ç¦äº†ï¼&lt;/p&gt;
&lt;h2 id=&#34;æ•ˆæœå›¾&#34;&gt;æ•ˆæœå›¾&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;è¿çº¿å®Œæˆæ•ˆæœ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;è¿çº¿å®Œæˆ&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/connected-device.jpg&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®‰è£…å®Œæˆæ•ˆæœ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;å®‰è£…å®Œæˆ-1&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/installed-device_1.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;å®‰è£…å®Œæˆ-2&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/installed-device_2.jpg&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨æ•ˆæœ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt=&#34;demo&#34; loading=&#34;lazy&#34; src=&#34;https://vaaandark.top/image/demo.gif&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Luaå…¥é—¨</title>
      <link>https://vaaandark.top/posts/lua-introduction/</link>
      <pubDate>Wed, 23 Mar 2022 23:40:09 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/lua-introduction/</guid>
      <description>&lt;p&gt;æœ€è¿‘å¯¹è„šæœ¬è¯­è¨€ Lua å¾ˆæ„Ÿå…´è¶£ï¼Œå…¶ä¸€æ˜¯å› ä¸ºå®ƒå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è°ƒç”¨ C è¯­è¨€åº“ï¼Œå…¶äºŒæ˜¯å› ä¸ºå®ƒæ˜¯å¾ˆå¤šç°ä»£åŒ–å·¥å…·çš„é…ç½®è¯­è¨€ï¼ˆæ¯”å¦‚ NeoVim ï¼‰ï¼Œå¦å¤– Lua çš„æºä»£ç ä¸æ˜¯å¾ˆé•¿ï¼Œå› æ­¤ç ”ç©¶å­¦ä¹ éš¾åº¦ä¼šæ¯”å…¶ä»–è¯­è¨€æ›´ä½ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;åŸºæœ¬è¯­æ³•&#34;&gt;åŸºæœ¬è¯­æ³•&lt;/h2&gt;
&lt;h3 id=&#34;æ³¨é‡Š&#34;&gt;æ³¨é‡Š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å•è¡Œæ³¨é‡Šä»¥åŒå‡å·å¼€å§‹&lt;code&gt;--&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¤šè¡Œæ³¨é‡Šä¸ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;--[[
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;comment
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;--]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ ‡è¯†ç¬¦&#34;&gt;æ ‡è¯†ç¬¦&lt;/h3&gt;
&lt;p&gt;ä¸Cè¯­è¨€è§„å®šç›¸åŒ&lt;/p&gt;
&lt;h3 id=&#34;ä¿ç•™å­—&#34;&gt;ä¿ç•™å­—&lt;/h3&gt;
&lt;p&gt;Lua è¯­è¨€ä¸­ä¿ç•™å­—æœ‰ 22 ä¸ªï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;and&lt;/code&gt; &lt;code&gt;break&lt;/code&gt; &lt;code&gt;do&lt;/code&gt; &lt;code&gt;else&lt;/code&gt; &lt;code&gt;elseif&lt;/code&gt; &lt;code&gt;end&lt;/code&gt; &lt;code&gt;false&lt;/code&gt; &lt;code&gt;for&lt;/code&gt; &lt;code&gt;function&lt;/code&gt; &lt;code&gt;if&lt;/code&gt; &lt;code&gt;in&lt;/code&gt; &lt;code&gt;local&lt;/code&gt; &lt;code&gt;nil&lt;/code&gt; &lt;code&gt;not&lt;/code&gt; &lt;code&gt;or&lt;/code&gt; &lt;code&gt;repeat&lt;/code&gt; &lt;code&gt;return&lt;/code&gt; &lt;code&gt;then&lt;/code&gt; &lt;code&gt;true&lt;/code&gt; &lt;code&gt;until&lt;/code&gt; &lt;code&gt;while&lt;/code&gt; &lt;code&gt;goto&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬çº¦å®šï¼Œä»¥ä¸‹åˆ’çº¿å¼€å¤´è¿æ¥ä¸€ä¸²å¤§å†™å­—æ¯çš„åå­—ï¼ˆæ¯”å¦‚ VERSION ï¼‰è¢«ä¿ç•™ç”¨äº Lua å†…éƒ¨å…¨å±€å˜é‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…¨å±€å˜é‡&#34;&gt;å…¨å±€å˜é‡&lt;/h3&gt;
&lt;p&gt;Lua ä¸­å˜é‡é»˜è®¤ä¸ºå…¨å±€å˜é‡ï¼Œä½¿ç”¨å…¨å±€å˜é‡å‰ä¸éœ€è¦å£°æ˜ï¼Œèµ‹å€¼ä¹‹åå³åˆ›å»ºäº†è¿™ä¸ªå˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè®¿é—®äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å…¨å±€å˜é‡ä¸ä¼šæŠ¥é”™ï¼Œåªæ˜¯å®ƒçš„å€¼æ˜¯&lt;code&gt;nil&lt;/code&gt;ã€‚åŒæ ·åœ°ï¼Œåˆ é™¤ä¸€ä¸ªå˜é‡å°±å¯ä»¥é€šè¿‡ç»™å®ƒèµ‹å€¼ä¸º&lt;code&gt;nil&lt;/code&gt;æ¥å®ç°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•°æ®ç±»å‹&#34;&gt;æ•°æ®ç±»å‹&lt;/h2&gt;
&lt;p&gt;Lua æ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œæœ‰å…«ä¸ªåŸºæœ¬ç±»å‹ï¼Œè€Œä¸”å…¶ä¸­çš„ä¸€äº›è¾ƒä¸ºç‰¹æ®Šï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æ•°æ®ç±»å‹&lt;/th&gt;
          &lt;th&gt;æè¿°&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;nil&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;åªæœ‰å€¼nilå±äºè¯¥ç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªæ— æ•ˆå€¼ï¼ˆåœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸­ç›¸å½“äºfalseï¼‰ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;boolean&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;falseå’Œtrueã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;number&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æ•°å­—ç±»å‹&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;string&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å­—ç¬¦ä¸²&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;function&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ç”± C æˆ– Lua ç¼–å†™çš„å‡½æ•°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;userdata&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;è¡¨ç¤ºä»»æ„å­˜å‚¨åœ¨å˜é‡ä¸­çš„Cæ•°æ®ç»“æ„&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;thread&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;è¡¨ç¤ºæ‰§è¡Œçš„ç‹¬ç«‹çº¿è·¯ï¼Œç”¨äºæ‰§è¡ŒååŒç¨‹åº&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;table&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Lua ä¸­è¡¨æ˜¯ä¸€ç§&amp;quot;å…³è”æ•°ç»„&amp;quot;ï¼Œæ•°ç»„çš„ç´¢å¼•å¯ä»¥æ˜¯æ•°å­—ã€å­—ç¬¦ä¸²æˆ–è¡¨ç±»å‹ã€‚&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ type å‡½æ•°æµ‹è¯•ç»™å®šå˜é‡æˆ–è€…å€¼çš„ç±»å‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(type(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;Hello&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- &amp;gt; string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(type(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;114514&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- &amp;gt; number&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(type(print))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- &amp;gt; function&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(type(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;true&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- &amp;gt; boolean&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(type(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;nil&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- &amp;gt; nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(type(type(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;nil&lt;/span&gt;)))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- &amp;gt; string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- type() å‡½æ•°è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;number&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Lua é»˜è®¤åªæœ‰ä¸€ç§ number ç±»å‹ï¼Œä¸º double åŒç²¾åº¦ç±»å‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;string&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ä¸€å¯¹åŒå¼•å·æˆ–è€…å•å¼•å·æ¥è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨&lt;code&gt;[[]]&lt;/code&gt;æ¥è¡¨ç¤ºä¸€å—å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå¯¹å­—ç¬¦ä¸²è¿›è¡Œæ•°å­—è¿ç®—ï¼Œä¼šå°è¯•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—å†è¿›è¡Œè¿ç®—ï¼›åœ¨ Lua ä¸­ï¼ŒçœŸæ­£çš„å­—ç¬¦ä¸²æ‹¼æ¥æ˜¯&lt;code&gt;..&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼äºä¸€äº›è„šæœ¬è¯­è¨€ï¼Œ Lua ä½¿ç”¨&lt;code&gt;#&lt;/code&gt;æ¥è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;table&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šè¿‡æ„é€ è¡¨è¾¾å¼æ¥åˆ›å»ºä¸€ä¸ª&lt;code&gt;table&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- åˆ›å»ºä¸€ä¸ªç©ºè¡¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;table1 = {}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- åœ¨åˆ›å»ºæ—¶è¿›è¡Œåˆå§‹åŒ–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;table2 = {&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‘è¡¨ä¸­æ·»åŠ å…ƒç´ ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a = {}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a[&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;] = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;value&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;] = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“è¡¨çš„ç´¢å¼•ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œå¯ä»¥ä½¿ç”¨&lt;code&gt;.&lt;/code&gt;æ¥åƒç»“æ„ä½“ä¸€æ ·è®¿é—®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;t = {}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;t.key = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ç­‰ä»·&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(t.key)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(t[&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸€ç§éå†è¡¨ä¸­å…ƒç´ çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; k, v &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; pairs(a) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	print(k .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34; : &amp;#34;&lt;/span&gt; .. v)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;Lua ä¸­è¡¨çš„é»˜è®¤åˆå§‹ç´¢å¼•ä¸º1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;function&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ Lua ä¸­ï¼Œfunction æ˜¯ç¬¬ä¸€ç±»å€¼ï¼Œå¯ä»¥ä½œä¸ºå¯¹è±¡ä¼ é€’ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°è¿”å›çš„å€¼ï¼Œå¯ä»¥å­˜åœ¨å˜é‡ä¹‹ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;function å¯ä»¥ä½¿ç”¨åŒ¿åå‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é—­åŒ…ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;äº‹å®ä¸Šï¼ŒLua å…¨éƒ¨çš„å‡½æ•°éƒ½æ˜¯åŒ¿åå‡½æ•°ï¼Œå‡½æ•°åæ˜¯å¯¹å…¶çš„å¼•ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;thread&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Lua ä¸­ä¸»è¦çš„çº¿ç¨‹æ˜¯åç¨‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;userdata&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯ä»¥å°† C/C++ ä¸­çš„ç±»å‹æ•°æ®å­˜åœ¨ Lua å˜é‡ä¸­è°ƒç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å˜é‡ä¸èµ‹å€¼&#34;&gt;å˜é‡ä¸èµ‹å€¼&lt;/h2&gt;
&lt;p&gt;Lua å˜é‡æœ‰ä¸‰ç§ç±»å‹ï¼šå…¨å±€å˜é‡ã€å±€éƒ¨å˜é‡ã€è¡¨ä¸­çš„åŸŸã€‚å˜é‡é»˜è®¤ä¸ºå…¨å±€å˜é‡&lt;/p&gt;
&lt;p&gt;åœ¨å¤šå€¼èµ‹å€¼æ—¶ï¼Œå‡ºç°å˜é‡çš„ä¸ªæ•°å’Œå€¼çš„ä¸ªæ•°ä¸ä¸€è‡´æƒ…å†µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœå€¼æ›´å¤šï¼Œåˆ™å¿½ç•¥æ‰å¤šä½™çš„å€¼&lt;/li&gt;
&lt;li&gt;å¦‚æœå˜é‡æ›´å¤šï¼Œåˆ™å¤šå‡ºæ¥çš„å˜é‡èµ‹å€¼ä¸º nil&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¤šå€¼èµ‹å€¼ç»å¸¸ç”¨æ¥äº¤æ¢å˜é‡ï¼Œæˆ–å°†å‡½æ•°è°ƒç”¨è¿”å›ç»™å˜é‡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a, b = func()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;a, b = b, a
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æµç¨‹æ§åˆ¶&#34;&gt;æµç¨‹æ§åˆ¶&lt;/h2&gt;
&lt;h3 id=&#34;å¾ªç¯&#34;&gt;å¾ªç¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;while å¾ªç¯&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; (test_expression) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;for å¾ªç¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;var çš„å€¼ä» exp1 åˆ° exp2 ï¼ˆé—­åŒºé—´ï¼‰ï¼Œexp3 å¯é€‰ï¼Œé»˜è®¤ä¸º 1 ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; var=exp1, exp2, exp3 &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Lua ä¸­ä¹Ÿæœ‰æ³›å‹ for å¾ªç¯&lt;code&gt;for .. in ...&lt;/code&gt;ï¼Œä¸ python ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;repeat &amp;hellip; until å¾ªç¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç±»ä¼¼ C è¯­è¨€ä¸­çš„ do &amp;hellip; while ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;repeat&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;until&lt;/span&gt;(test_expression)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;å¾ªç¯æ§åˆ¶è¯­å¥&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;break&lt;/code&gt; &lt;code&gt;goto&lt;/code&gt; ä¸ C è¯­è¨€ç±»ä¼¼&lt;/p&gt;
&lt;h3 id=&#34;åˆ†æ”¯åˆ¤æ–­&#34;&gt;åˆ†æ”¯åˆ¤æ–­&lt;/h3&gt;
&lt;p&gt;if ä½¿ç”¨ä¸ shell ä¸­ç±»ä¼¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; ( test_expression1 ) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;elseif&lt;/span&gt; ( test_expression2 ) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å‡½æ•°&#34;&gt;å‡½æ•°&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;optional_func_scope: é»˜è®¤ä¸ºå…¨å±€ï¼Œä½¿ç”¨ local å°†å‡½æ•°è®¾ç½®ä¸ºå±€éƒ¨ã€‚&lt;/li&gt;
&lt;li&gt;ret: Lua è¯­è¨€ä¸­å‡½æ•°è¿”å›å€¼å¯ä»¥æ˜¯å¤šä¸ªï¼Œç”¨é€—å·éš”å¼€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;optional_func_scope &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; func_name(arg1, arg2, ... , argn)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	function_body
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; ret_val
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’&lt;/p&gt;
&lt;p&gt;Lua æ”¯æŒå¯å˜å‚æ•°ï¼Œä½¿ç”¨æ—¶åœ¨å‚æ•°åˆ—è¡¨ä¸­ç”¨&lt;code&gt;...&lt;/code&gt;è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; average(...)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; res = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; arg = {...}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; i, v &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; ipairs(arg) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		res = res + v
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	res = res / #arg
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; res
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;å‡½æ•° select(&amp;quot;#&amp;quot;, &amp;hellip;) å¯ä»¥è¿”å›å¯å˜å‚æ•°çš„æ•°é‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;select(n, &amp;hellip;) å¯ä»¥è¿”å›ä»èµ·ç‚¹ n å¼€å§‹åˆ°ç»“æŸä½ç½®çš„æ‰€æœ‰å‚æ•°åˆ—è¡¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;è¿ç®—ç¬¦&#34;&gt;è¿ç®—ç¬¦&lt;/h2&gt;
&lt;p&gt;ä¸ C è¯­è¨€åŸºæœ¬ç›¸åŒï¼Œé€»è¾‘è¿ç®—ä¸º&lt;code&gt;and&lt;/code&gt; &lt;code&gt;or&lt;/code&gt; &lt;code&gt;not&lt;/code&gt;ï¼Œæ­¤å¤–è¿˜æœ‰ä¹˜å¹‚è¿ç®—&lt;code&gt;^&lt;/code&gt;å’Œæ•´é™¤è¿ç®—&lt;code&gt;//&lt;/code&gt;ï¼Œå…³ç³»è¿ç®—ç¬¦ä¸­ä¸ç­‰äºä¸º&lt;code&gt;~=&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lua5.3 ä¹‹åæ‰æ”¯æŒæ•´é™¤è¿ç®—&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å­—ç¬¦ä¸²&#34;&gt;å­—ç¬¦ä¸²&lt;/h2&gt;
&lt;p&gt;åœ¨ string æ¨¡å—ä¸­æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥æ“ä½œå­—ç¬¦ä¸²ï¼Œä»¥ä¸‹å‡½æ•°åŸå‹å¯ä»¥æœ›æ–‡ç”Ÿä¹‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.upper(str)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.lower(str)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.gsub(str, find, rep)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- è¿”å›å­ä¸²çš„å¼€å§‹å’Œç»“æŸç´¢å¼•ï¼Œ[] è¡¨ç¤ºå¯é€‰å‚æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.find(str, sub [, beg [, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;]])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.reverse(str)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- è¿”å›ç±»ä¼¼ printf çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.format(...)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- å°†æ•´å‹æ•°å­—è½¬ä¸ºå­—ç¬¦ä¸²å¹¶è¿æ¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.char(...)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- è½¬æ¢å­—ç¬¦ä¸ºæ•´æ•°å€¼ï¼Œé»˜è®¤ç¬¬ä¸€ä¸ªå­—ç¬¦&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.byte(str [, n])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.len(str)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- è¿”å› str çš„ n ä¸ªæ‹·è´&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.rep(str, n)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- è¿”å›ä¸€ä¸ªè¿­ä»£å™¨å‡½æ•°ï¼Œinit å¯é€‰ï¼Œæ˜¯æœç´¢çš„èµ·ç‚¹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.gmatch(str, pattern [, init])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- å­—ç¬¦ä¸²æˆªå–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;string.sub(str, beg [, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŒ¹é…æ¨¡å¼ï¼šLua ä¸­çš„åŒ¹é…æ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¯¦è§ä»¥ä¸‹é“¾æ¥&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://lua-users.org/wiki/PatternsTutorial&#34;&gt;http://lua-users.org/wiki/PatternsTutorial&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://riptutorial.com/lua/example/20315/lua-pattern-matching&#34;&gt;https://riptutorial.com/lua/example/20315/lua-pattern-matching&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ•°ç»„&#34;&gt;æ•°ç»„&lt;/h2&gt;
&lt;p&gt;Lua ä¸­çš„æ•°ç»„å®é™…ä¸Šå°±æ˜¯ä¸‹æ ‡ä¸ºæ•´æ•°çš„ table ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿­ä»£å™¨&#34;&gt;è¿­ä»£å™¨&lt;/h2&gt;
&lt;p&gt;é€šç”¨å½¢å¼çš„ for é€šè¿‡ä¸€ä¸ªå«ä½œ è¿­ä»£å™¨ çš„å‡½æ•°å·¥ä½œã€‚ æ¯æ¬¡è¿­ä»£ï¼Œè¿­ä»£å™¨å‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ä»¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å€¼ï¼Œ å½“è¿™ä¸ªå€¼ä¸º nil æ—¶ï¼Œå¾ªç¯åœæ­¢ã€‚ é€šç”¨å½¢å¼çš„ for å¾ªç¯çš„è¯­æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; namelist &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; explist &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt; block &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·çš„ for è¯­å¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; var_1, &lt;span style=&#34;color:#f00&#34;&gt;Â·Â·Â·&lt;/span&gt;, var_n &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; explist &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt; block &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒç­‰ä»·äºè¿™æ ·ä¸€æ®µä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; f, s, var = explist
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;true&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; var_1, &lt;span style=&#34;color:#f00&#34;&gt;Â·Â·Â·&lt;/span&gt;, var_n = f(s, var)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; var_1 == &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;nil&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	var = var_1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	block
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;explist åªä¼šè¢«è®¡ç®—ä¸€æ¬¡ã€‚å®ƒè¿”å›ä¸‰ä¸ªå€¼ï¼Œä¸€ä¸ªè¿­ä»£å™¨å‡½æ•° f ï¼Œä¸€ä¸ªçŠ¶æ€ s ï¼Œä¸€ä¸ªè¿­ä»£å™¨çš„åˆå§‹å€¼ var ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼šhttp://cloudwu.github.io/lua53doc/manual.html#3.3.5&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;æ— çŠ¶æ€çš„è¿­ä»£å™¨&#34;&gt;æ— çŠ¶æ€çš„è¿­ä»£å™¨&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; _square_iter(ending, current)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; current &amp;lt; ending &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		current = current + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; current, current * current
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- æ­¤å¤„ç›¸å½“äºå¯¹ _square_iter è¿›è¡Œäº†ä¸€ä¸ªåŒ…è£…&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; square_iter(ending, start)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; square_iter_, ending, start
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; i, n &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; square_iter(&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	print(i .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; .. i .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;=&amp;#39;&lt;/span&gt; .. n)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å‡ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1*1=1
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2*2=4
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;3*3=9
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æœ‰çŠ¶æ€çš„è¿­ä»£å™¨&#34;&gt;æœ‰çŠ¶æ€çš„è¿­ä»£å™¨&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢ä»£ç çš„ç­‰ä»·å½¢å¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; square_iter(a)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	idx = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	len = #a
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#007f7f&#34;&gt;-- è¿­ä»£å‡½æ•°éœ€è¦çš„ä¿¡æ¯è¢«å¤–å±‚å‡½æ•°ä¼ é€’ç»™äº†å†…å±‚å‡½æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		idx = idx + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; idx &amp;lt;= len &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;			&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; idx, a[idx] * a[idx]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; i, n &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; square_iter({&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;}) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	print(i .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; .. i .. &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;=&amp;#39;&lt;/span&gt; .. n)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;è¡¨&#34;&gt;è¡¨&lt;/h2&gt;
&lt;p&gt;ç§»é™¤ä¸€ä¸ªè¡¨çš„å¼•ç”¨å¯ä»¥é€šè¿‡èµ‹å€¼ä¸º nil æ¥å®Œæˆï¼Œå¦‚æœæ²¡æœ‰å¼•ç”¨æŒ‡å‘è¯¥è¡¨ï¼Œè¯¥è¡¨å ç”¨çš„å†…å­˜å°±ä¼šè¢«é‡Šæ”¾ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ table æ¨¡å—ä¸­æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥æ“ä½œè¡¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- åˆ—å‡ºå‚æ•°ä¸­æŒ‡å®štableçš„æ•°ç»„éƒ¨åˆ†ä»startä½ç½®åˆ°endä½ç½®çš„æ‰€æœ‰å…ƒç´ , å…ƒç´ é—´ä»¥æŒ‡å®šçš„åˆ†éš”ç¬¦(sep)éš”å¼€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;table.concat (table [, sep [, start [, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;]]]):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- é»˜è®¤æ’å…¥åˆ°æ•°ç»„å°¾éƒ¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;table.insert (table, [pos,] value)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- æŒ‡å®štableä¸­æ‰€æœ‰æ­£æ•°keyå€¼ä¸­æœ€å¤§çš„keyå€¼ã€‚å¦‚æœä¸å­˜åœ¨keyå€¼ä¸ºæ­£æ•°çš„å…ƒç´ , åˆ™è¿”å›0ã€‚(Lua5.2ä¹‹åè¯¥æ–¹æ³•å·²ç»ä¸å­˜åœ¨äº†)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;table.maxn (table)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- é»˜è®¤åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;table.remove (table [, pos])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- é»˜è®¤å‡åº&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;table.sort(table [, comp])
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰‹åŠ¨å®ç° maxn ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; maxn(t)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (t) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; max_key = t[&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; k, v &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; pairs(t) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;			&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; k &amp;gt; max_key &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;				max_key = k
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;			&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; max_key
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;#&lt;/code&gt;æ—¶ï¼Œå¦‚æœç´¢å¼•ä¸æ˜¯è¿ç»­çš„ï¼Œåˆ™ä¸ä¼šè¿”å›çœŸæ­£çš„è¡¨é•¿åº¦ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªå‡½æ•°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; table.len(t)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; len = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;for&lt;/span&gt; k, v &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;in&lt;/span&gt; pairs(t) &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		len = len + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; len
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ¨¡å—ä¸åŒ…&#34;&gt;æ¨¡å—ä¸åŒ…&lt;/h2&gt;
&lt;h3 id=&#34;lua-åŒ…&#34;&gt;Lua åŒ…&lt;/h3&gt;
&lt;p&gt;Lua ä¸­çš„æ¨¡å—æ˜¯ä¸€ä¸ªç”±å˜é‡ã€å‡½æ•°ç­‰å·²çŸ¥å…ƒç´ ç»„æˆçš„è¡¨ï¼Œåªéœ€è¦æœ€åå°†è¿™ä¸ª table è¿”å›å³å¯åˆ›å»ºä¸€ä¸ªæ¨¡å—ã€‚&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶æ ¼å¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# filename module.lua
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;module = {}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;module.const_var = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;114514&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; module.func()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- private function&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;function&lt;/span&gt; local_func()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	do_something
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; module
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥ä½¿ç”¨ require å‡½æ•°æ¥åŠ è½½æ¨¡å—ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;require(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;module_name&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- or&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;require &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;module_name&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥ç»™åŠ è½½çš„æ¨¡å—å®šä¹‰ä¸€ä¸ªåˆ«åï¼Œæ–¹ä¾¿è°ƒç”¨ï¼ˆæœ¬è´¨æ˜¯åˆåˆ›å»ºäº†ä¸€ä¸ªå¼•ç”¨ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;-- ä½¿ç”¨å±€éƒ¨å˜é‡é¿å…æ±¡æŸ“å‘½å&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; m = require(&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;module&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡½æ•° require æœ‰è‡ªå·±çš„æ–‡ä»¶è·¯å¾„åŠ è½½ç­–ç•¥ï¼Œä¼šå°è¯•ä» Lua æ–‡ä»¶æˆ–è€… C ç¨‹åºåº“ä¸­åŠ è½½æ¨¡å—ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥æœåˆ°çš„ Lua æ–‡ä»¶çš„è·¯å¾„å­˜æ”¾äºå…¨å±€å˜é‡ package.path ä¹‹ä¸­ï¼ŒLua è§£é‡Šå™¨å¯åŠ¨æ—¶ä¼šä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡ LUA_PATH æ¥åˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥åƒè¿™æ ·å°†è·¯å¾„åŠ å…¥ç¯å¢ƒå˜é‡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;#LUA_PATH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;export&lt;/span&gt; LUA_PATH=&lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;~/lua/?.lua;;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;c-åŒ…&#34;&gt;C åŒ…&lt;/h3&gt;
&lt;p&gt;C åŒ…åœ¨ä½¿ç”¨ä¹‹å‰ä¸€å®šè¦åŠ è½½å¹¶ä¸”é“¾æ¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; path = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;/usr/local/lua/lib/libluasocket.so&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; f = loadlib(path, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#39;luaopen_socket&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-lua&#34; data-lang=&#34;lua&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; path = &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;/usr/local/lua/lib/libluasocket.so&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;local&lt;/span&gt; f = assert(loadlib(path, &lt;span style=&#34;color:#0ff;font-weight:bold&#34;&gt;&amp;#34;luaopen_socket&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;f()  &lt;span style=&#34;color:#007f7f&#34;&gt;-- çœŸæ­£æ‰“å¼€åº“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>ä¸€äº›Vimä½¿ç”¨æŠ€å·§ï¼ˆæŒç»­æ›´æ–°ï¼‰</title>
      <link>https://vaaandark.top/posts/vim-practice/</link>
      <pubDate>Sun, 20 Feb 2022 10:53:42 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/vim-practice/</guid>
      <description>&lt;p&gt;æœ€è¿‘ç¿»çœ‹äº†ä¸€ä¸‹ &lt;strong&gt;ã€ŠVimä½¿ç”¨æŠ€å·§ã€‹&lt;/strong&gt; è¿™æœ¬ä¹¦ï¼Œç„¶åå°±å‘ç°æˆ‘å¯¹ &lt;strong&gt;Vim&lt;/strong&gt; å¿«æ·é”®çš„äº†è§£å¾ˆä¸æ·±å…¥ã€‚ä¸è¿‡å³ä½¿å¦‚æ­¤ï¼Œæˆ‘æ—¥å¸¸ä½¿ç”¨ &lt;strong&gt;Vim&lt;/strong&gt; å†™ä»£ç çš„æ•ˆç‡ä¹Ÿé«˜äºä½¿ç”¨å…¶ä»–ç¼–è¾‘å™¨äº†ï¼Œè¶³è§ &lt;strong&gt;Vim&lt;/strong&gt; æ¨¡å¼ä¹‹å¥‡ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;å®ç”¨çš„å‘½ä»¤&#34;&gt;å®ç”¨çš„å‘½ä»¤&lt;/h2&gt;
&lt;h3 id=&#34;æ™®é€šæ¨¡å¼&#34;&gt;æ™®é€šæ¨¡å¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡&lt;code&gt;g&lt;/code&gt;åŠ ç§»åŠ¨å‘½ä»¤å¯ä»¥åœ¨å±å¹•è¡Œè€Œä¸æ˜¯å®é™…è¡Œä¸­ç§»åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;C-a&amp;gt;&lt;/code&gt;å’Œ&lt;code&gt;&amp;lt;C-x&amp;gt;&lt;/code&gt;å¯ä»¥å¯¹æ•°å­—è¿›è¡ŒåŠ å‡ï¼Œå¦‚æœæ•°å­—å¼€å¤´æ˜¯&lt;code&gt;0&lt;/code&gt;åˆ™ä¼šè¢«è®¤ä¸ºæ˜¯å…«è¿›åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯¥å‘½ä»¤å’Œå¤§éƒ¨åˆ†å‘½ä»¤ä¸€æ ·å¯ä»¥ç”¨æ•°å­—åœ¨å‰ä¿®é¥°è¡¨ç¤ºé‡å¤ï¼Œæ¯”å¦‚åŠ &lt;code&gt;100&lt;/code&gt;æ˜¯&lt;code&gt;100&amp;lt;C-a&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;daw&lt;/code&gt;å’Œ&lt;code&gt;diw&lt;/code&gt;æ•ˆæœç±»ä¼¼ï¼Œä½†æ˜¯&lt;code&gt;daw&lt;/code&gt;ä½¿ç”¨æ›´å¤šï¼ˆ&lt;code&gt;caw&lt;/code&gt;ç­‰åŒç†ï¼‰ï¼Œå› ä¸ºå¯ä»¥å»é™¤å¤šä½™çš„ç©ºæ ¼ã€‚ä½†åœ¨ä½¿ç”¨çš„æ—¶å€™è¿˜æ˜¯çœ‹æƒ…å†µæ˜¯å¦åŒ…æ‹¬ä¸¤è¾¹ã€‚&lt;/li&gt;
&lt;li&gt;è¡Œå†…æŸ¥æ‰¾æ—¢å¯ä»¥ç”¨&lt;code&gt;t&lt;/code&gt;ä¹Ÿå¯ä»¥ç”¨&lt;code&gt;f&lt;/code&gt;ï¼Œç›®çš„åªæ˜¯æŸ¥æ‰¾æ—¶æ˜æ˜¾ä½¿ç”¨&lt;code&gt;f&lt;/code&gt;æ›´åŠ ç¬¦åˆç›´è§‰ï¼Œä½†æ˜¯åœ¨åˆ é™¤åˆ°æŒ‡å®šä½ç½®çš„ä½¿ç”¨åœºæ™¯æ—¶ï¼Œ&lt;code&gt;dt&lt;/code&gt;ä¿ç•™æŸ¥æ‰¾å­—ç¬¦çš„ç‰¹ç‚¹å¯ä»¥è®©æˆ‘ä»¬è¾“å…¥ä¸€äº›åœ¨æ–‡æœ¬ä¸­å¤šç”¨äºåˆ†å‰²çš„å­—ç¬¦ç”¨äºå®šä½ï¼Œè€Œä¸æ˜¯è´¹åŠ²å»çœ‹åˆ†å·å‰é¢æ—¶ä»€ä¹ˆå­—æ¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;%&lt;/code&gt;å¯ä»¥è·³è½¬åˆ°æˆå¯¹åŒ¹é…çš„ç¬¦å·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ’å…¥æ¨¡å¼&#34;&gt;æ’å…¥æ¨¡å¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰è¶£ä½†æ˜¯æ²¡å•¥å¤§ç”¨çš„æŠ€å·§ï¼Œ&lt;code&gt;&amp;lt;C-v&amp;gt;&lt;/code&gt;åæ¥æ•°å­—å¯ä»¥é€šè¿‡ç¼–ç è¾“å…¥å­—ç¬¦ï¼Œå¦‚æœæ•°å­—ä»¥&lt;code&gt;u&lt;/code&gt;æ‰“å¤´ï¼Œå°±æ˜¯åå…­è¿›åˆ¶ï¼Œ&lt;code&gt;&amp;lt;C-k&amp;gt;&lt;/code&gt;åæ¥ä¸¤ä¸ªå­—ç¬¦å¯ä»¥å¾—åˆ°äºŒåˆå­—æ¯è¡¨ç¤ºçš„å­—ç¬¦ã€‚è¿™ä¸ªæŠ€å·§åœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸­ä¹Ÿå­˜åœ¨ã€‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥ä½¿ç”¨&lt;code&gt;&amp;lt;C-h&amp;gt;&lt;/code&gt; &lt;code&gt;&amp;lt;C-w&amp;gt;&lt;/code&gt; &lt;code&gt;&amp;lt;C-u&amp;gt;&lt;/code&gt;åœ¨æ’å…¥æ¨¡å¼ä¸­åƒç»ˆç«¯ä¸€æ ·åˆ é™¤ï¼Œè¯¥æŠ€å·§åœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¹Ÿæˆç«‹ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;&amp;lt;C-r&amp;gt;&lt;/code&gt;åŠ å¯„å­˜å™¨åå®ç°åœ¨æ’å…¥æ¨¡å¼ä¸‹å¿«é€Ÿç²˜è´´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ç‰¹æ®Šçš„æ’å…¥-æ™®é€šæ¨¡å¼ï¼ˆ&lt;code&gt;&amp;lt;C-o&amp;gt;&lt;/code&gt;ï¼‰ï¼šå³æ‰§è¡Œä¸€æ¬¡æ™®é€šæ¨¡å¼å‘½ä»¤ç„¶åé©¬ä¸Šè¿›å…¥æ’å…¥æ¨¡å¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;å¯è§†æ¨¡å¼&#34;&gt;å¯è§†æ¨¡å¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨æŒ‰&lt;code&gt;v&lt;/code&gt;è¿›å…¥å¯è§†æ¨¡å¼ä¹‹åï¼Œé€šè¿‡&lt;code&gt;a&lt;/code&gt;æˆ–&lt;code&gt;i&lt;/code&gt;åŠ ä¸Š&lt;code&gt;&#39;&lt;/code&gt; &lt;code&gt;&amp;quot;&lt;/code&gt; &lt;code&gt;)&lt;/code&gt;ç­‰æˆå¯¹åŒ¹é…çš„ç¬¦å·ï¼Œå¯ä»¥ç›´æ¥é€‰ä¸­é‚£å¯¹ç¬¦å·ä¹‹é—´çš„éƒ¨åˆ†ï¼ˆå¦‚æœæ˜¯&lt;code&gt;a&lt;/code&gt;åˆ™åŒ…æ‹¬é‚£å¯¹ç¬¦å·ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æ™®é€šæ¨¡å¼ä¸‹æŒ‰ä¸‹&lt;code&gt;gv&lt;/code&gt;å¯ä»¥é€‰ä¸­ä¸Šæ¬¡é«˜äº®çš„éƒ¨åˆ†ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å¯è§†æ¨¡å¼ä¸‹æŒ‰ä¸‹&lt;code&gt;o&lt;/code&gt;å¯ä»¥å°†å…‰æ ‡åˆ‡æ¢åˆ°å¦å¤–ä¸€æ®µï¼ˆæ¯”è¾ƒå¸¸è§çš„æŠ€å·§ï¼Œåªæ˜¯æˆ‘ä¹‹å‰ä¸çŸ¥é“ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å—å¯è§†æ¨¡å¼ä¸­å¯ä»¥å¯¹å¤šè¡Œè¿›è¡Œæ’å…¥æ“ä½œï¼Œè¿™æ ·å¯ä»¥ä¸ä¾èµ–æ’ä»¶å®ç°å¿«é€Ÿæ³¨é‡Šå’Œå¿«é€Ÿå–æ¶ˆæ³¨é‡Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å‘½ä»¤è¡Œæ¨¡å¼&#34;&gt;å‘½ä»¤è¡Œæ¨¡å¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å‘½ä»¤è¡Œå‘½ä»¤çš„æ ¼å¼ä¸€èˆ¬ä¸º&lt;code&gt;[range]+[command]+[args]([address])&lt;/code&gt;ï¼Œä½œç”¨èŒƒå›´å’Œå‚æ•°å¯é€‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;!&lt;/code&gt;åçš„å‘½ä»¤ç”±å¤–éƒ¨shellæ‰§è¡Œï¼Œå¯ä»¥ç»“åˆè¯»å…¥åˆ°ç¼“å†²åŒºï¼ˆ&lt;code&gt;read&lt;/code&gt; &lt;code&gt;r&lt;/code&gt;ï¼‰ï¼Œä»ç¼“å†²åŒºå†™å…¥ï¼ˆ&lt;code&gt;write&lt;/code&gt; &lt;code&gt;w&lt;/code&gt;ï¼‰è¾¾åˆ°ä¸€äº›å¾ˆå¥½çš„æ•ˆæœï¼Œå¦‚å¾—åˆ°å½“å‰å·¥ä½œç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶&lt;code&gt;r !ls ./&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å½“&lt;code&gt;!&lt;/code&gt;å‰æœ‰ä¸€ä¸ªèŒƒå›´æ—¶ï¼Œæƒ…å†µå°±ä¼šæœ‰æ‰€ä¸åŒï¼Œshellæ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤çš„è¾“å‡ºä¼šè¢«å†™å›åˆ°ç¼“å†²åŒºã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å®ç°å¯¹æ–‡æœ¬çš„æ’åº&lt;code&gt;%!sort -n&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;%&lt;/code&gt;è¡¨ç¤ºå½“å‰ç¼–è¾‘çš„æ–‡ä»¶è·¯å¾„ï¼Œ&lt;code&gt;%:h&lt;/code&gt;å¯ä»¥å»æ‰å½“å‰æ–‡ä»¶è·¯å¾„çš„æ–‡ä»¶åï¼Œéå¸¸é€‚åˆç¼–è¾‘åŒæ—¶ç¼–è¾‘å¤šä¸ªç›¸å¯¹å·¥ä½œç›®å½•å±‚çº§å¾ˆæ·±çš„æ–‡ä»¶æ—¶ä½¿ç”¨ã€‚å½“ç„¶ï¼Œè¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥æ˜ å°„çš„ï¼ˆè¿™é‡Œæ›´åƒå®å±•å¼€ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ‡‚&lt;code&gt;vimscript&lt;/code&gt;ï¼‰ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cnoremap &amp;lt;expr&amp;gt; %% getcmdtype() == &amp;#39;:&amp;#39; ? expand(&amp;#39;%:h&amp;#39;).&amp;#39;/&amp;#39; : &amp;#39;%%&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;åœ¨è¡¨ç¤ºèŒƒå›´æ—¶ï¼Œ&lt;code&gt;%&lt;/code&gt;è¡¨ç¤ºæ•´ä¸ªæ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:&lt;/code&gt;åŠ è¡Œå·å®ç°è·³è½¬ï¼Œè¿™ä¸ªæ–¹æ³•å…¶å®å®ç”¨æ€§ä¸é«˜ï¼Œä¸å¦‚åœ¨æ™®é€šæ¨¡å¼ä¸‹ä½¿ç”¨è¡Œå·åŠ &amp;rsquo;G&amp;rsquo;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€äº›ç‰¹æ®Šæ ‡è®°ï¼š&lt;code&gt;&#39;m&lt;/code&gt; &lt;code&gt;&#39;&amp;lt;&lt;/code&gt; &lt;code&gt;&#39;&amp;gt;&lt;/code&gt;åˆ†åˆ«è¡¨ç¤ºä½ç½®æ ‡è®°ä¸º&lt;code&gt;m&lt;/code&gt;çš„è¡Œï¼Œé«˜äº®é€‰åŒºçš„èµ·å§‹è¡Œå’Œç»“æŸè¡Œã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å‘½ä»¤è¡Œä¸­ç”¨å¤åˆ¶ï¼ˆ&lt;code&gt;copy&lt;/code&gt; &lt;code&gt;t&lt;/code&gt;ï¼‰ã€ç§»åŠ¨ï¼ˆ&lt;code&gt;move&lt;/code&gt; &lt;code&gt;m&lt;/code&gt;ï¼‰å¾ˆå¤šæ—¶å€™ä¼šæ›´å¿«ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;normal&lt;/code&gt;å‘½ä»¤å¯ä»¥å®ç°åœ¨æŒ‡å®šèŒƒå›´æ‰§è¡Œæ™®é€šæ¨¡å¼å‘½ä»¤ï¼Œåœ¨æ¯æ¬¡æ‰§è¡Œå®Œä¹‹åè‡ªåŠ¨é€€å‡ºæ’å…¥æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Vim&lt;/strong&gt; çš„å‘½ä»¤è¡Œä¸shellä¸åŒï¼Œä¸Šä¸‹ç¿»å†å²ç”¨çš„ä¸æ˜¯&lt;code&gt;&amp;lt;M-p&amp;gt;&lt;/code&gt; &lt;code&gt;&amp;lt;M-n&amp;gt;&lt;/code&gt;è€Œæ˜¯&lt;code&gt;&amp;lt;C-p&amp;gt;&lt;/code&gt; &lt;code&gt;&amp;lt;C-n&amp;gt;&lt;/code&gt;ï¼ˆè€ç‰ˆæœ¬æ²¡æœ‰è¯¥ç‰¹æ€§éœ€è¦è‡ªå·±ç»‘å®š&lt;code&gt;cnoremap &amp;lt;C-p&amp;gt; &amp;lt;Up&amp;gt;&lt;/code&gt; &lt;code&gt;cnoremap &amp;lt;C-n&amp;gt; &amp;lt;Down&amp;gt;&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;é…ç½®äº†è·¯å¾„ä¹‹åå¯ä»¥ä½¿ç”¨ &lt;strong&gt;Vim&lt;/strong&gt; å†…å»ºçš„&lt;code&gt;find&lt;/code&gt;å‘½ä»¤ï¼Œå¦‚ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;:set path+={dirname/**}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;:find {filename}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å…¶ä»–æŠ€å·§&#34;&gt;å…¶ä»–æŠ€å·§&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ¸…å±&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ &lt;strong&gt;Vim&lt;/strong&gt; ä¸­ä¹Ÿå¯ä»¥åˆ©ç”¨&lt;code&gt;&amp;lt;C-l&amp;gt;&lt;/code&gt;è¿›è¡Œæ¸…å±ï¼Œè¿™ä¸ªæŠ€å·§åœ¨é€šè¿‡æŸ¥æ‰¾è·³è½¬æ—¶ç›¸å½“æœ‰ç”¨ï¼Œå› ä¸ºé«˜äº®æœ‰æ—¶ååˆ†çƒ¦äººã€‚ä¹Ÿæœ‰ä¸€åŠ³æ°¸é€¸çš„æ–¹æ³•ï¼Œå°±æ˜¯&lt;code&gt;set nohlsearch&lt;/code&gt;ç›´æ¥å…³é—­æŸ¥æ‰¾é«˜äº®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯åŠ¨æ—¶&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç å¯ä»¥åœ¨æ‰“å¼€æ–‡ä»¶æ—¶å…‰æ ‡å¤„äºä¸Šæ¬¡çš„æ›´æ–°ä½ç½®ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;autocmd BufReadPost * if line(&amp;#34;&amp;#39;\&amp;#34;&amp;#39;&amp;#34;) &amp;gt; 1 &amp;amp;&amp;amp; line(&amp;#34;&amp;#39;\&amp;#39;&amp;#34;) &amp;lt;= line(&amp;#34;$&amp;#34;) | exe &amp;#34;normal! g&amp;#39;\&amp;#34;&amp;#34; | endif
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä»£ç ä¿å­˜&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä½¿ç”¨çš„æ˜¯ &lt;strong&gt;Vim&lt;/strong&gt; ï¼Œæƒ³è¦ä»¥è¶…çº§ç”¨æˆ·æƒé™ä¿å­˜æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ä½¿ç”¨å‘½ä»¤&lt;code&gt;w !sudo tee % &amp;gt; /dev/null&lt;/code&gt;ï¼Œå³å°†ç¼“å†²åŒºé€šè¿‡&lt;code&gt;tee&lt;/code&gt;å‘½ä»¤è¾“å…¥åˆ°å½“å‰æ–‡ä»¶ä¸­ï¼Œå¹¶å°†æ ‡å‡†è¾“å‡ºæŠ›å¼ƒã€‚å¯ä»¥ç»‘å®šä¸ºï¼š&lt;code&gt;cmap w!! w !sudo tee % &amp;gt; /dev/null&lt;/code&gt;ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯ &lt;strong&gt;NeoVim&lt;/strong&gt; ï¼Œåˆ™å¾ˆé—æ†¾ä¸èƒ½ä½¿ç”¨è¿™ä¸ªå°æŠ€å·§ï¼Œå¯ä»¥ä½¿ç”¨æ’ä»¶ &lt;a href=&#34;https://github.com/lambdalisue/suda.vim&#34;&gt;&lt;strong&gt;Suda.vim&lt;/strong&gt;&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæƒ³è¦ä¿å­˜åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„ç›®å½•ï¼Œå¯ä»¥åˆ©ç”¨å¤–éƒ¨å‘½ä»¤åŠ ä¸Š&lt;code&gt;%:h&lt;/code&gt;çš„ç‰¹æ€§ï¼Œå¦‚ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;:!mkdir -p %:h
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;:w
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¼“å†²åŒº&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤šç¼“å†²åŒºç¼–è¾‘æ—¶ç”¨&lt;code&gt;:bprevious&lt;/code&gt; &lt;code&gt;:bnext&lt;/code&gt;å‘½ä»¤åˆ‡æ¢æ–‡ä»¶æ¯”è¾ƒéº»çƒ¦å¯ä»¥ç»‘å®šä¸ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nnoremap &amp;lt;silent&amp;gt; [b :bprevious&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nnoremap &amp;lt;silent&amp;gt; ]b :bnext&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nnoremap &amp;lt;silent&amp;gt; [B :bfirst&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nnoremap &amp;lt;silent&amp;gt; ]B :blast&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;åœ¨ç¼“å†²åŒºè¿›å…¥è½®æ¢ï¼Œå³&lt;code&gt;:ls&lt;/code&gt;æ—¶æ–‡ä»¶åå‰æœ‰äº•å·æ—¶ï¼Œæ‰å¯ä»¥ä½¿ç”¨&lt;code&gt;&amp;lt;C-^&amp;gt;&lt;/code&gt;å¿«é€Ÿåˆ‡æ¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:argdo&lt;/code&gt;å’Œ&lt;code&gt;:bufdo&lt;/code&gt;å‘½ä»¤å¯ä»¥å¯¹å¤šç¼“å†²åŒºè¿›è¡Œæ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ ‡ç­¾é¡µå’Œçª—å£&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›¸æ¯”ä¸ä½¿ç”¨å¤šç¼“å†²åŒºï¼Œä½¿ç”¨æ ‡ç­¾é¡µå’Œçª—å£æ›´åŠ ç›´è§‚ä¸”æ˜“äºæ“ä½œï¼Œå¯ä»¥è¾¾åˆ°ç±»ä¼¼äºä½¿ç”¨è™šæ‹Ÿæ¡Œé¢çš„æ•ˆæœã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:sp[lit] {file}&lt;/code&gt;æ°´å¹³åˆ†éš”çª—å£ï¼Œ&lt;code&gt;:vs[plit] {file}&lt;/code&gt;å‚ç›´åˆ†å‰²ï¼Œè¿™ä¸¤ä¸ªç”¨çš„æ¯”è¾ƒå¤šï¼›è€Œå¯¹äºåŒä¸€ä¸ªæ–‡ä»¶çš„åˆ†å±&lt;code&gt;&amp;lt;C-w&amp;gt;s&lt;/code&gt;å’Œ&lt;code&gt;&amp;lt;C-w&amp;gt;v&lt;/code&gt;å°±å¯èƒ½ç”¨å¾—æ¯”è¾ƒå°‘äº†ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨çª—å£é—´åˆ‡æ¢çš„å‘½ä»¤ï¼Œå‰ç¼€å…¨éƒ¨ä¸º&lt;code&gt;&amp;lt;C-w&amp;gt;&lt;/code&gt;ï¼ŒåŠ ä¸Šæ–¹å‘&lt;code&gt;hjkl&lt;/code&gt;å°±æ˜¯æŒ‰æ–¹å‘çš„åˆ‡æ¢ï¼ŒåŠ ä¸Š&lt;code&gt;w&lt;/code&gt;å°±æ˜¯å¾ªç¯åˆ‡æ¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:tabe[dit] {filename}&lt;/code&gt;åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼Œ&lt;code&gt;&amp;lt;C-w&amp;gt;T&lt;/code&gt;æŠŠå½“å‰çª—å£ç§»åˆ°æ–°æ ‡ç­¾é¡µï¼Œ&lt;code&gt;tabc[lose]&lt;/code&gt;å…³é—­å½“å‰æ ‡ç­¾é¡µåŠå…¶å…¨éƒ¨çª—å£ï¼Œ&lt;code&gt;tabo[nly]&lt;/code&gt;åªä¿æŒå½“å‰æ ‡ç­¾é¡µã€‚&lt;/li&gt;
&lt;li&gt;æ™®é€šæ¨¡å¼ä¸‹&lt;code&gt;{N}gt&lt;/code&gt;åˆ‡æ¢åˆ°æ ‡å·ä¸º&lt;code&gt;N&lt;/code&gt;çš„æ ‡ç­¾é¡µï¼Œå¦‚æœæ²¡æœ‰&lt;code&gt;N&lt;/code&gt;åˆ™æ˜¯åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªï¼Œ&lt;code&gt;gT&lt;/code&gt;æ˜¯åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è®¾ç½®æ ‡è®°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥é€šè¿‡&lt;code&gt;m{a-zA-Z}&lt;/code&gt;æ ‡è®°å…‰æ ‡æ‰€åœ¨ä½ç½®ï¼Œå°å†™æ˜¯å½“å‰ç¼“å†²åŒºå¯è§ï¼Œå¤§å†™æ˜¯å…¨å±€å¯è§ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;code&gt;&#39;{mark}&lt;/code&gt;è·³è½¬åˆ°æ ‡è®°çš„é‚£ä¸€è¡Œç¬¬ä¸€ä¸ªéç©ºç™½å­—ç¬¦ï¼Œ&lt;code&gt; `{mark}&lt;/code&gt;è·³è½¬åˆ°æ ‡è®°çš„å‡†ç¡®ä½ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æé«˜ç¼–è¾‘æ•ˆç‡çš„æ€è·¯&#34;&gt;æé«˜ç¼–è¾‘æ•ˆç‡çš„æ€è·¯&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨æ„ä¸€äº›æˆå¯¹çš„å‘½ä»¤çš„ä½¿ç”¨é€‰æ‹©ï¼Œå¦‚æ­£å‘è¿˜æ˜¯åå‘ã€åˆ°ç›®æ ‡ä½ç½®è¿˜æ˜¯åˆ°ç›®æ ‡ä½ç½®ä¹‹å‰ï¼Œè™½ç„¶æ¯æ¬¡ä¸ä¼šèŠ‚çº¦å¤ªå¤šæ—¶é—´ï¼Œä½†æ¯•ç«Ÿç§¯å°‘æˆå¤šã€‚&lt;/li&gt;
&lt;li&gt;å¤šæ„é€ èƒ½å¤Ÿé€šè¿‡&lt;code&gt;.&lt;/code&gt;æ¥é‡å¤çš„ç¼–è¾‘ï¼Œè¿™éœ€è¦æˆ‘ä»¬æ³¨æ„æ¯æ¬¡ç¼–è¾‘åå…‰æ ‡çš„ä½ç½®ï¼Œå¦‚æœä½¿ç”¨å®ä¹Ÿæ˜¯ç›¸åŒçš„é“ç†ã€‚&lt;/li&gt;
&lt;li&gt;èƒ½å¤Ÿé‡å¤å°±åˆ«ç”¨æ¬¡æ•°ï¼ˆä¸ºäº†æ’¤é”€æ—¶èƒ½å¤Ÿå½“ä½œæ•´ä½“ï¼‰:ä¾‹å¦‚&lt;code&gt;d3w&lt;/code&gt;å’Œ&lt;code&gt;2dw&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨é€‚å½“çš„æ—¶å€™å›åˆ°æ™®é€šæ¨¡å¼ï¼Œè®©æ¯ä¸€æ¬¡çš„ç¼–è¾‘æ›´åœ¨é€»è¾‘ä¸Šæ›´è¿è´¯ï¼ˆåŒæ ·æ˜¯æ–¹ä¾¿æ’¤é”€å’Œé‡å¤ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>gitignoreæ–‡ä»¶å¦‚ä½•ä¹¦å†™</title>
      <link>https://vaaandark.top/posts/how-to-write-gitignore/</link>
      <pubDate>Tue, 08 Feb 2022 13:32:19 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/how-to-write-gitignore/</guid>
      <description>&lt;p&gt;ä¹‹å‰ä½¿ç”¨&lt;code&gt;git&lt;/code&gt;åŸºæœ¬åªæ˜¯æŠŠå®ƒå½“ä½œæäº¤åˆ° &lt;strong&gt;GitHub&lt;/strong&gt; ä¸Šçš„å·¥å…·ï¼Œæœ€å¤šä½¿ç”¨åˆ°çš„åŠŸèƒ½å°±æ˜¯æ¢å¤è¯¯åˆ çš„æ–‡ä»¶è€Œå·²ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;åœ¨æˆ‘ä¹‹å‰çš„&lt;code&gt;git&lt;/code&gt;å‘½ä»¤ä½¿ç”¨ä¹‹ä¸­ï¼ŒåŸºæœ¬ä¸Šç”¨çš„å°±æ˜¯&lt;code&gt;git clone&lt;/code&gt;ã€&lt;code&gt;git add .&lt;/code&gt;ã€&lt;code&gt;git commit -m&lt;/code&gt;ä»¥åŠ&lt;code&gt;git commit push&lt;/code&gt;ã€‚ç”±äºåŸºæœ¬ä¸Šæ˜¯æ— è„‘&lt;code&gt;add&lt;/code&gt;ï¼Œå› æ­¤&lt;code&gt;.gitigore&lt;/code&gt;çš„æ–‡ä»¶ä¹¦å†™æ¯”è¾ƒé‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘æƒ³å¤ä¹ å¹¶å®è·µä¸€ä¸‹&lt;code&gt;git&lt;/code&gt;çš„æ“ä½œï¼Œåœ¨ç¿»çœ‹&lt;code&gt;git&lt;/code&gt;çš„æ–‡æ¡£æ—¶ï¼Œå‘ç°&lt;code&gt;.gitigore&lt;/code&gt;æ–‡ä»¶å¹¶æ²¡æœ‰æˆ‘æƒ³è±¡çš„é‚£ä¹ˆç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥å…ˆè®¾æƒ³å‡ ä¸ªæƒ…æ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªå­ç›®å½•é‡Œé¢çš„&lt;code&gt;tmp&lt;/code&gt;æ–‡ä»¶å¤¹éƒ½ä¸åŠ å…¥åˆ°&lt;code&gt;git&lt;/code&gt;çš„ç‰ˆæœ¬æ§åˆ¶ä¸­&lt;/li&gt;
&lt;li&gt;åªæœ‰æ ¹ç›®å½•ä¸‹çš„&lt;code&gt;tmp&lt;/code&gt;æ–‡ä»¶å¤¹ä¸åŠ å…¥&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰çš„&lt;code&gt;tmp&lt;/code&gt;æ–‡ä»¶å¤¹ï¼Œé™¤äº†&lt;code&gt;a/b/tmp&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¿½ç•¥&lt;code&gt;a&lt;/code&gt;ç›®å½•ä¸‹æ‰€æœ‰çš„&lt;code&gt;pdf&lt;/code&gt;æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;å¿½ç•¥&lt;code&gt;a&lt;/code&gt;ç›®å½•ä¸‹åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰çš„&lt;code&gt;pdf&lt;/code&gt;æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;å¿½ç•¥æŒ‡å®šæ–‡ä»¶ä¹‹å¤–çš„æ–‡ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨è§£å†³è¿™äº›é—®é¢˜ä¹‹å‰ï¼Œæˆ‘å…ˆäº†è§£äº†ä¸€ä¸‹&lt;code&gt;gitignore&lt;/code&gt;çš„è¯­æ³•è®¾è®¡ã€‚å®ƒè¢«ç§°ä¸º &lt;strong&gt;glob&lt;/strong&gt; æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;shell&lt;/code&gt;ä¸­ä½¿ç”¨åˆ°çš„ç®€åŒ–äº†çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå› æ­¤æŒæ¡å®ƒæ˜¯æ²¡æœ‰ä»€ä¹ˆéš¾åº¦çš„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# å¿½ç•¥æ‰€æœ‰çš„ .a æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;*.a
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# ä½†è·Ÿè¸ªæ‰€æœ‰çš„ lib.aï¼Œå³ä¾¿ä½ åœ¨å‰é¢å¿½ç•¥äº† .a æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;!lib.a
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# åªå¿½ç•¥å½“å‰ç›®å½•ä¸‹çš„ tmp æ–‡ä»¶å¤¹ï¼Œè€Œä¸å¿½ç•¥å­ç›®å½•ä¸­çš„ tmp
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/tmp/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# å¿½ç•¥ä»»ä½•ç›®å½•ä¸‹åä¸º tmp çš„æ–‡ä»¶å¤¹
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tmp/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# å¿½ç•¥ doc ç›®å½•ä¸‹çš„ pdf æ–‡ä»¶ï¼Œä½†ä¸å¿½ç•¥ doc å­ç›®å½•ä¸­çš„ pdf æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;doc/*.pdf
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;# å¿½ç•¥ doc/ ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ä¸‹çš„ .pdf æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;doc/**/*.pdf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>CSAPP Data Lab</title>
      <link>https://vaaandark.top/posts/csapp-data-lab/</link>
      <pubDate>Wed, 02 Feb 2022 13:06:25 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/csapp-data-lab/</guid>
      <description>&lt;p&gt;æœ€è¿‘æœ¬æ¥åœ¨çœ‹ &lt;em&gt;&lt;strong&gt;CSAPP&lt;/strong&gt;&lt;/em&gt; åé¢çš„å†…å®¹ï¼Œä½†çªç„¶å‘ç°è‡ªå·±å‰é¢å¯èƒ½è¿˜æœ‰ä¸€äº›çŸ¥è¯†æŒæ¡ä¸å®Œå…¨ï¼Œå› æ­¤åšä¸€ä¸‹ Lab æ£€éªŒä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h1 id=&#34;å‡†å¤‡å·¥ä½œ&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ CSAPP çš„å®˜ç½‘ä¸Šæ‰¾åˆ° Labï¼Œä¸‹è½½ Self-Study Handoutã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ä¸‹è½½ç›®å½•ä¸‹è§£å‹æ–‡ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tar -xf datalab-handout.tar
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å°è¯•æ‰§è¡Œè‡ªåŠ¨æµ‹è¯„è„šæœ¬&lt;code&gt;driver.pl&lt;/code&gt;ç»“æœå‘ç°æ²¡æœ‰32ä½ç¯å¢ƒï¼Œäºæ˜¯ç”¨&lt;code&gt;dnf&lt;/code&gt;å®‰è£…éœ€è¦çš„åº“ï¼ŒæŠ˜è…¾äº†ä¸€ä¼šå‘ç°è¿˜æ˜¯ä¸å¤ªè¡Œã€‚è¯·æ•™äº†å¤§ä½¬ &lt;a href=&#34;https://www.cnblogs.com/jyi2ya&#34;&gt;&lt;strong&gt;jyi2ya&lt;/strong&gt;&lt;/a&gt;ï¼Œä»–å‘Šè¯‰æˆ‘å¯ä»¥ç›´æ¥åœ¨&lt;code&gt;makefile&lt;/code&gt;é‡Œé¢æŠŠç¼–è¯‘æ¡ä»¶æ”¹ä¸º&lt;code&gt;-m64&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;é¢˜ç›®ä¸é¢˜è§£&#34;&gt;é¢˜ç›®ä¸é¢˜è§£&lt;/h1&gt;
&lt;h2 id=&#34;int-éƒ¨åˆ†&#34;&gt;int éƒ¨åˆ†&lt;/h2&gt;
&lt;h3 id=&#34;bitxor&#34;&gt;bitXor&lt;/h3&gt;
&lt;p&gt;åªç”¨&lt;code&gt;~&lt;/code&gt;å’Œ&lt;code&gt;&amp;amp;&lt;/code&gt;å®ç°&lt;code&gt;^&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E5%BE%B7%E6%91%A9%E6%A0%B9%E5%AE%9A%E5%BE%8B&#34;&gt;&lt;strong&gt;å¾·æ‘©æ ¹å®šç†&lt;/strong&gt;&lt;/a&gt;ç§’æ€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; bitXor(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; y) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; ~(~(~x &amp;amp; y) &amp;amp; ~(x &amp;amp; ~y));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;tmin&#34;&gt;tmin&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ä½è¿ç®—è·å–è¡¥ç çš„æœ€å°å€¼&lt;/p&gt;
&lt;p&gt;ç”±äºé¢˜ç›®å·²ç»å‘Šè¯‰äº†æˆ‘ä»¬æœºå™¨ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸º&lt;code&gt;int&lt;/code&gt;ç±»å‹æ˜¯å å…«ä¸ªå­—èŠ‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; tmin(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;void&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;31&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;istmax&#34;&gt;isTmax&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ä½è¿ç®—è·å–åˆ¤æ–­æ˜¯å¦æ˜¯è¡¥ç çš„æœ€å¤§å€¼&lt;/p&gt;
&lt;p&gt;è¿™é¢˜ç›¸è¾ƒä¸Šé¢˜æœ‰ä¸€å®šçš„æŠ€å·§ã€‚ä¸»è¦æ€è·¯ä¸ºæŠŠè¡¥ç çš„æ¯ä¸€ä½å˜ä¸º1ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¾—åˆ°0æˆ–é0çš„å€¼ã€‚åœ¨è½¬æ¢çš„è¿‡ç¨‹ä¸­è¦æ³¨æ„åˆ°-1åŒæ ·é€‚ç”¨ï¼Œæ‰€ä»¥è¦å¯¹-1è¿›è¡Œç‰¹åˆ¤ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; isTmax(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// å¦‚æœæ˜¯0b111...111æˆ–è€…0b011...111å°±èƒ½å˜ä¸º0b000...000
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; check = ~(x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; + x);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#007f7f&#34;&gt;// å¦‚æœæ˜¯-1åˆ™ç»“æœä¸º1ï¼Œæ’é™¤æ‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; except = !(x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; !(check | except);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;alloddbits&#34;&gt;allOddBits&lt;/h3&gt;
&lt;p&gt;åˆ¤æ–­æ‰€æœ‰å¥‡æ•°ä½æ˜¯å¦éƒ½ä¸º1&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹çš„æƒ³æ³•æ˜¯ç›´æ¥æš´åŠ›åˆ¤æ–­æ¯ä¸ªå¥‡æ•°ä½æ˜¯å¦ä¸º1ï¼ˆå…ˆç§»ä½ç„¶åè¿›è¡Œé€»è¾‘ä¸è¿ç®—ï¼‰ï¼Œä½†æ˜¯è¿™æ ·åº”è¯¥å¾—ä¸åˆ°æ€§èƒ½åˆ†ã€‚äºæ˜¯æˆ‘æƒ³åˆ°äº†ç±»ä¼¼äºäºŒåˆ†æ³•çš„æ€æƒ³ï¼Œæ¯æ¬¡å¯¹åŠæ¯”è¾ƒï¼Œæœ€ååªéœ€è¦ä¸ƒæ¬¡æ“ä½œæã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; allOddBits(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x &amp;amp;= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;16&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x &amp;amp;= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;8&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; !(x &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0xaa&lt;/span&gt; ^ &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0xaa&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;negate&#34;&gt;negate&lt;/h3&gt;
&lt;p&gt;ä¸ä½¿ç”¨&lt;code&gt;-&lt;/code&gt;æ“ä½œç¬¦ï¼Œæ±‚&lt;code&gt;-x&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿ç”¨è¡¥ç çš„åŸºç¡€çŸ¥è¯†å¾—åˆ°ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; negate(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; (~x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;isasciidigit&#34;&gt;isAsciiDigit&lt;/h3&gt;
&lt;p&gt;è®¡ç®—è¾“å…¥å€¼æ˜¯å¦æ˜¯æ•°å­—&lt;code&gt;0-9&lt;/code&gt;çš„ &lt;strong&gt;ASCII&lt;/strong&gt; å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹æ‰“ç®—å…ˆåˆ¤æ–­å‰å¤šå°‘å¤šå°‘ä½æ˜¯ä¸æ˜¯0ï¼Œåé¢æ˜¯å¦æ»¡è¶³&lt;code&gt;0x30 &amp;lt;= x &amp;lt;= 0x39&lt;/code&gt;ï¼Œåæ¥ä¸€æƒ³å‘ç°è¿™æ ·å¥½å¤æ‚ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡èŒƒå›´åˆ¤æ–­ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå°æŠ€å·§ï¼Œè¿™ä¸ªæŠ€å·§ä¹Ÿå¯ä»¥ä¼˜åŒ–åˆ†æ”¯é¢„æµ‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (x &amp;gt;= a &amp;amp;&amp;amp; x &amp;lt;= b) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  do_something();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;// ç­‰ä»·äº
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#007f7f&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; ((x - a) | (b - x) &amp;gt;= ) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  do_something();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œä¸èƒ½ä½¿ç”¨&lt;code&gt;-&lt;/code&gt;ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨å‰é¢é¢˜ç›®çš„ç»“è®ºï¼Œé€šè¿‡å–åå’ŒåŠ æ³•ä»£æ›¿å‡æ³•ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ç­”æ¡ˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; isAsciiDigit(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; !(((x + (~&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x30&lt;/span&gt; + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;)) | ((~x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;) + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x39&lt;/span&gt;)) &amp;amp; (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;31&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;conditional&#34;&gt;conditional&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ä½è¿ç®—æ¨¡æ‹Ÿä¸‰ç›®è¿ç®—&lt;/p&gt;
&lt;p&gt;ä¸éš¾æƒ³åˆ°ï¼šä¸€ä¸ªæ•°å’Œ&lt;code&gt;0x0&lt;/code&gt;è¿›è¡Œé€»è¾‘ä¸æ“ä½œçš„ç»“æœæ˜¯&lt;code&gt;0x0&lt;/code&gt;ï¼Œä¸€ä¸ªæ•°å’Œ&lt;code&gt;~0x0&lt;/code&gt;è¿›è¡Œé€»è¾‘ä¸æ“ä½œçš„ç»“æœæ˜¯æœ¬èº«ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªä¸&lt;code&gt;x&lt;/code&gt;æœ‰å…³çš„æ©ç ï¼Œå½“xä¸ºçœŸæ—¶å°±æ˜¯&lt;code&gt;0xffffffff&lt;/code&gt;ï¼Œå¦åˆ™ä¸º&lt;code&gt;0x0&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; conditional(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; y, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; z) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; mask = !x + (~&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  y &amp;amp;= mask;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  z &amp;amp;= ~mask;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; y | z;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;islessorequal&#34;&gt;isLessOrEqual&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ä½è¿ç®—æ¨¡æ‹Ÿå°äºç­‰äº&lt;/p&gt;
&lt;p&gt;å°†ä¸¤ä¸ªæ•°ç§»åˆ°ä¸€è¾¹å˜ä¸ºå‡æ³•è¿ç®—ï¼Œå†æŠŠå‡æ³•è¿ç®—å˜ä¸ºåŠ ä¸Šç»å¯¹å€¼çš„åŠ æ³•è¿ç®—ï¼Œæœ€ååˆ¤æ–­æœ€é«˜ä½æ˜¯å¦ä¸º0å³å¯ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; isLessOrEqual(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; y) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; !(y + (~x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;) &amp;amp; (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;31&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æœè¿™ä¸ªä»£ç è¢«æœ‹å‹å‰æ‰äº†ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰è€ƒè™‘åˆ°æº¢å‡ºçš„æƒ…å†µï¼Œæ‰€ä»¥è¦åŠ ä¸Šå¯¹ä¸€ä¸ªæ˜¯æ­£æ•°ä¸€ä¸ªæ˜¯è´Ÿæ•°çš„ç‰¹åˆ¤ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; isLessOrEqual(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x, &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; y) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; (((x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;31&lt;/span&gt;) &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;) | (!(y &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;31&lt;/span&gt;))) &amp;amp; !(y + (~x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;) &amp;amp; (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;31&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;logicalneg&#34;&gt;logicalNeg&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ä½è¿ç®—æ¨¡æ‹Ÿé€»è¾‘é&lt;/p&gt;
&lt;p&gt;æˆ‘å¾ˆè‡ªç„¶åœ°æƒ³åˆ°äº†è¿™æ ·çš„ä»£ç ï¼Œç»“æœå‘ç°æ²¡æœ‰æ‹¿åˆ°æ€§èƒ½åˆ†ï¼Œåˆšå¥½æ¯”è¦æ±‚å¤šä¸€ä¸ªæ“ä½œã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; logicalNeg(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x ^= ~&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x &amp;amp;= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;16&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x &amp;amp;= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;8&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x &amp;amp;= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x &amp;amp;= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x &amp;amp;= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; x &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;äºæ˜¯æˆ‘åˆ†æè¿™æ®µåƒåœ¾ä»£ç ï¼Œå‘ç°&lt;code&gt;x ^= ~0&lt;/code&gt;å°±å ç”¨äº†ä¸¤æ­¥æ“ä½œï¼Œè€Œä¸”æœ‰æ›´å¥½çš„æ›¿ä»£æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¾ç„¶ä½¿ç”¨ç±»ä¼¼äºŒåˆ†æ³•çš„æ€æƒ³ï¼ŒåŒæ—¶ä»¥ä½¿ç”¨æˆ–æ“ä½œä¸ºä¸»ï¼Œå°±èƒ½èŠ‚çº¦æ“ä½œäº†ã€‚ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; logicalNeg(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x |= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;16&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x |= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;8&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x |= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x |= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x |= (x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; x &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; ^ &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;howmanybits&#34;&gt;howManyBits&lt;/h3&gt;
&lt;p&gt;æ±‚æœ€å°‘ç”¨å¤šå°‘ä¸ªä½å¯ä»¥è¡¨ç¤ºå‡ºç»™å®šæ•°å­—&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹åšè¿™é¢˜æ—¶ï¼Œæˆ‘çœ‹ç€é¢˜ç›®çš„ä¾‹å­æä¸æ‡‚ä¸ºå•¥&lt;code&gt;-1&lt;/code&gt;åªéœ€è¦ä¸€ä½ã€‚æœ€åæˆ‘çš„ç†è§£å°±æ˜¯ï¼Œé¢˜ç›®æƒ³é—®çš„æ˜¯â€œæœ€å°‘ç”¨å¤šå°‘ä¸ªä½å¯ä»¥è¡¨ç¤ºä»0åˆ°ç»™å®šçš„æ•°å­—â€ï¼Œå› æ­¤å¦‚æœç»™å‡ºè´Ÿæ•°æˆ‘ä»¬å°±ä¸éœ€è¦è€ƒè™‘æ­£æ•°ï¼Œåä¹‹åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¿™é“é¢˜è½¬åŒ–ä¸ºäº†æ±‚ $log_2x$ ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯å¯ä»¥å°†ç”¨ç±»ä¼¼äºŒåˆ†çš„æ€æƒ³è§£é¢˜ã€‚é¦–å…ˆåˆ¤æ–­å‰16ä½æ˜¯å¦æœ‰1ï¼Œå¦‚æœæœ‰å°±è¦åŠ ä¸Š16ï¼ŒåŒæ—¶ä¸‹ä¸€æ¬¡çš„ç§»ä½è¦å¤šç§»åŠ¨16ä½ï¼Œä¾æ­¤ç±»æ¨ã€‚æ¯æ¬¡åŠ ä¸Šçš„æƒä¸åŒï¼Œä»£è¡¨è¿™æ¬¡åˆ¤æ–­çš„ä¸€å…±æœ‰&lt;code&gt;n&lt;/code&gt;ä½ï¼ˆ16ã€8ã€4ã€2ã€1ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; howManyBits(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; mask, b16, b8, b4, b2, b1, b0;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  mask = x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;31&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x = (mask &amp;amp; ~x) | (~mask &amp;amp; x);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  b16 = !!(x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;16&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x = x &amp;gt;&amp;gt; b16;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  b8 = !!(x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;8&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;3&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x = x &amp;gt;&amp;gt; b8;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  b4 = !!(x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;4&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x = x &amp;gt;&amp;gt; b4;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  b2 = !!(x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;2&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x = x &amp;gt;&amp;gt; b2;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  b1 = !!(x &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  x = x &amp;gt;&amp;gt; b1;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  b0 = x;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; b16 + b8 + b4 + b2 + b1 + b0 + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;float-éƒ¨åˆ†&#34;&gt;float éƒ¨åˆ†&lt;/h2&gt;
&lt;p&gt;æµ®ç‚¹æ•°çš„é¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œåªè€ƒå¯Ÿå…¶ç»“æ„è€Œä¸æ˜¯è¿ç®—ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºäº†ä½è¿ç®—æ–¹ä¾¿ï¼Œé¢˜ç›®ä¸­ç»™å‡ºçš„å‡½æ•°å‚æ•°å’Œè¿”å›å€¼éƒ½æ˜¯ä¸&lt;code&gt;float&lt;/code&gt;é•¿åº¦ç›¸åŒçš„&lt;code&gt;unsigned int&lt;/code&gt;æˆ–è€…&lt;code&gt;int&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;floatscale2&#34;&gt;floatScale2&lt;/h3&gt;
&lt;p&gt;æ±‚ä¸€ä¸ªæµ®ç‚¹æ•°ä¹˜2&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆå–å‡ºç¬¦å·&lt;code&gt;sign&lt;/code&gt;ã€å°¾æ•°&lt;code&gt;frac&lt;/code&gt;ã€é˜¶ç &lt;code&gt;exp&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœé˜¶ç æ˜¯0ï¼Œè¯´æ˜æ˜¯ä¸€ä¸ªéè§„æ ¼åŒ–çš„æµ®ç‚¹æ•°ï¼Œç”±äºæµ®ç‚¹æ•°çš„åˆ†è§„æ ¼åŒ–åˆ°è§„æ ¼åŒ–çš„è¿‡æ¸¡æ˜¯è¿ç»­çš„ï¼Œå› æ­¤å°¾æ•°å‘å·¦ç§»åŠ¨ä¸€ä½å˜æˆè§„æ ¼åŒ–æµ®ç‚¹æ•°ä¸æ˜¯ç‰¹æ®Šæƒ…å†µã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœé˜¶ç å…¨ä¸º1ï¼Œè¯´æ˜æ˜¯æ— ç©·å¤§ï¼Œç›´æ¥åŸæ ·è¿”å›å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;ç»™é˜¶ç åŠ ä¸Š1ï¼Œå³æ˜¯ç»™å˜é‡&lt;code&gt;exp&lt;/code&gt;åŠ ä¸Š&lt;code&gt;0x800000&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæº¢å‡ºäº†å˜ä¸ºæ— ç©·å¤§ï¼Œå°±è¦å°†å°¾æ•°å˜ä¸º0ï¼Œå¦åˆ™å°±æ˜¯&lt;code&gt;NaN&lt;/code&gt;äº†ã€‚&lt;/li&gt;
&lt;li&gt;å°†ä¸‰éƒ¨åˆ†æ‹¼æ¥åè¿”å›ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; floatScale2(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; uf) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; sign = uf &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x80000000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; exp = uf &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x7f800000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; frac = uf &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x007fffff&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (exp == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; sign | uf &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (exp == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x7f800000&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; uf;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  exp += &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00800000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (exp == &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x7f800000&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    frac = &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; sign | exp | frac;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;floatfloat2int&#34;&gt;floatFloat2Int&lt;/h3&gt;
&lt;p&gt;å°†ä¸€ä¸ªæµ®ç‚¹æ•°è½¬æ¢ä¸ºæ•´å‹æ•°&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;em&gt;&lt;strong&gt;CSAPP&lt;/strong&gt;&lt;/em&gt; ä¸­ä»‹ç»è¿‡å‡ ç§èˆå…¥çš„æ–¹æ³•ï¼Œåœ¨è®¡ç®—ä¸­å‘å¶æ•°ï¼ˆå¥‡æ•°ï¼‰ä½èˆå…¥ä¼šå‡å°è¯¯å·®ï¼Œè€Œåœ¨ç±»å‹è½¬æ¢ä¸­ï¼Œä½¿ç”¨å‘é›¶èˆå…¥ä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆå°†ç¬¦å·ã€å°¾æ•°ã€é˜¶ç å–å‡ºæ¥ï¼Œä¸ºäº†åŠ å‡æ³•è®¡ç®—æ–¹ä¾¿ï¼Œå¯¹é˜¶ç è¿›è¡Œäº†ç§»ä½ï¼Œå¹¶åŠ ä¸Šäº†127ã€‚&lt;/li&gt;
&lt;li&gt;å°¾æ•°çš„ç¬¬24ä½ç½®ä¸º1ï¼Œå› ä¸ºåœ¨è§„æ ¼åŒ–æ•°ä¸­å°±æ˜¯&lt;code&gt;1.x&lt;/code&gt;çš„å½¢å¼ã€‚è€Œéè§„æ ¼åŒ–æ•°èˆå…¥å˜ä¸º0ï¼Œä¸éœ€è¦è€ƒè™‘å…¶å°¾æ•°ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœé˜¶å°äº0ï¼Œç›´æ¥è¿”å›0ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœé˜¶å¤§äº31ï¼Œè¯´æ˜æ˜¯æ— ç©·å¤§ã€‚&lt;/li&gt;
&lt;li&gt;å…¶ä½™æƒ…å†µå°±æ˜¯å¯¹åŠ ä¸Š&lt;code&gt;1.x&lt;/code&gt;ï¼ˆ&lt;code&gt;x&lt;/code&gt;ä¸ºå°¾æ•°ï¼‰è¿›è¡Œç§»ä½ï¼Œç”±äºå°¾æ•°é•¿24ä½ï¼Œå› æ­¤æœ‰æ–¹å‘å’Œç»å¯¹å€¼è¦æ³¨æ„ã€‚&lt;/li&gt;
&lt;li&gt;å¸¦ä¸Šç¬¦å·åè¿”å›ç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; floatFloat2Int(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; uf) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; ans;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; sign = uf &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x80000000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; exp = ((uf &amp;gt;&amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;23&lt;/span&gt;) &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0xff&lt;/span&gt;) -&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;127&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; frac = (uf &amp;amp; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x007fffff&lt;/span&gt;) | &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x00800000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (exp &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (exp &amp;gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;31&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0x80000000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (exp &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;23&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ans = frac &amp;gt;&amp;gt; (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;23&lt;/span&gt; - exp);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ans = frac &amp;lt;&amp;lt; (exp - &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;23&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; sign ? ~ans + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; : ans;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;floatpower2&#34;&gt;floatPower2&lt;/h3&gt;
&lt;p&gt;æ±‚$2.0^x$&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ä¸€ä¸ªç»“è®ºï¼šæœ€å°çš„éè§„æ ¼åŒ–æ•°æ˜¯ $2^{-23}*2^{-126}$ ï¼Œæœ€å¤§çš„éè§„æ ¼åŒ–æ•°æ˜¯ $(1-u)*2^{-126}$ ï¼Œæœ€å°çš„è§„æ ¼åŒ–æ•°æ˜¯ $2^{-126}$ ï¼Œæœ€å¤§è§„æ ¼åŒ–æ•°æ˜¯ $(2-u)*2^{127}$ï¼Œå…¶ä¸­ $u$ ä¸ºæ— ç©·å°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;unsigned&lt;/span&gt; floatPower2(&lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;int&lt;/span&gt; x) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (x &amp;lt; -&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;149&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (x &amp;lt; -&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;126&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;1&lt;/span&gt; &amp;lt;&amp;lt; x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;149&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;if&lt;/span&gt; (x &amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;128&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; x + &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;127&lt;/span&gt; &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;23&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#fff;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;0xff&lt;/span&gt; &amp;lt;&amp;lt; &lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;23&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æµ‹è¯„ç»“æœ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Correctness Results	Perf Results
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Points	Rating	Errors	Points	Ops	Puzzle
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1	1	0	2	8	bitXor
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1	1	0	2	1	tmin
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1	1	0	2	7	isTmax
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2	2	0	2	7	allOddBits
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2	2	0	2	2	negate
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;3	3	0	2	10	isAsciiDigit
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;3	3	0	2	8	conditional
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;3	3	0	2	6	isLessOrEqual
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4	4	0	2	12	logicalNeg
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4	4	0	2	36	howManyBits
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4	4	0	2	11	floatScale2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4	4	0	2	15	floatFloat2Int
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4	4	0	2	10	floatPower2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Score = 62/62 [36/36 Corr + 26/26 Perf] (&lt;span style=&#34;color:#ff0;font-weight:bold&#34;&gt;133&lt;/span&gt; total operators)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åšäº† &lt;em&gt;&lt;strong&gt;CSAPP&lt;/strong&gt;&lt;/em&gt; çš„ &lt;strong&gt;Data Lab&lt;/strong&gt; è¿˜æ˜¯æ”¶è·è‰¯å¤šçš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘ç°è‡ªå·±ä¹‹å‰å­¦ä¹ çš„ä½è¿ç®—å’Œæµ®ç‚¹æ•°çš„çŸ¥è¯†è¿˜æœ‰ä¸å°‘æ¼æ´ï¼Œå¹¸å¥½è¡¥èµ·æ¥äº†ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨åšè¿™ç§é™åˆ¶æ“ä½œçš„é¢˜ç›®æ—¶ï¼Œä¸€å¼€å§‹è¿˜æ˜¯ä¼šæ„Ÿè§‰å¾ˆä¸é€‚åº”ï¼Œç–¯ç‹‚åœ°æƒ³å†™åˆ†æ”¯åˆ¤æ–­ç­‰æ“ä½œã€‚åšæŒä¸‹æ¥ä¹‹åå°±æœ‰ä¸å°çš„æé«˜ï¼Œå¯¹æŠ½è±¡èƒ½åŠ›å’Œå†™æ›´é«˜æ€§èƒ½çš„ä»£ç éƒ½æœ‰å¸®åŠ©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Lab&lt;/strong&gt; ä¸­ç»™å‡ºçš„&lt;code&gt;makefile&lt;/code&gt;å¼€çš„ç¼–è¯‘é€‰é¡¹ç»™æˆ‘æŠ¥äº†å¾ˆå¤šè­¦å‘Šï¼Œè®©æˆ‘å‘ç°æˆ‘çš„ä»£ç ä¹ æƒ¯ä¸æ˜¯å¾ˆå¥½ï¼Œè¿˜æœ‰å¾ˆå¤§è¿›æ­¥ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>æ–æ³¢é‚£å¥‘å †</title>
      <link>https://vaaandark.top/posts/fibonacci-heap/</link>
      <pubDate>Mon, 31 Jan 2022 12:51:49 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/fibonacci-heap/</guid>
      <description>&lt;p&gt;è”åˆ› Lab ç»„æ–°äººä»»åŠ¡ç¬¬ä¸€å¼¹ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;å…³äºæ–æ³¢é‚£å¥‘å †&#34;&gt;å…³äºæ–æ³¢é‚£å¥‘å †&lt;/h2&gt;
&lt;h3 id=&#34;ç»“æ„ä¸ç‰¹ç‚¹&#34;&gt;ç»“æ„ä¸ç‰¹ç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ–æ³¢é‚£å¥‘å †æ˜¯ç”±ä¸€ç»„æœ€å°å †æœ‰åºæ ‘æ„æˆçš„ã€‚æ¯ä¸ªèŠ‚ç‚¹çš„åº¦æ•°ä¸ºå…¶å­èŠ‚ç‚¹çš„æ•°ç›®ã€‚æ ‘çš„åº¦æ•°ä¸ºå…¶æ ¹èŠ‚ç‚¹çš„åº¦æ•°ã€‚&lt;/li&gt;
&lt;li&gt;æ–æ³¢é‚£å¥‘å †ä¸­çš„æ ‘éƒ½æ˜¯æœ‰æ ¹çš„ä½†æ˜¯æ— åºã€‚æ¯ä¸ªèŠ‚ç‚¹xåŒ…å«æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆp[x]å’ŒæŒ‡å‘ä»»æ„ä¸€ä¸ªå­ç»“ç‚¹çš„child[x]ã€‚xçš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½ç”¨åŒå‘å¾ªç¯é“¾è¡¨é“¾æ¥èµ·æ¥ï¼Œå«åšxçš„å­é“¾è¡¨ã€‚å­é“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹yéƒ½æœ‰æŒ‡å‘å®ƒçš„å·¦å…„å¼Ÿçš„left[y]å’Œå³å…„å¼Ÿçš„right[y]ã€‚å¦‚æœèŠ‚ç‚¹yæ˜¯xä»…æœ‰çš„å­èŠ‚ç‚¹ï¼Œåˆ™left[y]=right[y]=yã€‚&lt;/li&gt;
&lt;li&gt;æ–æ³¢é‚£å¥‘å †ä¸­æ‰€æœ‰æ ‘çš„æ ¹èŠ‚ç‚¹ä¹Ÿç”¨ä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨é“¾æ¥èµ·æ¥ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ–æ³¢é‚£å¥‘å †ä¸­æœ€å°å…ƒç´ ã€‚
æ–æ³¢é‚£å¥‘å †å°†æ“ä½œå°½å¯èƒ½åœ°å»¶åï¼Œå®ƒçš„æ’å…¥æ˜¯æ‡’æƒ°çš„ï¼Œåªæœ‰åœ¨ä¸å¾—ä¸è¿›è¡Œåˆå¹¶æ“ä½œæ—¶æ‰è¿›è¡Œåˆå¹¶ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œå®ƒç”šè‡³æ˜¯ä¸€ä¸ªé•¿åº¦å¾ˆå¤§çš„é“¾è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ’å…¥æ“ä½œ&#34;&gt;æ’å…¥æ“ä½œ&lt;/h3&gt;
&lt;p&gt;å°†ä¸€ä¸ªèŠ‚ç‚¹ç›´æ¥æ’å…¥åˆ°æ ¹é“¾è¡¨ä¸­ï¼Œå¹¶æ¯”è¾ƒé”®å€¼çš„å¤§å°ï¼Œå¦‚æœæ–°èŠ‚ç‚¹çš„é”®å€¼å°äºåŸæœ‰èŠ‚ç‚¹çš„é”®å€¼ï¼Œå°±å°†æ–æ³¢é‚£å¥‘å †çš„æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„æŒ‡é’ˆæŒ‡å‘å®ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆ é™¤æœ€å°èŠ‚ç‚¹æ“ä½œ&#34;&gt;åˆ é™¤æœ€å°èŠ‚ç‚¹æ“ä½œ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆå°†æœ€å°èŠ‚ç‚¹çš„å„¿å­æ’å…¥åˆ°æ ¹é“¾è¡¨ä¸­ï¼Œå†åˆ é™¤æ‰è¿™ä¸ªç›®æ ‡èŠ‚ç‚¹ã€‚å†éå†æ ¹é“¾è¡¨ï¼Œåˆå¹¶æ‰€æœ‰æ ¹èŠ‚ç‚¹æ˜¯ç›¸åŒåº¦æ•°çš„å †ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºæœ¬æ¬¡å®ç°ä¸éœ€è¦å®ç°å¯¹èŠ‚ç‚¹é”®å€¼çš„æ”¹å˜æˆ–è€…æ ¹æ®é”®å€¼åˆ é™¤èŠ‚ç‚¹ï¼Œå› æ­¤è¿™é‡Œçš„æ–æ³¢é‚£å¥‘å †å¯ä»¥è¿›è¡Œä¸€å®šç¨‹åº¦çš„ç®€åŒ–ï¼šä¸å†éœ€è¦æŒ‡å‘çˆ¶äº²èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä¹Ÿä¸éœ€è¦ç¬¬ä¸€ä¸ªå„¿å­æ˜¯å¦è¢«åˆ é™¤çš„æ ‡è®°ã€‚ç”±äºä¸éœ€è¦ç»´æŠ¤æŒ‡å‘çˆ¶äº²çš„æŒ‡é’ˆï¼Œåœ¨å°†å„¿å­ä»¬åˆå¹¶åˆ°æ ¹é“¾è¡¨æ—¶çš„æ“ä½œä¹Ÿå¯ä»¥ç®€åŒ–ï¼Œç›´æ¥å°†ä¸¤ä¸ªé“¾è¡¨åˆå¹¶å³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å®ç°æ–æ³¢é‚£å¥‘å †&#34;&gt;å®ç°æ–æ³¢é‚£å¥‘å †&lt;/h2&gt;
&lt;h3 id=&#34;ä»£ç æ–‡ä»¶&#34;&gt;ä»£ç æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/vaaandark/MyPriorityQueue&#34;&gt;https://github.com/vaaandark/MyPriorityQueue&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ–‡ä»¶ç»“æ„&#34;&gt;æ–‡ä»¶ç»“æ„&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;generatoræ–‡ä»¶å¤¹å†…æœ‰æ–‡ä»¶generator.cï¼Œç”¨äºç”Ÿæˆæµ‹è¯•æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;STLPriorityQueueæ–‡ä»¶å¤¹å†…æœ‰æ–‡ä»¶stl_priority_queue.cppï¼Œç”¨STLä¸­çš„Priority Queueç¼–å†™ï¼Œç”¨äºå¯¹ç…§å®éªŒã€‚&lt;/li&gt;
&lt;li&gt;srcä¸­ä¸ºåŸºäºFibonacci Heapçš„Priority Queueçš„å…·ä½“å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;è„šæœ¬test.shç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨å¯é€‰å‚æ•°cleanï¼Œç”¨äºæ¸…ç†ä¹‹å‰æµ‹è¯•å‡ºç°çš„éä»£ç æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;src_cppä¸ºSetçš„C++å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>å·¦åçº¢é»‘æ ‘</title>
      <link>https://vaaandark.top/posts/llrb/</link>
      <pubDate>Mon, 31 Jan 2022 12:51:39 +0000</pubDate>
      
      <guid>https://vaaandark.top/posts/llrb/</guid>
      <description>&lt;p&gt;è”åˆ› Lab ç»„æ–°äººä»»åŠ¡ç¬¬ä¸€å¼¹ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;å…³äºllrb&#34;&gt;å…³äºLLRB&lt;/h2&gt;
&lt;h3 id=&#34;å®šä¹‰&#34;&gt;å®šä¹‰&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²çš„ã€‚&lt;/li&gt;
&lt;li&gt;çº¢è‰²èŠ‚ç‚¹çš„å„¿å­ä¸€å®šæ˜¯é»‘è‰²çš„ã€‚&lt;/li&gt;
&lt;li&gt;ä»»æ„èŠ‚ç‚¹åˆ°ä»»æ„å¶å­çš„æœ€çŸ­è·¯å¾„ä¸Šéƒ½æœ‰ç›¸åŒæ•°é‡çš„é»‘è‰²èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;é»‘è‰²èŠ‚ç‚¹çš„å„¿å­è¦ä¹ˆå…¨æ˜¯é»‘è‰²ï¼Œè¦ä¹ˆåªæœ‰å·¦å„¿å­æ˜¯é»‘è‰²ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å‰ä¸‰ç‚¹ä¸çº¢é»‘æ ‘çš„æ€§è´¨ç›¸åŒï¼Œç¬¬å››ç‚¹ä¸ºå·¦åçº¢é»‘æ ‘çš„ç‰¹æ®Šæ€§è´¨ï¼Œè¿™å¯¼è‡´äº†å®ƒçš„æ“ä½œç›¸å¯¹çº¢é»‘æ ‘æ›´åŠ ç®€å•ã€‚&lt;/li&gt;
&lt;li&gt;å·¦åçº¢é»‘æ ‘ä¹Ÿå¯ä»¥è®¤ä¸ºå…¶ç›¸é‚»èŠ‚ç‚¹çš„è¾¹æ˜¯æœ‰é¢œè‰²çš„ã€‚&lt;/li&gt;
&lt;li&gt;ç©ºèŠ‚ç‚¹çš„é¢œè‰²è®¤ä¸ºæ˜¯é»‘è‰²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ’å…¥æ“ä½œ&#34;&gt;æ’å…¥æ“ä½œ&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å¯ä»¥å…ˆå°±åƒå‘äºŒå‰æŸ¥æ‰¾æ ‘ä¸­æ’å…¥èŠ‚ç‚¹ä¸€æ ·æ“ä½œï¼Œæ’å…¥æ—¶å°†å…¶é¢œè‰²èµ‹ä¸ºçº¢è‰²ã€‚å¦‚æœæ’å…¥æ—¶æ˜¯é»‘è‰²ï¼Œè¿™ä¼šå¯¼è‡´ç ´åäº†LLRBçš„å¹³è¡¡æ€§è´¨ã€‚&lt;/li&gt;
&lt;li&gt;ä¿æŒä½äº†é»‘è‰²å¹³è¡¡æ€§è´¨ä¹‹åå†æ¥è°ƒæ•´å…¶ä»–ç»“æ„æ€§è´¨ï¼Œè¦å¯¹è¿ç»­ä¸¤ä¸ªçº¢è‰²èŠ‚ç‚¹ã€åªæœ‰å³å„¿å­æ˜¯çº¢è‰²èŠ‚ç‚¹è¿›è¡Œæ—‹è½¬ï¼Œå¯¹å·¦å³å„¿å­éƒ½æ˜¯çº¢è‰²çš„èŠ‚ç‚¹è¿›è¡Œé¢œè‰²ç¿»è½¬ï¼ˆæ‹†åˆ†2-3-4æ ‘ä¸­çš„4-nodeï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å…¶æ“ä½œå¯ä»¥æ˜¯é€’å½’çš„ï¼Œç¼–å†™ä»£ç ä¹Ÿå°†æ›´åŠ å®¹æ˜“å®ç°ã€‚
ä¼˜å…ˆä¿æŒå¹³è¡¡æ€§è´¨çš„åŸå› æœ‰ï¼šåœ¨ä¸€å¼€å§‹æ’å…¥æ—¶ä¿æŒå¹³è¡¡æ€§è´¨æœ€å®¹æ˜“å®ç°ï¼ˆåªéœ€è¦ç»™æ–°èŠ‚ç‚¹èµ‹çº¢è‰²ï¼‰ï¼Œæ­¤æ—¶è‹¥ä¼˜å…ˆè€ƒè™‘å…¶ä»–æ€§è´¨ï¼Œä¼šå¯¼è‡´éœ€è¦è€ƒè™‘çš„æƒ…å†µè¿‡å¤šï¼Œè€Œä¸”åœ¨åç»­è¿›è¡Œä¿®è¡¥ï¼ˆæ—‹è½¬ã€é¢œè‰²ç¿»è½¬ï¼‰çš„æ—¶å€™ä¸ä¼šç ´åå…¶å¹³è¡¡æ€§è´¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;åˆ é™¤æ“ä½œ&#34;&gt;åˆ é™¤æ“ä½œ&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä¾ç„¶ä¼˜å…ˆè€ƒè™‘å…¶å¹³è¡¡æ€§è´¨ï¼Œåˆ é™¤çš„èŠ‚ç‚¹éœ€è¦æ˜¯çº¢è‰²çš„ï¼Œå› æ­¤æ€è·¯å°±æ˜¯å…ˆå°†éœ€è¦åˆ é™¤çš„èŠ‚ç‚¹å˜æˆçº¢è‰²çš„ã€‚&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶éœ€è¦è€ƒè™‘çš„æ˜¯ï¼Œå¦‚ä½•å°†çº¢è‰²èŠ‚ç‚¹å‘ä¸‹ç§»åŠ¨ï¼ˆå‘å·¦ä¸‹æˆ–å³ä¸‹ï¼‰ã€‚å½“å·¦å³å„¿å­éƒ½ä¸æ˜¯çº¢è‰²æ—¶ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œå¯ä»¥é€šè¿‡é¢œè‰²ç¿»è½¬å®ç°ï¼Œç¿»è½¬åéœ€è¦è€ƒè™‘ç§»åŠ¨çš„å¦ä¸€ä¸ªæ–¹å‘æ˜¯å¦ä¼šå‡ºç°ä¸æ»¡è¶³å·¦å€¾çº¢é»‘æ ‘çš„æƒ…å†µï¼Œå¹¶å¯¹å…¶è¿›è¡Œä¿®è¡¥ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºLLRBçš„å·¦åç‰¹æ€§ï¼Œå› æ­¤ä¼šå‡ºç°æƒ³è¦å‘å³ä¸‹ç§»åŠ¨æ—¶ï¼Œå·¦å„¿å­æ˜¯çº¢è‰²è€Œå³å„¿å­æ˜¯é»‘è‰²ï¼Œå› æ­¤éœ€è¦å¯¹è¯¥èŠ‚ç‚¹è¿›è¡Œå³æ—‹ï¼Œè®©å‘å³ä¸‹çš„è·¯å¾„ä¸Šå‡ºç°çº¢è‰²ã€‚&lt;/li&gt;
&lt;li&gt;å½“æ‰¾åˆ°åˆ é™¤çš„ç›®æ ‡èŠ‚ç‚¹åï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œç›´æ¥åˆ å»ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå†…éƒ¨èŠ‚ç‚¹ï¼Œä¾¿ä»å®ƒçš„å³å„¿å­çš„åˆ†æ”¯ä¸­æ‰¾åˆ°æœ€å°èŠ‚ç‚¹ä¸ä¹‹æ›¿æ¢ï¼Œå†åˆ æ‰ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å‘ä¸Šè¿”å›çš„é€”ä¸­ä¿®è¡¥èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;4&lt;/strong&gt; ä¸­åˆ¤æ–­æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ä¸åº”è¯¥ç”¨å®ƒæ˜¯å¦æœ‰å·¦å„¿å­æ¥åˆ¤æ–­ï¼Œè€Œæ˜¯ç”¨å®ƒæ˜¯å¦æœ‰å³å„¿å­æ¥åˆ¤æ–­ï¼Œå› ä¸ºåœ¨å‰ä¸€æ­¥ä¸­æœ‰å³æ—‹æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®ç°llrb&#34;&gt;å®ç°LLRB&lt;/h2&gt;
&lt;h3 id=&#34;ä»£ç æ–‡ä»¶&#34;&gt;ä»£ç æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/vaaandark/MySet&#34;&gt;https://github.com/vaaandark/MySet&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ–‡ä»¶ç»“æ„&#34;&gt;æ–‡ä»¶ç»“æ„&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;generatoræ–‡ä»¶å¤¹å†…æœ‰æ–‡ä»¶generator.cï¼Œç”¨äºç”Ÿæˆæµ‹è¯•æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;STLSetæ–‡ä»¶å¤¹å†…æœ‰æ–‡ä»¶stl_set.cppï¼ŒSTLä¸­çš„Setç¼–å†™ï¼Œç”¨äºå¯¹ç…§å®éªŒã€‚&lt;/li&gt;
&lt;li&gt;srcä¸­ä¸ºåŸºäºLLRB Treeçš„Setçš„å…·ä½“å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;è„šæœ¬test.shç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨å¯é€‰å‚æ•°cleanï¼Œç”¨äºæ¸…ç†ä¹‹å‰æµ‹è¯•å‡ºç°çš„éä»£ç æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;src_cppä¸ºSetçš„C++å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>
