<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CSAPP Bomb Lab | vaaandark&#39;s blog</title>
<meta name="keywords" content="CSAPP, æ±‡ç¼–è¯­è¨€, åæ±‡ç¼–">
<meta name="description" content="ä¹‹å‰çš„ Bomb Lab æ²¡æœ‰åšï¼Œç°åœ¨åˆšå¥½åœ¨ä¸Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€è¿™é—¨è¯¾ï¼Œå­¦æ ¡ä½¿ç”¨äº† CSAPP çš„ Bomb Lab ï¼Œå¯ä»¥è¡¥äº¤ä¸€ä¸‹ CSAPP çš„ä½œä¸šï¼Œä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ GDB çš„ä½¿ç”¨ã€‚
å®éªŒç®€è¿°
é—æ†¾åœ°ï¼ŒCSAPP çš„ Bomb Lab æ—©å·²æä¾›çš„æ˜¯ Linux çš„ 64 ä½å¯æ‰§è¡Œç¨‹åºï¼Œè€Œæˆ‘æ ¡çš„ Lab è¿˜æ˜¯ 32 ä½çš„ Windows PE32 ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯æ‰¾è€å¸ˆè¦åˆ°äº†å®ƒçš„ Linux ç‰ˆæœ¬ï¼Œä¸è¿‡ä¹Ÿæ˜¯ ELF32 ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—å«bomb_32ã€‚">
<meta name="author" content="vaaandark">
<link rel="canonical" href="https://vaaandark.top/posts/csapp-bomb-lab/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.556a50c7c92c2556e588f602528ac3c41884cdb6e537ce0647b5e200cd1c2094.css" integrity="sha256-VWpQx8ksJVbliPYCUorDxBiEzbblN84GR7XiAM0cIJQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://vaaandark.top/image/vaaandark.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://vaaandark.top/image/vaaandark.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://vaaandark.top/image/vaaandark.png">
<link rel="apple-touch-icon" href="https://vaaandark.top/image/vaaandark.png">
<link rel="mask-icon" href="https://vaaandark.top/image/vaaandark.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://vaaandark.top/posts/csapp-bomb-lab/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://vaaandark.top/posts/csapp-bomb-lab/">
  <meta property="og:site_name" content="vaaandark&#39;s blog">
  <meta property="og:title" content="CSAPP Bomb Lab">
  <meta property="og:description" content="ä¹‹å‰çš„ Bomb Lab æ²¡æœ‰åšï¼Œç°åœ¨åˆšå¥½åœ¨ä¸Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€è¿™é—¨è¯¾ï¼Œå­¦æ ¡ä½¿ç”¨äº† CSAPP çš„ Bomb Lab ï¼Œå¯ä»¥è¡¥äº¤ä¸€ä¸‹ CSAPP çš„ä½œä¸šï¼Œä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ GDB çš„ä½¿ç”¨ã€‚
å®éªŒç®€è¿° é—æ†¾åœ°ï¼ŒCSAPP çš„ Bomb Lab æ—©å·²æä¾›çš„æ˜¯ Linux çš„ 64 ä½å¯æ‰§è¡Œç¨‹åºï¼Œè€Œæˆ‘æ ¡çš„ Lab è¿˜æ˜¯ 32 ä½çš„ Windows PE32 ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯æ‰¾è€å¸ˆè¦åˆ°äº†å®ƒçš„ Linux ç‰ˆæœ¬ï¼Œä¸è¿‡ä¹Ÿæ˜¯ ELF32 ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—å«bomb_32ã€‚">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-10-29T22:24:22+00:00">
    <meta property="article:modified_time" content="2022-10-29T22:24:22+00:00">
    <meta property="article:tag" content="CSAPP">
    <meta property="article:tag" content="æ±‡ç¼–è¯­è¨€">
    <meta property="article:tag" content="åæ±‡ç¼–">
    <meta property="og:image" content="https://vaaandark.top/image/bomb.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://vaaandark.top/image/bomb.jpg">
<meta name="twitter:title" content="CSAPP Bomb Lab">
<meta name="twitter:description" content="ä¹‹å‰çš„ Bomb Lab æ²¡æœ‰åšï¼Œç°åœ¨åˆšå¥½åœ¨ä¸Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€è¿™é—¨è¯¾ï¼Œå­¦æ ¡ä½¿ç”¨äº† CSAPP çš„ Bomb Lab ï¼Œå¯ä»¥è¡¥äº¤ä¸€ä¸‹ CSAPP çš„ä½œä¸šï¼Œä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ GDB çš„ä½¿ç”¨ã€‚
å®éªŒç®€è¿°
é—æ†¾åœ°ï¼ŒCSAPP çš„ Bomb Lab æ—©å·²æä¾›çš„æ˜¯ Linux çš„ 64 ä½å¯æ‰§è¡Œç¨‹åºï¼Œè€Œæˆ‘æ ¡çš„ Lab è¿˜æ˜¯ 32 ä½çš„ Windows PE32 ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯æ‰¾è€å¸ˆè¦åˆ°äº†å®ƒçš„ Linux ç‰ˆæœ¬ï¼Œä¸è¿‡ä¹Ÿæ˜¯ ELF32 ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—å«bomb_32ã€‚">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://vaaandark.top/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CSAPP Bomb Lab",
      "item": "https://vaaandark.top/posts/csapp-bomb-lab/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CSAPP Bomb Lab",
  "name": "CSAPP Bomb Lab",
  "description": "ä¹‹å‰çš„ Bomb Lab æ²¡æœ‰åšï¼Œç°åœ¨åˆšå¥½åœ¨ä¸Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€è¿™é—¨è¯¾ï¼Œå­¦æ ¡ä½¿ç”¨äº† CSAPP çš„ Bomb Lab ï¼Œå¯ä»¥è¡¥äº¤ä¸€ä¸‹ CSAPP çš„ä½œä¸šï¼Œä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ GDB çš„ä½¿ç”¨ã€‚\nå®éªŒç®€è¿° é—æ†¾åœ°ï¼ŒCSAPP çš„ Bomb Lab æ—©å·²æä¾›çš„æ˜¯ Linux çš„ 64 ä½å¯æ‰§è¡Œç¨‹åºï¼Œè€Œæˆ‘æ ¡çš„ Lab è¿˜æ˜¯ 32 ä½çš„ Windows PE32 ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯æ‰¾è€å¸ˆè¦åˆ°äº†å®ƒçš„ Linux ç‰ˆæœ¬ï¼Œä¸è¿‡ä¹Ÿæ˜¯ ELF32 ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—å«bomb_32ã€‚\n",
  "keywords": [
    "CSAPP", "æ±‡ç¼–è¯­è¨€", "åæ±‡ç¼–"
  ],
  "articleBody": "ä¹‹å‰çš„ Bomb Lab æ²¡æœ‰åšï¼Œç°åœ¨åˆšå¥½åœ¨ä¸Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€è¿™é—¨è¯¾ï¼Œå­¦æ ¡ä½¿ç”¨äº† CSAPP çš„ Bomb Lab ï¼Œå¯ä»¥è¡¥äº¤ä¸€ä¸‹ CSAPP çš„ä½œä¸šï¼Œä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ GDB çš„ä½¿ç”¨ã€‚\nå®éªŒç®€è¿° é—æ†¾åœ°ï¼ŒCSAPP çš„ Bomb Lab æ—©å·²æä¾›çš„æ˜¯ Linux çš„ 64 ä½å¯æ‰§è¡Œç¨‹åºï¼Œè€Œæˆ‘æ ¡çš„ Lab è¿˜æ˜¯ 32 ä½çš„ Windows PE32 ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯æ‰¾è€å¸ˆè¦åˆ°äº†å®ƒçš„ Linux ç‰ˆæœ¬ï¼Œä¸è¿‡ä¹Ÿæ˜¯ ELF32 ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—å«bomb_32ã€‚\nè¯¥ Lab æ˜¯ CSAPP Bomb Lab çš„è€ç‰ˆ 32 ä½ç¨‹åºï¼Œæ‰€ä»¥ä¹‹åæˆ‘è¿˜æ˜¯çœ‹ä¸€ä¸‹æ–°ç‰ˆçš„ Bomb Lab è¾ƒå¥½ï¼Œä¸èƒ½å®Œå…¨ä¸äº†è§£ 64 ä½æ±‡ç¼–å˜› :(\nå®éªŒç¯å¢ƒ GNU gdb (GDB) Fedora 12.1-2.fc36 GNU objdump version 2.37-36.fc36 å®éªŒè¿‡ç¨‹ é¦–å…ˆåæ±‡ç¼–ç”Ÿæˆæ±‡ç¼–ä»£ç ï¼š\n$ objdump -S -C bomb_32 \u003e bomb.disas ç”±äºæˆ‘ä¸æ˜¯å¾ˆä¼šçœ‹ AT\u0026T çš„æ±‡ç¼–ä»£ç ï¼Œæ‰€ä»¥æˆ‘çš„ objdump æ˜¯ aliased çš„ï¼Œé»˜è®¤ä½¿ç”¨ Intel çš„è¯­æ³•ã€‚\n$ which objdump objdump='objdump --disassembler-options=intel' /usr/bin/objdump gdb ä¹Ÿé»˜è®¤ä½¿ç”¨ Intel çš„è¯­æ³•ï¼š\n$ cat ~/.gdbinit set disassembly-flavor intel å†ä½¿ç”¨ gdb å¼€å§‹è°ƒè¯•ç¨‹åºï¼š\n$ gdb --args ./bomb_32 input phase_1 ç”±äºè€å¸ˆç»™äº†è¿™ä¸ªç¨‹åºè¿è¡Œçš„æµç¨‹å›¾ï¼Œæˆ‘ä¹Ÿçœ‹è¿‡ Bomb Lab ä¸­æä¾›çš„ .c æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘çŸ¥é“æ¯ä¸ªå­—ç¬¦ä¸²éƒ½åœ¨phase_nçš„å‡½æ•°ä¸­è¾“å…¥æˆ–è€…æ£€éªŒã€‚\nå¯ä»¥ç›´æ¥æŸ¥çœ‹phase_1å‡½æ•°çš„åæ±‡ç¼–ä»£ç ï¼Œå¹¶æ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°ä¸­çš„ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼š\n(gdb) disas phase_1 Dump of assembler code for function phase_1: ...... 0x08048b2c \u003c+12\u003e:\tpush 0x80497c0 0x08048b31 \u003c+17\u003e:\tpush eax 0x08048b32 \u003c+18\u003e:\tcall 0x8049030 ...... å¯ä»¥çœ‹åˆ°å®ƒåœ¨å‹å…¥ä¸¤ä¸ªå‚æ•°ä¹‹åè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°strings_not_equalï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥çœ‹0x80497c0é‡Œé¢æ˜¯ä»€ä¹ˆå†…å®¹ï¼Œæˆ‘é¦–å…ˆçŒœæµ‹å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š\n(gdb) p (char *)0x80497c0 $1 = 0x80497c0 \"Public speaking is very easy.\" åœ¨ä¹‹åçš„æµ‹è¯•ä¸­ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä¹Ÿè®©æˆ‘è¿‡äº†ç¬¬ä¸€å…³ã€‚\nphase_2 ç›´æ¥æŸ¥çœ‹phase_2çš„æ±‡ç¼–ä»£ç ï¼š\n; phase_2 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8] 08048b48 : 8048b48:\t55 push ebp 8048b49:\t89 e5 mov ebp,esp ; ä¸ºå±€éƒ¨å˜é‡è…¾å‡ºç©ºé—´ 8048b4b:\t83 ec 20 sub esp,0x20 ; å¯èƒ½æ˜¯å†…éƒ¨è°ƒç”¨çš„å‡½æ•°éœ€è¦ä½¿ç”¨è¿™ä¸¤ä¸ªå¯„å­˜å™¨ ; æ‰€ä»¥æ ¹æ® caller save åœ¨è¿™é‡Œä¿å­˜ 8048b4e:\t56 push esi 8048b4f:\t53 push ebx ; å°† input æ”¾å…¥ edx ä¸­ 8048b50:\t8b 55 08 mov edx,DWORD PTR [ebp+0x8] ; ç­‰äº sub esp, 0x8 8048b53:\t83 c4 f8 add esp,0xfffffff8 ; å°†å±€éƒ¨å˜é‡çš„åœ°å€ [ebp-0x18] æ”¾å…¥ eax ä¸­ ; ä¸å¦¨ç»™å®ƒèµ·åä¸ºå˜é‡ A ; ç”±äºç»™å±€éƒ¨å˜é‡é¢„ç•™çš„ä½ç½®å¾ˆå¤§ï¼ŒçŒœæµ‹ A æ˜¯ä¸€ä¸ªæ•°ç»„ 8048b56:\t8d 45 e8 lea eax,[ebp-0x18] ; å‹æ ˆä¼ å‚ï¼Œä¼ å…¥çš„æ˜¯ input, A 8048b59:\t50 push eax 8048b5a:\t52 push edx ; è°ƒç”¨å‡½æ•° read_six_numbers æ ¹æ®åå­—åˆç†æ€€ç–‘è¿™é‡Œæ˜¯è¯»å…¥å…­ä¸ªæ•°å­—ï¼ŒA å¯èƒ½æœ‰ 6 ä¸ªå…ƒç´  8048b5b:\te8 78 04 00 00 call 8048fd8 ; è¿™é‡Œ esp åŠ äº† 0x10 ç›¸å½“äºæŠŠä¹‹å‰çš„å‚æ•°é€€æ ˆäº†ï¼Œè¿˜æŠŠä¹‹å‰ add esp,0xfffffff8 çš„åŠ å›å»äº†ã€‚æˆ‘çŒœæµ‹ä¹‹å‰çš„ add å¯èƒ½å’Œå†…å­˜å¯¹é½æœ‰å…³ 8048b60:\t83 c4 10 add esp,0x10 ; å°† A[0] ä¸ 1 æ¯”è¾ƒ ; ç”±äºä¹‹å‰ä¼ é€’çš„æ˜¯åœ°å€ï¼Œè¿™ä¸ªå˜é‡åº”è¯¥åœ¨ read_six_numbers ä¸­è¢«ä¿®æ”¹äº† 8048b63:\t83 7d e8 01 cmp DWORD PTR [ebp-0x18],0x1 ; å¦‚æœæ˜¯ 1 åˆ™æˆåŠŸï¼Œä¸æ˜¯ 1 åˆ™å¼•çˆ†ç‚¸å¼¹ 8048b67:\t74 05 je 8048b6e 8048b69:\te8 8e 09 00 00 call 80494fc ; ebx \u003c- 0x1 8048b6e:\tbb 01 00 00 00 mov ebx,0x1 ; å°† A æ”¾å…¥ esi ä¸­ 8048b73:\t8d 75 e8 lea esi,[ebp-0x18] ; eax \u003c- 0x2 8048b76:\t8d 43 01 lea eax,[ebx+0x1] ; è¿™æ­¥éª¤æ“ä½œä¹‹å eax çš„å€¼ä¸º (ebx + 1) * A[ebx - 1] ; ebx åˆå§‹ä¸º 1 8048b79:\t0f af 44 9e fc imul eax,DWORD PTR [esi+ebx*4-0x4] ; ç›¸å½“äºåˆ¤æ–­ A[ebx] æ˜¯ä¸æ˜¯ A[ebx - 1] ä¸¤å€ 8048b7e:\t39 04 9e cmp DWORD PTR [esi+ebx*4],eax 8048b81:\t74 05 je 8048b88 8048b83:\te8 74 09 00 00 call 80494fc 8048b88:\t43 inc ebx 8048b89:\t83 fb 05 cmp ebx,0x5 ; æˆ‘è¯»åˆ°è¿™é‡Œæ‰å‘ç°æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œç»ˆæ­¢æ¡ä»¶ä¸º ebx \u003e 5 8048b8c:\t7e e8 jle 8048b76 ; æ‰€ä»¥æ ¹æ®é€’æ¨å…¬å¼å¯çŸ¥å­—ç¬¦ä¸²ä¸º 1 2 6 24 120 720 8048b8e:\t8d 65 d8 lea esp,[ebp-0x28] 8048b91:\t5b pop ebx 8048b92:\t5e pop esi 8048b93:\t89 ec mov esp,ebp 8048b95:\t5d pop ebp 8048b96:\tc3 ret 8048b97:\t90 nop å®ƒè°ƒç”¨äº†å‡½æ•°read_six_numbersï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿåˆ†æä¸€ä¸‹å®ƒï¼š\n; å‚æ•°ä¸ºå­—ç¬¦ä¸² input å’Œæ•°ç»„ A 08048fd8 : 8048fd8:\t55 push ebp 8048fd9:\t89 e5 mov ebp,esp 8048fdb:\t83 ec 08 sub esp,0x8 ; ä¼ å…¥çš„è¾“å…¥å­—ç¬¦ä¸² 8048fde:\t8b 4d 08 mov ecx,DWORD PTR [ebp+0x8] ; ä¼ å…¥çš„æ•°ç»„ A 8048fe1:\t8b 55 0c mov edx,DWORD PTR [ebp+0xc] ; A[5] 8048fe4:\t8d 42 14 lea eax,[edx+0x14] 8048fe7:\t50 push eax ; A[4] 8048fe8:\t8d 42 10 lea eax,[edx+0x10] 8048feb:\t50 push eax ; A[3] 8048fec:\t8d 42 0c lea eax,[edx+0xc] 8048fef:\t50 push eax ; A[2] 8048ff0:\t8d 42 08 lea eax,[edx+0x8] 8048ff3:\t50 push eax ; A[1] 8048ff4:\t8d 42 04 lea eax,[edx+0x4] 8048ff7:\t50 push eax ; A[0] 8048ff8:\t52 push edx ; format å­—ç¬¦ä¸² \"%d %d %d %d %d %d\" 8048ff9:\t68 1b 9b 04 08 push 0x8049b1b ; input è¾“å…¥å­—ç¬¦ä¸² 8048ffe:\t51 push ecx 8048fff:\te8 5c f8 ff ff call 8048860 8049004:\t83 c4 20 add esp,0x20 8049007:\t83 f8 05 cmp eax,0x5 804900a:\t7f 05 jg 8049011 804900c:\te8 eb 04 00 00 call 80494fc 8049011:\t89 ec mov esp,ebp 8049013:\t5d pop ebp 8049014:\tc3 ret 8049015:\t8d 76 00 lea esi,[esi+0x0] ä½¿ç”¨å­—ç¬¦ä¸²1 2 6 24 120 720æˆåŠŸé€šè¿‡ç¬¬äºŒå…³ã€‚\nphase_3 ; phase_3 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8] 08048b98 : 8048b98:\t55 push ebp 8048b99:\t89 e5 mov ebp,esp ; é¢„ç•™ 20 ä¸ªå­—èŠ‚ 8048b9b:\t83 ec 14 sub esp,0x14 8048b9e:\t53 push ebx ; å°† input æ”¾å…¥ edx 8048b9f:\t8b 55 08 mov edx,DWORD PTR [ebp+0x8] ; sub esp, 0x4 8048ba2:\t83 c4 f4 add esp,0xfffffff4 ; ; int_b 8048ba5:\t8d 45 fc lea eax,[ebp-0x4] 8048ba8:\t50 push eax ; char_c 8048ba9:\t8d 45 fb lea eax,[ebp-0x5] 8048bac:\t50 push eax ; int_a 8048bad:\t8d 45 f4 lea eax,[ebp-0xc] 8048bb0:\t50 push eax ; é€šè¿‡ GBD è°ƒè¯•å¯ä»¥çŸ¥é“è¿™ä¸ªåœ°å€å†…å®¹ä¸º \"%d %c %d\" 8048bb1:\t68 de 97 04 08 push 0x80497de ; input 8048bb6:\t52 push edx 8048bb7:\te8 a4 fc ff ff call 8048860 8048bbc:\t83 c4 20 add esp,0x20 ; å¦‚æœ sscanf åŒ¹é…å¹¶èµ‹å€¼çš„ä¸ªæ•°ä¸å¤šäº 2 ï¼Œåˆ™çˆ†ç‚¸ 8048bbf:\t83 f8 02 cmp eax,0x2 8048bc2:\t7f 05 jg 8048bc9 8048bc4:\te8 33 09 00 00 call 80494fc ; å°† int_a ä¸ 0x7 æ¯”è¾ƒ ; æ€€ç–‘æ˜¯ä¸€ä¸ªé˜²æ­¢æ•°ç»„è¶Šç•Œçš„æ“ä½œ 8048bc9:\t83 7d f4 07 cmp DWORD PTR [ebp-0xc],0x7 ; å¦‚æœå¤§äºåˆ™çˆ†ç‚¸ 8048bcd:\t0f 87 b5 00 00 00 ja 8048c88 ; å°† int_a èµ‹å€¼ç»™ eax 8048bd3:\t8b 45 f4 mov eax,DWORD PTR [ebp-0xc] ; è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè·³è½¬è¡¨ï¼Œå¯¹åº”åˆ° C è¯­è¨€ä¸­åº”è¯¥æ˜¯ä¸€ä¸ª switch-case ç»“æ„ ; å¯ä»¥åœ¨ gdb é‡Œé¢æŸ¥çœ‹ä¸€ä¸‹å¯¹åº”çš„è¡¨ `(gdb) p/x *(int *)0x80497e8` ; [0x80497e8] å¯¹åº” 8048be0 ; [0x80497e8+1*4] å¯¹åº” 8048c00 ; [0x80497e8+2*4] å¯¹åº” 8048c16 ; [0x80497e8+3*4] å¯¹åº” 8048c28 ; [0x80497e8+4*4] å¯¹åº” 8048c40 ; [0x80497e8+5*4] å¯¹åº” 8048c52 ; [0x80497e8+6*4] å¯¹åº” 8048c64 ; [0x80497e8+7*4] å¯¹åº” 8048c76 ; switch-case(int_a) 8048bd6:\tff 24 85 e8 97 04 08 jmp DWORD PTR [eax*4+0x80497e8] 8048bdd:\t8d 76 00 lea esi,[esi+0x0] ; case 0: ; bl \u003c- 0x71 8048be0:\tb3 71 mov bl,0x71 ; å°† int_b ä¸ 0x309 æ¯”è¾ƒ 8048be2:\t81 7d fc 09 03 00 00 cmp DWORD PTR [ebp-0x4],0x309 ; å¦‚æœç­‰äºå°± break 8048be9:\t0f 84 a0 00 00 00 je 8048c8f 8048bef:\te8 08 09 00 00 call 80494fc 8048bf4:\te9 96 00 00 00 jmp 8048c8f ; eiz æ˜¯ä¸€ä¸ªä¼ªå¯„å­˜å™¨ï¼Œå®ƒå§‹ç»ˆä¸º 0 8048bf9:\t8d b4 26 00 00 00 00 lea esi,[esi+eiz*1+0x0] ; åé¢å‡ ä¸ª case éƒ½æ˜¯ç›¸åŒçš„é“ç† ...... ; bl ä¸ char_c æ¯”è¾ƒ 8048c8f:\t3a 5d fb cmp bl,BYTE PTR [ebp-0x5] ; æ‰€ä»¥åŸºæœ¬æµç¨‹å°±æ˜¯æ ¹æ® int_a çš„å€¼ç¡®å®šè¿›å»å“ªä¸€ä¸ª case ï¼Œ ; ç„¶ååœ¨è¯¥åˆ†æ”¯ä¸­å°† int_b å’ŒæŸä¸€å€¼æ¯”è¾ƒï¼Œå¹¶ç¡®å®š char_c åº”è¯¥ç­‰äºçš„å€¼ ; æ‰€ä»¥ç­”æ¡ˆåº”è¯¥ä¸å”¯ä¸€ï¼Œé€šè¿‡ int_a çš„å€¼ç¡®å®šåé¢ä¸¤ä¸ªç­”æ¡ˆ ...... æˆ‘ä½¿ç”¨0 q 777é€šè¿‡äº†è¿™ä¸€å…³ã€‚\nphase_4 è¿™ä¸€å…³åŒ…å«äº†é€’å½’å‡½æ•°ï¼Œä½†æ˜¯æŒ‘æˆ˜æ€§ä¸æ˜¯å¾ˆå¤§ã€‚\n; phase_4 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8] 08048ce0 : 8048ce0:\t55 push ebp 8048ce1:\t89 e5 mov ebp,esp 8048ce3:\t83 ec 18 sub esp,0x18 ; input -\u003e edx 8048ce6:\t8b 55 08 mov edx,DWORD PTR [ebp+0x8] ; sub esp, 0xc 8048ce9:\t83 c4 fc add esp,0xfffffffc ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸º A 8048cec:\t8d 45 fc lea eax,[ebp-0x4] 8048cef:\t50 push eax ; æ ¹æ® GDB `p (char *)0x8049808` å¯å¾—è¯¥å­—ç¬¦ä¸²ä¸º `%d` 8048cf0:\t68 08 98 04 08 push 0x8049808 8048cf5:\t52 push edx 8048cf6:\te8 65 fb ff ff call 8048860 8048cfb:\t83 c4 10 add esp,0x10 ; åˆ¤æ–­ sscanf æ˜¯å¦æˆåŠŸ 8048cfe:\t83 f8 01 cmp eax,0x1 8048d01:\t75 06 jne 8048d09 ; åˆ¤æ–­ A å’Œ 0x0 ï¼Œå¦‚æœä¸å¤§äº 0 åˆ™çˆ†ç‚¸ 8048d03:\t83 7d fc 00 cmp DWORD PTR [ebp-0x4],0x0 8048d07:\t7f 05 jg 8048d0e 8048d09:\te8 ee 07 00 00 call 80494fc ; sub esp, 0x4 8048d0e:\t83 c4 f4 add esp,0xfffffff4 ; A -\u003e eax 8048d11:\t8b 45 fc mov eax,DWORD PTR [ebp-0x4] ; å‚æ•°å…¥æ ˆå¹¶è°ƒç”¨ func4 8048d14:\t50 push eax 8048d15:\te8 86 ff ff ff call 8048ca0 8048d1a:\t83 c4 10 add esp,0x10 ; è¿”å›å€¼å¦‚æœä¸æ˜¯ 55 åˆ™çˆ†ç‚¸ 8048d1d:\t83 f8 37 cmp eax,0x37 8048d20:\t74 05 je 8048d27 8048d22:\te8 d5 07 00 00 call 80494fc 8048d27:\t89 ec mov esp,ebp 8048d29:\t5d pop ebp 8048d2a:\tc3 ret 8048d2b:\t90 nop ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹func4\n; phase_4 çš„å‚æ•°ä¸ºæ•´å‹ A ï¼Œåœ¨ [ebp+0x8] 08048ca0 : 8048ca0:\t55 push ebp 8048ca1:\t89 e5 mov ebp,esp 8048ca3:\t83 ec 10 sub esp,0x10 8048ca6:\t56 push esi 8048ca7:\t53 push ebx ; ebx \u003c- A 8048ca8:\t8b 5d 08 mov ebx,DWORD PTR [ebp+0x8] ; å¦‚æœ A ä¸å¤§äº 1 åˆ™è·³è½¬åˆ° é€€å‡ºï¼Œè¿™é‡Œåº”è¯¥æ˜¯é€’å½’å‡ºå£ï¼Œè¿”å›å€¼ä¸º 1 8048cab:\t83 fb 01 cmp ebx,0x1 8048cae:\t7e 20 jle 8048cd0 8048cb0:\t83 c4 f4 add esp,0xfffffff4 8048cb3:\t8d 43 ff lea eax,[ebx-0x1] 8048cb6:\t50 push eax ; func(A - 1) 8048cb7:\te8 e4 ff ff ff call 8048ca0 8048cbc:\t89 c6 mov esi,eax 8048cbe:\t83 c4 f4 add esp,0xfffffff4 8048cc1:\t8d 43 fe lea eax,[ebx-0x2] 8048cc4:\t50 push eax ; func(A - 2) ; å†™åˆ°è¿™é‡Œå¯ä»¥çŒœåˆ°è¿™æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œ ; ä¹‹å‰è¦æ±‚è¿”å›å€¼æ˜¯ 55 ï¼Œæ‰€ä»¥è¾“å…¥åº”è¯¥æ˜¯ 9 8048cc5:\te8 d6 ff ff ff call 8048ca0 8048cca:\t01 f0 add eax,esi 8048ccc:\teb 07 jmp 8048cd5 8048cce:\t89 f6 mov esi,esi 8048cd0:\tb8 01 00 00 00 mov eax,0x1 8048cd5:\t8d 65 e8 lea esp,[ebp-0x18] 8048cd8:\t5b pop ebx 8048cd9:\t5e pop esi 8048cda:\t89 ec mov esp,ebp 8048cdc:\t5d pop ebp 8048cdd:\tc3 ret 8048cde:\t89 f6 mov esi,esi è¾“å…¥9æˆåŠŸé€šè¿‡äº†è¿™ä¸€å…³ã€‚\nphase_5 ; phase_5 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8] 08048d2c : 8048d2c:\t55 push ebp 8048d2d:\t89 e5 mov ebp,esp 8048d2f:\t83 ec 10 sub esp,0x10 8048d32:\t56 push esi 8048d33:\t53 push ebx ; input -\u003e ebx 8048d34:\t8b 5d 08 mov ebx,DWORD PTR [ebp+0x8] 8048d37:\t83 c4 f4 add esp,0xfffffff4 8048d3a:\t53 push ebx ; è®¡ç®— input å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¦‚æœé•¿åº¦ä¸ä¸º 6 åˆ™çˆ†ç‚¸ 8048d3b:\te8 d8 02 00 00 call 8049018 8048d40:\t83 c4 10 add esp,0x10 8048d43:\t83 f8 06 cmp eax,0x6 8048d46:\t74 05 je 8048d4d 8048d48:\te8 af 07 00 00 call 80494fc ; å°çŸ¥è¯†ï¼šç”±äºä¸¤æ•°ç›¸åŒï¼Œæ‰€ä»¥ä½¿ç”¨ xor æ¥æ¸…é›¶å¿«ä¸€äº› 8048d4d:\t31 d2 xor edx,edx ; ä¸å¦¨ä»¤è¿™ä¸ªå˜é‡ä¸º str_a 8048d4f:\t8d 4d f8 lea ecx,[ebp-0x8] ; åœ°å€ 0x804b220 \"isrveawhobpnutfg\\260\\001\" ; æ€€ç–‘æ˜¯é€šè¿‡ä¸€äº›æ“ä½œä»ä¸Šè¿°å­—ç¬¦ä¸²ä¸­å–å‡ºå­—ç¬¦é‡æ–°æ‹¼æ¥ ; ä¸å¦¨ä»¤è¿™ä¸ªå­—ç¬¦ä¸²ä¸º dict 8048d52:\tbe 20 b2 04 08 mov esi,0x804b220 ; ä»è¿™é‡Œå¼€å§‹æ˜¯å¾ªç¯å…­æ¬¡ï¼Œåé¢çš„å­—ç¬¦ä¸²å¸¸é‡é•¿åº¦ä¹Ÿåˆšå¥½ä¸º 6 ; al \u003c- input[edx] 8048d57:\t8a 04 1a mov al,BYTE PTR [edx+ebx*1] ; å– al ä½å››ä½ 8048d5a:\t24 0f and al,0xf ; æ‹“å±•é•¿åº¦åˆ° 32 ä½ 8048d5c:\t0f be c0 movsx eax,al ; al \u003c- dict[eax] 8048d5f:\t8a 04 30 mov al,BYTE PTR [eax+esi*1] ; str_a[edx] \u003c- al 8048d62:\t88 04 0a mov BYTE PTR [edx+ecx*1],al 8048d65:\t42 inc edx 8048d66:\t83 fa 05 cmp edx,0x5 8048d69:\t7e ec jle 8048d57 ; å¾ªç¯ç»“æŸ ; ç»™å­—ç¬¦ä¸² str_a ç»“å°¾è¡¥ä¸Š '\\0' 8048d6b:\tc6 45 fe 00 mov BYTE PTR [ebp-0x2],0x0 8048d6f:\t83 c4 f8 add esp,0xfffffff8 ; åœ°å€ 0x804980b \"giants\" 8048d72:\t68 0b 98 04 08 push 0x804980b 8048d77:\t8d 45 f8 lea eax,[ebp-0x8] 8048d7a:\t50 push eax ; æ¯”è¾ƒ str_a å’Œ \"giants\" ; æ‰€ä»¥è¾“å…¥å­—ç¬¦ä¸²åªçœ‹æœ€ä½å››ä½åº”è¯¥æ˜¯ 15 0 5 11 13 1 ï¼Œåå…­è¿›åˆ¶æ˜¯ f 0 5 b d 1 ; æŸ¥çœ‹ ASCII è¡¨ï¼Œæ‰¾åˆ°æ–¹ä¾¿è¾“å…¥çš„å†…å®¹ï¼Œa-z åŠå…¶é™„è¿‘çš„å­—ç¬¦å¾ˆç¬¦åˆè¦æ±‚ ; æ‰€ä»¥ä½¿ç”¨ o`ekma 8048d7b:\te8 b0 02 00 00 call 8049030 ...... è¾“å…¥o`ekmaæˆåŠŸé€šè¿‡äº†è¿™ä¸€å…³ã€‚\nphase_6 è¿™ä¸€å…³æ¯”è¾ƒé•¿ï¼Œæˆ‘å°†å®ƒåˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ã€‚\nä¸€å¼€å§‹å°±èƒ½çœ‹åˆ°å±€éƒ¨å˜é‡è¢«èµ‹å€¼åˆ°ä¸€ä¸ªç¥ç§˜çš„åœ°å€ï¼Œè¿™åº”è¯¥è§£è¿™é¢˜çš„å…³é”®ã€‚ä¹‹åä½¿ç”¨äº†read_six_numbersè¿™ä¸ªå‡½æ•°è¯»å…¥å…­ä¸ªæ•°å­—ã€‚\n; phase_6 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8] 08048d98 : ...... ; input \u003c- edx 8048da1:\t8b 55 08 mov edx,DWORD PTR [ebp+0x8] ; *(int *)0x804b26c 153 ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæŒ‡é’ˆ C ; C \u003c- 0x804b26c ; å®ƒç›´æ¥æŒ‡å‘äº†ä¸€ä¸ªç¥ç§˜çš„ç»“æ„ 8048da4:\tc7 45 cc 6c b2 04 08 mov DWORD PTR [ebp-0x34],0x804b26c 8048dab:\t83 c4 f8 add esp,0xfffffff8 ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæ•°ç»„ A 8048dae:\t8d 45 e8 lea eax,[ebp-0x18] 8048db1:\t50 push eax 8048db2:\t52 push edx 8048db3:\te8 20 02 00 00 call 8048fd8 ç¢°åˆ°çš„ç¬¬ä¸€ä¸ªå¾ªç¯ï¼š\n; for (int i = 0; i \u003c= 5; ++i) { ; if (A[i] \u003e 6) ; explode_bomb(); ; for (int j = i + 1; j \u003c= 5; ++j) { ; if (A[i] == A[j]) ; explode_bomb(); ; } ; } ; edi \u003c- 0 ä¸å¦¨ä»¤å…¶ä¸º i 8048db8:\t31 ff xor edi,edi 8048dba:\t83 c4 10 add esp,0x10 8048dbd:\t8d 76 00 lea esi,[esi+0x0] ; eax \u003c- A ; å¾ªç¯ 6 æ¬¡ 8048dc0:\t8d 45 e8 lea eax,[ebp-0x18] ; eax \u003c- A[i] 8048dc3:\t8b 04 b8 mov eax,DWORD PTR [eax+edi*4] ; eax \u003c- A[i] - 1 8048dc6:\t48 dec eax ; å¦‚æœ eax å¤§äº 5 å°±çˆ†ç‚¸ï¼Œä¸èƒ½å¤§äº 6 8048dc7:\t83 f8 05 cmp eax,0x5 8048dca:\t76 05 jbe 8048dd1 8048dcc:\te8 2b 07 00 00 call 80494fc ; ebx \u003c- i + 1 ä¸å¦¨ä»¤å…¶ä¸º j 8048dd1:\t8d 5f 01 lea ebx,[edi+0x1] ; if (j \u003c= 5) 8048dd4:\t83 fb 05 cmp ebx,0x5 8048dd7:\t7f 23 jg 8048dfc ; eax \u003c- 4 * edi 8048dd9:\t8d 04 bd 00 00 00 00 lea eax,[edi*4+0x0] ; ä¸å¦¨ä»¤è¿™ä¸ªå±€éƒ¨å˜é‡ä¸º B ; B \u003c- 4 * edi 8048de0:\t89 45 c8 mov DWORD PTR [ebp-0x38],eax ; esi \u003c- A 8048de3:\t8d 75 e8 lea esi,[ebp-0x18] ; å†…å±‚å¾ªç¯ 8048de6:\t8b 55 c8 mov edx,DWORD PTR [ebp-0x38] ; eax \u003c- A[i] 8048de9:\t8b 04 32 mov eax,DWORD PTR [edx+esi*1] ; æ¯”è¾ƒ A[i] å’Œ A[j] 8048dec:\t3b 04 9e cmp eax,DWORD PTR [esi+ebx*4] ; å¦‚æœç›¸ç­‰åˆ™å¼•çˆ†ç‚¸å¼¹ 8048def:\t75 05 jne 8048df6 8048df1:\te8 06 07 00 00 call 80494fc 8048df6:\t43 inc ebx 8048df7:\t83 fb 05 cmp ebx,0x5 8048dfa:\t7e ea jle 8048de6 ; ç»“æŸå†…å±‚å¾ªç¯ 8048dfc:\t47 inc edi 8048dfd:\t83 ff 05 cmp edi,0x5 8048e00:\t7e be jle 8048dc0 ; ç»“æŸå¾ªç¯ è‡³æ­¤å¯ä»¥å¾—å‡ºåˆæ­¥ç»“è®ºï¼Œç¬¬ä¸€ä¸ªæ•°å­—ä¸€å®šä¸å¤§äº 6 ï¼Œè€Œä¸”ä»»æ„ä¸¤ä¸ªæ•°å­—ä¸ç›¸ç­‰\nç¢°åˆ°ç¬¬äºŒä¸ªå¾ªç¯ï¼š\n; E = D; ; for (int i = 0, p = C; i \u003c= 5; ++i) { ; j = 1; ; while (j \u003c A[i]) { ; p = p-\u003enext; ; j++; ; } ; E[i] = p; ; } ; edi \u003c- 0 ä¸å¦¨ä»¤å…¶ä¸º i 8048e02:\t31 ff xor edi,edi ; ecx \u003c- A 8048e04:\t8d 4d e8 lea ecx,[ebp-0x18] ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæ•°ç»„ D 8048e07:\t8d 45 d0 lea eax,[ebp-0x30] ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæŒ‡é’ˆ E ; E \u003c- D 8048e0a:\t89 45 c4 mov DWORD PTR [ebp-0x3c],eax 8048e0d:\t8d 76 00 lea esi,[esi+0x0] ; å¾ªç¯ 6 æ¬¡ ; esi \u003c- C ä¸å¦¨ä»¤å…¶ä¸ºæŒ‡é’ˆ p ; C åˆå€¼ä¸º 0x804b26c 8048e10:\t8b 75 cc mov esi,DWORD PTR [ebp-0x34] ; ebx \u003c- 1 ä¸å¦¨ä»¤å…¶ä¸º j 8048e13:\tbb 01 00 00 00 mov ebx,0x1 8048e18:\t8d 04 bd 00 00 00 00 lea eax,[edi*4+0x0] 8048e1f:\t89 c2 mov edx,eax ; å°† j ä¸ A[i] æ¯”è¾ƒ 8048e21:\t3b 1c 08 cmp ebx,DWORD PTR [eax+ecx*1] 8048e24:\t7d 12 jge 8048e38 ; å¦‚æœå°äºåˆ™æ‰§è¡Œä¸‹é¢è¿™æ®µ ; eax \u003c- A[i] 8048e26:\t8b 04 0a mov eax,DWORD PTR [edx+ecx*1] 8048e29:\t8d b4 26 00 00 00 00 lea esi,[esi+eiz*1+0x0] ; å†…å±‚å¾ªç¯ ; æ„Ÿè§‰æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„ ; çŒœæµ‹åç§»ä¸º 0x8 çš„ä½ç½®æ˜¯ next å­—æ®µ ; p \u003c- p-\u003enext 8048e30:\t8b 76 08 mov esi,DWORD PTR [esi+0x8] ; j++ 8048e33:\t43 inc ebx ; while (j \u003c A[i]) 8048e34:\t39 c3 cmp ebx,eax 8048e36:\t7c f8 jl 8048e30 ; ç»“æŸå†…å±‚å¾ªç¯ ; edx \u003c- E 8048e38:\t8b 55 c4 mov edx,DWORD PTR [ebp-0x3c] ; E[i] \u003c- p 8048e3b:\t89 34 ba mov DWORD PTR [edx+edi*4],esi ; i++ 8048e3e:\t47 inc edi ; while (i \u003c= 5) 8048e3f:\t83 ff 05 cmp edi,0x5 8048e42:\t7e cc jle 8048e10 ; ç»“æŸå¾ªç¯ ä½¿ç”¨ GDB æŸ¥çœ‹ä¸€ä¸‹é‚£ä¸ªç¥ç§˜åœ°å€æœç„¶æœ‰äº†æ”¶è·ï¼š\n(gdb) x/3x 0x804b26c 0x804b26c :\t0x000000fd\t0x00000001\t0x0804b260 (gdb) x/3x 0x804b260 0x804b260 :\t0x000002d5\t0x00000002\t0x0804b254 (gdb) x/3x 0x804b254 0x804b254 :\t0x0000012d\t0x00000003\t0x0804b248 (gdb) x/3x 0x804b248 0x804b248 :\t0x000003e5\t0x00000004\t0x0804b23c (gdb) x/3x 0x804b23c 0x804b23c :\t0x000000d4\t0x00000005\t0x0804b230 (gdb) x/3x 0x804b230 0x804b230 :\t0x000001b0\t0x00000006\t0x00000000 ä¸€å…±æœ‰å…­ä¸ªèŠ‚ç‚¹ çŒœæµ‹ä¸‰ä¸ªå­—æ®µåˆ†åˆ«ä¸ºï¼švalue, id, next\nç¢°åˆ°ç¬¬ä¸‰ä¸ªå¾ªç¯ï¼š\n; p = D; ; C = D; ; for (int i = 1; i \u003c= 5; ++i) { ; p-\u003enext = D[i]; ; p = p-\u003enext; ; } ; esi \u003c- D ä¸å¦¨ä»¤å…¶ä¸ºæŒ‡é’ˆ p 8048e44:\t8b 75 d0 mov esi,DWORD PTR [ebp-0x30] ; C \u003c- D 8048e47:\t89 75 cc mov DWORD PTR [ebp-0x34],esi ; edi \u003c- 1 ä»¤å…¶ä¸º i 8048e4a:\tbf 01 00 00 00 mov edi,0x1 ; edx \u003c- D 8048e4f:\t8d 55 d0 lea edx,[ebp-0x30] ; å¾ªç¯ 6 æ¬¡ ; eax \u003c- D[i] 8048e52:\t8b 04 ba mov eax,DWORD PTR [edx+edi*4] ; p-\u003enext \u003c- D[i] 8048e55:\t89 46 08 mov DWORD PTR [esi+0x8],eax ; p \u003c- p-\u003enext 8048e58:\t89 c6 mov esi,eax ; i++ 8048e5a:\t47 inc edi ; while (i \u003c= 5) 8048e5b:\t83 ff 05 cmp edi,0x5 8048e5e:\t7e f2 jle 8048e52 ; ç»“æŸå¾ªç¯ ; p-\u003enext = NULL; 8048e60:\tc7 46 08 00 00 00 00 mov DWORD PTR [esi+0x8],0x0 ä¸Šé¢è¿™éƒ¨åˆ†ä»£ç ç›¸å½“äºæŠŠæ•°ç»„Dä¸²èµ·æ¥å˜ä¸ºä¸€ä¸ªé“¾è¡¨ã€‚\nç¢°åˆ°ç¬¬å››ä¸ªå¾ªç¯ï¼š\n; p = C; ; for (int i = 0; i \u003c= 4; ++i) { ; if (p-\u003evalue \u003c p-\u003enext-\u003evalue) ; explode_bomb(); ; p = p-\u003enext; ; i++; ; } ; æ•°ç»„ D ç»„æˆçš„æ•°åˆ—åº”è¯¥é€’å‡ ; æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† 6 ä¸ª node æ’åº ; ä»å¤§åˆ°å°ï¼šnode4 node2 node 6 node3 node1 node5 8048e67:\t8b 75 cc mov esi,DWORD PTR [ebp-0x34] 8048e6a:\t31 ff xor edi,edi 8048e6c:\t8d 74 26 00 lea esi,[esi+eiz*1+0x0] ; å¾ªç¯ 5 æ¬¡ ; edx \u003c- p-\u003enext 8048e70:\t8b 56 08 mov edx,DWORD PTR [esi+0x8] ; eax \u003c- p-\u003evalue 8048e73:\t8b 06 mov eax,DWORD PTR [esi] ; å°† p-\u003evalue å’Œ p-\u003enext-\u003evalue æ¯”è¾ƒ ; å³å¦‚æœå°äºï¼Œåˆ™çˆ†ç‚¸ 8048e75:\t3b 02 cmp eax,DWORD PTR [edx] 8048e77:\t7d 05 jge 8048e7e 8048e79:\te8 7e 06 00 00 call 80494fc ; p \u003c- p-\u003enext 8048e7e:\t8b 76 08 mov esi,DWORD PTR [esi+0x8] ; i++ 8048e81:\t47 inc edi ; while (i \u003c= 4) 8048e82:\t83 ff 04 cmp edi,0x4 8048e85:\t7e e9 jle 8048e70 ; ç»“æŸå¾ªç¯ ç”±äºä»å¤§åˆ°å°æ˜¯node4, node2, node6, node3, node1, node5ã€‚\nè¾“å…¥å­—ç¬¦ä¸²4 2 6 3 1 5ä¾¿èƒ½é€šè¿‡è¿™å…³ã€‚\nsecret_phase å…¶å®åœ¨ 6 å…³ä¹‹åè¿˜æœ‰ä¸€ä¸ªéšè—å…³å¡ï¼Œéœ€è¦ä¸€å®šçš„æ¡ä»¶è§¦å‘ã€‚\nå¯ä»¥ç›´æ¥åœ¨bomb.disasé‡Œé¢æŸ¥æ‰¾å‡½æ•°secret_phaseï¼Œç„¶åå¯ä»¥å‘ç°å®ƒåœ¨å‡½æ•°phase_defusedä¸­è¢«è°ƒç”¨ã€‚\né¦–å…ˆåœ¨phase_6æ‰“ä¸Šæ–­ç‚¹ï¼Œå‘ç°åœ¨phase_defusedä¸­å‘ç°æœ‰æ€ªå¼‚ä¹‹å¤„ï¼š\n8049543:\t50 push eax ; æ ¼å¼åŒ–å­—ç¬¦ä¸² ; (gdb) x/s 0x8049d03 ; 0x8049d03:\t\"%d %s\" 8049544:\t68 03 9d 04 08 push 0x8049d03 ; æ²¡æœ‰è§£é”éšè—å…³å¡æ—¶ï¼Œè¾“å…¥å­—ç¬¦ä¸²åªæœ‰ä¸€ä¸ª 9 ï¼Œè¿™ä¸ä¸¤ä¸ªå ä½ç¬¦çš„ä¸ç›¸ç¬¦ ; æ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨ 9 åé¢è¡¥ä¸Šä¸€ä¸ªå­—ç¬¦ä¸² ; åœ¨ phase_6 æ‰“ä¸Šæ–­ç‚¹ ; (gdb) break phase_6 ; (gdb) run ; (gdb) x/s 0x804b770 ; 0x804b770 :\t\"9\" 8049549:\t68 70 b7 04 08 push 0x804b770 804954e:\te8 0d f3 ff ff call 8048860 8049553:\t83 c4 10 add esp,0x10 å‘ç°è¿™é‡Œæœ‰ä¸ªç”¨äºè°ƒè¯•çš„æ ‡ç­¾input_stringsï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹input_strings +0 +80 +160 éƒ½æ˜¯ä»€ä¹ˆï¼š\n(gdb) x/s 0x804b770-240 0x804b680 :\t\"Public speaking is very easy.\" (gdb) x/s 0x804b770-240+80 0x804b6d0 :\t\"1 2 6 24 120 720\" (gdb) x/s 0x804b770-240+160 0x804b720 :\t\"0 q 777\" å‘ç°æ˜¯å‰ä¸‰å…³è¾“å…¥çš„å­—ç¬¦ï¼Œæ‰€ä»¥\"9\"å¯¹åº”çš„æ˜¯æˆ‘ä»¬ç¬¬å››å…³çš„è¾“å…¥\n; å¦‚æœæˆåŠŸç»™ä¸¤ä¸ªå‚æ•°èµ‹å€¼ 8049556:\t83 f8 02 cmp eax,0x2 8049559:\t75 37 jne 8049592 804955b:\t83 c4 f8 add esp,0xfffffff8 ; å­—ç¬¦ä¸²æ¯”å¯¹ ; (gdb) x/s 0x8049d09 ; 0x8049d09:\t\"austinpowers\" ; å¯ä»¥å¾—çŸ¥ç¬¬å››å…³æ—¶åé¢åº”è¯¥æ·»åŠ ä¸€ä¸ª\"austinpowers\" ; ç”±æ­¤å¯ä»¥è¿›å…¥éšè—å…³å¡ ...... 804958d:\te8 56 f9 ff ff call 8048ee8 ç°åœ¨æˆ‘ä»¬å¼€å§‹çœ‹å‡½æ•°secret_phaseï¼š\n08048ee8 : 8048ee8:\t55 push ebp 8048ee9:\t89 e5 mov ebp,esp 8048eeb:\t83 ec 14 sub esp,0x14 8048eee:\t53 push ebx ; å°†è¾“å…¥çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­— ; è¿”å›å€¼åœ¨ eax 8048eef:\te8 08 03 00 00 call 80491fc 8048ef4:\t6a 00 push 0x0 8048ef6:\t6a 0a push 0xa 8048ef8:\t6a 00 push 0x0 8048efa:\t50 push eax 8048efb:\te8 f0 f8 ff ff call 80487f0 \u003c__strtol_internal@plt\u003e 8048f00:\t83 c4 10 add esp,0x10 8048f03:\t89 c3 mov ebx,eax 8048f05:\t8d 43 ff lea eax,[ebx-0x1] ; å¦‚æœ input-1 å¤§äº 0x3e8 åˆ™çˆ†ç‚¸ 8048f08:\t3d e8 03 00 00 cmp eax,0x3e8 8048f0d:\t76 05 jbe 8048f14 8048f0f:\te8 e8 05 00 00 call 80494fc 8048f14:\t83 c4 f8 add esp,0xfffffff8 8048f17:\t53 push ebx ; è¯¥åœ°å€å¯èƒ½æŒ‡å‘ä¸€ä¸ªæ•°ç»„æˆ–è€…ç»“æ„ 8048f18:\t68 20 b3 04 08 push 0x804b320 8048f1d:\te8 72 ff ff ff call 8048e94 8048f22:\t83 c4 10 add esp,0x10 ; å¦‚æœè¿”å›å€¼ä¸º 7 åˆ™æˆåŠŸ 8048f25:\t83 f8 07 cmp eax,0x7 8048f28:\t74 05 je 8048f2f ...... ç”±äºè°ƒç”¨äº†å‡½æ•°fun7ï¼Œæˆ‘ä»¬ç›´æ¥æ¥çœ‹å®ƒã€‚func7æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„é€’å½’å‡½æ•°ï¼Œä¸»è¦æ˜¯ç»“æ„ä½“è¾ƒä¸ºå¤æ‚ï¼š\n08048e94 : 8048e94:\t55 push ebp 8048e95:\t89 e5 mov ebp,esp 8048e97:\t83 ec 08 sub esp,0x8 8048e9a:\t8b 55 08 mov edx,DWORD PTR [ebp+0x8] 8048e9d:\t8b 45 0c mov eax,DWORD PTR [ebp+0xc] 8048ea0:\t85 d2 test edx,edx 8048ea2:\t75 0c jne 8048eb0 8048ea4:\tb8 ff ff ff ff mov eax,0xffffffff 8048ea9:\teb 37 jmp 8048ee2 8048eab:\t90 nop 8048eac:\t8d 74 26 00 lea esi,[esi+eiz*1+0x0] 8048eb0:\t3b 02 cmp eax,DWORD PTR [edx] 8048eb2:\t7d 11 jge 8048ec5 8048eb4:\t83 c4 f8 add esp,0xfffffff8 8048eb7:\t50 push eax ; ç±»ä¼¼é“¾è¡¨çš„ç»“æ„ 8048eb8:\t8b 42 04 mov eax,DWORD PTR [edx+0x4] 8048ebb:\t50 push eax 8048ebc:\te8 d3 ff ff ff call 8048e94 8048ec1:\t01 c0 add eax,eax 8048ec3:\teb 1d jmp 8048ee2 8048ec5:\t3b 02 cmp eax,DWORD PTR [edx] 8048ec7:\t74 17 je 8048ee0 8048ec9:\t83 c4 f8 add esp,0xfffffff8 8048ecc:\t50 push eax ; ç±»ä¼¼é“¾è¡¨çš„ç»“æ„ 8048ecd:\t8b 42 08 mov eax,DWORD PTR [edx+0x8] 8048ed0:\t50 push eax 8048ed1:\te8 be ff ff ff call 8048e94 8048ed6:\t01 c0 add eax,eax 8048ed8:\t40 inc eax 8048ed9:\teb 07 jmp 8048ee2 8048edb:\t90 nop 8048edc:\t8d 74 26 00 lea esi,[esi+eiz*1+0x0] 8048ee0:\t31 c0 xor eax,eax 8048ee2:\t89 ec mov esp,ebp 8048ee4:\t5d pop ebp 8048ee5:\tc3 ret 8048ee6:\t89 f6 mov esi,esi å¯ä»¥çœ‹åˆ°æœ‰ç±»ä¼¼é“¾è¡¨çš„ç»“æ„ï¼Œä½†æ˜¯å®ƒæ‹¥æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæƒ³è±¡ä¸ºä¸€æ£µæ ‘ï¼š\n// fun7 è¾“å…¥å‚æ•°ï¼šæŒ‡é’ˆ p å’Œ æ•´å‹ n // p å¯ä»¥ç†è§£ä¸ºäºŒå‰æ ‘çš„èŠ‚ç‚¹ typedef struct TreeNode { int value; struct TreeNode *left; struct TreeNode *right; } TreeNode; è¿™æ ·ä¸€æ¥fun7é©¬ä¸Šå¯ä»¥å†™æˆ C è¯­è¨€ï¼š\nint fun7(TreeNode *p, int n) { if (p == 0) { return -1; } else { if (n-\u003evalue \u003c p[0]) { return 2 * fun7(p-\u003eleft, n); } else if (n == p[0]) { return 0; } else { return 2 * fun7(p-\u003eright, n) + 1; } } } ç”±äºéœ€è¦é€’å½’å‡½æ•°è¿”å› 7 (å‚æ•°(p, n))ï¼Œæ‰€ä»¥å†…ä¸€å±‚åªèƒ½è¿”å› 3 (å‚æ•°(p-\u003eright, n))ï¼Œ å†å†…ä¸€å±‚åªèƒ½è¿”å› 1 (p-\u003eright-\u003eright, n)ï¼Œæœ€é‡Œé¢ä¸€å±‚è¿”å› 0 (p-\u003eright-\u003eright-\u003eright, n)ã€‚ æ‰€ä»¥ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶p-\u003erigh-\u003eright-\u003eright-\u003evalueåº”è¯¥ä¸nç›¸ç­‰\nå¯ä»¥é€šè¿‡ GDB å¾ˆå¿«æ‰¾åˆ°ï¼š\n# value left right (gdb) x/3x 0x804b320 0x804b320 : 0x00000024 0x0804b314 0x0804b308 (gdb) x/3x 0x0804b308 0x804b308 : 0x00000032 0x0804b2f0 0x0804b2d8 (gdb) x/3x 0x0804b2d8 0x804b2d8 : 0x0000006b 0x0804b2b4 0x0804b278 (gdb) x/3x 0x0804b278 0x804b278 : 0x000003e9 0x00000000 0x00000000 æ‰€ä»¥åº”è¯¥è¾“å…¥3e9ä¹Ÿå°±æ˜¯åè¿›åˆ¶1001ã€‚\nè¾“å…¥æ–‡ä»¶ å¦‚ä¸‹æ˜¯æœ€åé€šè¿‡æµ‹è¯•çš„è¾“å…¥æ–‡ä»¶ï¼š\n$ cat input Public speaking is very easy. 1 2 6 24 120 720 0 q 777 9 austinpowers o`ekma 4 2 6 3 1 5 1001 å®éªŒæ„Ÿå— è¿™å…­å…³åˆ†åˆ«æ¶‰åŠäº†å­—ç¬¦ä¸²å¸¸é‡ã€å¾ªç¯ã€switch-caseï¼ˆè·³è½¬è¡¨ï¼‰ã€é€’å½’ã€æ•°ç»„ã€é“¾è¡¨ç­‰çŸ¥è¯†ï¼Œéš¾åº¦æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆå¤§ï¼Œè€å¿ƒçœ‹æ±‡ç¼–ä»£ç å…¶å®æ˜¯å¾ˆå®¹æ˜“çœ‹æ‡‚çš„ã€‚è€Œéšè—å…³å¡éœ€è¦ç»†å¿ƒæˆ–è€…è¿æ°”å‘ç°ï¼Œä½†æ˜¯è§£å†³å®ƒå¹¶ä¸æ˜¯é—®é¢˜ã€‚\nåš Lab æ—¶æ²¡æœ‰åŠ¨æ€è°ƒè¯•è¿™ä¸ªç¨‹åºï¼Œæ„Ÿè§‰ä¹Ÿæ²¡æœ‰åŠ¨æ€è°ƒè¯•çš„å¿…è¦ï¼Œåªè¦çœ‹åˆ°äº†â€œé­”æ³•â€åœ°å€å°±å¯ä»¥ç›´æ¥ GDB æŸ¥çœ‹å®ƒã€‚\n",
  "wordCount" : "5980",
  "inLanguage": "zh",
  "image":"https://vaaandark.top/image/bomb.jpg","datePublished": "2022-10-29T22:24:22Z",
  "dateModified": "2022-10-29T22:24:22Z",
  "author":{
    "@type": "Person",
    "name": "vaaandark"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://vaaandark.top/posts/csapp-bomb-lab/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "vaaandark's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://vaaandark.top/image/vaaandark.png"
    }
  }
}
</script>


</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://vaaandark.top/" accesskey="h" title="vaaandark&#39;s blog (Alt + H)">
                <img src="https://vaaandark.top/image/vaaandark.png" alt="" aria-label="logo"
                    height="35">vaaandark&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://vaaandark.top/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://vaaandark.top/posts/" title="Posts">
                    <span>ğŸ“„ å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://vaaandark.top/categories/" title="categories">
                    <span>ğŸ“‚ åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://vaaandark.top/tags/" title="tags">
                    <span>ğŸ”– æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://vaaandark.top/about/" title="å…³äºæˆ‘">
                    <span>ğŸ™‹ å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://vaaandark.top/links/" title="å‹é“¾">
                    <span>ğŸ¤ å‹é“¾</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://vaaandark.top/">ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://vaaandark.top/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      CSAPP Bomb Lab
    </h1>
    <div class="post-meta"><span title='2022-10-29 22:24:22 +0000 UTC'>2022 10æœˆ 29</span>&nbsp;Â·&nbsp;12 åˆ†é’Ÿ&nbsp;Â·&nbsp;vaaandark

</div>
  </header> 
<figure class="entry-cover"><img loading="eager" src="https://vaaandark.top/image/bomb.jpg" alt="">
        
</figure><div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%ae%9e%e9%aa%8c%e7%ae%80%e8%bf%b0" aria-label="å®éªŒç®€è¿°">å®éªŒç®€è¿°</a></li>
                <li>
                    <a href="#%e5%ae%9e%e9%aa%8c%e7%8e%af%e5%a2%83" aria-label="å®éªŒç¯å¢ƒ">å®éªŒç¯å¢ƒ</a></li>
                <li>
                    <a href="#%e5%ae%9e%e9%aa%8c%e8%bf%87%e7%a8%8b" aria-label="å®éªŒè¿‡ç¨‹">å®éªŒè¿‡ç¨‹</a><ul>
                        
                <li>
                    <a href="#phase_1" aria-label="phase_1">phase_1</a></li>
                <li>
                    <a href="#phase_2" aria-label="phase_2">phase_2</a></li>
                <li>
                    <a href="#phase_3" aria-label="phase_3">phase_3</a></li>
                <li>
                    <a href="#phase_4" aria-label="phase_4">phase_4</a></li>
                <li>
                    <a href="#phase_5" aria-label="phase_5">phase_5</a></li>
                <li>
                    <a href="#phase_6" aria-label="phase_6">phase_6</a></li>
                <li>
                    <a href="#secret_phase" aria-label="secret_phase">secret_phase</a></li>
                <li>
                    <a href="#%e8%be%93%e5%85%a5%e6%96%87%e4%bb%b6" aria-label="è¾“å…¥æ–‡ä»¶">è¾“å…¥æ–‡ä»¶</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%ae%9e%e9%aa%8c%e6%84%9f%e5%8f%97" aria-label="å®éªŒæ„Ÿå—">å®éªŒæ„Ÿå—</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>ä¹‹å‰çš„ Bomb Lab æ²¡æœ‰åšï¼Œç°åœ¨åˆšå¥½åœ¨ä¸Šè®¡ç®—æœºç³»ç»ŸåŸºç¡€è¿™é—¨è¯¾ï¼Œå­¦æ ¡ä½¿ç”¨äº† CSAPP çš„ Bomb Lab ï¼Œå¯ä»¥è¡¥äº¤ä¸€ä¸‹ CSAPP çš„ä½œä¸šï¼Œä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ GDB çš„ä½¿ç”¨ã€‚</p>
<h2 id="å®éªŒç®€è¿°">å®éªŒç®€è¿°<a hidden class="anchor" aria-hidden="true" href="#å®éªŒç®€è¿°">#</a></h2>
<p>é—æ†¾åœ°ï¼ŒCSAPP çš„ Bomb Lab æ—©å·²æä¾›çš„æ˜¯ Linux çš„ 64 ä½å¯æ‰§è¡Œç¨‹åºï¼Œè€Œæˆ‘æ ¡çš„ Lab è¿˜æ˜¯ 32 ä½çš„ Windows PE32 ã€‚ä¸è¿‡æˆ‘è¿˜æ˜¯æ‰¾è€å¸ˆè¦åˆ°äº†å®ƒçš„ Linux ç‰ˆæœ¬ï¼Œä¸è¿‡ä¹Ÿæ˜¯ ELF32 ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—å«<code>bomb_32</code>ã€‚</p>
<p>è¯¥ Lab æ˜¯ CSAPP Bomb Lab çš„è€ç‰ˆ 32 ä½ç¨‹åºï¼Œæ‰€ä»¥ä¹‹åæˆ‘è¿˜æ˜¯çœ‹ä¸€ä¸‹æ–°ç‰ˆçš„ Bomb Lab è¾ƒå¥½ï¼Œä¸èƒ½å®Œå…¨ä¸äº†è§£ 64 ä½æ±‡ç¼–å˜› :(</p>
<h2 id="å®éªŒç¯å¢ƒ">å®éªŒç¯å¢ƒ<a hidden class="anchor" aria-hidden="true" href="#å®éªŒç¯å¢ƒ">#</a></h2>
<ul>
<li>GNU gdb (GDB) Fedora 12.1-2.fc36</li>
<li>GNU objdump version 2.37-36.fc36</li>
</ul>
<h2 id="å®éªŒè¿‡ç¨‹">å®éªŒè¿‡ç¨‹<a hidden class="anchor" aria-hidden="true" href="#å®éªŒè¿‡ç¨‹">#</a></h2>
<p>é¦–å…ˆåæ±‡ç¼–ç”Ÿæˆæ±‡ç¼–ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$ objdump -S -C bomb_32 &gt; bomb.disas
</span></span></code></pre></div><p>ç”±äºæˆ‘ä¸æ˜¯å¾ˆä¼šçœ‹ AT&amp;T çš„æ±‡ç¼–ä»£ç ï¼Œæ‰€ä»¥æˆ‘çš„ objdump æ˜¯ aliased çš„ï¼Œé»˜è®¤ä½¿ç”¨ Intel çš„è¯­æ³•ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$ which objdump
</span></span><span style="display:flex;"><span>objdump=&#39;objdump --disassembler-options=intel&#39;
</span></span><span style="display:flex;"><span>        /usr/bin/objdump
</span></span></code></pre></div><p>gdb ä¹Ÿé»˜è®¤ä½¿ç”¨ Intel çš„è¯­æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$ cat ~/.gdbinit
</span></span><span style="display:flex;"><span>set disassembly-flavor intel
</span></span></code></pre></div><p>å†ä½¿ç”¨ gdb å¼€å§‹è°ƒè¯•ç¨‹åºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$ gdb --args ./bomb_32 input
</span></span></code></pre></div><h3 id="phase_1">phase_1<a hidden class="anchor" aria-hidden="true" href="#phase_1">#</a></h3>
<p>ç”±äºè€å¸ˆç»™äº†è¿™ä¸ªç¨‹åºè¿è¡Œçš„æµç¨‹å›¾ï¼Œæˆ‘ä¹Ÿçœ‹è¿‡ Bomb Lab ä¸­æä¾›çš„ .c æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘çŸ¥é“æ¯ä¸ªå­—ç¬¦ä¸²éƒ½åœ¨<code>phase_n</code>çš„å‡½æ•°ä¸­è¾“å…¥æˆ–è€…æ£€éªŒã€‚</p>
<p>å¯ä»¥ç›´æ¥æŸ¥çœ‹<code>phase_1</code>å‡½æ•°çš„åæ±‡ç¼–ä»£ç ï¼Œå¹¶æ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°ä¸­çš„ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>(gdb) disas phase_1
</span></span><span style="display:flex;"><span>Dump of assembler code for function phase_1:
</span></span><span style="display:flex;"><span>   ......
</span></span><span style="display:flex;"><span>   0x08048b2c &lt;+12&gt;:	push   0x80497c0
</span></span><span style="display:flex;"><span>   0x08048b31 &lt;+17&gt;:	push   eax
</span></span><span style="display:flex;"><span>   0x08048b32 &lt;+18&gt;:	call   0x8049030 &lt;strings_not_equal&gt;
</span></span><span style="display:flex;"><span>   ......
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°å®ƒåœ¨å‹å…¥ä¸¤ä¸ªå‚æ•°ä¹‹åè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°<code>strings_not_equal</code>ï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥çœ‹<code>0x80497c0</code>é‡Œé¢æ˜¯ä»€ä¹ˆå†…å®¹ï¼Œæˆ‘é¦–å…ˆçŒœæµ‹å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>(gdb) p (char *)0x80497c0
</span></span><span style="display:flex;"><span>$1 = 0x80497c0 &#34;Public speaking is very easy.&#34;
</span></span></code></pre></div><p>åœ¨ä¹‹åçš„æµ‹è¯•ä¸­ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä¹Ÿè®©æˆ‘è¿‡äº†ç¬¬ä¸€å…³ã€‚</p>
<h3 id="phase_2">phase_2<a hidden class="anchor" aria-hidden="true" href="#phase_2">#</a></h3>
<p>ç›´æ¥æŸ¥çœ‹<code>phase_2</code>çš„æ±‡ç¼–ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>; phase_2 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
</span></span><span style="display:flex;"><span>08048b48 &lt;phase_2&gt;:
</span></span><span style="display:flex;"><span> 8048b48:	55                   	push   ebp
</span></span><span style="display:flex;"><span> 8048b49:	89 e5                	mov    ebp,esp
</span></span><span style="display:flex;"><span> ; ä¸ºå±€éƒ¨å˜é‡è…¾å‡ºç©ºé—´
</span></span><span style="display:flex;"><span> 8048b4b:	83 ec 20             	sub    esp,0x20
</span></span><span style="display:flex;"><span> ; å¯èƒ½æ˜¯å†…éƒ¨è°ƒç”¨çš„å‡½æ•°éœ€è¦ä½¿ç”¨è¿™ä¸¤ä¸ªå¯„å­˜å™¨
</span></span><span style="display:flex;"><span> ; æ‰€ä»¥æ ¹æ® caller save åœ¨è¿™é‡Œä¿å­˜
</span></span><span style="display:flex;"><span> 8048b4e:	56                   	push   esi
</span></span><span style="display:flex;"><span> 8048b4f:	53                   	push   ebx
</span></span><span style="display:flex;"><span> ; å°† input æ”¾å…¥ edx ä¸­
</span></span><span style="display:flex;"><span> 8048b50:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
</span></span><span style="display:flex;"><span> ; ç­‰äº sub esp, 0x8
</span></span><span style="display:flex;"><span> 8048b53:	83 c4 f8             	add    esp,0xfffffff8
</span></span><span style="display:flex;"><span> ; å°†å±€éƒ¨å˜é‡çš„åœ°å€ [ebp-0x18] æ”¾å…¥ eax ä¸­
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ç»™å®ƒèµ·åä¸ºå˜é‡ A
</span></span><span style="display:flex;"><span> ; ç”±äºç»™å±€éƒ¨å˜é‡é¢„ç•™çš„ä½ç½®å¾ˆå¤§ï¼ŒçŒœæµ‹ A æ˜¯ä¸€ä¸ªæ•°ç»„
</span></span><span style="display:flex;"><span> 8048b56:	8d 45 e8             	lea    eax,[ebp-0x18]
</span></span><span style="display:flex;"><span> ; å‹æ ˆä¼ å‚ï¼Œä¼ å…¥çš„æ˜¯ input, A
</span></span><span style="display:flex;"><span> 8048b59:	50                   	push   eax
</span></span><span style="display:flex;"><span> 8048b5a:	52                   	push   edx
</span></span><span style="display:flex;"><span> ; è°ƒç”¨å‡½æ•° read_six_numbers æ ¹æ®åå­—åˆç†æ€€ç–‘è¿™é‡Œæ˜¯è¯»å…¥å…­ä¸ªæ•°å­—ï¼ŒA å¯èƒ½æœ‰ 6 ä¸ªå…ƒç´ 
</span></span><span style="display:flex;"><span> 8048b5b:	e8 78 04 00 00       	call   8048fd8 &lt;read_six_numbers&gt;
</span></span><span style="display:flex;"><span> ; è¿™é‡Œ esp åŠ äº† 0x10 ç›¸å½“äºæŠŠä¹‹å‰çš„å‚æ•°é€€æ ˆäº†ï¼Œè¿˜æŠŠä¹‹å‰ add esp,0xfffffff8 çš„åŠ å›å»äº†ã€‚æˆ‘çŒœæµ‹ä¹‹å‰çš„ add å¯èƒ½å’Œå†…å­˜å¯¹é½æœ‰å…³
</span></span><span style="display:flex;"><span> 8048b60:	83 c4 10             	add    esp,0x10
</span></span><span style="display:flex;"><span> ; å°† A[0] ä¸ 1 æ¯”è¾ƒ
</span></span><span style="display:flex;"><span> ; ç”±äºä¹‹å‰ä¼ é€’çš„æ˜¯åœ°å€ï¼Œè¿™ä¸ªå˜é‡åº”è¯¥åœ¨ read_six_numbers ä¸­è¢«ä¿®æ”¹äº†
</span></span><span style="display:flex;"><span> 8048b63:	83 7d e8 01          	cmp    DWORD PTR [ebp-0x18],0x1
</span></span><span style="display:flex;"><span> ; å¦‚æœæ˜¯ 1 åˆ™æˆåŠŸï¼Œä¸æ˜¯ 1 åˆ™å¼•çˆ†ç‚¸å¼¹
</span></span><span style="display:flex;"><span> 8048b67:	74 05                	je     8048b6e &lt;phase_2+0x26&gt;
</span></span><span style="display:flex;"><span> 8048b69:	e8 8e 09 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> ; ebx &lt;- 0x1
</span></span><span style="display:flex;"><span> 8048b6e:	bb 01 00 00 00       	mov    ebx,0x1
</span></span><span style="display:flex;"><span> ; å°† A æ”¾å…¥ esi ä¸­
</span></span><span style="display:flex;"><span> 8048b73:	8d 75 e8             	lea    esi,[ebp-0x18]
</span></span><span style="display:flex;"><span> ; eax &lt;- 0x2
</span></span><span style="display:flex;"><span> 8048b76:	8d 43 01             	lea    eax,[ebx+0x1]
</span></span><span style="display:flex;"><span> ; è¿™æ­¥éª¤æ“ä½œä¹‹å eax çš„å€¼ä¸º (ebx + 1) * A[ebx - 1]
</span></span><span style="display:flex;"><span> ; ebx åˆå§‹ä¸º 1
</span></span><span style="display:flex;"><span> 8048b79:	0f af 44 9e fc       	imul   eax,DWORD PTR [esi+ebx*4-0x4]
</span></span><span style="display:flex;"><span> ; ç›¸å½“äºåˆ¤æ–­ A[ebx] æ˜¯ä¸æ˜¯ A[ebx - 1] ä¸¤å€
</span></span><span style="display:flex;"><span> 8048b7e:	39 04 9e             	cmp    DWORD PTR [esi+ebx*4],eax
</span></span><span style="display:flex;"><span> 8048b81:	74 05                	je     8048b88 &lt;phase_2+0x40&gt;
</span></span><span style="display:flex;"><span> 8048b83:	e8 74 09 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> 8048b88:	43                   	inc    ebx
</span></span><span style="display:flex;"><span> 8048b89:	83 fb 05             	cmp    ebx,0x5
</span></span><span style="display:flex;"><span> ; æˆ‘è¯»åˆ°è¿™é‡Œæ‰å‘ç°æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œç»ˆæ­¢æ¡ä»¶ä¸º ebx &gt; 5
</span></span><span style="display:flex;"><span> 8048b8c:	7e e8                	jle    8048b76 &lt;phase_2+0x2e&gt;
</span></span><span style="display:flex;"><span> ; æ‰€ä»¥æ ¹æ®é€’æ¨å…¬å¼å¯çŸ¥å­—ç¬¦ä¸²ä¸º 1 2 6 24 120 720
</span></span><span style="display:flex;"><span> 8048b8e:	8d 65 d8             	lea    esp,[ebp-0x28]
</span></span><span style="display:flex;"><span> 8048b91:	5b                   	pop    ebx
</span></span><span style="display:flex;"><span> 8048b92:	5e                   	pop    esi
</span></span><span style="display:flex;"><span> 8048b93:	89 ec                	mov    esp,ebp
</span></span><span style="display:flex;"><span> 8048b95:	5d                   	pop    ebp
</span></span><span style="display:flex;"><span> 8048b96:	c3                   	ret    
</span></span><span style="display:flex;"><span> 8048b97:	90                   	nop
</span></span></code></pre></div><p>å®ƒè°ƒç”¨äº†å‡½æ•°<code>read_six_numbers</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿåˆ†æä¸€ä¸‹å®ƒï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>; å‚æ•°ä¸ºå­—ç¬¦ä¸² input å’Œæ•°ç»„ A
</span></span><span style="display:flex;"><span>08048fd8 &lt;read_six_numbers&gt;:
</span></span><span style="display:flex;"><span> 8048fd8:	55                   	push   ebp
</span></span><span style="display:flex;"><span> 8048fd9:	89 e5                	mov    ebp,esp
</span></span><span style="display:flex;"><span> 8048fdb:	83 ec 08             	sub    esp,0x8
</span></span><span style="display:flex;"><span> ; ä¼ å…¥çš„è¾“å…¥å­—ç¬¦ä¸²
</span></span><span style="display:flex;"><span> 8048fde:	8b 4d 08             	mov    ecx,DWORD PTR [ebp+0x8]
</span></span><span style="display:flex;"><span> ; ä¼ å…¥çš„æ•°ç»„ A
</span></span><span style="display:flex;"><span> 8048fe1:	8b 55 0c             	mov    edx,DWORD PTR [ebp+0xc]
</span></span><span style="display:flex;"><span> ; A[5]
</span></span><span style="display:flex;"><span> 8048fe4:	8d 42 14             	lea    eax,[edx+0x14]
</span></span><span style="display:flex;"><span> 8048fe7:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; A[4]
</span></span><span style="display:flex;"><span> 8048fe8:	8d 42 10             	lea    eax,[edx+0x10]
</span></span><span style="display:flex;"><span> 8048feb:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; A[3]
</span></span><span style="display:flex;"><span> 8048fec:	8d 42 0c             	lea    eax,[edx+0xc]
</span></span><span style="display:flex;"><span> 8048fef:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; A[2]
</span></span><span style="display:flex;"><span> 8048ff0:	8d 42 08             	lea    eax,[edx+0x8]
</span></span><span style="display:flex;"><span> 8048ff3:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; A[1]
</span></span><span style="display:flex;"><span> 8048ff4:	8d 42 04             	lea    eax,[edx+0x4]
</span></span><span style="display:flex;"><span> 8048ff7:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; A[0]
</span></span><span style="display:flex;"><span> 8048ff8:	52                   	push   edx
</span></span><span style="display:flex;"><span> ; format å­—ç¬¦ä¸² &#34;%d %d %d %d %d %d&#34;
</span></span><span style="display:flex;"><span> 8048ff9:	68 1b 9b 04 08       	push   0x8049b1b
</span></span><span style="display:flex;"><span> ; input è¾“å…¥å­—ç¬¦ä¸²
</span></span><span style="display:flex;"><span> 8048ffe:	51                   	push   ecx
</span></span><span style="display:flex;"><span> 8048fff:	e8 5c f8 ff ff       	call   8048860 &lt;sscanf@plt&gt;
</span></span><span style="display:flex;"><span> 8049004:	83 c4 20             	add    esp,0x20
</span></span><span style="display:flex;"><span> 8049007:	83 f8 05             	cmp    eax,0x5
</span></span><span style="display:flex;"><span> 804900a:	7f 05                	jg     8049011 &lt;read_six_numbers+0x39&gt;
</span></span><span style="display:flex;"><span> 804900c:	e8 eb 04 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> 8049011:	89 ec                	mov    esp,ebp
</span></span><span style="display:flex;"><span> 8049013:	5d                   	pop    ebp
</span></span><span style="display:flex;"><span> 8049014:	c3                   	ret    
</span></span><span style="display:flex;"><span> 8049015:	8d 76 00             	lea    esi,[esi+0x0]
</span></span></code></pre></div><p>ä½¿ç”¨å­—ç¬¦ä¸²<code>1 2 6 24 120 720</code>æˆåŠŸé€šè¿‡ç¬¬äºŒå…³ã€‚</p>
<h3 id="phase_3">phase_3<a hidden class="anchor" aria-hidden="true" href="#phase_3">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>; phase_3 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
</span></span><span style="display:flex;"><span>08048b98 &lt;phase_3&gt;:
</span></span><span style="display:flex;"><span> 8048b98:	55                   	push   ebp
</span></span><span style="display:flex;"><span> 8048b99:	89 e5                	mov    ebp,esp
</span></span><span style="display:flex;"><span> ; é¢„ç•™ 20 ä¸ªå­—èŠ‚
</span></span><span style="display:flex;"><span> 8048b9b:	83 ec 14             	sub    esp,0x14
</span></span><span style="display:flex;"><span> 8048b9e:	53                   	push   ebx
</span></span><span style="display:flex;"><span> ; å°† input æ”¾å…¥ edx
</span></span><span style="display:flex;"><span> 8048b9f:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
</span></span><span style="display:flex;"><span> ; sub esp, 0x4
</span></span><span style="display:flex;"><span> 8048ba2:	83 c4 f4             	add    esp,0xfffffff4
</span></span><span style="display:flex;"><span> ; 
</span></span><span style="display:flex;"><span> ; int_b
</span></span><span style="display:flex;"><span> 8048ba5:	8d 45 fc             	lea    eax,[ebp-0x4]
</span></span><span style="display:flex;"><span> 8048ba8:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; char_c
</span></span><span style="display:flex;"><span> 8048ba9:	8d 45 fb             	lea    eax,[ebp-0x5]
</span></span><span style="display:flex;"><span> 8048bac:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; int_a
</span></span><span style="display:flex;"><span> 8048bad:	8d 45 f4             	lea    eax,[ebp-0xc]
</span></span><span style="display:flex;"><span> 8048bb0:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; é€šè¿‡ GBD è°ƒè¯•å¯ä»¥çŸ¥é“è¿™ä¸ªåœ°å€å†…å®¹ä¸º &#34;%d %c %d&#34;
</span></span><span style="display:flex;"><span> 8048bb1:	68 de 97 04 08       	push   0x80497de
</span></span><span style="display:flex;"><span> ; input
</span></span><span style="display:flex;"><span> 8048bb6:	52                   	push   edx
</span></span><span style="display:flex;"><span> 8048bb7:	e8 a4 fc ff ff       	call   8048860 &lt;sscanf@plt&gt;
</span></span><span style="display:flex;"><span> 8048bbc:	83 c4 20             	add    esp,0x20
</span></span><span style="display:flex;"><span> ; å¦‚æœ sscanf åŒ¹é…å¹¶èµ‹å€¼çš„ä¸ªæ•°ä¸å¤šäº 2 ï¼Œåˆ™çˆ†ç‚¸
</span></span><span style="display:flex;"><span> 8048bbf:	83 f8 02             	cmp    eax,0x2
</span></span><span style="display:flex;"><span> 8048bc2:	7f 05                	jg     8048bc9 &lt;phase_3+0x31&gt;
</span></span><span style="display:flex;"><span> 8048bc4:	e8 33 09 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> ; å°† int_a ä¸ 0x7 æ¯”è¾ƒ
</span></span><span style="display:flex;"><span> ; æ€€ç–‘æ˜¯ä¸€ä¸ªé˜²æ­¢æ•°ç»„è¶Šç•Œçš„æ“ä½œ
</span></span><span style="display:flex;"><span> 8048bc9:	83 7d f4 07          	cmp    DWORD PTR [ebp-0xc],0x7
</span></span><span style="display:flex;"><span> ; å¦‚æœå¤§äºåˆ™çˆ†ç‚¸
</span></span><span style="display:flex;"><span> 8048bcd:	0f 87 b5 00 00 00    	ja     8048c88 &lt;phase_3+0xf0&gt;
</span></span><span style="display:flex;"><span> ; å°† int_a èµ‹å€¼ç»™ eax
</span></span><span style="display:flex;"><span> 8048bd3:	8b 45 f4             	mov    eax,DWORD PTR [ebp-0xc]
</span></span><span style="display:flex;"><span> ; è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè·³è½¬è¡¨ï¼Œå¯¹åº”åˆ° C è¯­è¨€ä¸­åº”è¯¥æ˜¯ä¸€ä¸ª switch-case ç»“æ„
</span></span><span style="display:flex;"><span> ; å¯ä»¥åœ¨ gdb é‡Œé¢æŸ¥çœ‹ä¸€ä¸‹å¯¹åº”çš„è¡¨ `(gdb) p/x *(int *)0x80497e8`
</span></span><span style="display:flex;"><span> ; [0x80497e8] å¯¹åº” 8048be0
</span></span><span style="display:flex;"><span> ; [0x80497e8+1*4] å¯¹åº” 8048c00
</span></span><span style="display:flex;"><span> ; [0x80497e8+2*4] å¯¹åº” 8048c16
</span></span><span style="display:flex;"><span> ; [0x80497e8+3*4] å¯¹åº” 8048c28
</span></span><span style="display:flex;"><span> ; [0x80497e8+4*4] å¯¹åº” 8048c40
</span></span><span style="display:flex;"><span> ; [0x80497e8+5*4] å¯¹åº” 8048c52
</span></span><span style="display:flex;"><span> ; [0x80497e8+6*4] å¯¹åº” 8048c64
</span></span><span style="display:flex;"><span> ; [0x80497e8+7*4] å¯¹åº” 8048c76
</span></span><span style="display:flex;"><span> ; switch-case(int_a)
</span></span><span style="display:flex;"><span> 8048bd6:	ff 24 85 e8 97 04 08 	jmp    DWORD PTR [eax*4+0x80497e8]
</span></span><span style="display:flex;"><span> 8048bdd:	8d 76 00             	lea    esi,[esi+0x0]
</span></span><span style="display:flex;"><span> ; case 0:
</span></span><span style="display:flex;"><span> ; bl &lt;- 0x71
</span></span><span style="display:flex;"><span> 8048be0:	b3 71                	mov    bl,0x71
</span></span><span style="display:flex;"><span> ; å°† int_b ä¸ 0x309 æ¯”è¾ƒ
</span></span><span style="display:flex;"><span> 8048be2:	81 7d fc 09 03 00 00 	cmp    DWORD PTR [ebp-0x4],0x309
</span></span><span style="display:flex;"><span> ; å¦‚æœç­‰äºå°± break
</span></span><span style="display:flex;"><span> 8048be9:	0f 84 a0 00 00 00    	je     8048c8f &lt;phase_3+0xf7&gt;
</span></span><span style="display:flex;"><span> 8048bef:	e8 08 09 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> 8048bf4:	e9 96 00 00 00       	jmp    8048c8f &lt;phase_3+0xf7&gt;
</span></span><span style="display:flex;"><span> ; eiz æ˜¯ä¸€ä¸ªä¼ªå¯„å­˜å™¨ï¼Œå®ƒå§‹ç»ˆä¸º 0
</span></span><span style="display:flex;"><span> 8048bf9:	8d b4 26 00 00 00 00 	lea    esi,[esi+eiz*1+0x0]
</span></span><span style="display:flex;"><span> ; åé¢å‡ ä¸ª case éƒ½æ˜¯ç›¸åŒçš„é“ç†
</span></span><span style="display:flex;"><span> ......
</span></span><span style="display:flex;"><span> ; bl ä¸ char_c æ¯”è¾ƒ
</span></span><span style="display:flex;"><span> 8048c8f:	3a 5d fb             	cmp    bl,BYTE PTR [ebp-0x5]
</span></span><span style="display:flex;"><span> ; æ‰€ä»¥åŸºæœ¬æµç¨‹å°±æ˜¯æ ¹æ® int_a çš„å€¼ç¡®å®šè¿›å»å“ªä¸€ä¸ª case ï¼Œ
</span></span><span style="display:flex;"><span> ; ç„¶ååœ¨è¯¥åˆ†æ”¯ä¸­å°† int_b å’ŒæŸä¸€å€¼æ¯”è¾ƒï¼Œå¹¶ç¡®å®š char_c åº”è¯¥ç­‰äºçš„å€¼
</span></span><span style="display:flex;"><span> ; æ‰€ä»¥ç­”æ¡ˆåº”è¯¥ä¸å”¯ä¸€ï¼Œé€šè¿‡ int_a çš„å€¼ç¡®å®šåé¢ä¸¤ä¸ªç­”æ¡ˆ
</span></span><span style="display:flex;"><span> ......
</span></span></code></pre></div><p>æˆ‘ä½¿ç”¨<code>0 q 777</code>é€šè¿‡äº†è¿™ä¸€å…³ã€‚</p>
<h3 id="phase_4">phase_4<a hidden class="anchor" aria-hidden="true" href="#phase_4">#</a></h3>
<p>è¿™ä¸€å…³åŒ…å«äº†é€’å½’å‡½æ•°ï¼Œä½†æ˜¯æŒ‘æˆ˜æ€§ä¸æ˜¯å¾ˆå¤§ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>; phase_4 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
</span></span><span style="display:flex;"><span>08048ce0 &lt;phase_4&gt;:
</span></span><span style="display:flex;"><span> 8048ce0:	55                   	push   ebp
</span></span><span style="display:flex;"><span> 8048ce1:	89 e5                	mov    ebp,esp
</span></span><span style="display:flex;"><span> 8048ce3:	83 ec 18             	sub    esp,0x18
</span></span><span style="display:flex;"><span> ; input -&gt; edx
</span></span><span style="display:flex;"><span> 8048ce6:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
</span></span><span style="display:flex;"><span> ; sub esp, 0xc
</span></span><span style="display:flex;"><span> 8048ce9:	83 c4 fc             	add    esp,0xfffffffc
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸º A
</span></span><span style="display:flex;"><span> 8048cec:	8d 45 fc             	lea    eax,[ebp-0x4]
</span></span><span style="display:flex;"><span> 8048cef:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; æ ¹æ® GDB `p (char *)0x8049808` å¯å¾—è¯¥å­—ç¬¦ä¸²ä¸º `%d`
</span></span><span style="display:flex;"><span> 8048cf0:	68 08 98 04 08       	push   0x8049808
</span></span><span style="display:flex;"><span> 8048cf5:	52                   	push   edx
</span></span><span style="display:flex;"><span> 8048cf6:	e8 65 fb ff ff       	call   8048860 &lt;sscanf@plt&gt;
</span></span><span style="display:flex;"><span> 8048cfb:	83 c4 10             	add    esp,0x10
</span></span><span style="display:flex;"><span> ; åˆ¤æ–­ sscanf æ˜¯å¦æˆåŠŸ
</span></span><span style="display:flex;"><span> 8048cfe:	83 f8 01             	cmp    eax,0x1
</span></span><span style="display:flex;"><span> 8048d01:	75 06                	jne    8048d09 &lt;phase_4+0x29&gt;
</span></span><span style="display:flex;"><span> ; åˆ¤æ–­ A å’Œ 0x0 ï¼Œå¦‚æœä¸å¤§äº 0 åˆ™çˆ†ç‚¸
</span></span><span style="display:flex;"><span> 8048d03:	83 7d fc 00          	cmp    DWORD PTR [ebp-0x4],0x0
</span></span><span style="display:flex;"><span> 8048d07:	7f 05                	jg     8048d0e &lt;phase_4+0x2e&gt;
</span></span><span style="display:flex;"><span> 8048d09:	e8 ee 07 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> ; sub esp, 0x4
</span></span><span style="display:flex;"><span> 8048d0e:	83 c4 f4             	add    esp,0xfffffff4
</span></span><span style="display:flex;"><span> ; A -&gt; eax
</span></span><span style="display:flex;"><span> 8048d11:	8b 45 fc             	mov    eax,DWORD PTR [ebp-0x4]
</span></span><span style="display:flex;"><span> ; å‚æ•°å…¥æ ˆå¹¶è°ƒç”¨ func4
</span></span><span style="display:flex;"><span> 8048d14:	50                   	push   eax
</span></span><span style="display:flex;"><span> 8048d15:	e8 86 ff ff ff       	call   8048ca0 &lt;func4&gt;
</span></span><span style="display:flex;"><span> 8048d1a:	83 c4 10             	add    esp,0x10
</span></span><span style="display:flex;"><span> ; è¿”å›å€¼å¦‚æœä¸æ˜¯ 55 åˆ™çˆ†ç‚¸
</span></span><span style="display:flex;"><span> 8048d1d:	83 f8 37             	cmp    eax,0x37
</span></span><span style="display:flex;"><span> 8048d20:	74 05                	je     8048d27 &lt;phase_4+0x47&gt;
</span></span><span style="display:flex;"><span> 8048d22:	e8 d5 07 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> 8048d27:	89 ec                	mov    esp,ebp
</span></span><span style="display:flex;"><span> 8048d29:	5d                   	pop    ebp
</span></span><span style="display:flex;"><span> 8048d2a:	c3                   	ret    
</span></span><span style="display:flex;"><span> 8048d2b:	90                   	nop
</span></span></code></pre></div><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹<code>func4</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>; phase_4 çš„å‚æ•°ä¸ºæ•´å‹ A ï¼Œåœ¨ [ebp+0x8]
</span></span><span style="display:flex;"><span>08048ca0 &lt;func4&gt;:
</span></span><span style="display:flex;"><span> 8048ca0:	55                   	push   ebp
</span></span><span style="display:flex;"><span> 8048ca1:	89 e5                	mov    ebp,esp
</span></span><span style="display:flex;"><span> 8048ca3:	83 ec 10             	sub    esp,0x10
</span></span><span style="display:flex;"><span> 8048ca6:	56                   	push   esi
</span></span><span style="display:flex;"><span> 8048ca7:	53                   	push   ebx
</span></span><span style="display:flex;"><span> ; ebx &lt;- A
</span></span><span style="display:flex;"><span> 8048ca8:	8b 5d 08             	mov    ebx,DWORD PTR [ebp+0x8]
</span></span><span style="display:flex;"><span> ; å¦‚æœ A ä¸å¤§äº 1 åˆ™è·³è½¬åˆ° é€€å‡ºï¼Œè¿™é‡Œåº”è¯¥æ˜¯é€’å½’å‡ºå£ï¼Œè¿”å›å€¼ä¸º 1
</span></span><span style="display:flex;"><span> 8048cab:	83 fb 01             	cmp    ebx,0x1
</span></span><span style="display:flex;"><span> 8048cae:	7e 20                	jle    8048cd0 &lt;func4+0x30&gt;
</span></span><span style="display:flex;"><span> 8048cb0:	83 c4 f4             	add    esp,0xfffffff4
</span></span><span style="display:flex;"><span> 8048cb3:	8d 43 ff             	lea    eax,[ebx-0x1]
</span></span><span style="display:flex;"><span> 8048cb6:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; func(A - 1)
</span></span><span style="display:flex;"><span> 8048cb7:	e8 e4 ff ff ff       	call   8048ca0 &lt;func4&gt;
</span></span><span style="display:flex;"><span> 8048cbc:	89 c6                	mov    esi,eax
</span></span><span style="display:flex;"><span> 8048cbe:	83 c4 f4             	add    esp,0xfffffff4
</span></span><span style="display:flex;"><span> 8048cc1:	8d 43 fe             	lea    eax,[ebx-0x2]
</span></span><span style="display:flex;"><span> 8048cc4:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; func(A - 2)
</span></span><span style="display:flex;"><span> ; å†™åˆ°è¿™é‡Œå¯ä»¥çŒœåˆ°è¿™æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œ
</span></span><span style="display:flex;"><span> ; ä¹‹å‰è¦æ±‚è¿”å›å€¼æ˜¯ 55 ï¼Œæ‰€ä»¥è¾“å…¥åº”è¯¥æ˜¯ 9
</span></span><span style="display:flex;"><span> 8048cc5:	e8 d6 ff ff ff       	call   8048ca0 &lt;func4&gt;
</span></span><span style="display:flex;"><span> 8048cca:	01 f0                	add    eax,esi
</span></span><span style="display:flex;"><span> 8048ccc:	eb 07                	jmp    8048cd5 &lt;func4+0x35&gt;
</span></span><span style="display:flex;"><span> 8048cce:	89 f6                	mov    esi,esi
</span></span><span style="display:flex;"><span> 8048cd0:	b8 01 00 00 00       	mov    eax,0x1
</span></span><span style="display:flex;"><span> 8048cd5:	8d 65 e8             	lea    esp,[ebp-0x18]
</span></span><span style="display:flex;"><span> 8048cd8:	5b                   	pop    ebx
</span></span><span style="display:flex;"><span> 8048cd9:	5e                   	pop    esi
</span></span><span style="display:flex;"><span> 8048cda:	89 ec                	mov    esp,ebp
</span></span><span style="display:flex;"><span> 8048cdc:	5d                   	pop    ebp
</span></span><span style="display:flex;"><span> 8048cdd:	c3                   	ret    
</span></span><span style="display:flex;"><span> 8048cde:	89 f6                	mov    esi,esi
</span></span></code></pre></div><p>è¾“å…¥<code>9</code>æˆåŠŸé€šè¿‡äº†è¿™ä¸€å…³ã€‚</p>
<h3 id="phase_5">phase_5<a hidden class="anchor" aria-hidden="true" href="#phase_5">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>; phase_5 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
</span></span><span style="display:flex;"><span>08048d2c &lt;phase_5&gt;:
</span></span><span style="display:flex;"><span> 8048d2c:	55                   	push   ebp
</span></span><span style="display:flex;"><span> 8048d2d:	89 e5                	mov    ebp,esp
</span></span><span style="display:flex;"><span> 8048d2f:	83 ec 10             	sub    esp,0x10
</span></span><span style="display:flex;"><span> 8048d32:	56                   	push   esi
</span></span><span style="display:flex;"><span> 8048d33:	53                   	push   ebx
</span></span><span style="display:flex;"><span> ; input -&gt; ebx
</span></span><span style="display:flex;"><span> 8048d34:	8b 5d 08             	mov    ebx,DWORD PTR [ebp+0x8]
</span></span><span style="display:flex;"><span> 8048d37:	83 c4 f4             	add    esp,0xfffffff4
</span></span><span style="display:flex;"><span> 8048d3a:	53                   	push   ebx
</span></span><span style="display:flex;"><span> ; è®¡ç®— input å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¦‚æœé•¿åº¦ä¸ä¸º 6 åˆ™çˆ†ç‚¸
</span></span><span style="display:flex;"><span> 8048d3b:	e8 d8 02 00 00       	call   8049018 &lt;string_length&gt;
</span></span><span style="display:flex;"><span> 8048d40:	83 c4 10             	add    esp,0x10
</span></span><span style="display:flex;"><span> 8048d43:	83 f8 06             	cmp    eax,0x6
</span></span><span style="display:flex;"><span> 8048d46:	74 05                	je     8048d4d &lt;phase_5+0x21&gt;
</span></span><span style="display:flex;"><span> 8048d48:	e8 af 07 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> ; å°çŸ¥è¯†ï¼šç”±äºä¸¤æ•°ç›¸åŒï¼Œæ‰€ä»¥ä½¿ç”¨ xor æ¥æ¸…é›¶å¿«ä¸€äº›
</span></span><span style="display:flex;"><span> 8048d4d:	31 d2                	xor    edx,edx
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ä»¤è¿™ä¸ªå˜é‡ä¸º str_a
</span></span><span style="display:flex;"><span> 8048d4f:	8d 4d f8             	lea    ecx,[ebp-0x8]
</span></span><span style="display:flex;"><span> ; åœ°å€ 0x804b220 &#34;isrveawhobpnutfg\260\001&#34;
</span></span><span style="display:flex;"><span> ; æ€€ç–‘æ˜¯é€šè¿‡ä¸€äº›æ“ä½œä»ä¸Šè¿°å­—ç¬¦ä¸²ä¸­å–å‡ºå­—ç¬¦é‡æ–°æ‹¼æ¥
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ä»¤è¿™ä¸ªå­—ç¬¦ä¸²ä¸º dict
</span></span><span style="display:flex;"><span> 8048d52:	be 20 b2 04 08       	mov    esi,0x804b220
</span></span><span style="display:flex;"><span> ; ä»è¿™é‡Œå¼€å§‹æ˜¯å¾ªç¯å…­æ¬¡ï¼Œåé¢çš„å­—ç¬¦ä¸²å¸¸é‡é•¿åº¦ä¹Ÿåˆšå¥½ä¸º 6
</span></span><span style="display:flex;"><span> ; al &lt;- input[edx]
</span></span><span style="display:flex;"><span> 8048d57:	8a 04 1a             	mov    al,BYTE PTR [edx+ebx*1]
</span></span><span style="display:flex;"><span> ; å– al ä½å››ä½
</span></span><span style="display:flex;"><span> 8048d5a:	24 0f                	and    al,0xf
</span></span><span style="display:flex;"><span> ; æ‹“å±•é•¿åº¦åˆ° 32 ä½
</span></span><span style="display:flex;"><span> 8048d5c:	0f be c0             	movsx  eax,al
</span></span><span style="display:flex;"><span> ; al &lt;- dict[eax]
</span></span><span style="display:flex;"><span> 8048d5f:	8a 04 30             	mov    al,BYTE PTR [eax+esi*1]
</span></span><span style="display:flex;"><span> ; str_a[edx] &lt;- al
</span></span><span style="display:flex;"><span> 8048d62:	88 04 0a             	mov    BYTE PTR [edx+ecx*1],al
</span></span><span style="display:flex;"><span> 8048d65:	42                   	inc    edx
</span></span><span style="display:flex;"><span> 8048d66:	83 fa 05             	cmp    edx,0x5
</span></span><span style="display:flex;"><span> 8048d69:	7e ec                	jle    8048d57 &lt;phase_5+0x2b&gt;
</span></span><span style="display:flex;"><span> ; å¾ªç¯ç»“æŸ
</span></span><span style="display:flex;"><span> ; ç»™å­—ç¬¦ä¸² str_a ç»“å°¾è¡¥ä¸Š &#39;\0&#39;
</span></span><span style="display:flex;"><span> 8048d6b:	c6 45 fe 00          	mov    BYTE PTR [ebp-0x2],0x0
</span></span><span style="display:flex;"><span> 8048d6f:	83 c4 f8             	add    esp,0xfffffff8
</span></span><span style="display:flex;"><span> ; åœ°å€ 0x804980b &#34;giants&#34;
</span></span><span style="display:flex;"><span> 8048d72:	68 0b 98 04 08       	push   0x804980b
</span></span><span style="display:flex;"><span> 8048d77:	8d 45 f8             	lea    eax,[ebp-0x8]
</span></span><span style="display:flex;"><span> 8048d7a:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; æ¯”è¾ƒ str_a å’Œ &#34;giants&#34;
</span></span><span style="display:flex;"><span> ; æ‰€ä»¥è¾“å…¥å­—ç¬¦ä¸²åªçœ‹æœ€ä½å››ä½åº”è¯¥æ˜¯ 15 0 5 11 13 1 ï¼Œåå…­è¿›åˆ¶æ˜¯ f 0 5 b d 1
</span></span><span style="display:flex;"><span> ; æŸ¥çœ‹ ASCII è¡¨ï¼Œæ‰¾åˆ°æ–¹ä¾¿è¾“å…¥çš„å†…å®¹ï¼Œa-z åŠå…¶é™„è¿‘çš„å­—ç¬¦å¾ˆç¬¦åˆè¦æ±‚
</span></span><span style="display:flex;"><span> ; æ‰€ä»¥ä½¿ç”¨ o`ekma
</span></span><span style="display:flex;"><span> 8048d7b:	e8 b0 02 00 00       	call   8049030 &lt;strings_not_equal&gt;
</span></span><span style="display:flex;"><span> ......
</span></span></code></pre></div><p>è¾“å…¥<code>o`ekma</code>æˆåŠŸé€šè¿‡äº†è¿™ä¸€å…³ã€‚</p>
<h3 id="phase_6">phase_6<a hidden class="anchor" aria-hidden="true" href="#phase_6">#</a></h3>
<p>è¿™ä¸€å…³æ¯”è¾ƒé•¿ï¼Œæˆ‘å°†å®ƒåˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ã€‚</p>
<p>ä¸€å¼€å§‹å°±èƒ½çœ‹åˆ°å±€éƒ¨å˜é‡è¢«èµ‹å€¼åˆ°ä¸€ä¸ªç¥ç§˜çš„åœ°å€ï¼Œè¿™åº”è¯¥è§£è¿™é¢˜çš„å…³é”®ã€‚ä¹‹åä½¿ç”¨äº†<code>read_six_numbers</code>è¿™ä¸ªå‡½æ•°è¯»å…¥å…­ä¸ªæ•°å­—ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>; phase_6 çš„å‚æ•°ä¸ºå­—ç¬¦ä¸² input ï¼Œåœ¨ [ebp+0x8]
</span></span><span style="display:flex;"><span>08048d98 &lt;phase_6&gt;:
</span></span><span style="display:flex;"><span> ......
</span></span><span style="display:flex;"><span> ; input &lt;- edx
</span></span><span style="display:flex;"><span> 8048da1:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
</span></span><span style="display:flex;"><span> ; *(int *)0x804b26c 153
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæŒ‡é’ˆ C
</span></span><span style="display:flex;"><span> ; C &lt;- 0x804b26c
</span></span><span style="display:flex;"><span> ; å®ƒç›´æ¥æŒ‡å‘äº†ä¸€ä¸ªç¥ç§˜çš„ç»“æ„
</span></span><span style="display:flex;"><span> 8048da4:	c7 45 cc 6c b2 04 08 	mov    DWORD PTR [ebp-0x34],0x804b26c
</span></span><span style="display:flex;"><span> 8048dab:	83 c4 f8             	add    esp,0xfffffff8
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæ•°ç»„ A
</span></span><span style="display:flex;"><span> 8048dae:	8d 45 e8             	lea    eax,[ebp-0x18]
</span></span><span style="display:flex;"><span> 8048db1:	50                   	push   eax
</span></span><span style="display:flex;"><span> 8048db2:	52                   	push   edx
</span></span><span style="display:flex;"><span> 8048db3:	e8 20 02 00 00       	call   8048fd8 &lt;read_six_numbers&gt;
</span></span></code></pre></div><p>ç¢°åˆ°çš„ç¬¬ä¸€ä¸ªå¾ªç¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> ; for (int i = 0; i &lt;= 5; ++i) {
</span></span><span style="display:flex;"><span> ;     if (A[i] &gt; 6)
</span></span><span style="display:flex;"><span> ;         explode_bomb();
</span></span><span style="display:flex;"><span> ;     for (int j = i + 1; j &lt;= 5; ++j) {
</span></span><span style="display:flex;"><span> ;        if (A[i] == A[j])
</span></span><span style="display:flex;"><span> ;            explode_bomb();
</span></span><span style="display:flex;"><span> ;     }
</span></span><span style="display:flex;"><span> ; }
</span></span><span style="display:flex;"><span> ; edi &lt;- 0 ä¸å¦¨ä»¤å…¶ä¸º i
</span></span><span style="display:flex;"><span> 8048db8:	31 ff                	xor    edi,edi
</span></span><span style="display:flex;"><span> 8048dba:	83 c4 10             	add    esp,0x10
</span></span><span style="display:flex;"><span> 8048dbd:	8d 76 00             	lea    esi,[esi+0x0]
</span></span><span style="display:flex;"><span> ; eax &lt;- A
</span></span><span style="display:flex;"><span> ; å¾ªç¯ 6 æ¬¡
</span></span><span style="display:flex;"><span> 8048dc0:	8d 45 e8             	lea    eax,[ebp-0x18]
</span></span><span style="display:flex;"><span> ; eax &lt;- A[i]
</span></span><span style="display:flex;"><span> 8048dc3:	8b 04 b8             	mov    eax,DWORD PTR [eax+edi*4]
</span></span><span style="display:flex;"><span> ; eax &lt;- A[i] - 1
</span></span><span style="display:flex;"><span> 8048dc6:	48                   	dec    eax
</span></span><span style="display:flex;"><span> ; å¦‚æœ eax å¤§äº 5 å°±çˆ†ç‚¸ï¼Œä¸èƒ½å¤§äº 6
</span></span><span style="display:flex;"><span> 8048dc7:	83 f8 05             	cmp    eax,0x5
</span></span><span style="display:flex;"><span> 8048dca:	76 05                	jbe    8048dd1 &lt;phase_6+0x39&gt;
</span></span><span style="display:flex;"><span> 8048dcc:	e8 2b 07 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> ; ebx &lt;- i + 1 ä¸å¦¨ä»¤å…¶ä¸º j
</span></span><span style="display:flex;"><span> 8048dd1:	8d 5f 01             	lea    ebx,[edi+0x1]
</span></span><span style="display:flex;"><span> ; if (j &lt;= 5)
</span></span><span style="display:flex;"><span> 8048dd4:	83 fb 05             	cmp    ebx,0x5
</span></span><span style="display:flex;"><span> 8048dd7:	7f 23                	jg     8048dfc &lt;phase_6+0x64&gt;
</span></span><span style="display:flex;"><span> ; eax &lt;- 4 * edi
</span></span><span style="display:flex;"><span> 8048dd9:	8d 04 bd 00 00 00 00 	lea    eax,[edi*4+0x0]
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ä»¤è¿™ä¸ªå±€éƒ¨å˜é‡ä¸º B
</span></span><span style="display:flex;"><span> ; B &lt;- 4 * edi
</span></span><span style="display:flex;"><span> 8048de0:	89 45 c8             	mov    DWORD PTR [ebp-0x38],eax
</span></span><span style="display:flex;"><span> ; esi &lt;- A
</span></span><span style="display:flex;"><span> 8048de3:	8d 75 e8             	lea    esi,[ebp-0x18]
</span></span><span style="display:flex;"><span> ; å†…å±‚å¾ªç¯
</span></span><span style="display:flex;"><span> 8048de6:	8b 55 c8             	mov    edx,DWORD PTR [ebp-0x38]
</span></span><span style="display:flex;"><span> ; eax &lt;- A[i]
</span></span><span style="display:flex;"><span> 8048de9:	8b 04 32             	mov    eax,DWORD PTR [edx+esi*1]
</span></span><span style="display:flex;"><span> ; æ¯”è¾ƒ A[i] å’Œ A[j]
</span></span><span style="display:flex;"><span> 8048dec:	3b 04 9e             	cmp    eax,DWORD PTR [esi+ebx*4]
</span></span><span style="display:flex;"><span> ; å¦‚æœç›¸ç­‰åˆ™å¼•çˆ†ç‚¸å¼¹
</span></span><span style="display:flex;"><span> 8048def:	75 05                	jne    8048df6 &lt;phase_6+0x5e&gt;
</span></span><span style="display:flex;"><span> 8048df1:	e8 06 07 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> 8048df6:	43                   	inc    ebx
</span></span><span style="display:flex;"><span> 8048df7:	83 fb 05             	cmp    ebx,0x5
</span></span><span style="display:flex;"><span> 8048dfa:	7e ea                	jle    8048de6 &lt;phase_6+0x4e&gt;
</span></span><span style="display:flex;"><span> ; ç»“æŸå†…å±‚å¾ªç¯
</span></span><span style="display:flex;"><span> 8048dfc:	47                   	inc    edi
</span></span><span style="display:flex;"><span> 8048dfd:	83 ff 05             	cmp    edi,0x5
</span></span><span style="display:flex;"><span> 8048e00:	7e be                	jle    8048dc0 &lt;phase_6+0x28&gt;
</span></span><span style="display:flex;"><span> ; ç»“æŸå¾ªç¯
</span></span></code></pre></div><p>è‡³æ­¤å¯ä»¥å¾—å‡ºåˆæ­¥ç»“è®ºï¼Œç¬¬ä¸€ä¸ªæ•°å­—ä¸€å®šä¸å¤§äº 6 ï¼Œè€Œä¸”ä»»æ„ä¸¤ä¸ªæ•°å­—ä¸ç›¸ç­‰</p>
<p>ç¢°åˆ°ç¬¬äºŒä¸ªå¾ªç¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> ; E = D;
</span></span><span style="display:flex;"><span> ; for (int i = 0, p = C; i &lt;= 5; ++i) {
</span></span><span style="display:flex;"><span> ;     j = 1;
</span></span><span style="display:flex;"><span> ;     while (j &lt; A[i]) {
</span></span><span style="display:flex;"><span> ;         p = p-&gt;next;
</span></span><span style="display:flex;"><span> ;         j++;
</span></span><span style="display:flex;"><span> ;     }
</span></span><span style="display:flex;"><span> ;     E[i] = p;
</span></span><span style="display:flex;"><span> ; }
</span></span><span style="display:flex;"><span> ; edi &lt;- 0 ä¸å¦¨ä»¤å…¶ä¸º i
</span></span><span style="display:flex;"><span> 8048e02:	31 ff                	xor    edi,edi
</span></span><span style="display:flex;"><span> ; ecx &lt;- A
</span></span><span style="display:flex;"><span> 8048e04:	8d 4d e8             	lea    ecx,[ebp-0x18]
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæ•°ç»„ D
</span></span><span style="display:flex;"><span> 8048e07:	8d 45 d0             	lea    eax,[ebp-0x30]
</span></span><span style="display:flex;"><span> ; ä¸å¦¨ä»¤è¯¥å±€éƒ¨å˜é‡ä¸ºæŒ‡é’ˆ E
</span></span><span style="display:flex;"><span> ; E &lt;- D
</span></span><span style="display:flex;"><span> 8048e0a:	89 45 c4             	mov    DWORD PTR [ebp-0x3c],eax
</span></span><span style="display:flex;"><span> 8048e0d:	8d 76 00             	lea    esi,[esi+0x0]
</span></span><span style="display:flex;"><span> ; å¾ªç¯ 6 æ¬¡
</span></span><span style="display:flex;"><span> ; esi &lt;- C ä¸å¦¨ä»¤å…¶ä¸ºæŒ‡é’ˆ p
</span></span><span style="display:flex;"><span> ; C åˆå€¼ä¸º 0x804b26c
</span></span><span style="display:flex;"><span> 8048e10:	8b 75 cc             	mov    esi,DWORD PTR [ebp-0x34]
</span></span><span style="display:flex;"><span> ; ebx &lt;- 1 ä¸å¦¨ä»¤å…¶ä¸º j
</span></span><span style="display:flex;"><span> 8048e13:	bb 01 00 00 00       	mov    ebx,0x1
</span></span><span style="display:flex;"><span> 8048e18:	8d 04 bd 00 00 00 00 	lea    eax,[edi*4+0x0]
</span></span><span style="display:flex;"><span> 8048e1f:	89 c2                	mov    edx,eax
</span></span><span style="display:flex;"><span> ; å°† j ä¸ A[i] æ¯”è¾ƒ
</span></span><span style="display:flex;"><span> 8048e21:	3b 1c 08             	cmp    ebx,DWORD PTR [eax+ecx*1]
</span></span><span style="display:flex;"><span> 8048e24:	7d 12                	jge    8048e38 &lt;phase_6+0xa0&gt;
</span></span><span style="display:flex;"><span> ; å¦‚æœå°äºåˆ™æ‰§è¡Œä¸‹é¢è¿™æ®µ
</span></span><span style="display:flex;"><span> ; eax &lt;- A[i]
</span></span><span style="display:flex;"><span> 8048e26:	8b 04 0a             	mov    eax,DWORD PTR [edx+ecx*1]
</span></span><span style="display:flex;"><span> 8048e29:	8d b4 26 00 00 00 00 	lea    esi,[esi+eiz*1+0x0]
</span></span><span style="display:flex;"><span> ; å†…å±‚å¾ªç¯
</span></span><span style="display:flex;"><span> ; æ„Ÿè§‰æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„
</span></span><span style="display:flex;"><span> ; çŒœæµ‹åç§»ä¸º 0x8 çš„ä½ç½®æ˜¯ next å­—æ®µ
</span></span><span style="display:flex;"><span> ; p &lt;- p-&gt;next
</span></span><span style="display:flex;"><span> 8048e30:	8b 76 08             	mov    esi,DWORD PTR [esi+0x8]
</span></span><span style="display:flex;"><span> ; j++
</span></span><span style="display:flex;"><span> 8048e33:	43                   	inc    ebx
</span></span><span style="display:flex;"><span> ; while (j &lt; A[i])
</span></span><span style="display:flex;"><span> 8048e34:	39 c3                	cmp    ebx,eax
</span></span><span style="display:flex;"><span> 8048e36:	7c f8                	jl     8048e30 &lt;phase_6+0x98&gt;
</span></span><span style="display:flex;"><span> ; ç»“æŸå†…å±‚å¾ªç¯
</span></span><span style="display:flex;"><span> ; edx &lt;- E
</span></span><span style="display:flex;"><span> 8048e38:	8b 55 c4             	mov    edx,DWORD PTR [ebp-0x3c]
</span></span><span style="display:flex;"><span> ; E[i] &lt;- p
</span></span><span style="display:flex;"><span> 8048e3b:	89 34 ba             	mov    DWORD PTR [edx+edi*4],esi
</span></span><span style="display:flex;"><span> ; i++
</span></span><span style="display:flex;"><span> 8048e3e:	47                   	inc    edi
</span></span><span style="display:flex;"><span> ; while (i &lt;= 5)
</span></span><span style="display:flex;"><span> 8048e3f:	83 ff 05             	cmp    edi,0x5
</span></span><span style="display:flex;"><span> 8048e42:	7e cc                	jle    8048e10 &lt;phase_6+0x78&gt;
</span></span><span style="display:flex;"><span> ; ç»“æŸå¾ªç¯
</span></span></code></pre></div><p>ä½¿ç”¨ GDB æŸ¥çœ‹ä¸€ä¸‹é‚£ä¸ªç¥ç§˜åœ°å€æœç„¶æœ‰äº†æ”¶è·ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>(gdb) x/3x 0x804b26c
</span></span><span style="display:flex;"><span>0x804b26c &lt;node1&gt;:	0x000000fd	0x00000001	0x0804b260
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x804b260
</span></span><span style="display:flex;"><span>0x804b260 &lt;node2&gt;:	0x000002d5	0x00000002	0x0804b254
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x804b254
</span></span><span style="display:flex;"><span>0x804b254 &lt;node3&gt;:	0x0000012d	0x00000003	0x0804b248
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x804b248
</span></span><span style="display:flex;"><span>0x804b248 &lt;node4&gt;:	0x000003e5	0x00000004	0x0804b23c
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x804b23c
</span></span><span style="display:flex;"><span>0x804b23c &lt;node5&gt;:	0x000000d4	0x00000005	0x0804b230
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x804b230
</span></span><span style="display:flex;"><span>0x804b230 &lt;node6&gt;:	0x000001b0	0x00000006	0x00000000
</span></span><span style="display:flex;"><span>ä¸€å…±æœ‰å…­ä¸ªèŠ‚ç‚¹
</span></span></code></pre></div><p>çŒœæµ‹ä¸‰ä¸ªå­—æ®µåˆ†åˆ«ä¸ºï¼š<code>value</code>, <code>id</code>, <code>next</code></p>
<p>ç¢°åˆ°ç¬¬ä¸‰ä¸ªå¾ªç¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> ; p = D;
</span></span><span style="display:flex;"><span> ; C = D;
</span></span><span style="display:flex;"><span> ; for (int i = 1; i &lt;= 5; ++i) {
</span></span><span style="display:flex;"><span> ;     p-&gt;next = D[i];
</span></span><span style="display:flex;"><span> ;     p = p-&gt;next;
</span></span><span style="display:flex;"><span> ; }
</span></span><span style="display:flex;"><span> ; esi &lt;- D ä¸å¦¨ä»¤å…¶ä¸ºæŒ‡é’ˆ p
</span></span><span style="display:flex;"><span> 8048e44:	8b 75 d0             	mov    esi,DWORD PTR [ebp-0x30]
</span></span><span style="display:flex;"><span> ; C &lt;- D
</span></span><span style="display:flex;"><span> 8048e47:	89 75 cc             	mov    DWORD PTR [ebp-0x34],esi
</span></span><span style="display:flex;"><span> ; edi &lt;- 1 ä»¤å…¶ä¸º i
</span></span><span style="display:flex;"><span> 8048e4a:	bf 01 00 00 00       	mov    edi,0x1
</span></span><span style="display:flex;"><span> ; edx &lt;- D
</span></span><span style="display:flex;"><span> 8048e4f:	8d 55 d0             	lea    edx,[ebp-0x30]
</span></span><span style="display:flex;"><span> ; å¾ªç¯ 6 æ¬¡
</span></span><span style="display:flex;"><span> ; eax &lt;- D[i]
</span></span><span style="display:flex;"><span> 8048e52:	8b 04 ba             	mov    eax,DWORD PTR [edx+edi*4]
</span></span><span style="display:flex;"><span> ; p-&gt;next &lt;- D[i]
</span></span><span style="display:flex;"><span> 8048e55:	89 46 08             	mov    DWORD PTR [esi+0x8],eax
</span></span><span style="display:flex;"><span> ; p &lt;- p-&gt;next
</span></span><span style="display:flex;"><span> 8048e58:	89 c6                	mov    esi,eax
</span></span><span style="display:flex;"><span> ; i++
</span></span><span style="display:flex;"><span> 8048e5a:	47                   	inc    edi
</span></span><span style="display:flex;"><span> ; while (i &lt;= 5)
</span></span><span style="display:flex;"><span> 8048e5b:	83 ff 05             	cmp    edi,0x5
</span></span><span style="display:flex;"><span> 8048e5e:	7e f2                	jle    8048e52 &lt;phase_6+0xba&gt;
</span></span><span style="display:flex;"><span> ; ç»“æŸå¾ªç¯
</span></span><span style="display:flex;"><span> ; p-&gt;next = NULL;
</span></span><span style="display:flex;"><span> 8048e60:	c7 46 08 00 00 00 00 	mov    DWORD PTR [esi+0x8],0x0
</span></span></code></pre></div><p>ä¸Šé¢è¿™éƒ¨åˆ†ä»£ç ç›¸å½“äºæŠŠæ•°ç»„<code>D</code>ä¸²èµ·æ¥å˜ä¸ºä¸€ä¸ªé“¾è¡¨ã€‚</p>
<p>ç¢°åˆ°ç¬¬å››ä¸ªå¾ªç¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> ; p = C;
</span></span><span style="display:flex;"><span> ; for (int i = 0; i &lt;= 4; ++i) {
</span></span><span style="display:flex;"><span> ;     if (p-&gt;value &lt; p-&gt;next-&gt;value) 
</span></span><span style="display:flex;"><span> ;         explode_bomb();
</span></span><span style="display:flex;"><span> ;     p = p-&gt;next;
</span></span><span style="display:flex;"><span> ;     i++;
</span></span><span style="display:flex;"><span> ; }
</span></span><span style="display:flex;"><span> ; æ•°ç»„ D ç»„æˆçš„æ•°åˆ—åº”è¯¥é€’å‡
</span></span><span style="display:flex;"><span> ; æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† 6 ä¸ª node æ’åº
</span></span><span style="display:flex;"><span> ; ä»å¤§åˆ°å°ï¼šnode4 node2 node 6 node3 node1 node5
</span></span><span style="display:flex;"><span> 8048e67:	8b 75 cc             	mov    esi,DWORD PTR [ebp-0x34]
</span></span><span style="display:flex;"><span> 8048e6a:	31 ff                	xor    edi,edi
</span></span><span style="display:flex;"><span> 8048e6c:	8d 74 26 00          	lea    esi,[esi+eiz*1+0x0]
</span></span><span style="display:flex;"><span> ; å¾ªç¯ 5 æ¬¡
</span></span><span style="display:flex;"><span> ; edx &lt;- p-&gt;next
</span></span><span style="display:flex;"><span> 8048e70:	8b 56 08             	mov    edx,DWORD PTR [esi+0x8]
</span></span><span style="display:flex;"><span> ; eax &lt;- p-&gt;value
</span></span><span style="display:flex;"><span> 8048e73:	8b 06                	mov    eax,DWORD PTR [esi]
</span></span><span style="display:flex;"><span> ; å°† p-&gt;value å’Œ p-&gt;next-&gt;value æ¯”è¾ƒ
</span></span><span style="display:flex;"><span> ; å³å¦‚æœå°äºï¼Œåˆ™çˆ†ç‚¸
</span></span><span style="display:flex;"><span> 8048e75:	3b 02                	cmp    eax,DWORD PTR [edx]
</span></span><span style="display:flex;"><span> 8048e77:	7d 05                	jge    8048e7e &lt;phase_6+0xe6&gt;
</span></span><span style="display:flex;"><span> 8048e79:	e8 7e 06 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> ; p &lt;- p-&gt;next 
</span></span><span style="display:flex;"><span> 8048e7e:	8b 76 08             	mov    esi,DWORD PTR [esi+0x8]
</span></span><span style="display:flex;"><span> ; i++
</span></span><span style="display:flex;"><span> 8048e81:	47                   	inc    edi
</span></span><span style="display:flex;"><span> ; while (i &lt;= 4)
</span></span><span style="display:flex;"><span> 8048e82:	83 ff 04             	cmp    edi,0x4
</span></span><span style="display:flex;"><span> 8048e85:	7e e9                	jle    8048e70 &lt;phase_6+0xd8&gt;
</span></span><span style="display:flex;"><span> ; ç»“æŸå¾ªç¯
</span></span></code></pre></div><p>ç”±äºä»å¤§åˆ°å°æ˜¯<code>node4</code>, <code>node2</code>, <code>node6</code>, <code>node3</code>, <code>node1</code>, <code>node5</code>ã€‚</p>
<p>è¾“å…¥å­—ç¬¦ä¸²<code>4 2 6 3 1 5</code>ä¾¿èƒ½é€šè¿‡è¿™å…³ã€‚</p>
<h3 id="secret_phase">secret_phase<a hidden class="anchor" aria-hidden="true" href="#secret_phase">#</a></h3>
<p>å…¶å®åœ¨ 6 å…³ä¹‹åè¿˜æœ‰ä¸€ä¸ªéšè—å…³å¡ï¼Œéœ€è¦ä¸€å®šçš„æ¡ä»¶è§¦å‘ã€‚</p>
<p>å¯ä»¥ç›´æ¥åœ¨<code>bomb.disas</code>é‡Œé¢æŸ¥æ‰¾å‡½æ•°<code>secret_phase</code>ï¼Œç„¶åå¯ä»¥å‘ç°å®ƒåœ¨å‡½æ•°<code>phase_defused</code>ä¸­è¢«è°ƒç”¨ã€‚</p>
<p>é¦–å…ˆåœ¨<code>phase_6</code>æ‰“ä¸Šæ–­ç‚¹ï¼Œå‘ç°åœ¨<code>phase_defused</code>ä¸­å‘ç°æœ‰æ€ªå¼‚ä¹‹å¤„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> 8049543:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; æ ¼å¼åŒ–å­—ç¬¦ä¸²
</span></span><span style="display:flex;"><span> ; (gdb) x/s 0x8049d03
</span></span><span style="display:flex;"><span> ; 0x8049d03:	&#34;%d %s&#34;
</span></span><span style="display:flex;"><span> 8049544:	68 03 9d 04 08       	push   0x8049d03
</span></span><span style="display:flex;"><span> ; æ²¡æœ‰è§£é”éšè—å…³å¡æ—¶ï¼Œè¾“å…¥å­—ç¬¦ä¸²åªæœ‰ä¸€ä¸ª 9 ï¼Œè¿™ä¸ä¸¤ä¸ªå ä½ç¬¦çš„ä¸ç›¸ç¬¦
</span></span><span style="display:flex;"><span> ; æ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨ 9 åé¢è¡¥ä¸Šä¸€ä¸ªå­—ç¬¦ä¸²
</span></span><span style="display:flex;"><span> ; åœ¨ phase_6 æ‰“ä¸Šæ–­ç‚¹
</span></span><span style="display:flex;"><span> ; (gdb) break phase_6
</span></span><span style="display:flex;"><span> ; (gdb) run
</span></span><span style="display:flex;"><span> ; (gdb) x/s 0x804b770
</span></span><span style="display:flex;"><span> ; 0x804b770 &lt;input_strings+240&gt;:	&#34;9&#34;
</span></span><span style="display:flex;"><span> 8049549:	68 70 b7 04 08       	push   0x804b770
</span></span><span style="display:flex;"><span> 804954e:	e8 0d f3 ff ff       	call   8048860 &lt;sscanf@plt&gt;
</span></span><span style="display:flex;"><span> 8049553:	83 c4 10             	add    esp,0x10
</span></span></code></pre></div><p>å‘ç°è¿™é‡Œæœ‰ä¸ªç”¨äºè°ƒè¯•çš„æ ‡ç­¾<code>input_strings</code>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹<code>input_strings</code> +0 +80 +160 éƒ½æ˜¯ä»€ä¹ˆï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>(gdb) x/s 0x804b770-240
</span></span><span style="display:flex;"><span>0x804b680 &lt;input_strings&gt;:	&#34;Public speaking is very easy.&#34;
</span></span><span style="display:flex;"><span>(gdb) x/s 0x804b770-240+80
</span></span><span style="display:flex;"><span>0x804b6d0 &lt;input_strings+80&gt;:	&#34;1 2 6 24 120 720&#34;
</span></span><span style="display:flex;"><span>(gdb) x/s 0x804b770-240+160
</span></span><span style="display:flex;"><span>0x804b720 &lt;input_strings+160&gt;:	&#34;0 q 777&#34;
</span></span></code></pre></div><p>å‘ç°æ˜¯å‰ä¸‰å…³è¾“å…¥çš„å­—ç¬¦ï¼Œæ‰€ä»¥&quot;9&quot;å¯¹åº”çš„æ˜¯æˆ‘ä»¬ç¬¬å››å…³çš„è¾“å…¥</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> ; å¦‚æœæˆåŠŸç»™ä¸¤ä¸ªå‚æ•°èµ‹å€¼
</span></span><span style="display:flex;"><span> 8049556:	83 f8 02             	cmp    eax,0x2
</span></span><span style="display:flex;"><span> 8049559:	75 37                	jne    8049592 &lt;phase_defused+0x66&gt;
</span></span><span style="display:flex;"><span> 804955b:	83 c4 f8             	add    esp,0xfffffff8
</span></span><span style="display:flex;"><span> ; å­—ç¬¦ä¸²æ¯”å¯¹
</span></span><span style="display:flex;"><span> ; (gdb) x/s 0x8049d09
</span></span><span style="display:flex;"><span> ; 0x8049d09:	&#34;austinpowers&#34;
</span></span><span style="display:flex;"><span> ; å¯ä»¥å¾—çŸ¥ç¬¬å››å…³æ—¶åé¢åº”è¯¥æ·»åŠ ä¸€ä¸ª&#34;austinpowers&#34;
</span></span><span style="display:flex;"><span> ; ç”±æ­¤å¯ä»¥è¿›å…¥éšè—å…³å¡
</span></span><span style="display:flex;"><span> ......
</span></span><span style="display:flex;"><span> 804958d:	e8 56 f9 ff ff       	call   8048ee8 &lt;secret_phase&gt;
</span></span></code></pre></div><p>ç°åœ¨æˆ‘ä»¬å¼€å§‹çœ‹å‡½æ•°<code>secret_phase</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>08048ee8 &lt;secret_phase&gt;:
</span></span><span style="display:flex;"><span> 8048ee8:	55                   	push   ebp
</span></span><span style="display:flex;"><span> 8048ee9:	89 e5                	mov    ebp,esp
</span></span><span style="display:flex;"><span> 8048eeb:	83 ec 14             	sub    esp,0x14
</span></span><span style="display:flex;"><span> 8048eee:	53                   	push   ebx
</span></span><span style="display:flex;"><span> ; å°†è¾“å…¥çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—
</span></span><span style="display:flex;"><span> ; è¿”å›å€¼åœ¨ eax
</span></span><span style="display:flex;"><span> 8048eef:	e8 08 03 00 00       	call   80491fc &lt;read_line&gt;
</span></span><span style="display:flex;"><span> 8048ef4:	6a 00                	push   0x0
</span></span><span style="display:flex;"><span> 8048ef6:	6a 0a                	push   0xa
</span></span><span style="display:flex;"><span> 8048ef8:	6a 00                	push   0x0
</span></span><span style="display:flex;"><span> 8048efa:	50                   	push   eax
</span></span><span style="display:flex;"><span> 8048efb:	e8 f0 f8 ff ff       	call   80487f0 &lt;__strtol_internal@plt&gt;
</span></span><span style="display:flex;"><span> 8048f00:	83 c4 10             	add    esp,0x10
</span></span><span style="display:flex;"><span> 8048f03:	89 c3                	mov    ebx,eax
</span></span><span style="display:flex;"><span> 8048f05:	8d 43 ff             	lea    eax,[ebx-0x1]
</span></span><span style="display:flex;"><span> ; å¦‚æœ input-1 å¤§äº 0x3e8 åˆ™çˆ†ç‚¸
</span></span><span style="display:flex;"><span> 8048f08:	3d e8 03 00 00       	cmp    eax,0x3e8
</span></span><span style="display:flex;"><span> 8048f0d:	76 05                	jbe    8048f14 &lt;secret_phase+0x2c&gt;
</span></span><span style="display:flex;"><span> 8048f0f:	e8 e8 05 00 00       	call   80494fc &lt;explode_bomb&gt;
</span></span><span style="display:flex;"><span> 8048f14:	83 c4 f8             	add    esp,0xfffffff8
</span></span><span style="display:flex;"><span> 8048f17:	53                   	push   ebx
</span></span><span style="display:flex;"><span> ; è¯¥åœ°å€å¯èƒ½æŒ‡å‘ä¸€ä¸ªæ•°ç»„æˆ–è€…ç»“æ„
</span></span><span style="display:flex;"><span> 8048f18:	68 20 b3 04 08       	push   0x804b320
</span></span><span style="display:flex;"><span> 8048f1d:	e8 72 ff ff ff       	call   8048e94 &lt;fun7&gt;
</span></span><span style="display:flex;"><span> 8048f22:	83 c4 10             	add    esp,0x10
</span></span><span style="display:flex;"><span> ; å¦‚æœè¿”å›å€¼ä¸º 7 åˆ™æˆåŠŸ
</span></span><span style="display:flex;"><span> 8048f25:	83 f8 07             	cmp    eax,0x7
</span></span><span style="display:flex;"><span> 8048f28:	74 05                	je     8048f2f &lt;secret_phase+0x47&gt;
</span></span><span style="display:flex;"><span> ......
</span></span></code></pre></div><p>ç”±äºè°ƒç”¨äº†å‡½æ•°<code>fun7</code>ï¼Œæˆ‘ä»¬ç›´æ¥æ¥çœ‹å®ƒã€‚<code>func7</code>æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„é€’å½’å‡½æ•°ï¼Œä¸»è¦æ˜¯ç»“æ„ä½“è¾ƒä¸ºå¤æ‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>08048e94 &lt;fun7&gt;:
</span></span><span style="display:flex;"><span> 8048e94:	55                   	push   ebp
</span></span><span style="display:flex;"><span> 8048e95:	89 e5                	mov    ebp,esp
</span></span><span style="display:flex;"><span> 8048e97:	83 ec 08             	sub    esp,0x8
</span></span><span style="display:flex;"><span> 8048e9a:	8b 55 08             	mov    edx,DWORD PTR [ebp+0x8]
</span></span><span style="display:flex;"><span> 8048e9d:	8b 45 0c             	mov    eax,DWORD PTR [ebp+0xc]
</span></span><span style="display:flex;"><span> 8048ea0:	85 d2                	test   edx,edx
</span></span><span style="display:flex;"><span> 8048ea2:	75 0c                	jne    8048eb0 &lt;fun7+0x1c&gt;
</span></span><span style="display:flex;"><span> 8048ea4:	b8 ff ff ff ff       	mov    eax,0xffffffff
</span></span><span style="display:flex;"><span> 8048ea9:	eb 37                	jmp    8048ee2 &lt;fun7+0x4e&gt;
</span></span><span style="display:flex;"><span> 8048eab:	90                   	nop
</span></span><span style="display:flex;"><span> 8048eac:	8d 74 26 00          	lea    esi,[esi+eiz*1+0x0]
</span></span><span style="display:flex;"><span> 8048eb0:	3b 02                	cmp    eax,DWORD PTR [edx]
</span></span><span style="display:flex;"><span> 8048eb2:	7d 11                	jge    8048ec5 &lt;fun7+0x31&gt;
</span></span><span style="display:flex;"><span> 8048eb4:	83 c4 f8             	add    esp,0xfffffff8
</span></span><span style="display:flex;"><span> 8048eb7:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; ç±»ä¼¼é“¾è¡¨çš„ç»“æ„
</span></span><span style="display:flex;"><span> 8048eb8:	8b 42 04             	mov    eax,DWORD PTR [edx+0x4]
</span></span><span style="display:flex;"><span> 8048ebb:	50                   	push   eax
</span></span><span style="display:flex;"><span> 8048ebc:	e8 d3 ff ff ff       	call   8048e94 &lt;fun7&gt;
</span></span><span style="display:flex;"><span> 8048ec1:	01 c0                	add    eax,eax
</span></span><span style="display:flex;"><span> 8048ec3:	eb 1d                	jmp    8048ee2 &lt;fun7+0x4e&gt;
</span></span><span style="display:flex;"><span> 8048ec5:	3b 02                	cmp    eax,DWORD PTR [edx]
</span></span><span style="display:flex;"><span> 8048ec7:	74 17                	je     8048ee0 &lt;fun7+0x4c&gt;
</span></span><span style="display:flex;"><span> 8048ec9:	83 c4 f8             	add    esp,0xfffffff8
</span></span><span style="display:flex;"><span> 8048ecc:	50                   	push   eax
</span></span><span style="display:flex;"><span> ; ç±»ä¼¼é“¾è¡¨çš„ç»“æ„
</span></span><span style="display:flex;"><span> 8048ecd:	8b 42 08             	mov    eax,DWORD PTR [edx+0x8]
</span></span><span style="display:flex;"><span> 8048ed0:	50                   	push   eax
</span></span><span style="display:flex;"><span> 8048ed1:	e8 be ff ff ff       	call   8048e94 &lt;fun7&gt;
</span></span><span style="display:flex;"><span> 8048ed6:	01 c0                	add    eax,eax
</span></span><span style="display:flex;"><span> 8048ed8:	40                   	inc    eax
</span></span><span style="display:flex;"><span> 8048ed9:	eb 07                	jmp    8048ee2 &lt;fun7+0x4e&gt;
</span></span><span style="display:flex;"><span> 8048edb:	90                   	nop
</span></span><span style="display:flex;"><span> 8048edc:	8d 74 26 00          	lea    esi,[esi+eiz*1+0x0]
</span></span><span style="display:flex;"><span> 8048ee0:	31 c0                	xor    eax,eax
</span></span><span style="display:flex;"><span> 8048ee2:	89 ec                	mov    esp,ebp
</span></span><span style="display:flex;"><span> 8048ee4:	5d                   	pop    ebp
</span></span><span style="display:flex;"><span> 8048ee5:	c3                   	ret    
</span></span><span style="display:flex;"><span> 8048ee6:	89 f6                	mov    esi,esi
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°æœ‰ç±»ä¼¼é“¾è¡¨çš„ç»“æ„ï¼Œä½†æ˜¯å®ƒæ‹¥æœ‰ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæƒ³è±¡ä¸ºä¸€æ£µæ ‘ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#007f7f">// fun7 è¾“å…¥å‚æ•°ï¼šæŒ‡é’ˆ p å’Œ æ•´å‹ n
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">// p å¯ä»¥ç†è§£ä¸ºäºŒå‰æ ‘çš„èŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">typedef</span> <span style="color:#fff;font-weight:bold">struct</span> TreeNode {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> value;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">struct</span> TreeNode *left;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">struct</span> TreeNode *right;
</span></span><span style="display:flex;"><span>} TreeNode;
</span></span></code></pre></div><p>è¿™æ ·ä¸€æ¥<code>fun7</code>é©¬ä¸Šå¯ä»¥å†™æˆ C è¯­è¨€ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> fun7(TreeNode *p, <span style="color:#fff;font-weight:bold">int</span> n) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (p == <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> -<span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (n-&gt;value &lt; p[<span style="color:#ff0;font-weight:bold">0</span>]) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">2</span> * fun7(p-&gt;left, n);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> (n == p[<span style="color:#ff0;font-weight:bold">0</span>]) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">2</span> * fun7(p-&gt;right, n) + <span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç”±äºéœ€è¦é€’å½’å‡½æ•°è¿”å› 7 (å‚æ•°<code>(p, n)</code>)ï¼Œæ‰€ä»¥å†…ä¸€å±‚åªèƒ½è¿”å› 3 (å‚æ•°<code>(p-&gt;right, n)</code>)ï¼Œ å†å†…ä¸€å±‚åªèƒ½è¿”å› 1 <code>(p-&gt;right-&gt;right, n)</code>ï¼Œæœ€é‡Œé¢ä¸€å±‚è¿”å› 0 <code>(p-&gt;right-&gt;right-&gt;right, n)</code>ã€‚ æ‰€ä»¥ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶<code>p-&gt;righ-&gt;right-&gt;right-&gt;value</code>åº”è¯¥ä¸<code>n</code>ç›¸ç­‰</p>
<p>å¯ä»¥é€šè¿‡ GDB å¾ˆå¿«æ‰¾åˆ°ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>#                   value         left          right
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x804b320
</span></span><span style="display:flex;"><span>0x804b320 &lt;n1&gt;:     0x00000024    0x0804b314    0x0804b308
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x0804b308
</span></span><span style="display:flex;"><span>0x804b308 &lt;n22&gt;:    0x00000032    0x0804b2f0    0x0804b2d8
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x0804b2d8
</span></span><span style="display:flex;"><span>0x804b2d8 &lt;n34&gt;:    0x0000006b    0x0804b2b4    0x0804b278
</span></span><span style="display:flex;"><span>(gdb) x/3x 0x0804b278
</span></span><span style="display:flex;"><span>0x804b278 &lt;n48&gt;:    0x000003e9    0x00000000    0x00000000
</span></span></code></pre></div><p>æ‰€ä»¥åº”è¯¥è¾“å…¥<code>3e9</code>ä¹Ÿå°±æ˜¯åè¿›åˆ¶<code>1001</code>ã€‚</p>
<h3 id="è¾“å…¥æ–‡ä»¶">è¾“å…¥æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#è¾“å…¥æ–‡ä»¶">#</a></h3>
<p>å¦‚ä¸‹æ˜¯æœ€åé€šè¿‡æµ‹è¯•çš„è¾“å…¥æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$ cat input
</span></span><span style="display:flex;"><span>Public speaking is very easy.
</span></span><span style="display:flex;"><span>1 2 6 24 120 720
</span></span><span style="display:flex;"><span>0 q 777
</span></span><span style="display:flex;"><span>9 austinpowers
</span></span><span style="display:flex;"><span>o`ekma
</span></span><span style="display:flex;"><span>4 2 6 3 1 5
</span></span><span style="display:flex;"><span>1001
</span></span></code></pre></div><h2 id="å®éªŒæ„Ÿå—">å®éªŒæ„Ÿå—<a hidden class="anchor" aria-hidden="true" href="#å®éªŒæ„Ÿå—">#</a></h2>
<p>è¿™å…­å…³åˆ†åˆ«æ¶‰åŠäº†å­—ç¬¦ä¸²å¸¸é‡ã€å¾ªç¯ã€switch-caseï¼ˆè·³è½¬è¡¨ï¼‰ã€é€’å½’ã€æ•°ç»„ã€é“¾è¡¨ç­‰çŸ¥è¯†ï¼Œéš¾åº¦æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆå¤§ï¼Œè€å¿ƒçœ‹æ±‡ç¼–ä»£ç å…¶å®æ˜¯å¾ˆå®¹æ˜“çœ‹æ‡‚çš„ã€‚è€Œéšè—å…³å¡éœ€è¦ç»†å¿ƒæˆ–è€…è¿æ°”å‘ç°ï¼Œä½†æ˜¯è§£å†³å®ƒå¹¶ä¸æ˜¯é—®é¢˜ã€‚</p>
<p>åš Lab æ—¶æ²¡æœ‰åŠ¨æ€è°ƒè¯•è¿™ä¸ªç¨‹åºï¼Œæ„Ÿè§‰ä¹Ÿæ²¡æœ‰åŠ¨æ€è°ƒè¯•çš„å¿…è¦ï¼Œåªè¦çœ‹åˆ°äº†â€œé­”æ³•â€åœ°å€å°±å¯ä»¥ç›´æ¥ GDB æŸ¥çœ‹å®ƒã€‚</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://vaaandark.top/tags/csapp/">CSAPP</a></li>
      <li><a href="https://vaaandark.top/tags/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/">æ±‡ç¼–è¯­è¨€</a></li>
      <li><a href="https://vaaandark.top/tags/%E5%8F%8D%E6%B1%87%E7%BC%96/">åæ±‡ç¼–</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://vaaandark.top/posts/2022.11.6-man-utd-vs-aston-villa/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>2022.11.6 ç»´æ‹‰ 3 : 1 æ›¼è”</span>
  </a>
  <a class="next" href="https://vaaandark.top/posts/dive-in-vla/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>ç¨å¾®æ·±å…¥VLA</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CSAPP Bomb Lab on x"
            href="https://x.com/intent/tweet/?text=CSAPP%20Bomb%20Lab&amp;url=https%3a%2f%2fvaaandark.top%2fposts%2fcsapp-bomb-lab%2f&amp;hashtags=CSAPP%2c%e6%b1%87%e7%bc%96%e8%af%ad%e8%a8%80%2c%e5%8f%8d%e6%b1%87%e7%bc%96">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CSAPP Bomb Lab on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fvaaandark.top%2fposts%2fcsapp-bomb-lab%2f&amp;title=CSAPP%20Bomb%20Lab&amp;summary=CSAPP%20Bomb%20Lab&amp;source=https%3a%2f%2fvaaandark.top%2fposts%2fcsapp-bomb-lab%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CSAPP Bomb Lab on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fvaaandark.top%2fposts%2fcsapp-bomb-lab%2f&title=CSAPP%20Bomb%20Lab">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CSAPP Bomb Lab on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fvaaandark.top%2fposts%2fcsapp-bomb-lab%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CSAPP Bomb Lab on whatsapp"
            href="https://api.whatsapp.com/send?text=CSAPP%20Bomb%20Lab%20-%20https%3a%2f%2fvaaandark.top%2fposts%2fcsapp-bomb-lab%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CSAPP Bomb Lab on telegram"
            href="https://telegram.me/share/url?text=CSAPP%20Bomb%20Lab&amp;url=https%3a%2f%2fvaaandark.top%2fposts%2fcsapp-bomb-lab%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share CSAPP Bomb Lab on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=CSAPP%20Bomb%20Lab&u=https%3a%2f%2fvaaandark.top%2fposts%2fcsapp-bomb-lab%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer><script src="https://giscus.app/client.js"
        data-repo="vaaandark/vaaandark.github.io"
        data-repo-id="R_kgDOGsxTxw"
        data-category="Announcements"
        data-category-id="DIC_kwDOGsxTx84CmAQ1"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://vaaandark.top/">vaaandark&#39;s blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
